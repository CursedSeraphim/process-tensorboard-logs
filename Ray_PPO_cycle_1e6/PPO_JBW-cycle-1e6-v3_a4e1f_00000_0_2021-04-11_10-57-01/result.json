{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 4000, "timers": {"sample_time_ms": 10684.494, "sample_throughput": 374.374, "learn_time_ms": 11710.042, "learn_throughput": 341.587, "update_time_ms": 3.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.9564022123813629, "policy_loss": -0.04654676356585696, "vf_loss": 1.0003601759672165, "vf_explained_var": 0.25058871507644653, "kl": 0.012944000161951408, "entropy": 1.0854780972003937, "entropy_coeff": 0.0}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-57-49", "timestamp": 1618138669, "time_this_iter_s": 22.404359102249146, "time_total_s": 22.404359102249146, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7172212090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717225b110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.404359102249146, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.615624999999994, "ram_util_percent": 26.9625}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 8000, "timers": {"sample_time_ms": 8887.834, "sample_throughput": 450.053, "learn_time_ms": 11677.502, "learn_throughput": 342.539, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.8949156422168016, "policy_loss": -0.05146123736631125, "vf_loss": 0.9429642651230097, "vf_explained_var": 0.2826651930809021, "kl": 0.01706303789978847, "entropy": 1.060148075222969, "entropy_coeff": 0.0}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-58-08", "timestamp": 1618138688, "time_this_iter_s": 18.745776891708374, "time_total_s": 41.15013599395752, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7172212410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221ff50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.15013599395752, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.11851851851852, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 62.0, "episode_reward_min": 62.0, "episode_reward_mean": 62.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5161862762339283, "mean_raw_obs_processing_ms": 0.06687373938575186, "mean_inference_ms": 1.4394555188409388, "mean_action_processing_ms": 0.040215598018097286}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12000, "timers": {"sample_time_ms": 8322.078, "sample_throughput": 480.649, "learn_time_ms": 11628.958, "learn_throughput": 343.969, "update_time_ms": 2.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.6104680169373751, "policy_loss": -0.060798422258812934, "vf_loss": 0.6677524615079165, "vf_explained_var": 0.4537912607192993, "kl": 0.017569875984918326, "entropy": 1.0286804549396038, "entropy_coeff": 0.0}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-58-26", "timestamp": 1618138706, "time_this_iter_s": 18.72985315322876, "time_total_s": 59.87998914718628, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266305fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 59.87998914718628, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 57.644444444444446, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 62.0, "episode_reward_min": 62.0, "episode_reward_mean": 62.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5161862762339283, "mean_raw_obs_processing_ms": 0.06687373938575186, "mean_inference_ms": 1.4394555188409388, "mean_action_processing_ms": 0.040215598018097286}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timers": {"sample_time_ms": 8170.697, "sample_throughput": 489.554, "learn_time_ms": 11609.422, "learn_throughput": 344.548, "update_time_ms": 2.713}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 2.285941895097494, "policy_loss": -0.05539068958023563, "vf_loss": 2.3371195644140244, "vf_explained_var": 0.5801271200180054, "kl": 0.021065071923658252, "entropy": 0.9535374026745558, "entropy_coeff": 0.0}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 1, "training_iteration": 4, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-58-46", "timestamp": 1618138726, "time_this_iter_s": 19.27550983428955, "time_total_s": 79.15549898147583, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 79.15549898147583, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.682142857142864, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 267.0, "episode_reward_min": 267.0, "episode_reward_mean": 267.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43409837793632783, "mean_raw_obs_processing_ms": 0.0670877529808202, "mean_inference_ms": 1.4435771965788613, "mean_action_processing_ms": 0.040307068108356055}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 20000, "timers": {"sample_time_ms": 8010.423, "sample_throughput": 499.349, "learn_time_ms": 11601.639, "learn_throughput": 344.779, "update_time_ms": 2.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 2.739310495555401, "policy_loss": -0.05586903152288869, "vf_loss": 2.7904237508773804, "vf_explained_var": 0.4566250145435333, "kl": 0.015852517273742706, "entropy": 0.9484018292278051, "entropy_coeff": 0.0}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 2, "training_iteration": 5, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-59-05", "timestamp": 1618138745, "time_this_iter_s": 18.949352741241455, "time_total_s": 98.10485172271729, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171172950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 98.10485172271729, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.15555555555555, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 267.0, "episode_reward_min": 267.0, "episode_reward_mean": 267.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43409837793632783, "mean_raw_obs_processing_ms": 0.0670877529808202, "mean_inference_ms": 1.4435771965788613, "mean_action_processing_ms": 0.040307068108356055}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timers": {"sample_time_ms": 7968.58, "sample_throughput": 501.971, "learn_time_ms": 11598.208, "learn_throughput": 344.881, "update_time_ms": 2.73}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 2.460766278207302, "policy_loss": -0.04957205633400008, "vf_loss": 2.505906295031309, "vf_explained_var": 0.29892435669898987, "kl": 0.014773435977986082, "entropy": 0.8765409681946039, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 2, "training_iteration": 6, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-59-24", "timestamp": 1618138764, "time_this_iter_s": 19.347684621810913, "time_total_s": 117.4525363445282, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171172410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 117.4525363445282, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.766666666666666, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 267.0, "episode_reward_min": 267.0, "episode_reward_mean": 267.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43409837793632783, "mean_raw_obs_processing_ms": 0.0670877529808202, "mean_inference_ms": 1.4435771965788613, "mean_action_processing_ms": 0.040307068108356055}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28000, "timers": {"sample_time_ms": 7845.142, "sample_throughput": 509.87, "learn_time_ms": 11604.11, "learn_throughput": 344.705, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 3.9257073923945427, "policy_loss": -0.04740542033687234, "vf_loss": 3.968736544251442, "vf_explained_var": 0.5086113810539246, "kl": 0.014587712823413312, "entropy": 0.863006703555584, "entropy_coeff": 0.0}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 2, "training_iteration": 7, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_10-59-43", "timestamp": 1618138783, "time_this_iter_s": 18.75573182106018, "time_total_s": 136.20826816558838, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71722121d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72662f8ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 136.20826816558838, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 57.02592592592591, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 537.0, "episode_reward_min": 537.0, "episode_reward_mean": 537.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [537.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40155736913025697, "mean_raw_obs_processing_ms": 0.0671718661544703, "mean_inference_ms": 1.4378458279184443, "mean_action_processing_ms": 0.04006235276396239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timers": {"sample_time_ms": 7855.811, "sample_throughput": 509.177, "learn_time_ms": 11621.693, "learn_throughput": 344.184, "update_time_ms": 2.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 4.633906207978725, "policy_loss": -0.04419399966718629, "vf_loss": 4.674164168536663, "vf_explained_var": 0.39696913957595825, "kl": 0.013120512157911435, "entropy": 0.8072747830301523, "entropy_coeff": 0.0}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 3, "training_iteration": 8, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-00-03", "timestamp": 1618138803, "time_this_iter_s": 19.68605399131775, "time_total_s": 155.89432215690613, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 155.89432215690613, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.449999999999996, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 537.0, "episode_reward_min": 537.0, "episode_reward_mean": 537.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [537.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40155736913025697, "mean_raw_obs_processing_ms": 0.0671718661544703, "mean_inference_ms": 1.4378458279184443, "mean_action_processing_ms": 0.04006235276396239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 36000, "timers": {"sample_time_ms": 8021.45, "sample_throughput": 498.663, "learn_time_ms": 11615.579, "learn_throughput": 344.365, "update_time_ms": 2.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 4.662587456405163, "policy_loss": -0.053480549599044025, "vf_loss": 4.711557105183601, "vf_explained_var": 0.2541264295578003, "kl": 0.01503656999557279, "entropy": 0.7800772935152054, "entropy_coeff": 0.0}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 3, "training_iteration": 9, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-00-24", "timestamp": 1618138824, "time_this_iter_s": 20.921049118041992, "time_total_s": 176.81537127494812, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172265090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 176.81537127494812, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.18333333333332, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 883.0, "episode_reward_min": 883.0, "episode_reward_mean": 883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48164235857444326, "mean_raw_obs_processing_ms": 0.06743497346175355, "mean_inference_ms": 1.438826710721087, "mean_action_processing_ms": 0.04007738770993006}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 40000, "timers": {"sample_time_ms": 8180.818, "sample_throughput": 488.949, "learn_time_ms": 11609.433, "learn_throughput": 344.547, "update_time_ms": 2.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.377753183245659, "policy_loss": -0.047764258342795074, "vf_loss": 5.421351596713066, "vf_explained_var": 0.19082117080688477, "kl": 0.013886112137697637, "entropy": 0.714862672612071, "entropy_coeff": 0.0}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 4, "training_iteration": 10, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-00-45", "timestamp": 1618138845, "time_this_iter_s": 21.17872166633606, "time_total_s": 197.99409294128418, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171178110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116cbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 197.99409294128418, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 57.193333333333335, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 883.0, "episode_reward_min": 883.0, "episode_reward_mean": 883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48164235857444326, "mean_raw_obs_processing_ms": 0.06743497346175355, "mean_inference_ms": 1.438826710721087, "mean_action_processing_ms": 0.04007738770993006}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44000, "timers": {"sample_time_ms": 7967.098, "sample_throughput": 502.065, "learn_time_ms": 11589.564, "learn_throughput": 345.138, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.642952382564545, "policy_loss": -0.033176073571667075, "vf_loss": 5.672663226723671, "vf_explained_var": 0.5276917815208435, "kl": 0.01155048658256419, "entropy": 0.7210626471787691, "entropy_coeff": 0.0}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 4, "training_iteration": 11, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-01-05", "timestamp": 1618138865, "time_this_iter_s": 20.06944966316223, "time_total_s": 218.0635426044464, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 218.0635426044464, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 57.265517241379314, "ram_util_percent": 26.94482758620689}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 883.0, "episode_reward_min": 883.0, "episode_reward_mean": 883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48164235857444326, "mean_raw_obs_processing_ms": 0.06743497346175355, "mean_inference_ms": 1.438826710721087, "mean_action_processing_ms": 0.04007738770993006}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timers": {"sample_time_ms": 8101.397, "sample_throughput": 493.742, "learn_time_ms": 11579.351, "learn_throughput": 345.443, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 4.398096218705177, "policy_loss": -0.04725537437479943, "vf_loss": 4.441354371607304, "vf_explained_var": 0.31115445494651794, "kl": 0.013324216386536136, "entropy": 0.6944810692220926, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 4, "training_iteration": 12, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-01-25", "timestamp": 1618138885, "time_this_iter_s": 19.98800301551819, "time_total_s": 238.0515456199646, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117fe10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117f550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 238.0515456199646, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.675000000000004, "ram_util_percent": 26.90357142857142}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 903.0, "episode_reward_min": 903.0, "episode_reward_mean": 903.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [903.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4803685417005836, "mean_raw_obs_processing_ms": 0.06787463936956385, "mean_inference_ms": 1.44084116896355, "mean_action_processing_ms": 0.040214971057204264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52000, "timers": {"sample_time_ms": 8145.132, "sample_throughput": 491.091, "learn_time_ms": 11583.955, "learn_throughput": 345.305, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.864661455154419, "policy_loss": -0.04959203797625378, "vf_loss": 7.91008198261261, "vf_explained_var": 0.49449270963668823, "kl": 0.013905474363127723, "entropy": 0.7180042676627636, "entropy_coeff": 0.0}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 5, "training_iteration": 13, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-01-44", "timestamp": 1618138904, "time_this_iter_s": 19.213594436645508, "time_total_s": 257.2651400566101, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266306850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 257.2651400566101, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 56.69285714285716, "ram_util_percent": 26.899999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 903.0, "episode_reward_min": 903.0, "episode_reward_mean": 903.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [903.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4803685417005836, "mean_raw_obs_processing_ms": 0.06787463936956385, "mean_inference_ms": 1.44084116896355, "mean_action_processing_ms": 0.040214971057204264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 56000, "timers": {"sample_time_ms": 8278.367, "sample_throughput": 483.187, "learn_time_ms": 11584.994, "learn_throughput": 345.274, "update_time_ms": 2.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.741260543465614, "policy_loss": -0.04476650938158855, "vf_loss": 5.78152921050787, "vf_explained_var": 0.24580085277557373, "kl": 0.014993030286859721, "entropy": 0.6039386559277773, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 5, "training_iteration": 14, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-02-05", "timestamp": 1618138925, "time_this_iter_s": 20.620428323745728, "time_total_s": 277.88556838035583, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171172550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 277.88556838035583, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 57.43103448275861, "ram_util_percent": 26.89999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1210.0, "episode_reward_min": 1210.0, "episode_reward_mean": 1210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5090805401859838, "mean_raw_obs_processing_ms": 0.0683892733041343, "mean_inference_ms": 1.4460254427977448, "mean_action_processing_ms": 0.04030936928689942}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 60000, "timers": {"sample_time_ms": 8480.573, "sample_throughput": 471.666, "learn_time_ms": 11585.487, "learn_throughput": 345.26, "update_time_ms": 2.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 4.42297188937664, "policy_loss": -0.044602251262404025, "vf_loss": 4.463446848094463, "vf_explained_var": 0.25025543570518494, "kl": 0.013757613662164658, "entropy": 0.5412063719704747, "entropy_coeff": 0.0}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 6, "training_iteration": 15, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-02-26", "timestamp": 1618138946, "time_this_iter_s": 20.974477767944336, "time_total_s": 298.86004614830017, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665db290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 298.86004614830017, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 57.46, "ram_util_percent": 26.89999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1210.0, "episode_reward_min": 1210.0, "episode_reward_mean": 1210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5090805401859838, "mean_raw_obs_processing_ms": 0.0683892733041343, "mean_inference_ms": 1.4460254427977448, "mean_action_processing_ms": 0.04030936928689942}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 64000, "timers": {"sample_time_ms": 8742.344, "sample_throughput": 457.543, "learn_time_ms": 11584.977, "learn_throughput": 345.275, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.3510124534368515, "policy_loss": -0.04037311163847335, "vf_loss": 6.387819334864616, "vf_explained_var": 0.378465861082077, "kl": 0.011887290398590267, "entropy": 0.5212476570159197, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 6, "training_iteration": 16, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-02-48", "timestamp": 1618138968, "time_this_iter_s": 21.96542477607727, "time_total_s": 320.82547092437744, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171172790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117be90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 320.82547092437744, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 56.98125, "ram_util_percent": 26.9}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1210.0, "episode_reward_min": 1210.0, "episode_reward_mean": 1210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5090805401859838, "mean_raw_obs_processing_ms": 0.0683892733041343, "mean_inference_ms": 1.4460254427977448, "mean_action_processing_ms": 0.04030936928689942}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 68000, "timers": {"sample_time_ms": 8978.402, "sample_throughput": 445.514, "learn_time_ms": 11588.78, "learn_throughput": 345.161, "update_time_ms": 3.192}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.487404927611351, "policy_loss": -0.045911509660072625, "vf_loss": 6.52902127802372, "vf_explained_var": 0.505115270614624, "kl": 0.014316866145236418, "entropy": 0.5597499748691916, "entropy_coeff": 0.0}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 6, "training_iteration": 17, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-03-09", "timestamp": 1618138989, "time_this_iter_s": 21.153207063674927, "time_total_s": 341.97867798805237, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117fd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171172a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 341.97867798805237, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 57.306666666666665, "ram_util_percent": 26.89999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1235.0, "episode_reward_min": 1235.0, "episode_reward_mean": 1235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57967330572981, "mean_raw_obs_processing_ms": 0.06857940672874464, "mean_inference_ms": 1.44282645102092, "mean_action_processing_ms": 0.04021588736886033}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timers": {"sample_time_ms": 9183.8, "sample_throughput": 435.55, "learn_time_ms": 11586.575, "learn_throughput": 345.227, "update_time_ms": 3.268}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.560584262013435, "policy_loss": -0.0481897474383004, "vf_loss": 5.604808196425438, "vf_explained_var": 0.3015381991863251, "kl": 0.013219344371464103, "entropy": 0.5103967851027846, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 7, "training_iteration": 18, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-03-31", "timestamp": 1618139011, "time_this_iter_s": 21.720258712768555, "time_total_s": 363.6989367008209, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 363.6989367008209, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.64193548387097, "ram_util_percent": 26.89999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1235.0, "episode_reward_min": 1235.0, "episode_reward_mean": 1235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57967330572981, "mean_raw_obs_processing_ms": 0.06857940672874464, "mean_inference_ms": 1.44282645102092, "mean_action_processing_ms": 0.04021588736886033}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76000, "timers": {"sample_time_ms": 9070.415, "sample_throughput": 440.994, "learn_time_ms": 11580.731, "learn_throughput": 345.401, "update_time_ms": 3.35}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.661082208156586, "policy_loss": -0.041223485459340736, "vf_loss": 7.698498234152794, "vf_explained_var": 0.35661375522613525, "kl": 0.012691858952166513, "entropy": 0.5044017685577273, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 7, "training_iteration": 19, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-03-50", "timestamp": 1618139030, "time_this_iter_s": 19.731831550598145, "time_total_s": 383.43076825141907, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 383.43076825141907, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 56.771428571428565, "ram_util_percent": 26.899999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1322.0, "episode_reward_min": 1322.0, "episode_reward_mean": 1322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5814851345854225, "mean_raw_obs_processing_ms": 0.06881433240106807, "mean_inference_ms": 1.4424283892418066, "mean_action_processing_ms": 0.04028519103426368}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 80000, "timers": {"sample_time_ms": 9019.814, "sample_throughput": 443.468, "learn_time_ms": 11585.732, "learn_throughput": 345.252, "update_time_ms": 3.394}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.957860291004181, "policy_loss": -0.03953860094770789, "vf_loss": 5.992296352982521, "vf_explained_var": 0.4666920602321625, "kl": 0.01700860750861466, "entropy": 0.49584907572716475, "entropy_coeff": 0.0}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 8, "training_iteration": 20, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-04-11", "timestamp": 1618139051, "time_this_iter_s": 20.72437310218811, "time_total_s": 404.1551413536072, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711831d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 404.1551413536072, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.150000000000006, "ram_util_percent": 26.94}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1322.0, "episode_reward_min": 1322.0, "episode_reward_mean": 1322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5814851345854225, "mean_raw_obs_processing_ms": 0.06881433240106807, "mean_inference_ms": 1.4424283892418066, "mean_action_processing_ms": 0.04028519103426368}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84000, "timers": {"sample_time_ms": 9004.572, "sample_throughput": 444.219, "learn_time_ms": 11591.644, "learn_throughput": 345.076, "update_time_ms": 3.4}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.249188989400864, "policy_loss": -0.049843603337649256, "vf_loss": 6.295506119728088, "vf_explained_var": 0.3413466215133667, "kl": 0.011755318526411429, "entropy": 0.4831443903967738, "entropy_coeff": 0.0}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 8, "training_iteration": 21, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-04-31", "timestamp": 1618139071, "time_this_iter_s": 19.976031064987183, "time_total_s": 424.13117241859436, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117bed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f726630bb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 424.13117241859436, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.63928571428571, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1322.0, "episode_reward_min": 1322.0, "episode_reward_mean": 1322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5814851345854225, "mean_raw_obs_processing_ms": 0.06881433240106807, "mean_inference_ms": 1.4424283892418066, "mean_action_processing_ms": 0.04028519103426368}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 88000, "timers": {"sample_time_ms": 8880.121, "sample_throughput": 450.444, "learn_time_ms": 11598.183, "learn_throughput": 344.882, "update_time_ms": 3.38}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.324834376573563, "policy_loss": -0.039813573472201824, "vf_loss": 7.360769689083099, "vf_explained_var": 0.5238163471221924, "kl": 0.012927682633744553, "entropy": 0.661171693354845, "entropy_coeff": 0.0}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 8, "training_iteration": 22, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-04-50", "timestamp": 1618139090, "time_this_iter_s": 18.80807137489319, "time_total_s": 442.93924379348755, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110a090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110acd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 442.93924379348755, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 57.81481481481482, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 992.0, "episode_reward_min": 992.0, "episode_reward_mean": 992.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [992.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5688552961348347, "mean_raw_obs_processing_ms": 0.06922487240729322, "mean_inference_ms": 1.4427959231586256, "mean_action_processing_ms": 0.0402662601446691}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 92000, "timers": {"sample_time_ms": 9029.651, "sample_throughput": 442.985, "learn_time_ms": 11618.703, "learn_throughput": 344.273, "update_time_ms": 3.4}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.817781150341034, "policy_loss": -0.047139001660980284, "vf_loss": 9.861529350280762, "vf_explained_var": 0.6258741617202759, "kl": 0.011303105391561985, "entropy": 0.4630177663639188, "entropy_coeff": 0.0}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 9, "training_iteration": 23, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-05-11", "timestamp": 1618139111, "time_this_iter_s": 20.91455388069153, "time_total_s": 463.8537976741791, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711008d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665db290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 463.8537976741791, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 56.95333333333333, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 992.0, "episode_reward_min": 992.0, "episode_reward_mean": 992.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [992.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5688552961348347, "mean_raw_obs_processing_ms": 0.06922487240729322, "mean_inference_ms": 1.4427959231586256, "mean_action_processing_ms": 0.0402662601446691}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timers": {"sample_time_ms": 9059.215, "sample_throughput": 441.539, "learn_time_ms": 11624.238, "learn_throughput": 344.109, "update_time_ms": 3.423}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.304063633084297, "policy_loss": -0.03932474600151181, "vf_loss": 8.339433044195175, "vf_explained_var": 0.3206462860107422, "kl": 0.013183970644604415, "entropy": 0.4276683833450079, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 9, "training_iteration": 24, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-05-32", "timestamp": 1618139132, "time_this_iter_s": 20.968764781951904, "time_total_s": 484.822562456131, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110a090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 484.822562456131, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 57.21333333333334, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1428.0, "episode_reward_min": 1428.0, "episode_reward_mean": 1428.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1428.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5688180570701312, "mean_raw_obs_processing_ms": 0.06940420126362092, "mean_inference_ms": 1.4416852954235047, "mean_action_processing_ms": 0.04023907238268316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 100000, "timers": {"sample_time_ms": 8886.004, "sample_throughput": 450.146, "learn_time_ms": 11612.336, "learn_throughput": 344.461, "update_time_ms": 3.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.109791651368141, "policy_loss": -0.04143952683079988, "vf_loss": 9.147773414850235, "vf_explained_var": 0.4690462648868561, "kl": 0.011525949055794626, "entropy": 0.4835326122120023, "entropy_coeff": 0.0}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 10, "training_iteration": 25, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-05-51", "timestamp": 1618139151, "time_this_iter_s": 19.123603105545044, "time_total_s": 503.946165561676, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117fc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e25d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 503.946165561676, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 57.400000000000006, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1428.0, "episode_reward_min": 1428.0, "episode_reward_mean": 1428.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1428.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5688180570701312, "mean_raw_obs_processing_ms": 0.06940420126362092, "mean_inference_ms": 1.4416852954235047, "mean_action_processing_ms": 0.04023907238268316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 104000, "timers": {"sample_time_ms": 8739.838, "sample_throughput": 457.674, "learn_time_ms": 11614.899, "learn_throughput": 344.385, "update_time_ms": 3.172}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.753208428621292, "policy_loss": -0.05798642907757312, "vf_loss": 9.80204826593399, "vf_explained_var": 0.45233941078186035, "kl": 0.03048899013083428, "entropy": 0.46137138921767473, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 10, "training_iteration": 26, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-06-12", "timestamp": 1618139172, "time_this_iter_s": 20.524686336517334, "time_total_s": 524.4708518981934, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711729d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 524.4708518981934, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 57.516666666666666, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1428.0, "episode_reward_min": 1428.0, "episode_reward_mean": 1428.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1428.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5688180570701312, "mean_raw_obs_processing_ms": 0.06940420126362092, "mean_inference_ms": 1.4416852954235047, "mean_action_processing_ms": 0.04023907238268316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 108000, "timers": {"sample_time_ms": 8721.962, "sample_throughput": 458.612, "learn_time_ms": 11597.079, "learn_throughput": 344.914, "update_time_ms": 3.012}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.591173708438873, "policy_loss": -0.047602169681340456, "vf_loss": 10.633863776922226, "vf_explained_var": 0.48108595609664917, "kl": 0.010915813472820446, "entropy": 0.4197227032855153, "entropy_coeff": 0.0}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 10, "training_iteration": 27, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-06-32", "timestamp": 1618139192, "time_this_iter_s": 20.793260097503662, "time_total_s": 545.264111995697, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171178790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172246310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 545.264111995697, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 57.38275862068965, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1407.0, "episode_reward_min": 1407.0, "episode_reward_mean": 1407.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1407.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5834609116562017, "mean_raw_obs_processing_ms": 0.06975162974523723, "mean_inference_ms": 1.4413775640392255, "mean_action_processing_ms": 0.04021696388259002}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 112000, "timers": {"sample_time_ms": 8631.905, "sample_throughput": 463.397, "learn_time_ms": 11594.064, "learn_throughput": 345.004, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.02364756166935, "policy_loss": -0.0467527016880922, "vf_loss": 10.06517505645752, "vf_explained_var": 0.4584519863128662, "kl": 0.011611880618147552, "entropy": 0.39853483345359564, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 11, "training_iteration": 28, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-06-53", "timestamp": 1618139213, "time_this_iter_s": 20.78773784637451, "time_total_s": 566.0518498420715, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110a9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 566.0518498420715, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.303333333333335, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1407.0, "episode_reward_min": 1407.0, "episode_reward_mean": 1407.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1407.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5834609116562017, "mean_raw_obs_processing_ms": 0.06975162974523723, "mean_inference_ms": 1.4413775640392255, "mean_action_processing_ms": 0.04021696388259002}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 116000, "timers": {"sample_time_ms": 8923.849, "sample_throughput": 448.237, "learn_time_ms": 11603.438, "learn_throughput": 344.725, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.682659894227982, "policy_loss": -0.05460787034826353, "vf_loss": 8.730758473277092, "vf_explained_var": 0.6447068452835083, "kl": 0.014465006766840816, "entropy": 0.4123998396098614, "entropy_coeff": 0.0}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 11, "training_iteration": 29, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-07-16", "timestamp": 1618139236, "time_this_iter_s": 22.744297742843628, "time_total_s": 588.7961475849152, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 588.7961475849152, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.587500000000006, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1493.0, "episode_reward_min": 1493.0, "episode_reward_mean": 1493.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1493.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5944293355597261, "mean_raw_obs_processing_ms": 0.07001742387938292, "mean_inference_ms": 1.4459712210439122, "mean_action_processing_ms": 0.04026599946053307}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timers": {"sample_time_ms": 8811.649, "sample_throughput": 453.945, "learn_time_ms": 11598.054, "learn_throughput": 344.885, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.91934010386467, "policy_loss": -0.04378010652726516, "vf_loss": 9.958341404795647, "vf_explained_var": 0.4347307085990906, "kl": 0.010619903012411669, "entropy": 0.3905512932687998, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 12, "training_iteration": 30, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-07-36", "timestamp": 1618139256, "time_this_iter_s": 19.545923471450806, "time_total_s": 608.342071056366, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 608.342071056366, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.71785714285714, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1493.0, "episode_reward_min": 1493.0, "episode_reward_mean": 1493.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1493.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5944293355597261, "mean_raw_obs_processing_ms": 0.07001742387938292, "mean_inference_ms": 1.4459712210439122, "mean_action_processing_ms": 0.04026599946053307}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124000, "timers": {"sample_time_ms": 8656.775, "sample_throughput": 462.066, "learn_time_ms": 11597.409, "learn_throughput": 344.905, "update_time_ms": 2.832}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.409222945570946, "policy_loss": -0.0379406837746501, "vf_loss": 8.441790282726288, "vf_explained_var": 0.5464579463005066, "kl": 0.011940884200157598, "entropy": 0.4850904131308198, "entropy_coeff": 0.0}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 12, "training_iteration": 31, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-07-54", "timestamp": 1618139274, "time_this_iter_s": 18.419941902160645, "time_total_s": 626.7620129585266, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711835d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665db290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 626.7620129585266, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 56.87777777777777, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1493.0, "episode_reward_min": 1493.0, "episode_reward_mean": 1493.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1493.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5944293355597261, "mean_raw_obs_processing_ms": 0.07001742387938292, "mean_inference_ms": 1.4459712210439122, "mean_action_processing_ms": 0.04026599946053307}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 128000, "timers": {"sample_time_ms": 8658.913, "sample_throughput": 461.952, "learn_time_ms": 11590.605, "learn_throughput": 345.107, "update_time_ms": 2.871}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.1482298374176025, "policy_loss": -0.04662964295130223, "vf_loss": 7.189356237649918, "vf_explained_var": 0.6707111597061157, "kl": 0.012229338113684207, "entropy": 0.5555558102205396, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 12, "training_iteration": 32, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-08-13", "timestamp": 1618139293, "time_this_iter_s": 18.761778354644775, "time_total_s": 645.5237913131714, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7172212290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 645.5237913131714, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 57.73461538461538, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 674.0, "episode_reward_min": 674.0, "episode_reward_mean": 674.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [674.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5606008707926585, "mean_raw_obs_processing_ms": 0.07019834006703526, "mean_inference_ms": 1.4448386862554674, "mean_action_processing_ms": 0.04022434495952823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 132000, "timers": {"sample_time_ms": 8482.003, "sample_throughput": 471.587, "learn_time_ms": 11573.371, "learn_throughput": 345.621, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.276133805513382, "policy_loss": -0.04912534455070272, "vf_loss": 9.31979125738144, "vf_explained_var": 0.7058767676353455, "kl": 0.012150529393693432, "entropy": 0.5133488774299622, "entropy_coeff": 0.0}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 13, "training_iteration": 33, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-08-32", "timestamp": 1618139312, "time_this_iter_s": 18.975364208221436, "time_total_s": 664.4991555213928, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ec90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267861150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 664.4991555213928, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.40357142857142, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 674.0, "episode_reward_min": 674.0, "episode_reward_mean": 674.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [674.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5606008707926585, "mean_raw_obs_processing_ms": 0.07019834006703526, "mean_inference_ms": 1.4448386862554674, "mean_action_processing_ms": 0.04022434495952823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 136000, "timers": {"sample_time_ms": 8424.485, "sample_throughput": 474.806, "learn_time_ms": 11565.403, "learn_throughput": 345.859, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.743702411651611, "policy_loss": -0.04543149837991223, "vf_loss": 10.781196027994156, "vf_explained_var": 0.55637127161026, "kl": 0.017640165257034823, "entropy": 0.37638827692717314, "entropy_coeff": 0.0}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 13, "training_iteration": 34, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-08-52", "timestamp": 1618139332, "time_this_iter_s": 20.31629228591919, "time_total_s": 684.815447807312, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116eb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 684.815447807312, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.93448275862069, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1447.0, "episode_reward_min": 1447.0, "episode_reward_mean": 1447.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1447.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5530583727445857, "mean_raw_obs_processing_ms": 0.0703625864266026, "mean_inference_ms": 1.444781441598995, "mean_action_processing_ms": 0.040235834868766356}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 140000, "timers": {"sample_time_ms": 8384.074, "sample_throughput": 477.095, "learn_time_ms": 11576.988, "learn_throughput": 345.513, "update_time_ms": 2.833}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.733569383621216, "policy_loss": -0.03543882945086807, "vf_loss": 8.76477062702179, "vf_explained_var": 0.546635627746582, "kl": 0.009416900647920556, "entropy": 0.3710083346813917, "entropy_coeff": 0.0}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 14, "training_iteration": 35, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-09-11", "timestamp": 1618139351, "time_this_iter_s": 18.837940454483032, "time_total_s": 703.653388261795, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 703.653388261795, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 57.67307692307692, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1447.0, "episode_reward_min": 1447.0, "episode_reward_mean": 1447.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1447.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5530583727445857, "mean_raw_obs_processing_ms": 0.0703625864266026, "mean_inference_ms": 1.444781441598995, "mean_action_processing_ms": 0.040235834868766356}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timers": {"sample_time_ms": 8256.931, "sample_throughput": 484.441, "learn_time_ms": 11582.609, "learn_throughput": 345.345, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.249800682067871, "policy_loss": -0.04451425391016528, "vf_loss": 9.28944006562233, "vf_explained_var": 0.3898044526576996, "kl": 0.010832859697984532, "entropy": 0.37496137898415327, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 14, "training_iteration": 36, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-09-30", "timestamp": 1618139370, "time_this_iter_s": 19.31242871284485, "time_total_s": 722.9658169746399, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664b1f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 722.9658169746399, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.575, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1447.0, "episode_reward_min": 1447.0, "episode_reward_mean": 1447.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1447.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5530583727445857, "mean_raw_obs_processing_ms": 0.0703625864266026, "mean_inference_ms": 1.444781441598995, "mean_action_processing_ms": 0.040235834868766356}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 148000, "timers": {"sample_time_ms": 8055.667, "sample_throughput": 496.545, "learn_time_ms": 11593.274, "learn_throughput": 345.028, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.648575231432915, "policy_loss": -0.04041709814919159, "vf_loss": 8.68429060280323, "vf_explained_var": 0.5482133030891418, "kl": 0.010448254601215012, "entropy": 0.40049564093351364, "entropy_coeff": 0.0}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 14, "training_iteration": 37, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-09-49", "timestamp": 1618139389, "time_this_iter_s": 18.890249490737915, "time_total_s": 741.8560664653778, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 741.8560664653778, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 56.907407407407405, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1210.0, "episode_reward_min": 1210.0, "episode_reward_mean": 1210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.530009964543088, "mean_raw_obs_processing_ms": 0.07063488071817671, "mean_inference_ms": 1.4452732347888229, "mean_action_processing_ms": 0.04023221959227078}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 152000, "timers": {"sample_time_ms": 7866.975, "sample_throughput": 508.455, "learn_time_ms": 11591.214, "learn_throughput": 345.089, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.583362817764282, "policy_loss": -0.03535950224613771, "vf_loss": 9.613921135663986, "vf_explained_var": 0.5615574717521667, "kl": 0.010669547409634106, "entropy": 0.485761777497828, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 15, "training_iteration": 38, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-10-08", "timestamp": 1618139408, "time_this_iter_s": 18.878747940063477, "time_total_s": 760.7348144054413, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 760.7348144054413, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.92962962962962, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1210.0, "episode_reward_min": 1210.0, "episode_reward_mean": 1210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.530009964543088, "mean_raw_obs_processing_ms": 0.07063488071817671, "mean_inference_ms": 1.4452732347888229, "mean_action_processing_ms": 0.04023221959227078}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timers": {"sample_time_ms": 7456.147, "sample_throughput": 536.47, "learn_time_ms": 11601.348, "learn_throughput": 344.788, "update_time_ms": 2.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.692988492548466, "policy_loss": -0.0394631409435533, "vf_loss": 6.726637482643127, "vf_explained_var": 0.6971485614776611, "kl": 0.012920295266667381, "entropy": 0.5009061824530363, "entropy_coeff": 0.0}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 15, "training_iteration": 39, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-10-27", "timestamp": 1618139427, "time_this_iter_s": 18.73777961730957, "time_total_s": 779.4725940227509, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717224a150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 779.4725940227509, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.800000000000004, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 920.0, "episode_reward_min": 920.0, "episode_reward_mean": 920.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [920.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5172649449610297, "mean_raw_obs_processing_ms": 0.07085625649589293, "mean_inference_ms": 1.4461310155494465, "mean_action_processing_ms": 0.04024161728385636}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 160000, "timers": {"sample_time_ms": 7451.439, "sample_throughput": 536.809, "learn_time_ms": 11607.396, "learn_throughput": 344.608, "update_time_ms": 2.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.011216789484024, "policy_loss": -0.036729236715473235, "vf_loss": 11.043481200933456, "vf_explained_var": 0.3832922875881195, "kl": 0.009921934644808061, "entropy": 0.29670651024207473, "entropy_coeff": 0.0}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 16, "training_iteration": 40, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-10-47", "timestamp": 1618139447, "time_this_iter_s": 19.560718774795532, "time_total_s": 799.0333127975464, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 799.0333127975464, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.50714285714286, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 920.0, "episode_reward_min": 920.0, "episode_reward_mean": 920.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [920.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5172649449610297, "mean_raw_obs_processing_ms": 0.07085625649589293, "mean_inference_ms": 1.4461310155494465, "mean_action_processing_ms": 0.04024161728385636}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 164000, "timers": {"sample_time_ms": 7767.274, "sample_throughput": 514.981, "learn_time_ms": 11655.527, "learn_throughput": 343.185, "update_time_ms": 2.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.604314789175987, "policy_loss": -0.039866412756964564, "vf_loss": 8.639684349298477, "vf_explained_var": 0.3581963777542114, "kl": 0.009993102779844776, "entropy": 0.30116829089820385, "entropy_coeff": 0.0}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 16, "training_iteration": 41, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-11-09", "timestamp": 1618139469, "time_this_iter_s": 22.061232805252075, "time_total_s": 821.0945456027985, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711a8cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 821.0945456027985, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 57.71290322580646, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 920.0, "episode_reward_min": 920.0, "episode_reward_mean": 920.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [920.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5172649449610297, "mean_raw_obs_processing_ms": 0.07085625649589293, "mean_inference_ms": 1.4461310155494465, "mean_action_processing_ms": 0.04024161728385636}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timers": {"sample_time_ms": 7909.981, "sample_throughput": 505.69, "learn_time_ms": 11707.649, "learn_throughput": 341.657, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.104790657758713, "policy_loss": -0.03729774721432477, "vf_loss": 8.137329950928688, "vf_explained_var": 0.2977425456047058, "kl": 0.010574208994512446, "entropy": 0.3179331999272108, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 16, "training_iteration": 42, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-11-29", "timestamp": 1618139489, "time_this_iter_s": 20.711116790771484, "time_total_s": 841.80566239357, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 841.80566239357, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 58.013333333333335, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1588.0, "episode_reward_min": 1588.0, "episode_reward_mean": 1588.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1588.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5354156664692087, "mean_raw_obs_processing_ms": 0.07124968483997206, "mean_inference_ms": 1.4477311064692835, "mean_action_processing_ms": 0.040290513716932166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 172000, "timers": {"sample_time_ms": 8168.496, "sample_throughput": 489.686, "learn_time_ms": 11716.853, "learn_throughput": 341.389, "update_time_ms": 3.026}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.017791509628296, "policy_loss": -0.03893453045748174, "vf_loss": 11.051745891571045, "vf_explained_var": 0.4631003737449646, "kl": 0.011066985316574574, "entropy": 0.31141367694363, "entropy_coeff": 0.0}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 17, "training_iteration": 43, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-11-51", "timestamp": 1618139511, "time_this_iter_s": 21.6501247882843, "time_total_s": 863.4557871818542, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117fad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 863.4557871818542, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.41612903225807, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1588.0, "episode_reward_min": 1588.0, "episode_reward_mean": 1588.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1588.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5354156664692087, "mean_raw_obs_processing_ms": 0.07124968483997206, "mean_inference_ms": 1.4477311064692835, "mean_action_processing_ms": 0.040290513716932166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 176000, "timers": {"sample_time_ms": 8031.999, "sample_throughput": 498.008, "learn_time_ms": 11718.489, "learn_throughput": 341.341, "update_time_ms": 2.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.149349361658096, "policy_loss": -0.038948215573327616, "vf_loss": 10.182623505592346, "vf_explained_var": 0.30848556756973267, "kl": 0.01260929016279988, "entropy": 0.3219340480864048, "entropy_coeff": 0.0}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 17, "training_iteration": 44, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-12-10", "timestamp": 1618139530, "time_this_iter_s": 18.965495586395264, "time_total_s": 882.4212827682495, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71722126d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 882.4212827682495, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.48888888888889, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1496.0, "episode_reward_min": 1496.0, "episode_reward_mean": 1496.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1496.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5230344444308515, "mean_raw_obs_processing_ms": 0.07139341904626545, "mean_inference_ms": 1.4468064859890521, "mean_action_processing_ms": 0.0402577931968066}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 180000, "timers": {"sample_time_ms": 8017.721, "sample_throughput": 498.895, "learn_time_ms": 11731.094, "learn_throughput": 340.974, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.476451575756073, "policy_loss": -0.03721241420134902, "vf_loss": 11.508957117795944, "vf_explained_var": 0.5151238441467285, "kl": 0.010459624245413579, "entropy": 0.3534113857895136, "entropy_coeff": 0.0}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 18, "training_iteration": 45, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-12-29", "timestamp": 1618139549, "time_this_iter_s": 18.821411609649658, "time_total_s": 901.2426943778992, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171120350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ced0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 901.2426943778992, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.085185185185175, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1496.0, "episode_reward_min": 1496.0, "episode_reward_mean": 1496.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1496.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5230344444308515, "mean_raw_obs_processing_ms": 0.07139341904626545, "mean_inference_ms": 1.4468064859890521, "mean_action_processing_ms": 0.0402577931968066}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 184000, "timers": {"sample_time_ms": 8034.715, "sample_throughput": 497.84, "learn_time_ms": 11722.283, "learn_throughput": 341.23, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.886720299720764, "policy_loss": -0.03941941724042408, "vf_loss": 13.921458661556244, "vf_explained_var": 0.5405511260032654, "kl": 0.010402296989923343, "entropy": 0.3709282800555229, "entropy_coeff": 0.0}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 18, "training_iteration": 46, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-12-48", "timestamp": 1618139568, "time_this_iter_s": 19.390955924987793, "time_total_s": 920.633650302887, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171120b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 920.633650302887, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.577777777777776, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1496.0, "episode_reward_min": 1496.0, "episode_reward_mean": 1496.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1496.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5230344444308515, "mean_raw_obs_processing_ms": 0.07139341904626545, "mean_inference_ms": 1.4468064859890521, "mean_action_processing_ms": 0.0402577931968066}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 188000, "timers": {"sample_time_ms": 8305.187, "sample_throughput": 481.627, "learn_time_ms": 11731.245, "learn_throughput": 340.97, "update_time_ms": 2.937}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.652432054281235, "policy_loss": -0.03735058952588588, "vf_loss": 11.68478611111641, "vf_explained_var": 0.32170015573501587, "kl": 0.011103432159870863, "entropy": 0.26073685195297003, "entropy_coeff": 0.0}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 18, "training_iteration": 47, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-13-10", "timestamp": 1618139590, "time_this_iter_s": 21.68450927734375, "time_total_s": 942.3181595802307, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 942.3181595802307, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 57.36774193548386, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1564.0, "episode_reward_min": 1564.0, "episode_reward_mean": 1564.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1564.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.527483536022026, "mean_raw_obs_processing_ms": 0.07166959642857937, "mean_inference_ms": 1.4459102556268761, "mean_action_processing_ms": 0.040247948452667416}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timers": {"sample_time_ms": 8397.693, "sample_throughput": 476.321, "learn_time_ms": 11737.584, "learn_throughput": 340.786, "update_time_ms": 2.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.384589195251465, "policy_loss": -0.042388788191601634, "vf_loss": 10.422224044799805, "vf_explained_var": 0.686546802520752, "kl": 0.010564680909737945, "entropy": 0.38622192572802305, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 19, "training_iteration": 48, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-13-30", "timestamp": 1618139610, "time_this_iter_s": 19.865078687667847, "time_total_s": 962.1832382678986, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118de10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171120ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 962.1832382678986, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 57.317241379310346, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1564.0, "episode_reward_min": 1564.0, "episode_reward_mean": 1564.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1564.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.527483536022026, "mean_raw_obs_processing_ms": 0.07166959642857937, "mean_inference_ms": 1.4459102556268761, "mean_action_processing_ms": 0.040247948452667416}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 196000, "timers": {"sample_time_ms": 8623.08, "sample_throughput": 463.871, "learn_time_ms": 11737.34, "learn_throughput": 340.793, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.285749107599258, "policy_loss": -0.03676729783182964, "vf_loss": 10.318112134933472, "vf_explained_var": 0.3035825490951538, "kl": 0.009787658491404727, "entropy": 0.27527446998283267, "entropy_coeff": 0.0}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 19, "training_iteration": 49, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-13-51", "timestamp": 1618139631, "time_this_iter_s": 20.98802137374878, "time_total_s": 983.1712596416473, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171120510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 983.1712596416473, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.269999999999996, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1516.0, "episode_reward_min": 1516.0, "episode_reward_mean": 1516.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1516.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5341206559367135, "mean_raw_obs_processing_ms": 0.07184454996838174, "mean_inference_ms": 1.445737800760459, "mean_action_processing_ms": 0.04024240518941753}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 200000, "timers": {"sample_time_ms": 8715.662, "sample_throughput": 458.944, "learn_time_ms": 11779.193, "learn_throughput": 339.582, "update_time_ms": 2.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.238846689462662, "policy_loss": -0.035711332340724766, "vf_loss": 9.269536077976227, "vf_explained_var": 0.2860094904899597, "kl": 0.01115979986207094, "entropy": 0.272698069922626, "entropy_coeff": 0.0}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 20, "training_iteration": 50, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-14-12", "timestamp": 1618139652, "time_this_iter_s": 20.90272831916809, "time_total_s": 1004.0739879608154, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117fad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1004.0739879608154, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 57.623333333333335, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1516.0, "episode_reward_min": 1516.0, "episode_reward_mean": 1516.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1516.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5341206559367135, "mean_raw_obs_processing_ms": 0.07184454996838174, "mean_inference_ms": 1.445737800760459, "mean_action_processing_ms": 0.04024240518941753}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 204000, "timers": {"sample_time_ms": 8827.435, "sample_throughput": 453.133, "learn_time_ms": 11750.268, "learn_throughput": 340.418, "update_time_ms": 2.766}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.758561044931412, "policy_loss": -0.046871962142176926, "vf_loss": 11.800592362880707, "vf_explained_var": 0.2769819498062134, "kl": 0.010757137628388591, "entropy": 0.2416381468065083, "entropy_coeff": 0.0}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 20, "training_iteration": 51, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-14-35", "timestamp": 1618139675, "time_this_iter_s": 22.888142108917236, "time_total_s": 1026.9621300697327, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e26d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1026.9621300697327, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 57.215625, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1516.0, "episode_reward_min": 1516.0, "episode_reward_mean": 1516.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1516.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5341206559367135, "mean_raw_obs_processing_ms": 0.07184454996838174, "mean_inference_ms": 1.445737800760459, "mean_action_processing_ms": 0.04024240518941753}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 208000, "timers": {"sample_time_ms": 8989.278, "sample_throughput": 444.975, "learn_time_ms": 11712.064, "learn_throughput": 341.528, "update_time_ms": 2.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.794281780719757, "policy_loss": -0.04656268152757548, "vf_loss": 10.835537403821945, "vf_explained_var": 0.3336274027824402, "kl": 0.01179412346391473, "entropy": 0.27198986569419503, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 20, "training_iteration": 52, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-14-57", "timestamp": 1618139697, "time_this_iter_s": 21.94346570968628, "time_total_s": 1048.905595779419, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171120f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117f290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1048.905595779419, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.109375, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1842.0, "episode_reward_min": 1842.0, "episode_reward_mean": 1842.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1842.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5616111490322859, "mean_raw_obs_processing_ms": 0.07218337535968367, "mean_inference_ms": 1.446069948789117, "mean_action_processing_ms": 0.040245294794720374}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 212000, "timers": {"sample_time_ms": 8986.359, "sample_throughput": 445.119, "learn_time_ms": 11688.229, "learn_throughput": 342.225, "update_time_ms": 2.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.10481558740139, "policy_loss": -0.04135971766663715, "vf_loss": 7.141490176320076, "vf_explained_var": 0.32858172059059143, "kl": 0.010411323382868432, "entropy": 0.26648132456466556, "entropy_coeff": 0.0}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 21, "training_iteration": 53, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-15-18", "timestamp": 1618139718, "time_this_iter_s": 21.38461685180664, "time_total_s": 1070.2902126312256, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711a88d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1070.2902126312256, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 57.24333333333334, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1842.0, "episode_reward_min": 1842.0, "episode_reward_mean": 1842.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1842.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5616111490322859, "mean_raw_obs_processing_ms": 0.07218337535968367, "mean_inference_ms": 1.446069948789117, "mean_action_processing_ms": 0.040245294794720374}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timers": {"sample_time_ms": 9220.303, "sample_throughput": 433.825, "learn_time_ms": 11697.861, "learn_throughput": 341.943, "update_time_ms": 2.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.502091348171234, "policy_loss": -0.03671383089385927, "vf_loss": 11.534135311841965, "vf_explained_var": 0.36073485016822815, "kl": 0.010377700891694985, "entropy": 0.253910758998245, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 21, "training_iteration": 54, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-15-40", "timestamp": 1618139740, "time_this_iter_s": 21.400721311569214, "time_total_s": 1091.6909339427948, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118e110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118e590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1091.6909339427948, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.219354838709684, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1813.0, "episode_reward_min": 1813.0, "episode_reward_mean": 1813.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1813.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5650268436623157, "mean_raw_obs_processing_ms": 0.07236869818912822, "mean_inference_ms": 1.4460790652630462, "mean_action_processing_ms": 0.04023905041563499}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 220000, "timers": {"sample_time_ms": 9323.722, "sample_throughput": 429.013, "learn_time_ms": 11690.663, "learn_throughput": 342.153, "update_time_ms": 2.743}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.119587928056717, "policy_loss": -0.03959164000116289, "vf_loss": 7.155728980898857, "vf_explained_var": 0.41646480560302734, "kl": 0.007667769590625539, "entropy": 0.24993765261024237, "entropy_coeff": 0.0}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 22, "training_iteration": 55, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-15-59", "timestamp": 1618139759, "time_this_iter_s": 19.781810998916626, "time_total_s": 1111.4727449417114, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117f350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172265210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1111.4727449417114, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 57.50000000000001, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1813.0, "episode_reward_min": 1813.0, "episode_reward_mean": 1813.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1813.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5650268436623157, "mean_raw_obs_processing_ms": 0.07236869818912822, "mean_inference_ms": 1.4460790652630462, "mean_action_processing_ms": 0.04023905041563499}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 224000, "timers": {"sample_time_ms": 9520.224, "sample_throughput": 420.158, "learn_time_ms": 11686.043, "learn_throughput": 342.289, "update_time_ms": 2.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.41600213944912, "policy_loss": -0.04245722177438438, "vf_loss": 8.453324362635612, "vf_explained_var": 0.39337432384490967, "kl": 0.01141120852844324, "entropy": 0.24803830264136195, "entropy_coeff": 0.0}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 22, "training_iteration": 56, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-16-21", "timestamp": 1618139781, "time_this_iter_s": 21.310325145721436, "time_total_s": 1132.7830700874329, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171120d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1132.7830700874329, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.39666666666667, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1813.0, "episode_reward_min": 1813.0, "episode_reward_mean": 1813.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1813.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5650268436623157, "mean_raw_obs_processing_ms": 0.07236869818912822, "mean_inference_ms": 1.4460790652630462, "mean_action_processing_ms": 0.04023905041563499}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228000, "timers": {"sample_time_ms": 9248.291, "sample_throughput": 432.512, "learn_time_ms": 11686.315, "learn_throughput": 342.281, "update_time_ms": 2.821}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.913306534290314, "policy_loss": -0.04245097696548328, "vf_loss": 12.951326698064804, "vf_explained_var": 0.5681959986686707, "kl": 0.009846330460277386, "entropy": 0.29791554994881153, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 22, "training_iteration": 57, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-16-40", "timestamp": 1618139800, "time_this_iter_s": 18.967896223068237, "time_total_s": 1151.750966310501, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711205d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1151.750966310501, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 57.46428571428571, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1510.0, "episode_reward_min": 1510.0, "episode_reward_mean": 1510.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1510.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5640084284926205, "mean_raw_obs_processing_ms": 0.07263607438496748, "mean_inference_ms": 1.4459866296551305, "mean_action_processing_ms": 0.04023524424244015}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 232000, "timers": {"sample_time_ms": 9281.013, "sample_throughput": 430.987, "learn_time_ms": 11696.207, "learn_throughput": 341.991, "update_time_ms": 2.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.354485034942627, "policy_loss": -0.0340981938643381, "vf_loss": 12.385220259428024, "vf_explained_var": 0.4753264784812927, "kl": 0.007473318080883473, "entropy": 0.2398667116649449, "entropy_coeff": 0.0}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 23, "training_iteration": 58, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-17-00", "timestamp": 1618139820, "time_this_iter_s": 20.295294761657715, "time_total_s": 1172.0462610721588, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717233c250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1172.0462610721588, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 57.58275862068965, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1510.0, "episode_reward_min": 1510.0, "episode_reward_mean": 1510.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1510.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5640084284926205, "mean_raw_obs_processing_ms": 0.07263607438496748, "mean_inference_ms": 1.4459866296551305, "mean_action_processing_ms": 0.04023524424244015}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 236000, "timers": {"sample_time_ms": 9064.784, "sample_throughput": 441.268, "learn_time_ms": 11687.847, "learn_throughput": 342.236, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.38267408311367, "policy_loss": -0.03914443898247555, "vf_loss": 9.4165558218956, "vf_explained_var": 0.5860071778297424, "kl": 0.011694504966726527, "entropy": 0.42583553679287434, "entropy_coeff": 0.0}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 23, "training_iteration": 59, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-17-19", "timestamp": 1618139839, "time_this_iter_s": 18.73993706703186, "time_total_s": 1190.7861981391907, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1190.7861981391907, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 57.93076923076923, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1038.0, "episode_reward_min": 1038.0, "episode_reward_mean": 1038.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1038.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5509877006114358, "mean_raw_obs_processing_ms": 0.07280364199419138, "mean_inference_ms": 1.4461374903318682, "mean_action_processing_ms": 0.04023753725641622}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timers": {"sample_time_ms": 8873.297, "sample_throughput": 450.791, "learn_time_ms": 11634.879, "learn_throughput": 343.794, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.255448311567307, "policy_loss": -0.042909988085739315, "vf_loss": 12.293947786092758, "vf_explained_var": 0.4998031556606293, "kl": 0.00980111918761395, "entropy": 0.3341263961046934, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 24, "training_iteration": 60, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-17-37", "timestamp": 1618139857, "time_this_iter_s": 18.461178064346313, "time_total_s": 1209.247376203537, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1209.247376203537, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 57.26296296296296, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1038.0, "episode_reward_min": 1038.0, "episode_reward_mean": 1038.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1038.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5509877006114358, "mean_raw_obs_processing_ms": 0.07280364199419138, "mean_inference_ms": 1.4461374903318682, "mean_action_processing_ms": 0.04023753725641622}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 244000, "timers": {"sample_time_ms": 8664.448, "sample_throughput": 461.657, "learn_time_ms": 11608.551, "learn_throughput": 344.574, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.825091749429703, "policy_loss": -0.03152987267822027, "vf_loss": 9.851966232061386, "vf_explained_var": 0.3674146831035614, "kl": 0.010345621456508525, "entropy": 0.24577110446989536, "entropy_coeff": 0.0}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 24, "training_iteration": 61, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-17-58", "timestamp": 1618139878, "time_this_iter_s": 20.536194324493408, "time_total_s": 1229.7835705280304, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ee50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1229.7835705280304, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 57.42413793103448, "ram_util_percent": 27.03103448275862}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1038.0, "episode_reward_min": 1038.0, "episode_reward_mean": 1038.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1038.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5509877006114358, "mean_raw_obs_processing_ms": 0.07280364199419138, "mean_inference_ms": 1.4461374903318682, "mean_action_processing_ms": 0.04023753725641622}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 248000, "timers": {"sample_time_ms": 8415.771, "sample_throughput": 475.298, "learn_time_ms": 11597.444, "learn_throughput": 344.904, "update_time_ms": 2.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.106890588998795, "policy_loss": -0.034442601492628455, "vf_loss": 11.136515349149704, "vf_explained_var": 0.4643401801586151, "kl": 0.01070637017255649, "entropy": 0.2527057803235948, "entropy_coeff": 0.0}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 24, "training_iteration": 62, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-18-17", "timestamp": 1618139897, "time_this_iter_s": 19.348691701889038, "time_total_s": 1249.1322622299194, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266305fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1249.1322622299194, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 57.57857142857142, "ram_util_percent": 27.064285714285717}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1618.0, "episode_reward_min": 1618.0, "episode_reward_mean": 1618.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1618.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5449606097591629, "mean_raw_obs_processing_ms": 0.0730843415923097, "mean_inference_ms": 1.4457325511112835, "mean_action_processing_ms": 0.04022051162468744}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 252000, "timers": {"sample_time_ms": 8141.648, "sample_throughput": 491.301, "learn_time_ms": 11609.189, "learn_throughput": 344.555, "update_time_ms": 2.918}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.8064404129982, "policy_loss": -0.04817978595383465, "vf_loss": 11.848907083272934, "vf_explained_var": 0.7548443078994751, "kl": 0.012695992249064147, "entropy": 0.32363935466855764, "entropy_coeff": 0.0}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 25, "training_iteration": 63, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-18-36", "timestamp": 1618139916, "time_this_iter_s": 18.758299827575684, "time_total_s": 1267.8905620574951, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1267.8905620574951, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 57.57037037037036, "ram_util_percent": 27.066666666666666}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1618.0, "episode_reward_min": 1618.0, "episode_reward_mean": 1618.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1618.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5449606097591629, "mean_raw_obs_processing_ms": 0.0730843415923097, "mean_inference_ms": 1.4457325511112835, "mean_action_processing_ms": 0.04022051162468744}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 256000, "timers": {"sample_time_ms": 7992.838, "sample_throughput": 500.448, "learn_time_ms": 11606.359, "learn_throughput": 344.639, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 16.657183974981308, "policy_loss": -0.03802450455259532, "vf_loss": 16.6914641559124, "vf_explained_var": 0.6064871549606323, "kl": 0.008320814871694893, "entropy": 0.251991534139961, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 25, "training_iteration": 64, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-18-56", "timestamp": 1618139936, "time_this_iter_s": 19.886728048324585, "time_total_s": 1287.7772901058197, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ea90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1287.7772901058197, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 57.01428571428572, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1131.0, "episode_reward_min": 1131.0, "episode_reward_mean": 1131.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1131.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5387898391500092, "mean_raw_obs_processing_ms": 0.07325934880331872, "mean_inference_ms": 1.4456385003169276, "mean_action_processing_ms": 0.040212085924045085}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 260000, "timers": {"sample_time_ms": 7890.602, "sample_throughput": 506.932, "learn_time_ms": 11609.424, "learn_throughput": 344.548, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.667519360780716, "policy_loss": -0.0441491668461822, "vf_loss": 10.70606780052185, "vf_explained_var": 0.6049920320510864, "kl": 0.012446161854313686, "entropy": 0.41649668384343386, "entropy_coeff": 0.0}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 26, "training_iteration": 65, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-19-15", "timestamp": 1618139955, "time_this_iter_s": 18.791142463684082, "time_total_s": 1306.5684325695038, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172246690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1306.5684325695038, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 57.8074074074074, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1131.0, "episode_reward_min": 1131.0, "episode_reward_mean": 1131.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1131.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5387898391500092, "mean_raw_obs_processing_ms": 0.07325934880331872, "mean_inference_ms": 1.4456385003169276, "mean_action_processing_ms": 0.040212085924045085}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 264000, "timers": {"sample_time_ms": 7601.968, "sample_throughput": 526.18, "learn_time_ms": 11623.08, "learn_throughput": 344.143, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 4.982017248868942, "policy_loss": -0.041083037795033306, "vf_loss": 5.018054865300655, "vf_explained_var": 0.7444113492965698, "kl": 0.011212042416445911, "entropy": 0.46568360179662704, "entropy_coeff": 0.0}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 26, "training_iteration": 66, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-19-33", "timestamp": 1618139973, "time_this_iter_s": 18.562784910202026, "time_total_s": 1325.1312174797058, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117bd10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711a8850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1325.1312174797058, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.17307692307692, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1131.0, "episode_reward_min": 1131.0, "episode_reward_mean": 1131.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1131.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5387898391500092, "mean_raw_obs_processing_ms": 0.07325934880331872, "mean_inference_ms": 1.4456385003169276, "mean_action_processing_ms": 0.040212085924045085}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 268000, "timers": {"sample_time_ms": 7586.016, "sample_throughput": 527.286, "learn_time_ms": 11606.588, "learn_throughput": 344.632, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 14.736818850040436, "policy_loss": -0.04085267605842091, "vf_loss": 14.772348046302795, "vf_explained_var": 0.5585763454437256, "kl": 0.011830340095912106, "entropy": 0.281030872836709, "entropy_coeff": 0.0}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 26, "training_iteration": 67, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-19-52", "timestamp": 1618139992, "time_this_iter_s": 18.64057993888855, "time_total_s": 1343.7717974185944, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1343.7717974185944, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 57.9037037037037, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 875.0, "episode_reward_min": 875.0, "episode_reward_mean": 875.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [875.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5222881930405101, "mean_raw_obs_processing_ms": 0.07353655605222267, "mean_inference_ms": 1.4455812063225613, "mean_action_processing_ms": 0.0402043543937588}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 272000, "timers": {"sample_time_ms": 7436.191, "sample_throughput": 537.91, "learn_time_ms": 11584.311, "learn_throughput": 345.295, "update_time_ms": 2.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.410429060459137, "policy_loss": -0.04107304330682382, "vf_loss": 13.446462333202362, "vf_explained_var": 0.6685716509819031, "kl": 0.01119930882123299, "entropy": 0.33580961264669895, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 27, "training_iteration": 68, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-20-11", "timestamp": 1618140011, "time_this_iter_s": 18.57093119621277, "time_total_s": 1362.3427286148071, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711a8550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171120590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1362.3427286148071, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.153846153846146, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 875.0, "episode_reward_min": 875.0, "episode_reward_mean": 875.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [875.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5222881930405101, "mean_raw_obs_processing_ms": 0.07353655605222267, "mean_inference_ms": 1.4455812063225613, "mean_action_processing_ms": 0.0402043543937588}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 276000, "timers": {"sample_time_ms": 7425.459, "sample_throughput": 538.687, "learn_time_ms": 11578.715, "learn_throughput": 345.461, "update_time_ms": 2.877}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.106069833040237, "policy_loss": -0.03236986801493913, "vf_loss": 13.134297162294388, "vf_explained_var": 0.6302326321601868, "kl": 0.009205290029058233, "entropy": 0.29494962841272354, "entropy_coeff": 0.0}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 27, "training_iteration": 69, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-20-29", "timestamp": 1618140029, "time_this_iter_s": 18.580854892730713, "time_total_s": 1380.9235835075378, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119bf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664da6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1380.9235835075378, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.86666666666668, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 973.0, "episode_reward_min": 973.0, "episode_reward_mean": 973.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [973.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.512037819928547, "mean_raw_obs_processing_ms": 0.07370174516309623, "mean_inference_ms": 1.445193032214543, "mean_action_processing_ms": 0.040179288792481}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 280000, "timers": {"sample_time_ms": 7414.139, "sample_throughput": 539.51, "learn_time_ms": 11598.936, "learn_throughput": 344.859, "update_time_ms": 2.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.675988331437111, "policy_loss": -0.03880933462642133, "vf_loss": 9.710058316588402, "vf_explained_var": 0.4355638027191162, "kl": 0.01053198984300252, "entropy": 0.33635652903467417, "entropy_coeff": 0.0}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 28, "training_iteration": 70, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-20-48", "timestamp": 1618140048, "time_this_iter_s": 18.548132181167603, "time_total_s": 1399.4717156887054, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171120890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1399.4717156887054, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 56.98076923076924, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 973.0, "episode_reward_min": 973.0, "episode_reward_mean": 973.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [973.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.512037819928547, "mean_raw_obs_processing_ms": 0.07370174516309623, "mean_inference_ms": 1.445193032214543, "mean_action_processing_ms": 0.040179288792481}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 284000, "timers": {"sample_time_ms": 7207.14, "sample_throughput": 555.005, "learn_time_ms": 11604.634, "learn_throughput": 344.69, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.44027191400528, "policy_loss": -0.03894785715965554, "vf_loss": 12.473077356815338, "vf_explained_var": 0.5547294616699219, "kl": 0.013649966000230052, "entropy": 0.27870677039027214, "entropy_coeff": 0.0}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 28, "training_iteration": 71, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-21-06", "timestamp": 1618140066, "time_this_iter_s": 18.523126363754272, "time_total_s": 1417.9948420524597, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117ba90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665cef50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1417.9948420524597, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 57.925925925925924, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 973.0, "episode_reward_min": 973.0, "episode_reward_mean": 973.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [973.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.512037819928547, "mean_raw_obs_processing_ms": 0.07370174516309623, "mean_inference_ms": 1.445193032214543, "mean_action_processing_ms": 0.040179288792481}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 288000, "timers": {"sample_time_ms": 7146.392, "sample_throughput": 559.723, "learn_time_ms": 11602.069, "learn_throughput": 344.766, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.915036663413048, "policy_loss": -0.039051126717822626, "vf_loss": 8.948987767100334, "vf_explained_var": 0.6392337083816528, "kl": 0.011333417947753333, "entropy": 0.34285352379083633, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 28, "training_iteration": 72, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-21-25", "timestamp": 1618140085, "time_this_iter_s": 18.714646100997925, "time_total_s": 1436.7094881534576, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1436.7094881534576, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 57.12962962962964, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 892.0, "episode_reward_min": 892.0, "episode_reward_mean": 892.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49985431682495185, "mean_raw_obs_processing_ms": 0.0739323651179755, "mean_inference_ms": 1.4444484021110806, "mean_action_processing_ms": 0.04016243068041569}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 292000, "timers": {"sample_time_ms": 7151.46, "sample_throughput": 559.326, "learn_time_ms": 11607.642, "learn_throughput": 344.601, "update_time_ms": 2.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.71571683883667, "policy_loss": -0.043101070186821744, "vf_loss": 9.753028094768524, "vf_explained_var": 0.7109957933425903, "kl": 0.012866296179709025, "entropy": 0.3511239606887102, "entropy_coeff": 0.0}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 29, "training_iteration": 73, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-21-44", "timestamp": 1618140104, "time_this_iter_s": 18.8690402507782, "time_total_s": 1455.5785284042358, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664da6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1455.5785284042358, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.614814814814814, "ram_util_percent": 27.062962962962963}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 892.0, "episode_reward_min": 892.0, "episode_reward_mean": 892.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49985431682495185, "mean_raw_obs_processing_ms": 0.0739323651179755, "mean_inference_ms": 1.4444484021110806, "mean_action_processing_ms": 0.04016243068041569}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 296000, "timers": {"sample_time_ms": 7438.24, "sample_throughput": 537.762, "learn_time_ms": 11599.113, "learn_throughput": 344.854, "update_time_ms": 2.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.172502160072327, "policy_loss": -0.02183546597370878, "vf_loss": 10.190057069063187, "vf_explained_var": 0.2332703173160553, "kl": 0.009512344928225502, "entropy": 0.17061002738773823, "entropy_coeff": 0.0}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 29, "training_iteration": 74, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-22-07", "timestamp": 1618140127, "time_this_iter_s": 22.66729164123535, "time_total_s": 1478.2458200454712, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1478.2458200454712, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.06875, "ram_util_percent": 27.059375000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1717.0, "episode_reward_min": 1717.0, "episode_reward_mean": 1717.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1717.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5102044511218309, "mean_raw_obs_processing_ms": 0.07410242254886047, "mean_inference_ms": 1.4443109505341871, "mean_action_processing_ms": 0.04017086467042099}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 300000, "timers": {"sample_time_ms": 7585.028, "sample_throughput": 527.355, "learn_time_ms": 11585.051, "learn_throughput": 345.273, "update_time_ms": 2.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.179166913032532, "policy_loss": -0.053558868006803095, "vf_loss": 12.220301300287247, "vf_explained_var": 0.3960617780685425, "kl": 0.02760974579723552, "entropy": 0.21672480925917625, "entropy_coeff": 0.0}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 30, "training_iteration": 75, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-22-27", "timestamp": 1618140147, "time_this_iter_s": 20.1159610748291, "time_total_s": 1498.3617811203003, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171120490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1498.3617811203003, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 57.568965517241374, "ram_util_percent": 27.017241379310345}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1717.0, "episode_reward_min": 1717.0, "episode_reward_mean": 1717.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1717.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5102044511218309, "mean_raw_obs_processing_ms": 0.07410242254886047, "mean_inference_ms": 1.4443109505341871, "mean_action_processing_ms": 0.04017086467042099}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 304000, "timers": {"sample_time_ms": 7645.913, "sample_throughput": 523.155, "learn_time_ms": 11578.996, "learn_throughput": 345.453, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.450503200292587, "policy_loss": -0.0352027285262011, "vf_loss": 12.479205876588821, "vf_explained_var": 0.3136354684829712, "kl": 0.009629581145418342, "entropy": 0.20067660929635167, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 30, "training_iteration": 76, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-22-46", "timestamp": 1618140166, "time_this_iter_s": 19.111834049224854, "time_total_s": 1517.4736151695251, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266306a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1517.4736151695251, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.74444444444445, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1717.0, "episode_reward_min": 1717.0, "episode_reward_mean": 1717.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1717.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5102044511218309, "mean_raw_obs_processing_ms": 0.07410242254886047, "mean_inference_ms": 1.4443109505341871, "mean_action_processing_ms": 0.04017086467042099}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 308000, "timers": {"sample_time_ms": 7621.741, "sample_throughput": 524.814, "learn_time_ms": 11581.311, "learn_throughput": 345.384, "update_time_ms": 2.91}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.649076998233795, "policy_loss": -0.03323931008344516, "vf_loss": 10.67462894320488, "vf_explained_var": 0.48475536704063416, "kl": 0.011388522922061384, "entropy": 0.2187334643676877, "entropy_coeff": 0.0}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 30, "training_iteration": 77, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-23-04", "timestamp": 1618140184, "time_this_iter_s": 18.424747467041016, "time_total_s": 1535.8983626365662, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119bfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1535.8983626365662, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.169230769230765, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1551.0, "episode_reward_min": 1551.0, "episode_reward_mean": 1551.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1551.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5014453482824792, "mean_raw_obs_processing_ms": 0.07436175537735375, "mean_inference_ms": 1.4438796272108982, "mean_action_processing_ms": 0.0401584747228476}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 312000, "timers": {"sample_time_ms": 7714.066, "sample_throughput": 518.533, "learn_time_ms": 11575.01, "learn_throughput": 345.572, "update_time_ms": 2.97}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 9.865431860089302, "policy_loss": -0.036049930611625314, "vf_loss": 9.895711094141006, "vf_explained_var": 0.4050460755825043, "kl": 0.00854925015300978, "entropy": 0.18238964676856995, "entropy_coeff": 0.0}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 31, "training_iteration": 78, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-23-24", "timestamp": 1618140204, "time_this_iter_s": 19.43384289741516, "time_total_s": 1555.3322055339813, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119f6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119f710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1555.3322055339813, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.825, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1551.0, "episode_reward_min": 1551.0, "episode_reward_mean": 1551.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1551.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5014453482824792, "mean_raw_obs_processing_ms": 0.07436175537735375, "mean_inference_ms": 1.4438796272108982, "mean_action_processing_ms": 0.0401584747228476}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 316000, "timers": {"sample_time_ms": 7802.618, "sample_throughput": 512.648, "learn_time_ms": 11572.349, "learn_throughput": 345.652, "update_time_ms": 3.025}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.22605736553669, "policy_loss": -0.04445301811210811, "vf_loss": 10.264037996530533, "vf_explained_var": 0.6347119212150574, "kl": 0.009588579967385158, "entropy": 0.20897200657054782, "entropy_coeff": 0.0}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 31, "training_iteration": 79, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-23-43", "timestamp": 1618140223, "time_this_iter_s": 19.436193466186523, "time_total_s": 1574.7683990001678, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1574.7683990001678, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.91428571428572, "ram_util_percent": 27.0}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1552.0, "episode_reward_min": 1552.0, "episode_reward_mean": 1552.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1552.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5004268855284991, "mean_raw_obs_processing_ms": 0.07452794641788023, "mean_inference_ms": 1.4436251051704934, "mean_action_processing_ms": 0.04014855519291338}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 320000, "timers": {"sample_time_ms": 7954.573, "sample_throughput": 502.855, "learn_time_ms": 11556.566, "learn_throughput": 346.124, "update_time_ms": 3.073}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 17.10642072558403, "policy_loss": -0.02885646966751665, "vf_loss": 17.13146072626114, "vf_explained_var": 0.5369768142700195, "kl": 0.00565356661536498, "entropy": 0.1960771637968719, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 32, "training_iteration": 80, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-24-03", "timestamp": 1618140243, "time_this_iter_s": 19.90924334526062, "time_total_s": 1594.6776423454285, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221fbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1594.6776423454285, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 57.44285714285714, "ram_util_percent": 27.00357142857143}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1552.0, "episode_reward_min": 1552.0, "episode_reward_mean": 1552.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1552.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5004268855284991, "mean_raw_obs_processing_ms": 0.07452794641788023, "mean_inference_ms": 1.4436251051704934, "mean_action_processing_ms": 0.04014855519291338}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 324000, "timers": {"sample_time_ms": 8377.156, "sample_throughput": 477.489, "learn_time_ms": 11569.884, "learn_throughput": 345.725, "update_time_ms": 3.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.427306443452835, "policy_loss": -0.036941991187632084, "vf_loss": 8.458415538072586, "vf_explained_var": 0.21567723155021667, "kl": 0.00864139266195707, "entropy": 0.14164359751157463, "entropy_coeff": 0.0}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 32, "training_iteration": 81, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-24-26", "timestamp": 1618140266, "time_this_iter_s": 22.8826687335968, "time_total_s": 1617.5603110790253, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1617.5603110790253, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.31515151515152, "ram_util_percent": 27.06969696969697}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1552.0, "episode_reward_min": 1552.0, "episode_reward_mean": 1552.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1552.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5004268855284991, "mean_raw_obs_processing_ms": 0.07452794641788023, "mean_inference_ms": 1.4436251051704934, "mean_action_processing_ms": 0.04014855519291338}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 328000, "timers": {"sample_time_ms": 8635.829, "sample_throughput": 463.187, "learn_time_ms": 11586.656, "learn_throughput": 345.225, "update_time_ms": 3.188}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.4292121678590775, "policy_loss": -0.032942108577117324, "vf_loss": 6.456022888422012, "vf_explained_var": 0.3058083653450012, "kl": 0.00908347150834743, "entropy": 0.169169062981382, "entropy_coeff": 0.0}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 32, "training_iteration": 82, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-24-48", "timestamp": 1618140288, "time_this_iter_s": 21.470213890075684, "time_total_s": 1639.030524969101, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711a8550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1639.030524969101, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 57.84193548387096, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1981.0, "episode_reward_min": 1981.0, "episode_reward_mean": 1981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157908320545073, "mean_raw_obs_processing_ms": 0.07482708014097447, "mean_inference_ms": 1.44331775464679, "mean_action_processing_ms": 0.040134467032906795}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 332000, "timers": {"sample_time_ms": 8820.475, "sample_throughput": 453.49, "learn_time_ms": 11592.462, "learn_throughput": 345.052, "update_time_ms": 3.291}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.180092990398407, "policy_loss": -0.027950484247412533, "vf_loss": 7.203286796808243, "vf_explained_var": 0.25525084137916565, "kl": 0.007047015649732202, "entropy": 0.15084631252102554, "entropy_coeff": 0.0}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 33, "training_iteration": 83, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-25-09", "timestamp": 1618140309, "time_this_iter_s": 20.774876356124878, "time_total_s": 1659.8054013252258, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711407d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1659.8054013252258, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 57.03103448275861, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1981.0, "episode_reward_min": 1981.0, "episode_reward_mean": 1981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157908320545073, "mean_raw_obs_processing_ms": 0.07482708014097447, "mean_inference_ms": 1.44331775464679, "mean_action_processing_ms": 0.040134467032906795}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 336000, "timers": {"sample_time_ms": 8460.887, "sample_throughput": 472.764, "learn_time_ms": 11601.7, "learn_throughput": 344.777, "update_time_ms": 3.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.388244897127151, "policy_loss": -0.055414621863747016, "vf_loss": 12.435839295387268, "vf_explained_var": 0.7517895698547363, "kl": 0.011585431420826353, "entropy": 0.3190202019177377, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 33, "training_iteration": 84, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-25-28", "timestamp": 1618140328, "time_this_iter_s": 19.166810274124146, "time_total_s": 1678.97221159935, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fe50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711a83d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1678.97221159935, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 57.657142857142844, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1616.0, "episode_reward_min": 1616.0, "episode_reward_mean": 1616.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1616.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5151236487941317, "mean_raw_obs_processing_ms": 0.0749626703709517, "mean_inference_ms": 1.4424338621208825, "mean_action_processing_ms": 0.04012032377240624}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 340000, "timers": {"sample_time_ms": 8472.768, "sample_throughput": 472.101, "learn_time_ms": 11608.941, "learn_throughput": 344.562, "update_time_ms": 3.315}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.745607972145081, "policy_loss": -0.04417466785525903, "vf_loss": 7.782500341534615, "vf_explained_var": 0.39989393949508667, "kl": 0.010788623745611403, "entropy": 0.15419068350456655, "entropy_coeff": 0.0}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 34, "training_iteration": 85, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-25-48", "timestamp": 1618140348, "time_this_iter_s": 20.311118841171265, "time_total_s": 1699.2833304405212, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665cef50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1699.2833304405212, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.248275862068965, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1616.0, "episode_reward_min": 1616.0, "episode_reward_mean": 1616.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1616.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5151236487941317, "mean_raw_obs_processing_ms": 0.0749626703709517, "mean_inference_ms": 1.4424338621208825, "mean_action_processing_ms": 0.04012032377240624}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 344000, "timers": {"sample_time_ms": 8793.499, "sample_throughput": 454.882, "learn_time_ms": 11609.866, "learn_throughput": 344.535, "update_time_ms": 3.333}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.427973613142967, "policy_loss": -0.029315658030100167, "vf_loss": 7.453296557068825, "vf_explained_var": 0.3300817310810089, "kl": 0.0059150261513423175, "entropy": 0.13860132917761803, "entropy_coeff": 0.0}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 34, "training_iteration": 86, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-26-10", "timestamp": 1618140370, "time_this_iter_s": 22.33049988746643, "time_total_s": 1721.6138303279877, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711a1cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1721.6138303279877, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 57.30625, "ram_util_percent": 27.1}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1616.0, "episode_reward_min": 1616.0, "episode_reward_mean": 1616.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1616.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5151236487941317, "mean_raw_obs_processing_ms": 0.0749626703709517, "mean_inference_ms": 1.4424338621208825, "mean_action_processing_ms": 0.04012032377240624}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 348000, "timers": {"sample_time_ms": 8809.137, "sample_throughput": 454.074, "learn_time_ms": 11618.406, "learn_throughput": 344.281, "update_time_ms": 3.316}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 5.917318232357502, "policy_loss": -0.02761616639327258, "vf_loss": 5.94027466326952, "vf_explained_var": 0.43847760558128357, "kl": 0.006903290486661717, "entropy": 0.1745703211054206, "entropy_coeff": 0.0}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 34, "training_iteration": 87, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-26-29", "timestamp": 1618140389, "time_this_iter_s": 18.665284156799316, "time_total_s": 1740.279114484787, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119f910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717223fa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1740.279114484787, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 58.06153846153846, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1914.0, "episode_reward_min": 1914.0, "episode_reward_mean": 1914.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1914.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5165321647491478, "mean_raw_obs_processing_ms": 0.07523155920611883, "mean_inference_ms": 1.4420866068455147, "mean_action_processing_ms": 0.04010919736856292}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 352000, "timers": {"sample_time_ms": 8803.944, "sample_throughput": 454.342, "learn_time_ms": 11609.111, "learn_throughput": 344.557, "update_time_ms": 3.252}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.258503794670105, "policy_loss": -0.03495762113016099, "vf_loss": 12.288330316543579, "vf_explained_var": 0.47773653268814087, "kl": 0.007601603894727305, "entropy": 0.19967749854549766, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 35, "training_iteration": 88, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-26-48", "timestamp": 1618140408, "time_this_iter_s": 19.289865016937256, "time_total_s": 1759.5689795017242, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171146a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171146f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1759.5689795017242, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 56.935714285714276, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1914.0, "episode_reward_min": 1914.0, "episode_reward_mean": 1914.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1914.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5165321647491478, "mean_raw_obs_processing_ms": 0.07523155920611883, "mean_inference_ms": 1.4420866068455147, "mean_action_processing_ms": 0.04010919736856292}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 356000, "timers": {"sample_time_ms": 8919.096, "sample_throughput": 448.476, "learn_time_ms": 11639.148, "learn_throughput": 343.668, "update_time_ms": 3.219}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.561100542545319, "policy_loss": -0.02755111936130561, "vf_loss": 8.582550585269928, "vf_explained_var": 0.2500876784324646, "kl": 0.009038644479005598, "entropy": 0.15507554239593446, "entropy_coeff": 0.0}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 35, "training_iteration": 89, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-27-09", "timestamp": 1618140429, "time_this_iter_s": 20.890756368637085, "time_total_s": 1780.4597358703613, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1780.4597358703613, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 58.02666666666667, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1580.0, "episode_reward_min": 1580.0, "episode_reward_mean": 1580.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1580.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157964028206696, "mean_raw_obs_processing_ms": 0.07541555608923663, "mean_inference_ms": 1.4421321618949736, "mean_action_processing_ms": 0.040100445884161146}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 360000, "timers": {"sample_time_ms": 8832.679, "sample_throughput": 452.864, "learn_time_ms": 11641.189, "learn_throughput": 343.608, "update_time_ms": 3.195}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.838688850402832, "policy_loss": -0.03888872038805857, "vf_loss": 10.870554983615875, "vf_explained_var": 0.6456069946289062, "kl": 0.01040360472688917, "entropy": 0.25880965823307633, "entropy_coeff": 0.0}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 36, "training_iteration": 90, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-27-28", "timestamp": 1618140448, "time_this_iter_s": 19.06506323814392, "time_total_s": 1799.5247991085052, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119be90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119ba10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1799.5247991085052, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 57.86666666666667, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1580.0, "episode_reward_min": 1580.0, "episode_reward_mean": 1580.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1580.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157964028206696, "mean_raw_obs_processing_ms": 0.07541555608923663, "mean_inference_ms": 1.4421321618949736, "mean_action_processing_ms": 0.040100445884161146}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 364000, "timers": {"sample_time_ms": 8825.86, "sample_throughput": 453.214, "learn_time_ms": 11622.751, "learn_throughput": 344.153, "update_time_ms": 3.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 9.603721871972084, "policy_loss": -0.03648401686223224, "vf_loss": 9.635160982608795, "vf_explained_var": 0.2316684126853943, "kl": 0.00747415150544839, "entropy": 0.14361202088184655, "entropy_coeff": 0.0}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 36, "training_iteration": 91, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-27-51", "timestamp": 1618140471, "time_this_iter_s": 22.629454612731934, "time_total_s": 1822.1542537212372, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1822.1542537212372, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 57.278125, "ram_util_percent": 27.1}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1580.0, "episode_reward_min": 1580.0, "episode_reward_mean": 1580.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1580.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157964028206696, "mean_raw_obs_processing_ms": 0.07541555608923663, "mean_inference_ms": 1.4421321618949736, "mean_action_processing_ms": 0.040100445884161146}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 368000, "timers": {"sample_time_ms": 8774.963, "sample_throughput": 455.842, "learn_time_ms": 11606.388, "learn_throughput": 344.638, "update_time_ms": 3.126}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.436289131641388, "policy_loss": -0.029095841222442687, "vf_loss": 8.460900232195854, "vf_explained_var": 0.2850978970527649, "kl": 0.006644021486863494, "entropy": 0.14368630619719625, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 36, "training_iteration": 92, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-28-12", "timestamp": 1618140492, "time_this_iter_s": 20.796908378601074, "time_total_s": 1842.9511620998383, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711407d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1842.9511620998383, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 57.279999999999994, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2056.0, "episode_reward_min": 2056.0, "episode_reward_mean": 2056.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2056.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5264690151963847, "mean_raw_obs_processing_ms": 0.07573923265205502, "mean_inference_ms": 1.4424411846509348, "mean_action_processing_ms": 0.04009543428341522}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 372000, "timers": {"sample_time_ms": 8761.57, "sample_throughput": 456.539, "learn_time_ms": 11593.254, "learn_throughput": 345.028, "update_time_ms": 2.979}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.308013260364532, "policy_loss": -0.032557838421780616, "vf_loss": 10.336079582571983, "vf_explained_var": 0.47798559069633484, "kl": 0.006654069118667394, "entropy": 0.1535975222941488, "entropy_coeff": 0.0}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 37, "training_iteration": 93, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-28-32", "timestamp": 1618140512, "time_this_iter_s": 20.50578212738037, "time_total_s": 1863.4569442272186, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665db290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1863.4569442272186, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 57.76896551724137, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2056.0, "episode_reward_min": 2056.0, "episode_reward_mean": 2056.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2056.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5264690151963847, "mean_raw_obs_processing_ms": 0.07573923265205502, "mean_inference_ms": 1.4424411846509348, "mean_action_processing_ms": 0.04009543428341522}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 376000, "timers": {"sample_time_ms": 8701.37, "sample_throughput": 459.698, "learn_time_ms": 11596.424, "learn_throughput": 344.934, "update_time_ms": 2.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.335887789726257, "policy_loss": -0.03886425800737925, "vf_loss": 12.369184613227844, "vf_explained_var": 0.5121943354606628, "kl": 0.008248068945249543, "entropy": 0.21663261018693447, "entropy_coeff": 0.0}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 37, "training_iteration": 94, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-28-51", "timestamp": 1618140531, "time_this_iter_s": 18.595571041107178, "time_total_s": 1882.0525152683258, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1882.0525152683258, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 57.10000000000001, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1527.0, "episode_reward_min": 1527.0, "episode_reward_mean": 1527.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1527.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5195728570244735, "mean_raw_obs_processing_ms": 0.0759198612721482, "mean_inference_ms": 1.4422837819697758, "mean_action_processing_ms": 0.04008604028787166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 380000, "timers": {"sample_time_ms": 8557.829, "sample_throughput": 467.408, "learn_time_ms": 11597.097, "learn_throughput": 344.914, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 14.099681079387665, "policy_loss": -0.03621945343911648, "vf_loss": 14.126889795064926, "vf_explained_var": 0.6078002452850342, "kl": 0.01334912895981688, "entropy": 0.2775433314964175, "entropy_coeff": 0.0}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 38, "training_iteration": 95, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-29-10", "timestamp": 1618140550, "time_this_iter_s": 18.881572484970093, "time_total_s": 1900.934087753296, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118dbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711403d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1900.934087753296, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 58.04074074074074, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1527.0, "episode_reward_min": 1527.0, "episode_reward_mean": 1527.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1527.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5195728570244735, "mean_raw_obs_processing_ms": 0.0759198612721482, "mean_inference_ms": 1.4422837819697758, "mean_action_processing_ms": 0.04008604028787166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 384000, "timers": {"sample_time_ms": 8441.606, "sample_throughput": 473.843, "learn_time_ms": 11591.004, "learn_throughput": 345.095, "update_time_ms": 2.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 14.47451075911522, "policy_loss": -0.03149758666404523, "vf_loss": 14.501341879367828, "vf_explained_var": 0.30933159589767456, "kl": 0.00691340361663606, "entropy": 0.16614375403150916, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 38, "training_iteration": 96, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-29-31", "timestamp": 1618140571, "time_this_iter_s": 21.10171151161194, "time_total_s": 1922.0357992649078, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664da6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1922.0357992649078, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 57.54666666666666, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1527.0, "episode_reward_min": 1527.0, "episode_reward_mean": 1527.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1527.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5195728570244735, "mean_raw_obs_processing_ms": 0.0759198612721482, "mean_inference_ms": 1.4422837819697758, "mean_action_processing_ms": 0.04008604028787166}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 388000, "timers": {"sample_time_ms": 8697.679, "sample_throughput": 459.893, "learn_time_ms": 11583.326, "learn_throughput": 345.324, "update_time_ms": 2.825}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.05526365339756, "policy_loss": -0.036380254896357656, "vf_loss": 6.082821041345596, "vf_explained_var": 0.29545828700065613, "kl": 0.013070997709291987, "entropy": 0.16963042598217726, "entropy_coeff": 0.0}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 38, "training_iteration": 97, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-29-52", "timestamp": 1618140592, "time_this_iter_s": 21.14855194091797, "time_total_s": 1943.1843512058258, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1943.1843512058258, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.38999999999999, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1970.0, "episode_reward_min": 1970.0, "episode_reward_mean": 1970.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1970.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5260767817947632, "mean_raw_obs_processing_ms": 0.0762291564453282, "mean_inference_ms": 1.4423055372263194, "mean_action_processing_ms": 0.04009345346316255}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 392000, "timers": {"sample_time_ms": 8785.213, "sample_throughput": 455.311, "learn_time_ms": 11605.159, "learn_throughput": 344.674, "update_time_ms": 2.879}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.675079554319382, "policy_loss": -0.047537780163111165, "vf_loss": 6.711225479841232, "vf_explained_var": 0.24361366033554077, "kl": 0.0168767859286163, "entropy": 0.1701289559714496, "entropy_coeff": 0.0}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 39, "training_iteration": 98, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-30-13", "timestamp": 1618140613, "time_this_iter_s": 20.381215810775757, "time_total_s": 1963.5655670166016, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1963.5655670166016, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.54827586206898, "ram_util_percent": 27.10000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1970.0, "episode_reward_min": 1970.0, "episode_reward_mean": 1970.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1970.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5260767817947632, "mean_raw_obs_processing_ms": 0.0762291564453282, "mean_inference_ms": 1.4423055372263194, "mean_action_processing_ms": 0.04009345346316255}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 396000, "timers": {"sample_time_ms": 9030.031, "sample_throughput": 442.966, "learn_time_ms": 11574.865, "learn_throughput": 345.576, "update_time_ms": 2.89}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 4.575245499610901, "policy_loss": -0.031224224163452163, "vf_loss": 4.602546691894531, "vf_explained_var": 0.34460264444351196, "kl": 0.005811838622321375, "entropy": 0.13985770172439516, "entropy_coeff": 0.0}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 39, "training_iteration": 99, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-30-36", "timestamp": 1618140636, "time_this_iter_s": 23.033329963684082, "time_total_s": 1986.5988969802856, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119bb10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1986.5988969802856, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 57.369696969696975, "ram_util_percent": 27.1}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.539349689962529, "mean_raw_obs_processing_ms": 0.07640947909081948, "mean_inference_ms": 1.4417583661241042, "mean_action_processing_ms": 0.04007601553738578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 400000, "timers": {"sample_time_ms": 9327.732, "sample_throughput": 428.829, "learn_time_ms": 11577.745, "learn_throughput": 345.49, "update_time_ms": 2.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.089640215039253, "policy_loss": -0.07627635117387399, "vf_loss": 7.144519731402397, "vf_explained_var": 0.6558876037597656, "kl": 0.03169900248758495, "entropy": 0.18584578949958086, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 40, "training_iteration": 100, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-30-58", "timestamp": 1618140658, "time_this_iter_s": 22.073729991912842, "time_total_s": 2008.6726269721985, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2008.6726269721985, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 57.178125, "ram_util_percent": 27.109375000000004}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.539349689962529, "mean_raw_obs_processing_ms": 0.07640947909081948, "mean_inference_ms": 1.4417583661241042, "mean_action_processing_ms": 0.04007601553738578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 404000, "timers": {"sample_time_ms": 8992.798, "sample_throughput": 444.8, "learn_time_ms": 11590.406, "learn_throughput": 345.113, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 8.82131077349186, "policy_loss": -0.03746739821508527, "vf_loss": 8.85349839925766, "vf_explained_var": 0.3647041916847229, "kl": 0.005214669195993338, "entropy": 0.1572074363939464, "entropy_coeff": 0.0}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 40, "training_iteration": 101, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-31-17", "timestamp": 1618140677, "time_this_iter_s": 19.40696620941162, "time_total_s": 2028.07959318161, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711464d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2028.07959318161, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 57.96296296296296, "ram_util_percent": 27.10370370370371}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.539349689962529, "mean_raw_obs_processing_ms": 0.07640947909081948, "mean_inference_ms": 1.4417583661241042, "mean_action_processing_ms": 0.04007601553738578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 408000, "timers": {"sample_time_ms": 8956.927, "sample_throughput": 446.582, "learn_time_ms": 11599.092, "learn_throughput": 344.855, "update_time_ms": 2.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 8.679091230034828, "policy_loss": -0.03588748749461956, "vf_loss": 8.705794781446457, "vf_explained_var": 0.34680017828941345, "kl": 0.009070464118849486, "entropy": 0.15715486067347229, "entropy_coeff": 0.0}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 40, "training_iteration": 102, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-31-38", "timestamp": 1618140698, "time_this_iter_s": 20.522540807724, "time_total_s": 2048.602133989334, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2048.602133989334, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 57.82666666666666, "ram_util_percent": 27.19333333333334}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2041.0, "episode_reward_min": 2041.0, "episode_reward_mean": 2041.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2041.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5425942460279924, "mean_raw_obs_processing_ms": 0.07670440389022777, "mean_inference_ms": 1.4417284292808332, "mean_action_processing_ms": 0.04006795856721257}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 412000, "timers": {"sample_time_ms": 9080.139, "sample_throughput": 440.522, "learn_time_ms": 11597.688, "learn_throughput": 344.896, "update_time_ms": 3.007}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 5.599730759859085, "policy_loss": -0.03147438683663495, "vf_loss": 5.626641735434532, "vf_explained_var": 0.2612330913543701, "kl": 0.004507113131694496, "entropy": 0.13124272180721164, "entropy_coeff": 0.0}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 41, "training_iteration": 103, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-32-00", "timestamp": 1618140720, "time_this_iter_s": 21.72620391845703, "time_total_s": 2070.328337907791, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118dd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118da10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2070.328337907791, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 57.34516129032257, "ram_util_percent": 27.16774193548388}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2041.0, "episode_reward_min": 2041.0, "episode_reward_mean": 2041.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2041.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5425942460279924, "mean_raw_obs_processing_ms": 0.07670440389022777, "mean_inference_ms": 1.4417284292808332, "mean_action_processing_ms": 0.04006795856721257}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 416000, "timers": {"sample_time_ms": 9188.888, "sample_throughput": 435.308, "learn_time_ms": 11596.206, "learn_throughput": 344.94, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.502142369747162, "policy_loss": -0.028195933147799224, "vf_loss": 8.52721981704235, "vf_explained_var": 0.2560054063796997, "kl": 0.00615982247836655, "entropy": 0.1321971700526774, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 41, "training_iteration": 104, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-32-19", "timestamp": 1618140739, "time_this_iter_s": 19.669636011123657, "time_total_s": 2089.997973918915, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d3a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2089.997973918915, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 57.51071428571429, "ram_util_percent": 27.11071428571429}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1777.0, "episode_reward_min": 1777.0, "episode_reward_mean": 1777.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1777.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5378405021107939, "mean_raw_obs_processing_ms": 0.07687685521165455, "mean_inference_ms": 1.4415519951029623, "mean_action_processing_ms": 0.040064674307378305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 420000, "timers": {"sample_time_ms": 9154.212, "sample_throughput": 436.957, "learn_time_ms": 11597.405, "learn_throughput": 344.905, "update_time_ms": 3.056}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 12.911219626665115, "policy_loss": -0.037267247040290385, "vf_loss": 12.943612068891525, "vf_explained_var": 0.4616931080818176, "kl": 0.00962905956839677, "entropy": 0.23858555406332016, "entropy_coeff": 0.0}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 42, "training_iteration": 105, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-32-38", "timestamp": 1618140758, "time_this_iter_s": 18.546515226364136, "time_total_s": 2108.544489145279, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d3c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2108.544489145279, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 57.70384615384615, "ram_util_percent": 27.10384615384616}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1777.0, "episode_reward_min": 1777.0, "episode_reward_mean": 1777.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1777.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5378405021107939, "mean_raw_obs_processing_ms": 0.07687685521165455, "mean_inference_ms": 1.4415519951029623, "mean_action_processing_ms": 0.040064674307378305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 424000, "timers": {"sample_time_ms": 8909.414, "sample_throughput": 448.963, "learn_time_ms": 11600.742, "learn_throughput": 344.806, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.206453070044518, "policy_loss": -0.03657482366543263, "vf_loss": 11.238676264882088, "vf_explained_var": 0.5394257307052612, "kl": 0.008595692183007486, "entropy": 0.18307487736456096, "entropy_coeff": 0.0}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 42, "training_iteration": 106, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-32-57", "timestamp": 1618140777, "time_this_iter_s": 18.688637495040894, "time_total_s": 2127.23312664032, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2127.23312664032, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 57.333333333333336, "ram_util_percent": 27.166666666666668}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1777.0, "episode_reward_min": 1777.0, "episode_reward_mean": 1777.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1777.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5378405021107939, "mean_raw_obs_processing_ms": 0.07687685521165455, "mean_inference_ms": 1.4415519951029623, "mean_action_processing_ms": 0.040064674307378305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 428000, "timers": {"sample_time_ms": 8648.841, "sample_throughput": 462.49, "learn_time_ms": 11607.493, "learn_throughput": 344.605, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 12.084393054246902, "policy_loss": -0.04799275580444373, "vf_loss": 12.124387592077255, "vf_explained_var": 0.5679274201393127, "kl": 0.015798925276612863, "entropy": 0.32724621426314116, "entropy_coeff": 0.0}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 42, "training_iteration": 107, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-33-15", "timestamp": 1618140795, "time_this_iter_s": 18.612784385681152, "time_total_s": 2145.845911026001, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2145.845911026001, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.75555555555556, "ram_util_percent": 27.111111111111114}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1314.0, "episode_reward_min": 1314.0, "episode_reward_mean": 1314.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1314.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5277744318343917, "mean_raw_obs_processing_ms": 0.0771562161177254, "mean_inference_ms": 1.4414004773609133, "mean_action_processing_ms": 0.040058446693584215}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 432000, "timers": {"sample_time_ms": 8478.715, "sample_throughput": 471.77, "learn_time_ms": 11603.372, "learn_throughput": 344.727, "update_time_ms": 2.98}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.203487977385521, "policy_loss": -0.02169442700687796, "vf_loss": 10.22066916525364, "vf_explained_var": 0.36352330446243286, "kl": 0.008914967824239284, "entropy": 0.14818121888674796, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 43, "training_iteration": 108, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-33-34", "timestamp": 1618140814, "time_this_iter_s": 18.63675093650818, "time_total_s": 2164.482661962509, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d37d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2164.482661962509, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 57.38461538461539, "ram_util_percent": 27.188461538461542}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1314.0, "episode_reward_min": 1314.0, "episode_reward_mean": 1314.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1314.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5277744318343917, "mean_raw_obs_processing_ms": 0.0771562161177254, "mean_inference_ms": 1.4414004773609133, "mean_action_processing_ms": 0.040058446693584215}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 436000, "timers": {"sample_time_ms": 8020.953, "sample_throughput": 498.694, "learn_time_ms": 11601.76, "learn_throughput": 344.775, "update_time_ms": 2.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.788409054279327, "policy_loss": -0.04785875434754416, "vf_loss": 11.83060371875763, "vf_explained_var": 0.5228978395462036, "kl": 0.011188724456587806, "entropy": 0.2526461500674486, "entropy_coeff": 0.0}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 43, "training_iteration": 109, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-33-52", "timestamp": 1618140832, "time_this_iter_s": 18.442467212677002, "time_total_s": 2182.925129175186, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171146890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266306a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2182.925129175186, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 57.900000000000006, "ram_util_percent": 27.129629629629637}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1299.0, "episode_reward_min": 1299.0, "episode_reward_mean": 1299.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1299.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5213504115548369, "mean_raw_obs_processing_ms": 0.07735957206944846, "mean_inference_ms": 1.4414465384781456, "mean_action_processing_ms": 0.040060887538551825}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 440000, "timers": {"sample_time_ms": 7693.513, "sample_throughput": 519.919, "learn_time_ms": 11616.888, "learn_throughput": 344.326, "update_time_ms": 2.959}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.59813080728054, "policy_loss": -0.03718833776656538, "vf_loss": 9.630723550915718, "vf_explained_var": 0.6022698283195496, "kl": 0.009077920607523993, "entropy": 0.19561545480974019, "entropy_coeff": 0.0}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 44, "training_iteration": 110, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-34-11", "timestamp": 1618140851, "time_this_iter_s": 18.94822120666504, "time_total_s": 2201.873350381851, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221fe10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2201.873350381851, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 58.03703703703703, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1299.0, "episode_reward_min": 1299.0, "episode_reward_mean": 1299.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1299.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5213504115548369, "mean_raw_obs_processing_ms": 0.07735957206944846, "mean_inference_ms": 1.4414465384781456, "mean_action_processing_ms": 0.040060887538551825}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 444000, "timers": {"sample_time_ms": 7614.762, "sample_throughput": 525.295, "learn_time_ms": 11613.896, "learn_throughput": 344.415, "update_time_ms": 2.983}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 13.485987275838852, "policy_loss": -0.040496450223145075, "vf_loss": 13.51987612247467, "vf_explained_var": 0.4076698422431946, "kl": 0.013052310547209345, "entropy": 0.20926819974556565, "entropy_coeff": 0.0}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 44, "training_iteration": 111, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-34-30", "timestamp": 1618140870, "time_this_iter_s": 18.587745904922485, "time_total_s": 2220.4610962867737, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d3c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221ff10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2220.4610962867737, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 57.38076923076923, "ram_util_percent": 27.11538461538462}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1299.0, "episode_reward_min": 1299.0, "episode_reward_mean": 1299.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1299.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5213504115548369, "mean_raw_obs_processing_ms": 0.07735957206944846, "mean_inference_ms": 1.4414465384781456, "mean_action_processing_ms": 0.040060887538551825}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 448000, "timers": {"sample_time_ms": 7438.848, "sample_throughput": 537.718, "learn_time_ms": 11618.135, "learn_throughput": 344.289, "update_time_ms": 2.968}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.593215242028236, "policy_loss": -0.03690631658537313, "vf_loss": 9.625923171639442, "vf_explained_var": 0.34684574604034424, "kl": 0.008292965270811692, "entropy": 0.15552075556479394, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 44, "training_iteration": 112, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-34-49", "timestamp": 1618140889, "time_this_iter_s": 18.80808711051941, "time_total_s": 2239.269183397293, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171146890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2239.269183397293, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 57.733333333333334, "ram_util_percent": 27.100000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1660.0, "episode_reward_min": 1660.0, "episode_reward_mean": 1660.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1660.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5220986732125528, "mean_raw_obs_processing_ms": 0.07761795512696301, "mean_inference_ms": 1.4412609675887194, "mean_action_processing_ms": 0.04005679250271709}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 452000, "timers": {"sample_time_ms": 7564.964, "sample_throughput": 528.753, "learn_time_ms": 11617.967, "learn_throughput": 344.294, "update_time_ms": 2.882}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.109539434313774, "policy_loss": -0.027129723923280835, "vf_loss": 6.130909666419029, "vf_explained_var": 0.2553715109825134, "kl": 0.011376851733075455, "entropy": 0.13302300148643553, "entropy_coeff": 0.0}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 45, "training_iteration": 113, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-35-12", "timestamp": 1618140912, "time_this_iter_s": 22.982743978500366, "time_total_s": 2262.2519273757935, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2262.2519273757935, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 57.03333333333334, "ram_util_percent": 27.1}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1660.0, "episode_reward_min": 1660.0, "episode_reward_mean": 1660.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1660.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5220986732125528, "mean_raw_obs_processing_ms": 0.07761795512696301, "mean_inference_ms": 1.4412609675887194, "mean_action_processing_ms": 0.04005679250271709}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 456000, "timers": {"sample_time_ms": 7683.008, "sample_throughput": 520.629, "learn_time_ms": 11612.361, "learn_throughput": 344.461, "update_time_ms": 2.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.042531967163086, "policy_loss": -0.04499441327061504, "vf_loss": 9.078013509511948, "vf_explained_var": 0.41960299015045166, "kl": 0.018790847330819815, "entropy": 0.15848753927275538, "entropy_coeff": 0.0}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 45, "training_iteration": 114, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-35-33", "timestamp": 1618140933, "time_this_iter_s": 20.7922420501709, "time_total_s": 2283.0441694259644, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2283.0441694259644, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 57.679310344827584, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1997.0, "episode_reward_min": 1997.0, "episode_reward_mean": 1997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5251464550267734, "mean_raw_obs_processing_ms": 0.07780277971158331, "mean_inference_ms": 1.44127950193344, "mean_action_processing_ms": 0.04005923943901673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 460000, "timers": {"sample_time_ms": 7898.723, "sample_throughput": 506.411, "learn_time_ms": 11605.47, "learn_throughput": 344.665, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.677917197346687, "policy_loss": -0.027383208100218326, "vf_loss": 9.701623067259789, "vf_explained_var": 0.3597264885902405, "kl": 0.0072638792771613225, "entropy": 0.13210622244514525, "entropy_coeff": 0.0}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 46, "training_iteration": 115, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-35-53", "timestamp": 1618140953, "time_this_iter_s": 20.63366436958313, "time_total_s": 2303.6778337955475, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d3590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2303.6778337955475, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 57.406666666666666, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1997.0, "episode_reward_min": 1997.0, "episode_reward_mean": 1997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5251464550267734, "mean_raw_obs_processing_ms": 0.07780277971158331, "mean_inference_ms": 1.44127950193344, "mean_action_processing_ms": 0.04005923943901673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 464000, "timers": {"sample_time_ms": 8045.475, "sample_throughput": 497.174, "learn_time_ms": 11621.67, "learn_throughput": 344.185, "update_time_ms": 2.942}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.315136134624481, "policy_loss": -0.03109769767615944, "vf_loss": 11.342575907707214, "vf_explained_var": 0.36974194645881653, "kl": 0.007225667490274645, "entropy": 0.13767471350729465, "entropy_coeff": 0.0}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 46, "training_iteration": 116, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-36-14", "timestamp": 1618140974, "time_this_iter_s": 20.32070302963257, "time_total_s": 2323.99853682518, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2323.99853682518, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 57.23103448275862, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1997.0, "episode_reward_min": 1997.0, "episode_reward_mean": 1997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5251464550267734, "mean_raw_obs_processing_ms": 0.07780277971158331, "mean_inference_ms": 1.44127950193344, "mean_action_processing_ms": 0.04005923943901673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 468000, "timers": {"sample_time_ms": 8462.749, "sample_throughput": 472.66, "learn_time_ms": 11633.028, "learn_throughput": 343.849, "update_time_ms": 2.977}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 7.747893303632736, "policy_loss": -0.023415608768118545, "vf_loss": 7.767866089940071, "vf_explained_var": 0.40177279710769653, "kl": 0.006800640621804632, "entropy": 0.12239335104823112, "entropy_coeff": 0.0}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 46, "training_iteration": 117, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-36-36", "timestamp": 1618140996, "time_this_iter_s": 22.897992372512817, "time_total_s": 2346.896529197693, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71722127d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2346.896529197693, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 57.775757575757574, "ram_util_percent": 27.184848484848487}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1981.0, "episode_reward_min": 1981.0, "episode_reward_mean": 1981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5381281122954751, "mean_raw_obs_processing_ms": 0.07810415373385739, "mean_inference_ms": 1.4411874722735458, "mean_action_processing_ms": 0.04005230786863267}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 472000, "timers": {"sample_time_ms": 8935.684, "sample_throughput": 447.643, "learn_time_ms": 11651.135, "learn_throughput": 343.314, "update_time_ms": 2.981}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 14.953225553035736, "policy_loss": -0.0344578757067211, "vf_loss": 14.982937306165695, "vf_explained_var": 0.38601696491241455, "kl": 0.009375317604281008, "entropy": 0.1402490553446114, "entropy_coeff": 0.0}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 47, "training_iteration": 118, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-37-00", "timestamp": 1618141020, "time_this_iter_s": 23.549826622009277, "time_total_s": 2370.446355819702, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2370.446355819702, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 57.624242424242425, "ram_util_percent": 27.187878787878788}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1981.0, "episode_reward_min": 1981.0, "episode_reward_mean": 1981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5381281122954751, "mean_raw_obs_processing_ms": 0.07810415373385739, "mean_inference_ms": 1.4411874722735458, "mean_action_processing_ms": 0.04005230786863267}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 476000, "timers": {"sample_time_ms": 9459.651, "sample_throughput": 422.849, "learn_time_ms": 11653.868, "learn_throughput": 343.234, "update_time_ms": 2.958}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.847292467951775, "policy_loss": -0.04870755231240764, "vf_loss": 9.886779427528381, "vf_explained_var": 0.34557920694351196, "kl": 0.0182132406916935, "entropy": 0.1361512669827789, "entropy_coeff": 0.0}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 47, "training_iteration": 119, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-37-24", "timestamp": 1618141044, "time_this_iter_s": 23.70868492126465, "time_total_s": 2394.155040740967, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2394.155040740967, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.694117647058825, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2226.0, "episode_reward_min": 2226.0, "episode_reward_mean": 2226.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2226.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.550366526641188, "mean_raw_obs_processing_ms": 0.07833360306673016, "mean_inference_ms": 1.4417148207673234, "mean_action_processing_ms": 0.04007725611518043}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 480000, "timers": {"sample_time_ms": 9841.071, "sample_throughput": 406.46, "learn_time_ms": 11643.683, "learn_throughput": 343.534, "update_time_ms": 2.972}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.0159432888031, "policy_loss": -0.016790306486655027, "vf_loss": 8.029941201210022, "vf_explained_var": 0.26163622736930847, "kl": 0.005515668046427891, "entropy": 0.10123887984082103, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 48, "training_iteration": 120, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-37-46", "timestamp": 1618141066, "time_this_iter_s": 22.663275718688965, "time_total_s": 2416.8183164596558, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711839d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2416.8183164596558, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 57.31818181818182, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2226.0, "episode_reward_min": 2226.0, "episode_reward_mean": 2226.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2226.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.550366526641188, "mean_raw_obs_processing_ms": 0.07833360306673016, "mean_inference_ms": 1.4417148207673234, "mean_action_processing_ms": 0.04007725611518043}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 484000, "timers": {"sample_time_ms": 10106.242, "sample_throughput": 395.795, "learn_time_ms": 11661.456, "learn_throughput": 343.01, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.201958045363426, "policy_loss": -0.01901442708913237, "vf_loss": 6.21708257496357, "vf_explained_var": 0.3197740316390991, "kl": 0.007683669507969171, "entropy": 0.12079117237590253, "entropy_coeff": 0.0}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 48, "training_iteration": 121, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-38-08", "timestamp": 1618141088, "time_this_iter_s": 21.419169425964355, "time_total_s": 2438.23748588562, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117be50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2438.23748588562, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 57.713333333333324, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2226.0, "episode_reward_min": 2226.0, "episode_reward_mean": 2226.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2226.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.550366526641188, "mean_raw_obs_processing_ms": 0.07833360306673016, "mean_inference_ms": 1.4417148207673234, "mean_action_processing_ms": 0.04007725611518043}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 488000, "timers": {"sample_time_ms": 10322.832, "sample_throughput": 387.491, "learn_time_ms": 11683.115, "learn_throughput": 342.374, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 7.865894064307213, "policy_loss": -0.029346469847951084, "vf_loss": 7.891248345375061, "vf_explained_var": 0.3697516620159149, "kl": 0.007885685889050364, "entropy": 0.12415770255029202, "entropy_coeff": 0.0}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 48, "training_iteration": 122, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-38-29", "timestamp": 1618141109, "time_this_iter_s": 21.188395023345947, "time_total_s": 2459.425880908966, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2459.425880908966, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 57.959999999999994, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2122.0, "episode_reward_min": 2122.0, "episode_reward_mean": 2122.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2122.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5596213693433914, "mean_raw_obs_processing_ms": 0.07868249870978765, "mean_inference_ms": 1.44291212790763, "mean_action_processing_ms": 0.04011485961689399}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 492000, "timers": {"sample_time_ms": 10374.558, "sample_throughput": 385.559, "learn_time_ms": 11730.19, "learn_throughput": 341.0, "update_time_ms": 2.985}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 4.382460527122021, "policy_loss": -0.02162670437246561, "vf_loss": 4.40048785507679, "vf_explained_var": 0.30965179204940796, "kl": 0.007109941179805901, "entropy": 0.11388176796026528, "entropy_coeff": 0.0}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 49, "training_iteration": 123, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-38-53", "timestamp": 1618141133, "time_this_iter_s": 23.978047847747803, "time_total_s": 2483.403928756714, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2483.403928756714, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 58.14, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2122.0, "episode_reward_min": 2122.0, "episode_reward_mean": 2122.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2122.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5596213693433914, "mean_raw_obs_processing_ms": 0.07868249870978765, "mean_inference_ms": 1.44291212790763, "mean_action_processing_ms": 0.04011485961689399}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 496000, "timers": {"sample_time_ms": 10491.662, "sample_throughput": 381.255, "learn_time_ms": 11781.735, "learn_throughput": 339.509, "update_time_ms": 3.011}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 5.782788708806038, "policy_loss": -0.02649484114954248, "vf_loss": 5.805655002593994, "vf_explained_var": 0.3098704218864441, "kl": 0.007167606498114765, "entropy": 0.10918404848780483, "entropy_coeff": 0.0}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 49, "training_iteration": 124, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-39-16", "timestamp": 1618141156, "time_this_iter_s": 22.485695838928223, "time_total_s": 2505.889624595642, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d3b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2505.889624595642, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 58.003125, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1984.0, "episode_reward_min": 1984.0, "episode_reward_mean": 1984.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1984.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5597805977392196, "mean_raw_obs_processing_ms": 0.07893794103158865, "mean_inference_ms": 1.4437092493269543, "mean_action_processing_ms": 0.040143472493206385}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 500000, "timers": {"sample_time_ms": 10319.692, "sample_throughput": 387.608, "learn_time_ms": 11793.127, "learn_throughput": 339.181, "update_time_ms": 2.997}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.87716543674469, "policy_loss": -0.04434750851942226, "vf_loss": 10.91676627099514, "vf_explained_var": 0.4677533209323883, "kl": 0.009376161280670203, "entropy": 0.15426978329196572, "entropy_coeff": 0.0}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 50, "training_iteration": 125, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-39-35", "timestamp": 1618141175, "time_this_iter_s": 19.030295848846436, "time_total_s": 2524.9199204444885, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118de90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2524.9199204444885, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 57.44814814814814, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1984.0, "episode_reward_min": 1984.0, "episode_reward_mean": 1984.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1984.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5597805977392196, "mean_raw_obs_processing_ms": 0.07893794103158865, "mean_inference_ms": 1.4437092493269543, "mean_action_processing_ms": 0.040143472493206385}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 504000, "timers": {"sample_time_ms": 10177.818, "sample_throughput": 393.012, "learn_time_ms": 11787.766, "learn_throughput": 339.335, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 13.731551557779312, "policy_loss": -0.044431271351641044, "vf_loss": 13.768739432096481, "vf_explained_var": 0.4942886233329773, "kl": 0.014307905395980924, "entropy": 0.2612081440165639, "entropy_coeff": 0.0}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 50, "training_iteration": 126, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-39-54", "timestamp": 1618141194, "time_this_iter_s": 18.844154119491577, "time_total_s": 2543.76407456398, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2543.76407456398, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 58.20740740740741, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1984.0, "episode_reward_min": 1984.0, "episode_reward_mean": 1984.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1984.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5597805977392196, "mean_raw_obs_processing_ms": 0.07893794103158865, "mean_inference_ms": 1.4437092493269543, "mean_action_processing_ms": 0.040143472493206385}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 508000, "timers": {"sample_time_ms": 9864.146, "sample_throughput": 405.509, "learn_time_ms": 11789.814, "learn_throughput": 339.276, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 12.79905691742897, "policy_loss": -0.03169311978854239, "vf_loss": 12.826881766319275, "vf_explained_var": 0.3360016942024231, "kl": 0.007640733616426587, "entropy": 0.1311483688186854, "entropy_coeff": 0.0}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 50, "training_iteration": 127, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-40-13", "timestamp": 1618141213, "time_this_iter_s": 19.782711505889893, "time_total_s": 2563.54678606987, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ef10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2563.54678606987, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 57.76071428571429, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1546.0, "episode_reward_min": 1546.0, "episode_reward_mean": 1546.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1546.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5579839351800031, "mean_raw_obs_processing_ms": 0.07924125000746368, "mean_inference_ms": 1.443894453285131, "mean_action_processing_ms": 0.04014444007632062}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 512000, "timers": {"sample_time_ms": 9676.59, "sample_throughput": 413.369, "learn_time_ms": 11768.129, "learn_throughput": 339.901, "update_time_ms": 2.951}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.507087618112564, "policy_loss": -0.029646216629771516, "vf_loss": 8.533434972167015, "vf_explained_var": 0.3698786497116089, "kl": 0.006516309545986587, "entropy": 0.10639657662250102, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 51, "training_iteration": 128, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-40-35", "timestamp": 1618141235, "time_this_iter_s": 21.45729351043701, "time_total_s": 2585.004079580307, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2585.004079580307, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 57.912903225806446, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1546.0, "episode_reward_min": 1546.0, "episode_reward_mean": 1546.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1546.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5579839351800031, "mean_raw_obs_processing_ms": 0.07924125000746368, "mean_inference_ms": 1.443894453285131, "mean_action_processing_ms": 0.04014444007632062}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 516000, "timers": {"sample_time_ms": 9473.563, "sample_throughput": 422.228, "learn_time_ms": 11773.884, "learn_throughput": 339.735, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 5.8719193786382675, "policy_loss": -0.019611860974691808, "vf_loss": 5.8884066343307495, "vf_explained_var": 0.29154521226882935, "kl": 0.0061722244281554595, "entropy": 0.10531739029102027, "entropy_coeff": 0.0}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 51, "training_iteration": 129, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-40-57", "timestamp": 1618141257, "time_this_iter_s": 21.737701892852783, "time_total_s": 2606.74178147316, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d39d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ead0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2606.74178147316, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 57.61290322580645, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2119.0, "episode_reward_min": 2119.0, "episode_reward_mean": 2119.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2119.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5651432049355117, "mean_raw_obs_processing_ms": 0.07945719303185088, "mean_inference_ms": 1.4440887584377913, "mean_action_processing_ms": 0.040146756452917515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 520000, "timers": {"sample_time_ms": 9465.275, "sample_throughput": 422.597, "learn_time_ms": 11783.776, "learn_throughput": 339.45, "update_time_ms": 3.006}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.038736909627914, "policy_loss": -0.03670684256940149, "vf_loss": 8.071515932679176, "vf_explained_var": 0.5220049619674683, "kl": 0.007758652536722366, "entropy": 0.1222245185635984, "entropy_coeff": 0.0}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 52, "training_iteration": 130, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-41-19", "timestamp": 1618141279, "time_this_iter_s": 22.679566144943237, "time_total_s": 2629.421347618103, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e26d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711429d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2629.421347618103, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 57.293749999999996, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2119.0, "episode_reward_min": 2119.0, "episode_reward_mean": 2119.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2119.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5651432049355117, "mean_raw_obs_processing_ms": 0.07945719303185088, "mean_inference_ms": 1.4440887584377913, "mean_action_processing_ms": 0.040146756452917515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 524000, "timers": {"sample_time_ms": 9358.858, "sample_throughput": 427.403, "learn_time_ms": 11779.742, "learn_throughput": 339.566, "update_time_ms": 3.037}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.750598132610321, "policy_loss": -0.022329386469209567, "vf_loss": 6.76956981420517, "vf_explained_var": 0.2935788631439209, "kl": 0.006632168886426371, "entropy": 0.10303013236261904, "entropy_coeff": 0.0}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 52, "training_iteration": 131, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-41-40", "timestamp": 1618141300, "time_this_iter_s": 20.316085815429688, "time_total_s": 2649.7374334335327, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7172212390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2649.7374334335327, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 57.75172413793104, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2119.0, "episode_reward_min": 2119.0, "episode_reward_mean": 2119.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2119.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5651432049355117, "mean_raw_obs_processing_ms": 0.07945719303185088, "mean_inference_ms": 1.4440887584377913, "mean_action_processing_ms": 0.040146756452917515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 528000, "timers": {"sample_time_ms": 9559.607, "sample_throughput": 418.427, "learn_time_ms": 11756.498, "learn_throughput": 340.237, "update_time_ms": 3.033}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 5.148504197597504, "policy_loss": -0.026262031635269523, "vf_loss": 5.171427324414253, "vf_explained_var": 0.2848362326622009, "kl": 0.00659526124218246, "entropy": 0.09985971904825419, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 52, "training_iteration": 132, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-42-03", "timestamp": 1618141323, "time_this_iter_s": 22.965734481811523, "time_total_s": 2672.7031679153442, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2672.7031679153442, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 57.32727272727272, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2211.0, "episode_reward_min": 2211.0, "episode_reward_mean": 2211.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2211.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5755286315589734, "mean_raw_obs_processing_ms": 0.07974079432472582, "mean_inference_ms": 1.4441817253437315, "mean_action_processing_ms": 0.04015083536850358}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 532000, "timers": {"sample_time_ms": 9526.994, "sample_throughput": 419.86, "learn_time_ms": 11705.652, "learn_throughput": 341.715, "update_time_ms": 3.094}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 5.425049617886543, "policy_loss": -0.026794154255185276, "vf_loss": 5.448180004954338, "vf_explained_var": 0.3168647587299347, "kl": 0.00723701695096679, "entropy": 0.0957162156701088, "entropy_coeff": 0.0}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 53, "training_iteration": 133, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-42-26", "timestamp": 1618141346, "time_this_iter_s": 23.139134168624878, "time_total_s": 2695.842302083969, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2695.842302083969, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 56.984848484848484, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2211.0, "episode_reward_min": 2211.0, "episode_reward_mean": 2211.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2211.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5755286315589734, "mean_raw_obs_processing_ms": 0.07974079432472582, "mean_inference_ms": 1.4441817253437315, "mean_action_processing_ms": 0.04015083536850358}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 536000, "timers": {"sample_time_ms": 9440.582, "sample_throughput": 423.703, "learn_time_ms": 11654.74, "learn_throughput": 343.208, "update_time_ms": 3.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.301327899098396, "policy_loss": -0.022344112483551726, "vf_loss": 6.320157900452614, "vf_explained_var": 0.35611677169799805, "kl": 0.006941524814465083, "entropy": 0.10922332271002233, "entropy_coeff": 0.0}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 53, "training_iteration": 134, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-42-47", "timestamp": 1618141367, "time_this_iter_s": 21.10701298713684, "time_total_s": 2716.949315071106, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711401d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2716.949315071106, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 57.629999999999995, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2158.0, "episode_reward_min": 2158.0, "episode_reward_mean": 2158.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2158.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5791760474485765, "mean_raw_obs_processing_ms": 0.07997582866397696, "mean_inference_ms": 1.4447156351687434, "mean_action_processing_ms": 0.040169510804662065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 540000, "timers": {"sample_time_ms": 9719.344, "sample_throughput": 411.55, "learn_time_ms": 11670.487, "learn_throughput": 342.745, "update_time_ms": 3.079}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.029611960053444, "policy_loss": -0.02975221024826169, "vf_loss": 8.055542543530464, "vf_explained_var": 0.5229747295379639, "kl": 0.007548771696747281, "entropy": 0.1251248351763934, "entropy_coeff": 0.0}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 54, "training_iteration": 135, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-43-09", "timestamp": 1618141389, "time_this_iter_s": 21.973215103149414, "time_total_s": 2738.9225301742554, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2738.9225301742554, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 58.328125, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2158.0, "episode_reward_min": 2158.0, "episode_reward_mean": 2158.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2158.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5791760474485765, "mean_raw_obs_processing_ms": 0.07997582866397696, "mean_inference_ms": 1.4447156351687434, "mean_action_processing_ms": 0.040169510804662065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 544000, "timers": {"sample_time_ms": 9943.412, "sample_throughput": 402.276, "learn_time_ms": 11680.83, "learn_throughput": 342.441, "update_time_ms": 3.215}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 5.053410030901432, "policy_loss": -0.02513142634415999, "vf_loss": 5.075009427964687, "vf_explained_var": 0.30829334259033203, "kl": 0.006976714634220116, "entropy": 0.0985631849616766, "entropy_coeff": 0.0}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 54, "training_iteration": 136, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-43-30", "timestamp": 1618141410, "time_this_iter_s": 21.19444751739502, "time_total_s": 2760.1169776916504, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711982d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2760.1169776916504, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 57.20666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2158.0, "episode_reward_min": 2158.0, "episode_reward_mean": 2158.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2158.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5791760474485765, "mean_raw_obs_processing_ms": 0.07997582866397696, "mean_inference_ms": 1.4447156351687434, "mean_action_processing_ms": 0.040169510804662065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 548000, "timers": {"sample_time_ms": 10122.718, "sample_throughput": 395.151, "learn_time_ms": 11684.555, "learn_throughput": 342.332, "update_time_ms": 3.238}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 4.976582318544388, "policy_loss": -0.02648068853886798, "vf_loss": 4.9982960522174835, "vf_explained_var": 0.3716038465499878, "kl": 0.009416392596904188, "entropy": 0.12455333187244833, "entropy_coeff": 0.0}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 54, "training_iteration": 137, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-43-52", "timestamp": 1618141432, "time_this_iter_s": 21.620368003845215, "time_total_s": 2781.7373456954956, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711421d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2781.7373456954956, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 58.08387096774194, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2061.0, "episode_reward_min": 2061.0, "episode_reward_mean": 2061.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2061.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5798307743683517, "mean_raw_obs_processing_ms": 0.08026105656171598, "mean_inference_ms": 1.4447271099882297, "mean_action_processing_ms": 0.04016687970571578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 552000, "timers": {"sample_time_ms": 9864.602, "sample_throughput": 405.49, "learn_time_ms": 11701.063, "learn_throughput": 341.849, "update_time_ms": 3.207}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.077284425497055, "policy_loss": -0.036662279977463186, "vf_loss": 10.109848141670227, "vf_explained_var": 0.4596421420574188, "kl": 0.008096153367660008, "entropy": 0.15730939316563308, "entropy_coeff": 0.0}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 55, "training_iteration": 138, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-44-11", "timestamp": 1618141451, "time_this_iter_s": 19.041064500808716, "time_total_s": 2800.7784101963043, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2800.7784101963043, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 57.6888888888889, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2061.0, "episode_reward_min": 2061.0, "episode_reward_mean": 2061.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2061.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5798307743683517, "mean_raw_obs_processing_ms": 0.08026105656171598, "mean_inference_ms": 1.4447271099882297, "mean_action_processing_ms": 0.04016687970571578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 556000, "timers": {"sample_time_ms": 9567.469, "sample_throughput": 418.083, "learn_time_ms": 11724.9, "learn_throughput": 341.154, "update_time_ms": 3.175}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.930633395910263, "policy_loss": -0.037412885067169555, "vf_loss": 11.962433904409409, "vf_explained_var": 0.3535367250442505, "kl": 0.011086209560744464, "entropy": 0.1636978064198047, "entropy_coeff": 0.0}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 55, "training_iteration": 139, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-44-30", "timestamp": 1618141470, "time_this_iter_s": 19.006266117095947, "time_total_s": 2819.7846763134003, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2819.7846763134003, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 58.3, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1787.0, "episode_reward_min": 1787.0, "episode_reward_mean": 1787.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1787.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5771079393088229, "mean_raw_obs_processing_ms": 0.08046034724577994, "mean_inference_ms": 1.4448119112507025, "mean_action_processing_ms": 0.040169574753127754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 560000, "timers": {"sample_time_ms": 9353.38, "sample_throughput": 427.653, "learn_time_ms": 11734.619, "learn_throughput": 340.872, "update_time_ms": 3.185}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.88748213648796, "policy_loss": -0.03506955230841413, "vf_loss": 11.918057292699814, "vf_explained_var": 0.5399487018585205, "kl": 0.008877619809936732, "entropy": 0.15005433140322566, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 56, "training_iteration": 140, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-44-51", "timestamp": 1618141491, "time_this_iter_s": 20.63606905937195, "time_total_s": 2840.420745372772, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2840.420745372772, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 57.833333333333336, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1787.0, "episode_reward_min": 1787.0, "episode_reward_mean": 1787.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1787.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5771079393088229, "mean_raw_obs_processing_ms": 0.08046034724577994, "mean_inference_ms": 1.4448119112507025, "mean_action_processing_ms": 0.040169574753127754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 564000, "timers": {"sample_time_ms": 9364.461, "sample_throughput": 427.147, "learn_time_ms": 11730.199, "learn_throughput": 341.0, "update_time_ms": 3.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.747114479541779, "policy_loss": -0.028542442072648555, "vf_loss": 10.772197961807251, "vf_explained_var": 0.36819988489151, "kl": 0.0068325792944960995, "entropy": 0.10963084653485566, "entropy_coeff": 0.0}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 56, "training_iteration": 141, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-45-11", "timestamp": 1618141511, "time_this_iter_s": 20.382575511932373, "time_total_s": 2860.8033208847046, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ebb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114fd90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2860.8033208847046, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 57.08620689655172, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1787.0, "episode_reward_min": 1787.0, "episode_reward_mean": 1787.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1787.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5771079393088229, "mean_raw_obs_processing_ms": 0.08046034724577994, "mean_inference_ms": 1.4448119112507025, "mean_action_processing_ms": 0.040169574753127754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 568000, "timers": {"sample_time_ms": 9078.233, "sample_throughput": 440.614, "learn_time_ms": 11747.494, "learn_throughput": 340.498, "update_time_ms": 3.189}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.948917999863625, "policy_loss": -0.029491970548406243, "vf_loss": 8.974667146801949, "vf_explained_var": 0.3931933343410492, "kl": 0.007393267434963491, "entropy": 0.13066333113238215, "entropy_coeff": 0.0}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 56, "training_iteration": 142, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-45-31", "timestamp": 1618141531, "time_this_iter_s": 20.276968717575073, "time_total_s": 2881.0802896022797, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2881.0802896022797, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 58.172413793103445, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2061.0, "episode_reward_min": 2061.0, "episode_reward_mean": 2061.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2061.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.579831103349934, "mean_raw_obs_processing_ms": 0.08075005329144104, "mean_inference_ms": 1.4450042661306852, "mean_action_processing_ms": 0.04016734233517554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 572000, "timers": {"sample_time_ms": 8979.571, "sample_throughput": 445.456, "learn_time_ms": 11765.373, "learn_throughput": 339.981, "update_time_ms": 3.121}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 7.033025041222572, "policy_loss": -0.03270872280700132, "vf_loss": 7.061687186360359, "vf_explained_var": 0.38240137696266174, "kl": 0.007993030405486934, "entropy": 0.12247141590341926, "entropy_coeff": 0.0}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 57, "training_iteration": 143, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-45-54", "timestamp": 1618141554, "time_this_iter_s": 22.327789306640625, "time_total_s": 2903.4080789089203, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717225bed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2903.4080789089203, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 57.612500000000004, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2061.0, "episode_reward_min": 2061.0, "episode_reward_mean": 2061.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2061.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.579831103349934, "mean_raw_obs_processing_ms": 0.08075005329144104, "mean_inference_ms": 1.4450042661306852, "mean_action_processing_ms": 0.04016734233517554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 576000, "timers": {"sample_time_ms": 8761.142, "sample_throughput": 456.561, "learn_time_ms": 11784.906, "learn_throughput": 339.417, "update_time_ms": 3.104}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.54809184372425, "policy_loss": -0.03137261513620615, "vf_loss": 9.576013088226318, "vf_explained_var": 0.39197906851768494, "kl": 0.006817426954512484, "entropy": 0.13073830562643707, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 57, "training_iteration": 144, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-46-13", "timestamp": 1618141573, "time_this_iter_s": 19.117389678955078, "time_total_s": 2922.5254685878754, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e24d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717225b9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2922.5254685878754, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 58.36296296296297, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1938.0, "episode_reward_min": 1938.0, "episode_reward_mean": 1938.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1938.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5791098311183037, "mean_raw_obs_processing_ms": 0.08093973748196212, "mean_inference_ms": 1.4451181895712315, "mean_action_processing_ms": 0.04016790452644635}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 580000, "timers": {"sample_time_ms": 8719.945, "sample_throughput": 458.718, "learn_time_ms": 11760.938, "learn_throughput": 340.109, "update_time_ms": 3.067}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.07146467268467, "policy_loss": -0.03958300215890631, "vf_loss": 9.106842637062073, "vf_explained_var": 0.4442776143550873, "kl": 0.008306408937642118, "entropy": 0.11752443958539516, "entropy_coeff": 0.0}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 58, "training_iteration": 145, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-46-34", "timestamp": 1618141594, "time_this_iter_s": 21.31975555419922, "time_total_s": 2943.8452241420746, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fa90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2943.8452241420746, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 57.63000000000001, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1938.0, "episode_reward_min": 1938.0, "episode_reward_mean": 1938.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1938.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5791098311183037, "mean_raw_obs_processing_ms": 0.08093973748196212, "mean_inference_ms": 1.4451181895712315, "mean_action_processing_ms": 0.04016790452644635}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 584000, "timers": {"sample_time_ms": 8851.393, "sample_throughput": 451.906, "learn_time_ms": 11734.738, "learn_throughput": 340.868, "update_time_ms": 2.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.4225934445858, "policy_loss": -0.02838338617584668, "vf_loss": 9.443851709365845, "vf_explained_var": 0.3031995892524719, "kl": 0.014073983722482808, "entropy": 0.12440953846089542, "entropy_coeff": 0.0}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 58, "training_iteration": 146, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-46-57", "timestamp": 1618141617, "time_this_iter_s": 22.241084814071655, "time_total_s": 2966.0863089561462, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221f190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2966.0863089561462, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 57.63125, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1938.0, "episode_reward_min": 1938.0, "episode_reward_mean": 1938.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1938.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5791098311183037, "mean_raw_obs_processing_ms": 0.08093973748196212, "mean_inference_ms": 1.4451181895712315, "mean_action_processing_ms": 0.04016790452644635}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 588000, "timers": {"sample_time_ms": 8962.945, "sample_throughput": 446.282, "learn_time_ms": 11707.631, "learn_throughput": 341.658, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.804692566394806, "policy_loss": -0.02509840711718425, "vf_loss": 6.824877023696899, "vf_explained_var": 0.2841954231262207, "kl": 0.009706558412290178, "entropy": 0.11647505243308842, "entropy_coeff": 0.0}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 58, "training_iteration": 147, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-47-19", "timestamp": 1618141639, "time_this_iter_s": 22.45428228378296, "time_total_s": 2988.540591239929, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2988.540591239929, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 58.040625000000006, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2141.0, "episode_reward_min": 2141.0, "episode_reward_mean": 2141.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2141.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5867239080174411, "mean_raw_obs_processing_ms": 0.08124441884506758, "mean_inference_ms": 1.4460622868727857, "mean_action_processing_ms": 0.04017644415343919}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 592000, "timers": {"sample_time_ms": 9194.103, "sample_throughput": 435.061, "learn_time_ms": 11687.765, "learn_throughput": 342.238, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.3149586617946625, "policy_loss": -0.023943459033034742, "vf_loss": 6.334787905216217, "vf_explained_var": 0.3654201924800873, "kl": 0.008126972410536837, "entropy": 0.11430751625448465, "entropy_coeff": 0.0}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 59, "training_iteration": 148, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-47-40", "timestamp": 1618141660, "time_this_iter_s": 21.151925802230835, "time_total_s": 3009.69251704216, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ebc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3009.69251704216, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 57.75666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2141.0, "episode_reward_min": 2141.0, "episode_reward_mean": 2141.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2141.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5867239080174411, "mean_raw_obs_processing_ms": 0.08124441884506758, "mean_inference_ms": 1.4460622868727857, "mean_action_processing_ms": 0.04017644415343919}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 596000, "timers": {"sample_time_ms": 9429.743, "sample_throughput": 424.19, "learn_time_ms": 11663.354, "learn_throughput": 342.955, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.764138087630272, "policy_loss": -0.03377583061228506, "vf_loss": 9.791460499167442, "vf_explained_var": 0.3715309500694275, "kl": 0.012747489570756443, "entropy": 0.12178118526935577, "entropy_coeff": 0.0}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 59, "training_iteration": 149, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-48-01", "timestamp": 1618141681, "time_this_iter_s": 21.114795923233032, "time_total_s": 3030.807312965393, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ebc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3030.807312965393, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 57.80322580645161, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2119.0, "episode_reward_min": 2119.0, "episode_reward_mean": 2119.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2119.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5897477974170265, "mean_raw_obs_processing_ms": 0.08143045761422552, "mean_inference_ms": 1.445900879085922, "mean_action_processing_ms": 0.04017033994729617}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 600000, "timers": {"sample_time_ms": 9519.277, "sample_throughput": 420.2, "learn_time_ms": 11632.831, "learn_throughput": 343.854, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.373816445469856, "policy_loss": -0.030926321560400538, "vf_loss": 9.400558665394783, "vf_explained_var": 0.3445972800254822, "kl": 0.008264764997875318, "entropy": 0.11505986424162984, "entropy_coeff": 0.0}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 60, "training_iteration": 150, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-48-23", "timestamp": 1618141703, "time_this_iter_s": 21.22611951828003, "time_total_s": 3052.033432483673, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717224e5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3052.033432483673, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 57.71, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2119.0, "episode_reward_min": 2119.0, "episode_reward_mean": 2119.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2119.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5897477974170265, "mean_raw_obs_processing_ms": 0.08143045761422552, "mean_inference_ms": 1.445900879085922, "mean_action_processing_ms": 0.04017033994729617}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 604000, "timers": {"sample_time_ms": 9514.462, "sample_throughput": 420.413, "learn_time_ms": 11623.443, "learn_throughput": 344.132, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 14.546121388673782, "policy_loss": -0.06020552763948217, "vf_loss": 14.591592997312546, "vf_explained_var": 0.537375271320343, "kl": 0.02910408010939136, "entropy": 0.1809939881786704, "entropy_coeff": 0.0}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 60, "training_iteration": 151, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-48-43", "timestamp": 1618141723, "time_this_iter_s": 20.239505529403687, "time_total_s": 3072.272938013077, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664da6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3072.272938013077, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 57.7551724137931, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2119.0, "episode_reward_min": 2119.0, "episode_reward_mean": 2119.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2119.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5897477974170265, "mean_raw_obs_processing_ms": 0.08143045761422552, "mean_inference_ms": 1.445900879085922, "mean_action_processing_ms": 0.04017033994729617}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 608000, "timers": {"sample_time_ms": 9698.0, "sample_throughput": 412.456, "learn_time_ms": 11602.364, "learn_throughput": 344.757, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 8.161194115877151, "policy_loss": -0.0429944506904576, "vf_loss": 8.189793840050697, "vf_explained_var": 0.3431125581264496, "kl": 0.018956281041027978, "entropy": 0.12704620463773608, "entropy_coeff": 0.0}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 60, "training_iteration": 152, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-49-05", "timestamp": 1618141745, "time_this_iter_s": 21.90393304824829, "time_total_s": 3094.176871061325, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717115bbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3094.176871061325, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 57.832258064516125, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1944.0, "episode_reward_min": 1944.0, "episode_reward_mean": 1944.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1944.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5957132828770879, "mean_raw_obs_processing_ms": 0.08174145578227208, "mean_inference_ms": 1.4461415216980538, "mean_action_processing_ms": 0.04017651606520717}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 612000, "timers": {"sample_time_ms": 9752.754, "sample_throughput": 410.141, "learn_time_ms": 11593.33, "learn_throughput": 345.026, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 9.713445901870728, "policy_loss": -0.06922243640292436, "vf_loss": 9.755343869328499, "vf_explained_var": 0.5327271223068237, "kl": 0.03598292812239379, "entropy": 0.1473126569762826, "entropy_coeff": 0.0}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 61, "training_iteration": 153, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-49-28", "timestamp": 1618141768, "time_this_iter_s": 22.784403800964355, "time_total_s": 3116.9612748622894, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711409d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3116.9612748622894, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 57.44242424242424, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1944.0, "episode_reward_min": 1944.0, "episode_reward_mean": 1944.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1944.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5957132828770879, "mean_raw_obs_processing_ms": 0.08174145578227208, "mean_inference_ms": 1.4461415216980538, "mean_action_processing_ms": 0.04017651606520717}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 616000, "timers": {"sample_time_ms": 10111.465, "sample_throughput": 395.591, "learn_time_ms": 11589.928, "learn_throughput": 345.127, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1390625, "cur_lr": 5e-05, "total_loss": 7.549428969621658, "policy_loss": -0.023333072080276906, "vf_loss": 7.568223640322685, "vf_explained_var": 0.354674756526947, "kl": 0.003984325561759761, "entropy": 0.11085159983485937, "entropy_coeff": 0.0}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 61, "training_iteration": 154, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-49-50", "timestamp": 1618141790, "time_this_iter_s": 22.66779112815857, "time_total_s": 3139.629065990448, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3139.629065990448, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 58.29375, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2152.0, "episode_reward_min": 2152.0, "episode_reward_mean": 2152.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2152.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6028091179306682, "mean_raw_obs_processing_ms": 0.08195850512332076, "mean_inference_ms": 1.4462309872210355, "mean_action_processing_ms": 0.04017942200756441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 620000, "timers": {"sample_time_ms": 10252.099, "sample_throughput": 390.164, "learn_time_ms": 11599.416, "learn_throughput": 344.845, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.3685891777277, "policy_loss": -0.04120860848343, "vf_loss": 10.403372645378113, "vf_explained_var": 0.4641522467136383, "kl": 0.011281267565209419, "entropy": 0.12542667449451983, "entropy_coeff": 0.0}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 62, "training_iteration": 155, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-50-13", "timestamp": 1618141813, "time_this_iter_s": 22.82129406929016, "time_total_s": 3162.450360059738, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171157c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266348710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3162.450360059738, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 57.45454545454545, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2152.0, "episode_reward_min": 2152.0, "episode_reward_mean": 2152.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2152.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6028091179306682, "mean_raw_obs_processing_ms": 0.08195850512332076, "mean_inference_ms": 1.4462309872210355, "mean_action_processing_ms": 0.04017942200756441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 624000, "timers": {"sample_time_ms": 10344.444, "sample_throughput": 386.681, "learn_time_ms": 11596.689, "learn_throughput": 344.926, "update_time_ms": 2.89}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.132838621735573, "policy_loss": -0.022109098368673585, "vf_loss": 8.151766449213028, "vf_explained_var": 0.2613486051559448, "kl": 0.005585520641034236, "entropy": 0.09876453829929233, "entropy_coeff": 0.0}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 62, "training_iteration": 156, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-50-36", "timestamp": 1618141836, "time_this_iter_s": 23.137078285217285, "time_total_s": 3185.5874383449554, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118da10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3185.5874383449554, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 57.35151515151515, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2152.0, "episode_reward_min": 2152.0, "episode_reward_mean": 2152.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2152.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6028091179306682, "mean_raw_obs_processing_ms": 0.08195850512332076, "mean_inference_ms": 1.4462309872210355, "mean_action_processing_ms": 0.04017942200756441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 628000, "timers": {"sample_time_ms": 10244.6, "sample_throughput": 390.45, "learn_time_ms": 11604.981, "learn_throughput": 344.68, "update_time_ms": 2.937}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.124154821038246, "policy_loss": -0.02275618858402595, "vf_loss": 5.142869517207146, "vf_explained_var": 0.19015556573867798, "kl": 0.00709615416417364, "entropy": 0.0961648328229785, "entropy_coeff": 0.0}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 62, "training_iteration": 157, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-50-58", "timestamp": 1618141858, "time_this_iter_s": 21.542366981506348, "time_total_s": 3207.129805326462, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711981d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717224e1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3207.129805326462, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 57.730000000000004, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2269.0, "episode_reward_min": 2269.0, "episode_reward_mean": 2269.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2269.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6073957094654804, "mean_raw_obs_processing_ms": 0.08227853454321754, "mean_inference_ms": 1.4469465772057575, "mean_action_processing_ms": 0.04020542523763757}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 632000, "timers": {"sample_time_ms": 10115.18, "sample_throughput": 395.445, "learn_time_ms": 11603.215, "learn_throughput": 344.732, "update_time_ms": 2.948}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.421604588627815, "policy_loss": -0.028684042510576546, "vf_loss": 9.445124983787537, "vf_explained_var": 0.4393211007118225, "kl": 0.009066698519745842, "entropy": 0.1395653069484979, "entropy_coeff": 0.0}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 63, "training_iteration": 158, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-51-18", "timestamp": 1618141878, "time_this_iter_s": 19.845632076263428, "time_total_s": 3226.975437402725, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172257b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3226.975437402725, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 58.05862068965517, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2269.0, "episode_reward_min": 2269.0, "episode_reward_mean": 2269.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2269.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6073957094654804, "mean_raw_obs_processing_ms": 0.08227853454321754, "mean_inference_ms": 1.4469465772057575, "mean_action_processing_ms": 0.04020542523763757}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 636000, "timers": {"sample_time_ms": 10314.073, "sample_throughput": 387.82, "learn_time_ms": 11607.389, "learn_throughput": 344.608, "update_time_ms": 2.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.394739776849747, "policy_loss": -0.02784480625996366, "vf_loss": 7.418909624218941, "vf_explained_var": 0.38158267736434937, "kl": 0.0064528431903454475, "entropy": 0.11113172490149736, "entropy_coeff": 0.0}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 63, "training_iteration": 159, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-51-41", "timestamp": 1618141901, "time_this_iter_s": 23.145947217941284, "time_total_s": 3250.1213846206665, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cfd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3250.1213846206665, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 57.44242424242424, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2010.0, "episode_reward_min": 2010.0, "episode_reward_mean": 2010.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2010.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6126599525354469, "mean_raw_obs_processing_ms": 0.08248625994754953, "mean_inference_ms": 1.4472460541166685, "mean_action_processing_ms": 0.04021424365387744}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 640000, "timers": {"sample_time_ms": 10321.374, "sample_throughput": 387.545, "learn_time_ms": 11612.187, "learn_throughput": 344.466, "update_time_ms": 3.042}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.321675315499306, "policy_loss": -0.02561798895476386, "vf_loss": 9.343112722039223, "vf_explained_var": 0.5459225177764893, "kl": 0.0073403318237978965, "entropy": 0.12106807949021459, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 64, "training_iteration": 160, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-52-02", "timestamp": 1618141922, "time_this_iter_s": 21.344433546066284, "time_total_s": 3271.465818166733, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118dc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172257b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3271.465818166733, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 57.813333333333325, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2010.0, "episode_reward_min": 2010.0, "episode_reward_mean": 2010.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2010.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6126599525354469, "mean_raw_obs_processing_ms": 0.08248625994754953, "mean_inference_ms": 1.4472460541166685, "mean_action_processing_ms": 0.04021424365387744}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 644000, "timers": {"sample_time_ms": 10493.706, "sample_throughput": 381.181, "learn_time_ms": 11623.96, "learn_throughput": 344.117, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.71753665804863, "policy_loss": -0.024050106876529753, "vf_loss": 6.7374680787324905, "vf_explained_var": 0.27818846702575684, "kl": 0.0072316562218475156, "entropy": 0.10018898150883615, "entropy_coeff": 0.0}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 64, "training_iteration": 161, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-52-24", "timestamp": 1618141944, "time_this_iter_s": 22.08094096183777, "time_total_s": 3293.5467591285706, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3293.5467591285706, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 58.0125, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2010.0, "episode_reward_min": 2010.0, "episode_reward_mean": 2010.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2010.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6126599525354469, "mean_raw_obs_processing_ms": 0.08248625994754953, "mean_inference_ms": 1.4472460541166685, "mean_action_processing_ms": 0.04021424365387744}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 648000, "timers": {"sample_time_ms": 10210.22, "sample_throughput": 391.764, "learn_time_ms": 11634.071, "learn_throughput": 343.818, "update_time_ms": 3.023}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.154918029904366, "policy_loss": -0.03189501428278163, "vf_loss": 8.18283386528492, "vf_explained_var": 0.353249728679657, "kl": 0.006986693122598808, "entropy": 0.12110897176899016, "entropy_coeff": 0.0}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 64, "training_iteration": 162, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-52-44", "timestamp": 1618141964, "time_this_iter_s": 19.16777491569519, "time_total_s": 3312.7145340442657, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3312.7145340442657, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 58.25555555555556, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2129.0, "episode_reward_min": 2129.0, "episode_reward_mean": 2129.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2129.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6124117368419487, "mean_raw_obs_processing_ms": 0.08281387933683346, "mean_inference_ms": 1.44784380406066, "mean_action_processing_ms": 0.04023210009707323}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 652000, "timers": {"sample_time_ms": 9998.293, "sample_throughput": 400.068, "learn_time_ms": 11647.567, "learn_throughput": 343.419, "update_time_ms": 3.057}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.498243972659111, "policy_loss": -0.026697925088228658, "vf_loss": 7.520679205656052, "vf_explained_var": 0.37044745683670044, "kl": 0.007484496170945931, "entropy": 0.11625975999049842, "entropy_coeff": 0.0}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 65, "training_iteration": 163, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-53-04", "timestamp": 1618141984, "time_this_iter_s": 20.803900957107544, "time_total_s": 3333.5184350013733, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711402d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3333.5184350013733, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 57.75000000000001, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2129.0, "episode_reward_min": 2129.0, "episode_reward_mean": 2129.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2129.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6124117368419487, "mean_raw_obs_processing_ms": 0.08281387933683346, "mean_inference_ms": 1.44784380406066, "mean_action_processing_ms": 0.04023210009707323}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 656000, "timers": {"sample_time_ms": 9766.133, "sample_throughput": 409.579, "learn_time_ms": 11639.609, "learn_throughput": 343.654, "update_time_ms": 3.112}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.476698860526085, "policy_loss": -0.024544128216803074, "vf_loss": 9.495929583907127, "vf_explained_var": 0.46535682678222656, "kl": 0.00932908100367058, "entropy": 0.13112651417031884, "entropy_coeff": 0.0}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 65, "training_iteration": 164, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-53-25", "timestamp": 1618142005, "time_this_iter_s": 20.271700143814087, "time_total_s": 3353.7901351451874, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e25d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3353.7901351451874, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 58.327586206896555, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2100.0, "episode_reward_min": 2100.0, "episode_reward_mean": 2100.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2100.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6133560633652897, "mean_raw_obs_processing_ms": 0.08303465761105344, "mean_inference_ms": 1.4482870229966518, "mean_action_processing_ms": 0.04024095001264861}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 660000, "timers": {"sample_time_ms": 9660.266, "sample_throughput": 414.067, "learn_time_ms": 11628.384, "learn_throughput": 343.986, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.706356376409531, "policy_loss": -0.02924685348989442, "vf_loss": 6.731670662760735, "vf_explained_var": 0.3526530861854553, "kl": 0.006904985595610924, "entropy": 0.11367522832006216, "entropy_coeff": 0.0}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 66, "training_iteration": 165, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-53-46", "timestamp": 1618142026, "time_this_iter_s": 21.65383529663086, "time_total_s": 3375.4439704418182, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3375.4439704418182, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 57.65483870967742, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2100.0, "episode_reward_min": 2100.0, "episode_reward_mean": 2100.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2100.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6133560633652897, "mean_raw_obs_processing_ms": 0.08303465761105344, "mean_inference_ms": 1.4482870229966518, "mean_action_processing_ms": 0.04024095001264861}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 664000, "timers": {"sample_time_ms": 9242.172, "sample_throughput": 432.799, "learn_time_ms": 11640.147, "learn_throughput": 343.638, "update_time_ms": 3.107}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.632216289639473, "policy_loss": -0.02824602258624509, "vf_loss": 9.65601746737957, "vf_explained_var": 0.4837666153907776, "kl": 0.007804106528055854, "entropy": 0.1494418524671346, "entropy_coeff": 0.0}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 66, "training_iteration": 166, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-54-05", "timestamp": 1618142045, "time_this_iter_s": 19.074462175369263, "time_total_s": 3394.5184326171875, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171093610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171093dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3394.5184326171875, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 57.46666666666667, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2100.0, "episode_reward_min": 2100.0, "episode_reward_mean": 2100.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2100.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6133560633652897, "mean_raw_obs_processing_ms": 0.08303465761105344, "mean_inference_ms": 1.4482870229966518, "mean_action_processing_ms": 0.04024095001264861}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 668000, "timers": {"sample_time_ms": 9318.859, "sample_throughput": 429.237, "learn_time_ms": 11646.036, "learn_throughput": 343.465, "update_time_ms": 3.079}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.131645157933235, "policy_loss": -0.03289762721396983, "vf_loss": 8.159843027591705, "vf_explained_var": 0.5589772462844849, "kl": 0.008252275583799928, "entropy": 0.1362789454869926, "entropy_coeff": 0.0}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 66, "training_iteration": 167, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-54-28", "timestamp": 1618142068, "time_this_iter_s": 22.367199182510376, "time_total_s": 3416.885631799698, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711980d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3416.885631799698, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 58.203125, "ram_util_percent": 27.2}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1933.0, "episode_reward_min": 1933.0, "episode_reward_mean": 1933.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1933.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6135113894750409, "mean_raw_obs_processing_ms": 0.08334969885506258, "mean_inference_ms": 1.4487074360537409, "mean_action_processing_ms": 0.040248483130487026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 672000, "timers": {"sample_time_ms": 9380.468, "sample_throughput": 426.418, "learn_time_ms": 11647.499, "learn_throughput": 343.421, "update_time_ms": 3.092}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.135810658335686, "policy_loss": -0.0337102665216662, "vf_loss": 7.165433570742607, "vf_explained_var": 0.2790363132953644, "kl": 0.007176812825491652, "entropy": 0.10844167857430875, "entropy_coeff": 0.0}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 67, "training_iteration": 168, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-54-48", "timestamp": 1618142088, "time_this_iter_s": 20.472316026687622, "time_total_s": 3437.3579478263855, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710eb3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664b1f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3437.3579478263855, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 57.24827586206897, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1933.0, "episode_reward_min": 1933.0, "episode_reward_mean": 1933.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1933.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6135113894750409, "mean_raw_obs_processing_ms": 0.08334969885506258, "mean_inference_ms": 1.4487074360537409, "mean_action_processing_ms": 0.040248483130487026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 676000, "timers": {"sample_time_ms": 9161.899, "sample_throughput": 436.591, "learn_time_ms": 11646.538, "learn_throughput": 343.45, "update_time_ms": 3.044}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.731747016310692, "policy_loss": -0.03366266348166391, "vf_loss": 5.761095464229584, "vf_explained_var": 0.34082096815109253, "kl": 0.007575028765131719, "entropy": 0.11455892375670373, "entropy_coeff": 0.0}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 67, "training_iteration": 169, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-55-09", "timestamp": 1618142109, "time_this_iter_s": 20.948468923568726, "time_total_s": 3458.306416749954, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171093410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3458.306416749954, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 57.779999999999994, "ram_util_percent": 27.280000000000012}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2191.0, "episode_reward_min": 2191.0, "episode_reward_mean": 2191.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2191.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6168248922856019, "mean_raw_obs_processing_ms": 0.08354400837808199, "mean_inference_ms": 1.4489189869492536, "mean_action_processing_ms": 0.040251845882753}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 680000, "timers": {"sample_time_ms": 9270.221, "sample_throughput": 431.489, "learn_time_ms": 11659.928, "learn_throughput": 343.055, "update_time_ms": 2.99}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.348831862211227, "policy_loss": -0.031119106512051076, "vf_loss": 6.375552520155907, "vf_explained_var": 0.31132233142852783, "kl": 0.007722847709374037, "entropy": 0.10956154856830835, "entropy_coeff": 0.0}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 68, "training_iteration": 170, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-55-32", "timestamp": 1618142132, "time_this_iter_s": 22.561853170394897, "time_total_s": 3480.868269920349, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3480.868269920349, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 57.734375, "ram_util_percent": 27.284375000000004}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2191.0, "episode_reward_min": 2191.0, "episode_reward_mean": 2191.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2191.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6168248922856019, "mean_raw_obs_processing_ms": 0.08354400837808199, "mean_inference_ms": 1.4489189869492536, "mean_action_processing_ms": 0.040251845882753}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 684000, "timers": {"sample_time_ms": 9433.545, "sample_throughput": 424.019, "learn_time_ms": 11648.138, "learn_throughput": 343.403, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.755945518612862, "policy_loss": -0.04468941886443645, "vf_loss": 8.790022179484367, "vf_explained_var": 0.29559603333473206, "kl": 0.018634307576576248, "entropy": 0.12236448004841805, "entropy_coeff": 0.0}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 68, "training_iteration": 171, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-55-56", "timestamp": 1618142156, "time_this_iter_s": 23.59561324119568, "time_total_s": 3504.463883161545, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ebf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116cdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3504.463883161545, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 57.800000000000004, "ram_util_percent": 27.238235294117644}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2191.0, "episode_reward_min": 2191.0, "episode_reward_mean": 2191.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2191.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6168248922856019, "mean_raw_obs_processing_ms": 0.08354400837808199, "mean_inference_ms": 1.4489189869492536, "mean_action_processing_ms": 0.040251845882753}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 688000, "timers": {"sample_time_ms": 9666.511, "sample_throughput": 413.8, "learn_time_ms": 11644.636, "learn_throughput": 343.506, "update_time_ms": 3.054}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.46108902990818, "policy_loss": -0.02312405698467046, "vf_loss": 6.480543538928032, "vf_explained_var": 0.3057999312877655, "kl": 0.00644311256473884, "entropy": 0.10769495961721987, "entropy_coeff": 0.0}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 68, "training_iteration": 172, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-56-17", "timestamp": 1618142177, "time_this_iter_s": 21.46224069595337, "time_total_s": 3525.926123857498, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717224e1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3525.926123857498, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 57.83870967741936, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2243.0, "episode_reward_min": 2243.0, "episode_reward_mean": 2243.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2243.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6279007783491674, "mean_raw_obs_processing_ms": 0.08383248699230421, "mean_inference_ms": 1.4488961107087437, "mean_action_processing_ms": 0.040255244466358225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 692000, "timers": {"sample_time_ms": 10018.567, "sample_throughput": 399.259, "learn_time_ms": 11632.984, "learn_throughput": 343.85, "update_time_ms": 3.06}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.8054307252168655, "policy_loss": -0.029203274403698742, "vf_loss": 5.827493891119957, "vf_explained_var": 0.32763993740081787, "kl": 0.012536635622382164, "entropy": 0.10718580009415746, "entropy_coeff": 0.0}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 69, "training_iteration": 173, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-56-41", "timestamp": 1618142201, "time_this_iter_s": 24.20508646965027, "time_total_s": 3550.1312103271484, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717115b1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3550.1312103271484, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 57.48235294117647, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2243.0, "episode_reward_min": 2243.0, "episode_reward_mean": 2243.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2243.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6279007783491674, "mean_raw_obs_processing_ms": 0.08383248699230421, "mean_inference_ms": 1.4488961107087437, "mean_action_processing_ms": 0.040255244466358225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 696000, "timers": {"sample_time_ms": 9951.538, "sample_throughput": 401.948, "learn_time_ms": 11662.61, "learn_throughput": 342.976, "update_time_ms": 3.029}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.844116270542145, "policy_loss": -0.043489083589520305, "vf_loss": 9.878394663333893, "vf_explained_var": 0.3380235433578491, "kl": 0.016172599178389646, "entropy": 0.1476819075178355, "entropy_coeff": 0.0}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 69, "training_iteration": 174, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-57-01", "timestamp": 1618142221, "time_this_iter_s": 19.892592668533325, "time_total_s": 3570.0238029956818, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118da90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118df10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3570.0238029956818, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 58.9103448275862, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1883.0, "episode_reward_min": 1883.0, "episode_reward_mean": 1883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6248363182362594, "mean_raw_obs_processing_ms": 0.08403346454692007, "mean_inference_ms": 1.4492005278765914, "mean_action_processing_ms": 0.04026124345646774}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 700000, "timers": {"sample_time_ms": 9746.911, "sample_throughput": 410.386, "learn_time_ms": 11664.767, "learn_throughput": 342.913, "update_time_ms": 2.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 12.711196780204773, "policy_loss": -0.06497286498779431, "vf_loss": 12.762078285217285, "vf_explained_var": 0.6642121076583862, "kl": 0.024741971195908263, "entropy": 0.21785262692719698, "entropy_coeff": 0.0}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 70, "training_iteration": 175, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-57-21", "timestamp": 1618142241, "time_this_iter_s": 19.62863254547119, "time_total_s": 3589.652435541153, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711400d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3589.652435541153, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 58.167857142857144, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1883.0, "episode_reward_min": 1883.0, "episode_reward_mean": 1883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6248363182362594, "mean_raw_obs_processing_ms": 0.08403346454692007, "mean_inference_ms": 1.4492005278765914, "mean_action_processing_ms": 0.04026124345646774}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 704000, "timers": {"sample_time_ms": 9725.61, "sample_throughput": 411.285, "learn_time_ms": 11671.075, "learn_throughput": 342.728, "update_time_ms": 3.05}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 14.027327597141266, "policy_loss": -0.03365533144096844, "vf_loss": 14.055140554904938, "vf_explained_var": 0.49658116698265076, "kl": 0.006839033841970377, "entropy": 0.1527000032365322, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 70, "training_iteration": 176, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-57-40", "timestamp": 1618142260, "time_this_iter_s": 18.92884612083435, "time_total_s": 3608.5812816619873, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e25d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f726668acd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3608.5812816619873, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 57.75555555555555, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1883.0, "episode_reward_min": 1883.0, "episode_reward_mean": 1883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6248363182362594, "mean_raw_obs_processing_ms": 0.08403346454692007, "mean_inference_ms": 1.4492005278765914, "mean_action_processing_ms": 0.04026124345646774}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 708000, "timers": {"sample_time_ms": 9539.613, "sample_throughput": 419.304, "learn_time_ms": 11660.302, "learn_throughput": 343.044, "update_time_ms": 3.029}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.059340327978134, "policy_loss": -0.041901631106156856, "vf_loss": 12.093433231115341, "vf_explained_var": 0.7629817724227905, "kl": 0.009140342255705036, "entropy": 0.22976820124313235, "entropy_coeff": 0.0}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 70, "training_iteration": 177, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-58-00", "timestamp": 1618142280, "time_this_iter_s": 20.399263381958008, "time_total_s": 3628.9805450439453, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ce50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3628.9805450439453, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 57.755172413793105, "ram_util_percent": 27.200000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1770.0, "episode_reward_min": 1770.0, "episode_reward_mean": 1770.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1770.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.624079130480265, "mean_raw_obs_processing_ms": 0.08431359467987017, "mean_inference_ms": 1.4490484495679623, "mean_action_processing_ms": 0.04025617146538182}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 712000, "timers": {"sample_time_ms": 9658.101, "sample_throughput": 414.16, "learn_time_ms": 11678.337, "learn_throughput": 342.515, "update_time_ms": 3.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 5.770004138350487, "policy_loss": -0.02822559021296911, "vf_loss": 5.793370470404625, "vf_explained_var": 0.26271432638168335, "kl": 0.0056879770127125084, "entropy": 0.11076690698973835, "entropy_coeff": 0.0}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 71, "training_iteration": 178, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-58-22", "timestamp": 1618142302, "time_this_iter_s": 21.835898637771606, "time_total_s": 3650.816443681717, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711985d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3650.816443681717, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 57.7516129032258, "ram_util_percent": 27.20000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1770.0, "episode_reward_min": 1770.0, "episode_reward_mean": 1770.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1770.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.624079130480265, "mean_raw_obs_processing_ms": 0.08431359467987017, "mean_inference_ms": 1.4490484495679623, "mean_action_processing_ms": 0.04025617146538182}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 716000, "timers": {"sample_time_ms": 9463.555, "sample_throughput": 422.674, "learn_time_ms": 11672.274, "learn_throughput": 342.692, "update_time_ms": 3.03}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.249761372804642, "policy_loss": -0.027216530608711764, "vf_loss": 10.2717564702034, "vf_explained_var": 0.4460136294364929, "kl": 0.0061119496676838025, "entropy": 0.14646503888070583, "entropy_coeff": 0.0}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 71, "training_iteration": 179, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-58-41", "timestamp": 1618142321, "time_this_iter_s": 18.944541454315186, "time_total_s": 3669.760985136032, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171157690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3669.760985136032, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 58.33333333333334, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1986.0, "episode_reward_min": 1986.0, "episode_reward_mean": 1986.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1986.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6208973956662979, "mean_raw_obs_processing_ms": 0.08450868114660204, "mean_inference_ms": 1.4491843497356722, "mean_action_processing_ms": 0.040255039651568125}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 720000, "timers": {"sample_time_ms": 9209.453, "sample_throughput": 434.336, "learn_time_ms": 11661.149, "learn_throughput": 343.019, "update_time_ms": 3.05}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.473584145307541, "policy_loss": -0.033945993694942445, "vf_loss": 8.502270564436913, "vf_explained_var": 0.42579472064971924, "kl": 0.006156590105092619, "entropy": 0.1361688741017133, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 72, "training_iteration": 180, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-59-01", "timestamp": 1618142341, "time_this_iter_s": 19.910041332244873, "time_total_s": 3689.671026468277, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3689.671026468277, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 58.11034482758621, "ram_util_percent": 27.255172413793098}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1986.0, "episode_reward_min": 1986.0, "episode_reward_mean": 1986.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1986.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6208973956662979, "mean_raw_obs_processing_ms": 0.08450868114660204, "mean_inference_ms": 1.4491843497356722, "mean_action_processing_ms": 0.040255039651568125}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 724000, "timers": {"sample_time_ms": 8916.571, "sample_throughput": 448.603, "learn_time_ms": 11674.646, "learn_throughput": 342.623, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.750534996390343, "policy_loss": -0.033005657081957906, "vf_loss": 9.7759780138731, "vf_explained_var": 0.41947141289711, "kl": 0.0088525206228951, "entropy": 0.1339295047800988, "entropy_coeff": 0.0}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 72, "training_iteration": 181, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-59-22", "timestamp": 1618142362, "time_this_iter_s": 20.802347421646118, "time_total_s": 3710.473373889923, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3710.473373889923, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 57.40689655172413, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1986.0, "episode_reward_min": 1986.0, "episode_reward_mean": 1986.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1986.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6208973956662979, "mean_raw_obs_processing_ms": 0.08450868114660204, "mean_inference_ms": 1.4491843497356722, "mean_action_processing_ms": 0.040255039651568125}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 728000, "timers": {"sample_time_ms": 9068.64, "sample_throughput": 441.08, "learn_time_ms": 11672.851, "learn_throughput": 342.675, "update_time_ms": 3.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 6.756957530975342, "policy_loss": -0.027837952322443016, "vf_loss": 6.780364662408829, "vf_explained_var": 0.20132890343666077, "kl": 0.005186500544368755, "entropy": 0.11054412787780166, "entropy_coeff": 0.0}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 72, "training_iteration": 182, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_11-59-45", "timestamp": 1618142385, "time_this_iter_s": 22.96693181991577, "time_total_s": 3733.440305709839, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171093150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3733.440305709839, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 58.23030303030303, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2115.0, "episode_reward_min": 2115.0, "episode_reward_mean": 2115.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2115.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6224902660099494, "mean_raw_obs_processing_ms": 0.08479521748247047, "mean_inference_ms": 1.4490959269919543, "mean_action_processing_ms": 0.04025148439050308}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 732000, "timers": {"sample_time_ms": 8561.41, "sample_throughput": 467.213, "learn_time_ms": 11688.915, "learn_throughput": 342.205, "update_time_ms": 3.157}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.5200524777174, "policy_loss": -0.03444257963565178, "vf_loss": 9.547301098704338, "vf_explained_var": 0.40797504782676697, "kl": 0.008420666963502299, "entropy": 0.13584447326138616, "entropy_coeff": 0.0}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 73, "training_iteration": 183, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-00-04", "timestamp": 1618142404, "time_this_iter_s": 19.29840922355652, "time_total_s": 3752.7387149333954, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3752.7387149333954, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 57.378571428571426, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2115.0, "episode_reward_min": 2115.0, "episode_reward_mean": 2115.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2115.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6224902660099494, "mean_raw_obs_processing_ms": 0.08479521748247047, "mean_inference_ms": 1.4490959269919543, "mean_action_processing_ms": 0.04025148439050308}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 736000, "timers": {"sample_time_ms": 8499.315, "sample_throughput": 470.626, "learn_time_ms": 11658.502, "learn_throughput": 343.097, "update_time_ms": 3.191}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.308577090501785, "policy_loss": -0.03548732755007222, "vf_loss": 11.338160067796707, "vf_explained_var": 0.4406461715698242, "kl": 0.006911487551406026, "entropy": 0.17071303073316813, "entropy_coeff": 0.0}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 73, "training_iteration": 184, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-00-23", "timestamp": 1618142423, "time_this_iter_s": 18.97088646888733, "time_total_s": 3771.7096014022827, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7172212510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267d10b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3771.7096014022827, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 58.1925925925926, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1702.0, "episode_reward_min": 1702.0, "episode_reward_mean": 1702.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1702.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6197905999292579, "mean_raw_obs_processing_ms": 0.08499247851104588, "mean_inference_ms": 1.4492998735955416, "mean_action_processing_ms": 0.0402541393079959}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 740000, "timers": {"sample_time_ms": 8566.588, "sample_throughput": 466.93, "learn_time_ms": 11663.675, "learn_throughput": 342.945, "update_time_ms": 3.243}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.178092539310455, "policy_loss": -0.04807782545685768, "vf_loss": 13.218155413866043, "vf_explained_var": 0.6535491943359375, "kl": 0.009381711526657455, "entropy": 0.18025639606639743, "entropy_coeff": 0.0}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 74, "training_iteration": 185, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-00-44", "timestamp": 1618142444, "time_this_iter_s": 20.35327982902527, "time_total_s": 3792.062881231308, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fa90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3792.062881231308, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 57.99655172413794, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1702.0, "episode_reward_min": 1702.0, "episode_reward_mean": 1702.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1702.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6197905999292579, "mean_raw_obs_processing_ms": 0.08499247851104588, "mean_inference_ms": 1.4492998735955416, "mean_action_processing_ms": 0.0402541393079959}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 744000, "timers": {"sample_time_ms": 8783.088, "sample_throughput": 455.421, "learn_time_ms": 11664.269, "learn_throughput": 342.928, "update_time_ms": 3.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.84406054019928, "policy_loss": -0.04057383397594094, "vf_loss": 12.8791384100914, "vf_explained_var": 0.5090732574462891, "kl": 0.006433261441998184, "entropy": 0.14438457996584475, "entropy_coeff": 0.0}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 74, "training_iteration": 186, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-01-05", "timestamp": 1618142465, "time_this_iter_s": 21.094943523406982, "time_total_s": 3813.157824754715, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3813.157824754715, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 58.026666666666664, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1702.0, "episode_reward_min": 1702.0, "episode_reward_mean": 1702.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1702.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6197905999292579, "mean_raw_obs_processing_ms": 0.08499247851104588, "mean_inference_ms": 1.4492998735955416, "mean_action_processing_ms": 0.0402541393079959}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 748000, "timers": {"sample_time_ms": 8701.965, "sample_throughput": 459.666, "learn_time_ms": 11675.302, "learn_throughput": 342.604, "update_time_ms": 3.278}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.728564396500587, "policy_loss": -0.03204222075873986, "vf_loss": 10.755072951316833, "vf_explained_var": 0.6548038721084595, "kl": 0.006477625858678948, "entropy": 0.15683458279818296, "entropy_coeff": 0.0}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 74, "training_iteration": 187, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-01-24", "timestamp": 1618142484, "time_this_iter_s": 19.70084309577942, "time_total_s": 3832.8586678504944, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114efd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3832.8586678504944, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 57.19642857142857, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1932.0, "episode_reward_min": 1932.0, "episode_reward_mean": 1932.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1932.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6182932294715702, "mean_raw_obs_processing_ms": 0.08528586121479602, "mean_inference_ms": 1.4493433760243783, "mean_action_processing_ms": 0.04025425687794018}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 752000, "timers": {"sample_time_ms": 8519.587, "sample_throughput": 469.506, "learn_time_ms": 11667.68, "learn_throughput": 342.827, "update_time_ms": 3.265}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.727512329816818, "policy_loss": -0.040277503605466336, "vf_loss": 11.759480208158493, "vf_explained_var": 0.42645812034606934, "kl": 0.009726818221679423, "entropy": 0.14416297269053757, "entropy_coeff": 0.0}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 75, "training_iteration": 188, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-01-44", "timestamp": 1618142504, "time_this_iter_s": 19.93825078010559, "time_total_s": 3852.7969186306, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171100990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3852.7969186306, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 58.2448275862069, "ram_util_percent": 27.203448275862076}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1932.0, "episode_reward_min": 1932.0, "episode_reward_mean": 1932.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1932.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6182932294715702, "mean_raw_obs_processing_ms": 0.08528586121479602, "mean_inference_ms": 1.4493433760243783, "mean_action_processing_ms": 0.04025425687794018}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 756000, "timers": {"sample_time_ms": 8609.794, "sample_throughput": 464.587, "learn_time_ms": 11679.108, "learn_throughput": 342.492, "update_time_ms": 3.267}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.230282872915268, "policy_loss": -0.035309237136971205, "vf_loss": 11.259503245353699, "vf_explained_var": 0.3922908902168274, "kl": 0.007127432167180814, "entropy": 0.13703172863461077, "entropy_coeff": 0.0}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 75, "training_iteration": 189, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-02-04", "timestamp": 1618142524, "time_this_iter_s": 19.96078658103943, "time_total_s": 3872.7577052116394, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3872.7577052116394, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 58.03928571428572, "ram_util_percent": 27.22142857142858}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1877.0, "episode_reward_min": 1877.0, "episode_reward_mean": 1877.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1877.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6152625982390025, "mean_raw_obs_processing_ms": 0.08547155622002635, "mean_inference_ms": 1.4492952328654365, "mean_action_processing_ms": 0.04025244812243733}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 760000, "timers": {"sample_time_ms": 8500.882, "sample_throughput": 470.539, "learn_time_ms": 11692.042, "learn_throughput": 342.113, "update_time_ms": 3.259}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.585957080125809, "policy_loss": -0.044411476876121014, "vf_loss": 10.623737424612045, "vf_explained_var": 0.5797291994094849, "kl": 0.007762213281239383, "entropy": 0.20109342504292727, "entropy_coeff": 0.0}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 76, "training_iteration": 190, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-02-23", "timestamp": 1618142543, "time_this_iter_s": 18.951051473617554, "time_total_s": 3891.708756685257, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3891.708756685257, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 57.68888888888888, "ram_util_percent": 27.200000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1877.0, "episode_reward_min": 1877.0, "episode_reward_mean": 1877.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1877.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6152625982390025, "mean_raw_obs_processing_ms": 0.08547155622002635, "mean_inference_ms": 1.4492952328654365, "mean_action_processing_ms": 0.04025244812243733}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 764000, "timers": {"sample_time_ms": 8389.823, "sample_throughput": 476.768, "learn_time_ms": 11681.565, "learn_throughput": 342.42, "update_time_ms": 3.252}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.477949291467667, "policy_loss": -0.04468274215469137, "vf_loss": 10.517462477087975, "vf_explained_var": 0.3934680223464966, "kl": 0.006051174612366594, "entropy": 0.14430800476111472, "entropy_coeff": 0.0}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 76, "training_iteration": 191, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-02-43", "timestamp": 1618142563, "time_this_iter_s": 19.585110425949097, "time_total_s": 3911.293867111206, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171100410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171093150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3911.293867111206, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 58.075, "ram_util_percent": 27.292857142857137}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1877.0, "episode_reward_min": 1877.0, "episode_reward_mean": 1877.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1877.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6152625982390025, "mean_raw_obs_processing_ms": 0.08547155622002635, "mean_inference_ms": 1.4492952328654365, "mean_action_processing_ms": 0.04025244812243733}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 768000, "timers": {"sample_time_ms": 7997.203, "sample_throughput": 500.175, "learn_time_ms": 11678.471, "learn_throughput": 342.511, "update_time_ms": 3.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.79279550909996, "policy_loss": -0.03313150201574899, "vf_loss": 12.819818913936615, "vf_explained_var": 0.5037347078323364, "kl": 0.007149756769649684, "entropy": 0.17951210867613554, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 76, "training_iteration": 192, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-03-02", "timestamp": 1618142582, "time_this_iter_s": 19.007091283798218, "time_total_s": 3930.3009583950043, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ef10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3930.3009583950043, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 58.42222222222222, "ram_util_percent": 27.25555555555556}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1651.0, "episode_reward_min": 1651.0, "episode_reward_mean": 1651.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1651.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6095746425948113, "mean_raw_obs_processing_ms": 0.08575512409115701, "mean_inference_ms": 1.449444986250455, "mean_action_processing_ms": 0.0402531179634976}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 772000, "timers": {"sample_time_ms": 7958.527, "sample_throughput": 502.606, "learn_time_ms": 11671.64, "learn_throughput": 342.711, "update_time_ms": 3.033}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.096288353204727, "policy_loss": -0.04563609533943236, "vf_loss": 13.133492857217789, "vf_explained_var": 0.5866951942443848, "kl": 0.009869381276075728, "entropy": 0.2772633293643594, "entropy_coeff": 0.0}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 77, "training_iteration": 193, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-03-21", "timestamp": 1618142601, "time_this_iter_s": 18.83756732940674, "time_total_s": 3949.138525724411, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114ea90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3949.138525724411, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 58.02962962962964, "ram_util_percent": 27.28888888888889}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1651.0, "episode_reward_min": 1651.0, "episode_reward_mean": 1651.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1651.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6095746425948113, "mean_raw_obs_processing_ms": 0.08575512409115701, "mean_inference_ms": 1.449444986250455, "mean_action_processing_ms": 0.0402531179634976}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 776000, "timers": {"sample_time_ms": 7950.907, "sample_throughput": 503.087, "learn_time_ms": 11678.032, "learn_throughput": 342.523, "update_time_ms": 2.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.019799202680588, "policy_loss": -0.037916168686933815, "vf_loss": 13.050980597734451, "vf_explained_var": 0.6558279395103455, "kl": 0.007883386992034502, "entropy": 0.27731411857530475, "entropy_coeff": 0.0}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 77, "training_iteration": 194, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-03-40", "timestamp": 1618142620, "time_this_iter_s": 18.959694385528564, "time_total_s": 3968.0982201099396, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3968.0982201099396, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 58.34444444444444, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1175.0, "episode_reward_min": 1175.0, "episode_reward_mean": 1175.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1175.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.60506878576449, "mean_raw_obs_processing_ms": 0.08594563695646897, "mean_inference_ms": 1.4494681103077018, "mean_action_processing_ms": 0.04025158428920202}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 780000, "timers": {"sample_time_ms": 7784.624, "sample_throughput": 513.833, "learn_time_ms": 11670.296, "learn_throughput": 342.751, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.848829627037048, "policy_loss": -0.038597711303737015, "vf_loss": 12.879934698343277, "vf_explained_var": 0.7233129739761353, "kl": 0.00877046432287898, "entropy": 0.22087649255990982, "entropy_coeff": 0.0}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 78, "training_iteration": 195, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-03-58", "timestamp": 1618142638, "time_this_iter_s": 18.609530925750732, "time_total_s": 3986.7077510356903, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171100a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171100d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3986.7077510356903, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 57.34814814814814, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1175.0, "episode_reward_min": 1175.0, "episode_reward_mean": 1175.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1175.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.60506878576449, "mean_raw_obs_processing_ms": 0.08594563695646897, "mean_inference_ms": 1.4494681103077018, "mean_action_processing_ms": 0.04025158428920202}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 784000, "timers": {"sample_time_ms": 7588.826, "sample_throughput": 527.091, "learn_time_ms": 11662.655, "learn_throughput": 342.975, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 14.488594561815262, "policy_loss": -0.041741104156244546, "vf_loss": 14.52327412366867, "vf_explained_var": 0.5177883505821228, "kl": 0.00826605170732364, "entropy": 0.1999185518361628, "entropy_coeff": 0.0}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 78, "training_iteration": 196, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-04-18", "timestamp": 1618142658, "time_this_iter_s": 19.06055760383606, "time_total_s": 4005.7683086395264, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ec90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171100a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4005.7683086395264, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 58.362962962962975, "ram_util_percent": 27.288888888888888}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1175.0, "episode_reward_min": 1175.0, "episode_reward_mean": 1175.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1175.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.60506878576449, "mean_raw_obs_processing_ms": 0.08594563695646897, "mean_inference_ms": 1.4494681103077018, "mean_action_processing_ms": 0.04025158428920202}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 788000, "timers": {"sample_time_ms": 7635.664, "sample_throughput": 523.858, "learn_time_ms": 11661.609, "learn_throughput": 343.006, "update_time_ms": 2.919}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.431253433227539, "policy_loss": -0.030179454770404845, "vf_loss": 13.45635810494423, "vf_explained_var": 0.4604130983352661, "kl": 0.005940419599937741, "entropy": 0.1303775121923536, "entropy_coeff": 0.0}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 78, "training_iteration": 197, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-04-38", "timestamp": 1618142678, "time_this_iter_s": 20.165339708328247, "time_total_s": 4025.9336483478546, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4025.9336483478546, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 57.22068965517241, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1719.0, "episode_reward_min": 1719.0, "episode_reward_mean": 1719.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1719.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6018631186157507, "mean_raw_obs_processing_ms": 0.08622729999142786, "mean_inference_ms": 1.4493226716314063, "mean_action_processing_ms": 0.040248564754256054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 792000, "timers": {"sample_time_ms": 7611.505, "sample_throughput": 525.52, "learn_time_ms": 11649.948, "learn_throughput": 343.349, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.730980455875397, "policy_loss": -0.028144390147645026, "vf_loss": 12.75367784500122, "vf_explained_var": 0.4762038290500641, "kl": 0.0063758906617295, "entropy": 0.13159361411817372, "entropy_coeff": 0.0}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 79, "training_iteration": 198, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-04-57", "timestamp": 1618142697, "time_this_iter_s": 19.58072280883789, "time_total_s": 4045.5143711566925, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4045.5143711566925, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 58.03928571428571, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1719.0, "episode_reward_min": 1719.0, "episode_reward_mean": 1719.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1719.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6018631186157507, "mean_raw_obs_processing_ms": 0.08622729999142786, "mean_inference_ms": 1.4493226716314063, "mean_action_processing_ms": 0.040248564754256054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 796000, "timers": {"sample_time_ms": 7719.445, "sample_throughput": 518.172, "learn_time_ms": 11640.397, "learn_throughput": 343.631, "update_time_ms": 3.016}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.522361561655998, "policy_loss": -0.02839277300518006, "vf_loss": 9.545692220330238, "vf_explained_var": 0.4414571523666382, "kl": 0.005925485347688664, "entropy": 0.12680727220140398, "entropy_coeff": 0.0}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 79, "training_iteration": 199, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-05-18", "timestamp": 1618142718, "time_this_iter_s": 20.945610523223877, "time_total_s": 4066.4599816799164, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267861150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4066.4599816799164, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 57.87666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1800.0, "episode_reward_min": 1800.0, "episode_reward_mean": 1800.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1800.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.600241555990112, "mean_raw_obs_processing_ms": 0.08641958729326109, "mean_inference_ms": 1.4493813949387722, "mean_action_processing_ms": 0.04025304858877578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 800000, "timers": {"sample_time_ms": 7709.956, "sample_throughput": 518.81, "learn_time_ms": 11644.85, "learn_throughput": 343.5, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.046695202589035, "policy_loss": -0.04014010276296176, "vf_loss": 13.080192804336548, "vf_explained_var": 0.4348289370536804, "kl": 0.007775990859954618, "entropy": 0.21259929006919265, "entropy_coeff": 0.0}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 80, "training_iteration": 200, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-05-37", "timestamp": 1618142737, "time_this_iter_s": 18.898342609405518, "time_total_s": 4085.358324289322, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4085.358324289322, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 58.629629629629626, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1800.0, "episode_reward_min": 1800.0, "episode_reward_mean": 1800.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1800.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.600241555990112, "mean_raw_obs_processing_ms": 0.08641958729326109, "mean_inference_ms": 1.4493813949387722, "mean_action_processing_ms": 0.04025304858877578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 804000, "timers": {"sample_time_ms": 7615.12, "sample_throughput": 525.271, "learn_time_ms": 11647.896, "learn_throughput": 343.41, "update_time_ms": 2.998}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.067116409540176, "policy_loss": -0.041197084938175976, "vf_loss": 13.101092636585236, "vf_explained_var": 0.6171886324882507, "kl": 0.008452632406260818, "entropy": 0.23699889332056046, "entropy_coeff": 0.0}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 80, "training_iteration": 201, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-05-56", "timestamp": 1618142756, "time_this_iter_s": 18.669668674468994, "time_total_s": 4104.027992963791, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4104.027992963791, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 57.48888888888888, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1800.0, "episode_reward_min": 1800.0, "episode_reward_mean": 1800.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1800.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.600241555990112, "mean_raw_obs_processing_ms": 0.08641958729326109, "mean_inference_ms": 1.4493813949387722, "mean_action_processing_ms": 0.04025304858877578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 808000, "timers": {"sample_time_ms": 7592.622, "sample_throughput": 526.827, "learn_time_ms": 11657.146, "learn_throughput": 343.137, "update_time_ms": 3.034}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.017435997724533, "policy_loss": -0.039885496720671654, "vf_loss": 13.050892531871796, "vf_explained_var": 0.7367491722106934, "kl": 0.00752522014954593, "entropy": 0.22913157101720572, "entropy_coeff": 0.0}}, "num_steps_sampled": 808000, "num_steps_trained": 808000}, "done": false, "episodes_total": 80, "training_iteration": 202, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-06-15", "timestamp": 1618142775, "time_this_iter_s": 18.875309705734253, "time_total_s": 4122.903302669525, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171103390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171103e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4122.903302669525, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 58.588888888888896, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1313.0, "episode_reward_min": 1313.0, "episode_reward_mean": 1313.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1313.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5939230081795328, "mean_raw_obs_processing_ms": 0.08668875676687149, "mean_inference_ms": 1.4492726024471851, "mean_action_processing_ms": 0.040252739622021305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 812000, "timers": {"sample_time_ms": 7598.421, "sample_throughput": 526.425, "learn_time_ms": 11651.678, "learn_throughput": 343.298, "update_time_ms": 3.071}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.550994098186493, "policy_loss": -0.04302953608566895, "vf_loss": 11.587796092033386, "vf_explained_var": 0.3675330877304077, "kl": 0.007289585977559909, "entropy": 0.14315944933332503, "entropy_coeff": 0.0}}, "num_steps_sampled": 812000, "num_steps_trained": 812000}, "done": false, "episodes_total": 81, "training_iteration": 203, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-06-34", "timestamp": 1618142794, "time_this_iter_s": 18.84247922897339, "time_total_s": 4141.7457818984985, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118dcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171109ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4141.7457818984985, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 57.614814814814814, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1313.0, "episode_reward_min": 1313.0, "episode_reward_mean": 1313.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1313.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5939230081795328, "mean_raw_obs_processing_ms": 0.08668875676687149, "mean_inference_ms": 1.4492726024471851, "mean_action_processing_ms": 0.040252739622021305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 816000, "timers": {"sample_time_ms": 7593.304, "sample_throughput": 526.78, "learn_time_ms": 11653.017, "learn_throughput": 343.259, "update_time_ms": 3.039}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.711327284574509, "policy_loss": -0.03258573214407079, "vf_loss": 10.737463742494583, "vf_explained_var": 0.5502585172653198, "kl": 0.007549020716396626, "entropy": 0.17415907024405897, "entropy_coeff": 0.0}}, "num_steps_sampled": 816000, "num_steps_trained": 816000}, "done": false, "episodes_total": 81, "training_iteration": 204, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-06-53", "timestamp": 1618142813, "time_this_iter_s": 18.919224739074707, "time_total_s": 4160.665006637573, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171103790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4160.665006637573, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 58.37777777777777, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1408.0, "episode_reward_min": 1408.0, "episode_reward_mean": 1408.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1408.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5898006480486749, "mean_raw_obs_processing_ms": 0.08687472972084069, "mean_inference_ms": 1.449562593522251, "mean_action_processing_ms": 0.040250275535731295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 820000, "timers": {"sample_time_ms": 7621.863, "sample_throughput": 524.806, "learn_time_ms": 11661.035, "learn_throughput": 343.023, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.385708540678024, "policy_loss": -0.047648646228481084, "vf_loss": 12.425417006015778, "vf_explained_var": 0.6567219495773315, "kl": 0.009294253613916226, "entropy": 0.2740041958168149, "entropy_coeff": 0.0}}, "num_steps_sampled": 820000, "num_steps_trained": 820000}, "done": false, "episodes_total": 82, "training_iteration": 205, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-07-12", "timestamp": 1618142832, "time_this_iter_s": 18.975444078445435, "time_total_s": 4179.640450716019, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110bb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4179.640450716019, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 58.34814814814815, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1408.0, "episode_reward_min": 1408.0, "episode_reward_mean": 1408.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1408.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5898006480486749, "mean_raw_obs_processing_ms": 0.08687472972084069, "mean_inference_ms": 1.449562593522251, "mean_action_processing_ms": 0.040250275535731295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 824000, "timers": {"sample_time_ms": 7635.983, "sample_throughput": 523.836, "learn_time_ms": 11666.275, "learn_throughput": 342.869, "update_time_ms": 3.076}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.461922347545624, "policy_loss": -0.043479646294144914, "vf_loss": 12.498853772878647, "vf_explained_var": 0.6301511526107788, "kl": 0.007665118318982422, "entropy": 0.3260592631995678, "entropy_coeff": 0.0}}, "num_steps_sampled": 824000, "num_steps_trained": 824000}, "done": false, "episodes_total": 82, "training_iteration": 206, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-07-31", "timestamp": 1618142851, "time_this_iter_s": 19.254400968551636, "time_total_s": 4198.89485168457, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4198.89485168457, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 58.46296296296297, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1408.0, "episode_reward_min": 1408.0, "episode_reward_mean": 1408.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1408.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5898006480486749, "mean_raw_obs_processing_ms": 0.08687472972084069, "mean_inference_ms": 1.449562593522251, "mean_action_processing_ms": 0.040250275535731295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 828000, "timers": {"sample_time_ms": 7565.303, "sample_throughput": 528.73, "learn_time_ms": 11668.64, "learn_throughput": 342.799, "update_time_ms": 2.985}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 16.82521989941597, "policy_loss": -0.03430437497445382, "vf_loss": 16.853731781244278, "vf_explained_var": 0.5231162309646606, "kl": 0.006780752861232031, "entropy": 0.1699624841567129, "entropy_coeff": 0.0}}, "num_steps_sampled": 828000, "num_steps_trained": 828000}, "done": false, "episodes_total": 82, "training_iteration": 207, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-07-51", "timestamp": 1618142871, "time_this_iter_s": 19.473374366760254, "time_total_s": 4218.368226051331, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4218.368226051331, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 57.435714285714276, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1397.0, "episode_reward_min": 1397.0, "episode_reward_mean": 1397.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1397.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5861683618081578, "mean_raw_obs_processing_ms": 0.08718512502974081, "mean_inference_ms": 1.4499765091096346, "mean_action_processing_ms": 0.040267837192132325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 832000, "timers": {"sample_time_ms": 7607.375, "sample_throughput": 525.806, "learn_time_ms": 11681.883, "learn_throughput": 342.411, "update_time_ms": 3.063}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.400820165872574, "policy_loss": -0.02961975274956785, "vf_loss": 9.423340499401093, "vf_explained_var": 0.21488609910011292, "kl": 0.008310445424285717, "entropy": 0.10915447142906487, "entropy_coeff": 0.0}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 83, "training_iteration": 208, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-08-11", "timestamp": 1618142891, "time_this_iter_s": 20.13665509223938, "time_total_s": 4238.50488114357, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117bad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4238.50488114357, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 58.099999999999994, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1397.0, "episode_reward_min": 1397.0, "episode_reward_mean": 1397.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1397.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5861683618081578, "mean_raw_obs_processing_ms": 0.08718512502974081, "mean_inference_ms": 1.4499765091096346, "mean_action_processing_ms": 0.040267837192132325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 836000, "timers": {"sample_time_ms": 7490.896, "sample_throughput": 533.982, "learn_time_ms": 11694.502, "learn_throughput": 342.041, "update_time_ms": 3.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.390094608068466, "policy_loss": -0.04086067187017761, "vf_loss": 11.423399746418, "vf_explained_var": 0.5894862413406372, "kl": 0.008844244861393236, "entropy": 0.18821862200275064, "entropy_coeff": 0.0}}, "num_steps_sampled": 836000, "num_steps_trained": 836000}, "done": false, "episodes_total": 83, "training_iteration": 209, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-08-31", "timestamp": 1618142911, "time_this_iter_s": 19.907003164291382, "time_total_s": 4258.411884307861, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4258.411884307861, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 58.25357142857143, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1754.0, "episode_reward_min": 1754.0, "episode_reward_mean": 1754.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1754.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5843402783357623, "mean_raw_obs_processing_ms": 0.0873738835332992, "mean_inference_ms": 1.449995147977429, "mean_action_processing_ms": 0.040267237341677954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 840000, "timers": {"sample_time_ms": 7569.338, "sample_throughput": 528.448, "learn_time_ms": 11687.436, "learn_throughput": 342.248, "update_time_ms": 3.268}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 14.74333769083023, "policy_loss": -0.047979221591958776, "vf_loss": 14.775684505701065, "vf_explained_var": 0.48550865054130554, "kl": 0.01829872009693645, "entropy": 0.1752804289571941, "entropy_coeff": 0.0}}, "num_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 84, "training_iteration": 210, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-08-50", "timestamp": 1618142930, "time_this_iter_s": 19.617398500442505, "time_total_s": 4278.029282808304, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114ef50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4278.029282808304, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 57.653571428571425, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1754.0, "episode_reward_min": 1754.0, "episode_reward_mean": 1754.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1754.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5843402783357623, "mean_raw_obs_processing_ms": 0.0873738835332992, "mean_inference_ms": 1.449995147977429, "mean_action_processing_ms": 0.040267237341677954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 844000, "timers": {"sample_time_ms": 7996.152, "sample_throughput": 500.241, "learn_time_ms": 11694.629, "learn_throughput": 342.037, "update_time_ms": 3.281}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.427179396152496, "policy_loss": -0.024749049451202154, "vf_loss": 8.447449758648872, "vf_explained_var": 0.374790221452713, "kl": 0.005242445389740169, "entropy": 0.10017211665399373, "entropy_coeff": 0.0}}, "num_steps_sampled": 844000, "num_steps_trained": 844000}, "done": false, "episodes_total": 84, "training_iteration": 211, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-09-13", "timestamp": 1618142953, "time_this_iter_s": 23.00622057914734, "time_total_s": 4301.035503387451, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711030d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171103190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4301.035503387451, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 58.2939393939394, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1754.0, "episode_reward_min": 1754.0, "episode_reward_mean": 1754.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1754.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5843402783357623, "mean_raw_obs_processing_ms": 0.0873738835332992, "mean_inference_ms": 1.449995147977429, "mean_action_processing_ms": 0.040267237341677954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 848000, "timers": {"sample_time_ms": 8093.161, "sample_throughput": 494.244, "learn_time_ms": 11691.704, "learn_throughput": 342.123, "update_time_ms": 3.255}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.630876928567886, "policy_loss": -0.02577812725212425, "vf_loss": 7.651593133807182, "vf_explained_var": 0.27374929189682007, "kl": 0.00592546645202674, "entropy": 0.11976890149526298, "entropy_coeff": 0.0}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 84, "training_iteration": 212, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-09-33", "timestamp": 1618142973, "time_this_iter_s": 19.8147714138031, "time_total_s": 4320.850274801254, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171103290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4320.850274801254, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 57.385714285714286, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2123.0, "episode_reward_min": 2123.0, "episode_reward_mean": 2123.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2123.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5868526844243596, "mean_raw_obs_processing_ms": 0.0876625690428125, "mean_inference_ms": 1.4500000872127423, "mean_action_processing_ms": 0.0402700778170515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 852000, "timers": {"sample_time_ms": 8291.97, "sample_throughput": 482.394, "learn_time_ms": 11688.724, "learn_throughput": 342.21, "update_time_ms": 3.224}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.365064173936844, "policy_loss": -0.03171754669165239, "vf_loss": 9.390558153390884, "vf_explained_var": 0.4905356168746948, "kl": 0.007284945866558701, "entropy": 0.13818270433694124, "entropy_coeff": 0.0}}, "num_steps_sampled": 852000, "num_steps_trained": 852000}, "done": false, "episodes_total": 85, "training_iteration": 213, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-09-54", "timestamp": 1618142994, "time_this_iter_s": 20.799595832824707, "time_total_s": 4341.649870634079, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171157e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171157c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4341.649870634079, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 57.983333333333334, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2123.0, "episode_reward_min": 2123.0, "episode_reward_mean": 2123.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2123.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5868526844243596, "mean_raw_obs_processing_ms": 0.0876625690428125, "mean_inference_ms": 1.4500000872127423, "mean_action_processing_ms": 0.0402700778170515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 856000, "timers": {"sample_time_ms": 8570.891, "sample_throughput": 466.696, "learn_time_ms": 11678.046, "learn_throughput": 342.523, "update_time_ms": 3.252}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.350848883390427, "policy_loss": -0.029357957071624696, "vf_loss": 11.374921828508377, "vf_explained_var": 0.39631205797195435, "kl": 0.006186457394505851, "entropy": 0.11565251764841378, "entropy_coeff": 0.0}}, "num_steps_sampled": 856000, "num_steps_trained": 856000}, "done": false, "episodes_total": 85, "training_iteration": 214, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-10-16", "timestamp": 1618143016, "time_this_iter_s": 21.6024432182312, "time_total_s": 4363.25231385231, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4363.25231385231, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 58.012903225806454, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5875933224253814, "mean_raw_obs_processing_ms": 0.08787458037977885, "mean_inference_ms": 1.4502318796131852, "mean_action_processing_ms": 0.040275934150188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 860000, "timers": {"sample_time_ms": 8690.095, "sample_throughput": 460.294, "learn_time_ms": 11687.411, "learn_throughput": 342.249, "update_time_ms": 3.275}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.710555419325829, "policy_loss": -0.041492849646601826, "vf_loss": 8.745723724365234, "vf_explained_var": 0.38638991117477417, "kl": 0.007403216703096405, "entropy": 0.14471628656610847, "entropy_coeff": 0.0}}, "num_steps_sampled": 860000, "num_steps_trained": 860000}, "done": false, "episodes_total": 86, "training_iteration": 215, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-10-36", "timestamp": 1618143036, "time_this_iter_s": 20.263813495635986, "time_total_s": 4383.516127347946, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ef50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4383.516127347946, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 58.42758620689656, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5875933224253814, "mean_raw_obs_processing_ms": 0.08787458037977885, "mean_inference_ms": 1.4502318796131852, "mean_action_processing_ms": 0.040275934150188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 864000, "timers": {"sample_time_ms": 8653.71, "sample_throughput": 462.23, "learn_time_ms": 11683.183, "learn_throughput": 342.372, "update_time_ms": 3.247}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.992443650960922, "policy_loss": -0.04906843294156715, "vf_loss": 14.032765984535217, "vf_explained_var": 0.6206645965576172, "kl": 0.010237625945592299, "entropy": 0.22835153620690107, "entropy_coeff": 0.0}}, "num_steps_sampled": 864000, "num_steps_trained": 864000}, "done": false, "episodes_total": 86, "training_iteration": 216, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-10-55", "timestamp": 1618143055, "time_this_iter_s": 18.848644971847534, "time_total_s": 4402.364772319794, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110b710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4402.364772319794, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 58.42962962962962, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5875933224253814, "mean_raw_obs_processing_ms": 0.08787458037977885, "mean_inference_ms": 1.4502318796131852, "mean_action_processing_ms": 0.040275934150188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 868000, "timers": {"sample_time_ms": 8577.87, "sample_throughput": 466.316, "learn_time_ms": 11676.716, "learn_throughput": 342.562, "update_time_ms": 3.242}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.445827156305313, "policy_loss": -0.0430831853300333, "vf_loss": 11.48132660984993, "vf_explained_var": 0.5803773403167725, "kl": 0.00887708920345176, "entropy": 0.3660756554454565, "entropy_coeff": 0.0}}, "num_steps_sampled": 868000, "num_steps_trained": 868000}, "done": false, "episodes_total": 86, "training_iteration": 217, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-11-13", "timestamp": 1618143073, "time_this_iter_s": 18.648216247558594, "time_total_s": 4421.012988567352, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4421.012988567352, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 58.06923076923077, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1283.0, "episode_reward_min": 1283.0, "episode_reward_mean": 1283.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1283.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5859833253654303, "mean_raw_obs_processing_ms": 0.08814449165261286, "mean_inference_ms": 1.4500997175429267, "mean_action_processing_ms": 0.04027057790235478}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 872000, "timers": {"sample_time_ms": 8801.153, "sample_throughput": 454.486, "learn_time_ms": 11673.916, "learn_throughput": 342.644, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.549312263727188, "policy_loss": -0.01818868488771841, "vf_loss": 9.56238578259945, "vf_explained_var": 0.23818762600421906, "kl": 0.005987913616991136, "entropy": 0.11172447679564357, "entropy_coeff": 0.0}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 87, "training_iteration": 218, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-11-36", "timestamp": 1618143096, "time_this_iter_s": 22.33597493171692, "time_total_s": 4443.348963499069, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ea10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4443.348963499069, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1283.0, "episode_reward_min": 1283.0, "episode_reward_mean": 1283.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1283.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5859833253654303, "mean_raw_obs_processing_ms": 0.08814449165261286, "mean_inference_ms": 1.4500997175429267, "mean_action_processing_ms": 0.04027057790235478}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 876000, "timers": {"sample_time_ms": 9107.003, "sample_throughput": 439.222, "learn_time_ms": 11680.262, "learn_throughput": 342.458, "update_time_ms": 3.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.197457358241081, "policy_loss": -0.027316908701322973, "vf_loss": 8.219391971826553, "vf_explained_var": 0.41977864503860474, "kl": 0.006300266948528588, "entropy": 0.12202043971046805, "entropy_coeff": 0.0}}, "num_steps_sampled": 876000, "num_steps_trained": 876000}, "done": false, "episodes_total": 87, "training_iteration": 219, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-11-59", "timestamp": 1618143119, "time_this_iter_s": 23.02577829360962, "time_total_s": 4466.374741792679, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221ff10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4466.374741792679, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 58.52424242424242, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2130.0, "episode_reward_min": 2130.0, "episode_reward_mean": 2130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5878733031534751, "mean_raw_obs_processing_ms": 0.08835234897336887, "mean_inference_ms": 1.4504084729459992, "mean_action_processing_ms": 0.04028106035129251}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 880000, "timers": {"sample_time_ms": 9150.879, "sample_throughput": 437.116, "learn_time_ms": 11675.647, "learn_throughput": 342.593, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.964859455823898, "policy_loss": -0.03191609517671168, "vf_loss": 8.991368010640144, "vf_explained_var": 0.3918016850948334, "kl": 0.006329924966848921, "entropy": 0.13347918028011918, "entropy_coeff": 0.0}}, "num_steps_sampled": 880000, "num_steps_trained": 880000}, "done": false, "episodes_total": 88, "training_iteration": 220, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-12-19", "timestamp": 1618143139, "time_this_iter_s": 20.008534908294678, "time_total_s": 4486.3832767009735, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110bfd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110b710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4486.3832767009735, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 57.54827586206896, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2130.0, "episode_reward_min": 2130.0, "episode_reward_mean": 2130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5878733031534751, "mean_raw_obs_processing_ms": 0.08835234897336887, "mean_inference_ms": 1.4504084729459992, "mean_action_processing_ms": 0.04028106035129251}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 884000, "timers": {"sample_time_ms": 8941.037, "sample_throughput": 447.375, "learn_time_ms": 11665.439, "learn_throughput": 342.893, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.554812997579575, "policy_loss": -0.04848424007650465, "vf_loss": 12.591901689767838, "vf_explained_var": 0.6796637177467346, "kl": 0.01333908257947769, "entropy": 0.23051312332972884, "entropy_coeff": 0.0}}, "num_steps_sampled": 884000, "num_steps_trained": 884000}, "done": false, "episodes_total": 88, "training_iteration": 221, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-12-40", "timestamp": 1618143160, "time_this_iter_s": 20.807872533798218, "time_total_s": 4507.191149234772, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171157a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110bb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4507.191149234772, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 58.27666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2130.0, "episode_reward_min": 2130.0, "episode_reward_mean": 2130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5878733031534751, "mean_raw_obs_processing_ms": 0.08835234897336887, "mean_inference_ms": 1.4504084729459992, "mean_action_processing_ms": 0.04028106035129251}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 888000, "timers": {"sample_time_ms": 9147.554, "sample_throughput": 437.275, "learn_time_ms": 11656.874, "learn_throughput": 343.145, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 6.050333932042122, "policy_loss": -0.02688699122518301, "vf_loss": 6.071706563234329, "vf_explained_var": 0.33366644382476807, "kl": 0.006454898328229319, "entropy": 0.12939609098248184, "entropy_coeff": 0.0}}, "num_steps_sampled": 888000, "num_steps_trained": 888000}, "done": false, "episodes_total": 88, "training_iteration": 222, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-13-02", "timestamp": 1618143182, "time_this_iter_s": 21.79525375366211, "time_total_s": 4528.986402988434, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4528.986402988434, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 58.354838709677416, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1900.0, "episode_reward_min": 1900.0, "episode_reward_mean": 1900.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1900.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5919306693223629, "mean_raw_obs_processing_ms": 0.0886626195806078, "mean_inference_ms": 1.4506540601873272, "mean_action_processing_ms": 0.04029434838991352}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 892000, "timers": {"sample_time_ms": 9330.702, "sample_throughput": 428.692, "learn_time_ms": 11667.218, "learn_throughput": 342.841, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.163764595985413, "policy_loss": -0.02139897836605087, "vf_loss": 7.179944157600403, "vf_explained_var": 0.4006141424179077, "kl": 0.0061095314886188135, "entropy": 0.12007878301665187, "entropy_coeff": 0.0}}, "num_steps_sampled": 892000, "num_steps_trained": 892000}, "done": false, "episodes_total": 89, "training_iteration": 223, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-13-24", "timestamp": 1618143204, "time_this_iter_s": 22.73491930961609, "time_total_s": 4551.72132229805, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4551.72132229805, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 58.6375, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1900.0, "episode_reward_min": 1900.0, "episode_reward_mean": 1900.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1900.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5919306693223629, "mean_raw_obs_processing_ms": 0.0886626195806078, "mean_inference_ms": 1.4506540601873272, "mean_action_processing_ms": 0.04029434838991352}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 896000, "timers": {"sample_time_ms": 9293.93, "sample_throughput": 430.388, "learn_time_ms": 11679.777, "learn_throughput": 342.472, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.40730431675911, "policy_loss": -0.029255570378154516, "vf_loss": 10.430090576410294, "vf_explained_var": 0.3599228858947754, "kl": 0.007572750153485686, "entropy": 0.14305362105369568, "entropy_coeff": 0.0}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 89, "training_iteration": 224, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-13-46", "timestamp": 1618143226, "time_this_iter_s": 21.359566926956177, "time_total_s": 4573.080889225006, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711098d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4573.080889225006, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 58.47419354838709, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5940866966299989, "mean_raw_obs_processing_ms": 0.0888583986761472, "mean_inference_ms": 1.4506864270581448, "mean_action_processing_ms": 0.04029514180022493}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 900000, "timers": {"sample_time_ms": 9448.155, "sample_throughput": 423.363, "learn_time_ms": 11683.571, "learn_throughput": 342.361, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.101534396409988, "policy_loss": -0.024984980234876275, "vf_loss": 11.12111121416092, "vf_explained_var": 0.4449922740459442, "kl": 0.006330708558380138, "entropy": 0.14847795572131872, "entropy_coeff": 0.0}}, "num_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 90, "training_iteration": 225, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-14-08", "timestamp": 1618143248, "time_this_iter_s": 21.841429710388184, "time_total_s": 4594.922318935394, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171109110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4594.922318935394, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 57.803225806451614, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5940866966299989, "mean_raw_obs_processing_ms": 0.0888583986761472, "mean_inference_ms": 1.4506864270581448, "mean_action_processing_ms": 0.04029514180022493}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 904000, "timers": {"sample_time_ms": 9687.271, "sample_throughput": 412.913, "learn_time_ms": 11698.948, "learn_throughput": 341.911, "update_time_ms": 2.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.656672656536102, "policy_loss": -0.02734083274845034, "vf_loss": 9.675172299146652, "vf_explained_var": 0.29493772983551025, "kl": 0.010349016447435133, "entropy": 0.14238297450356185, "entropy_coeff": 0.0}}, "num_steps_sampled": 904000, "num_steps_trained": 904000}, "done": false, "episodes_total": 90, "training_iteration": 226, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-14-29", "timestamp": 1618143269, "time_this_iter_s": 21.392792463302612, "time_total_s": 4616.315111398697, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110bb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4616.315111398697, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 57.976666666666674, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5940866966299989, "mean_raw_obs_processing_ms": 0.0888583986761472, "mean_inference_ms": 1.4506864270581448, "mean_action_processing_ms": 0.04029514180022493}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 908000, "timers": {"sample_time_ms": 9762.754, "sample_throughput": 409.72, "learn_time_ms": 11704.479, "learn_throughput": 341.749, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.402826607227325, "policy_loss": -0.07066966919228435, "vf_loss": 13.441588193178177, "vf_explained_var": 0.534956693649292, "kl": 0.0373501458670944, "entropy": 0.2037628055550158, "entropy_coeff": 0.0}}, "num_steps_sampled": 908000, "num_steps_trained": 908000}, "done": false, "episodes_total": 90, "training_iteration": 227, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-14-49", "timestamp": 1618143289, "time_this_iter_s": 19.46038055419922, "time_total_s": 4635.775491952896, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ea90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4635.775491952896, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 58.08214285714285, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1934.0, "episode_reward_min": 1934.0, "episode_reward_mean": 1934.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1934.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5972898907788547, "mean_raw_obs_processing_ms": 0.08916328560419108, "mean_inference_ms": 1.4508710180996505, "mean_action_processing_ms": 0.040299070501915044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 912000, "timers": {"sample_time_ms": 9923.65, "sample_throughput": 403.077, "learn_time_ms": 11707.402, "learn_throughput": 341.664, "update_time_ms": 2.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2814453125, "cur_lr": 5e-05, "total_loss": 6.433073177933693, "policy_loss": -0.03913730417843908, "vf_loss": 6.458838164806366, "vf_explained_var": 0.348423033952713, "kl": 0.010435326039441861, "entropy": 0.11548924841918051, "entropy_coeff": 0.0}}, "num_steps_sampled": 912000, "num_steps_trained": 912000}, "done": false, "episodes_total": 91, "training_iteration": 228, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-15-13", "timestamp": 1618143313, "time_this_iter_s": 23.975494623184204, "time_total_s": 4659.75098657608, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711190d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4659.75098657608, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 58.51176470588236, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1934.0, "episode_reward_min": 1934.0, "episode_reward_mean": 1934.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1934.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5972898907788547, "mean_raw_obs_processing_ms": 0.08916328560419108, "mean_inference_ms": 1.4508710180996505, "mean_action_processing_ms": 0.040299070501915044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 916000, "timers": {"sample_time_ms": 9768.867, "sample_throughput": 409.464, "learn_time_ms": 11697.766, "learn_throughput": 341.946, "update_time_ms": 2.951}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2814453125, "cur_lr": 5e-05, "total_loss": 8.105408847332, "policy_loss": -0.02809595747385174, "vf_loss": 8.126560360193253, "vf_explained_var": 0.32137584686279297, "kl": 0.005419288223492913, "entropy": 0.13235620642080903, "entropy_coeff": 0.0}}, "num_steps_sampled": 916000, "num_steps_trained": 916000}, "done": false, "episodes_total": 91, "training_iteration": 229, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-15-34", "timestamp": 1618143334, "time_this_iter_s": 21.385526657104492, "time_total_s": 4681.136513233185, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114fd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4681.136513233185, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 57.803225806451614, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2144.0, "episode_reward_min": 2144.0, "episode_reward_mean": 2144.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2144.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5989208913221851, "mean_raw_obs_processing_ms": 0.08933967177822727, "mean_inference_ms": 1.4507798474737568, "mean_action_processing_ms": 0.040294726773880435}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 920000, "timers": {"sample_time_ms": 9879.235, "sample_throughput": 404.89, "learn_time_ms": 11704.567, "learn_throughput": 341.747, "update_time_ms": 2.998}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2814453125, "cur_lr": 5e-05, "total_loss": 9.012769773602486, "policy_loss": -0.03224785832571797, "vf_loss": 9.038022965192795, "vf_explained_var": 0.3787548542022705, "kl": 0.005458458210341632, "entropy": 0.12965940916910768, "entropy_coeff": 0.0}}, "num_steps_sampled": 920000, "num_steps_trained": 920000}, "done": false, "episodes_total": 92, "training_iteration": 230, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-15-55", "timestamp": 1618143355, "time_this_iter_s": 21.176619052886963, "time_total_s": 4702.313132286072, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4702.313132286072, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 58.15666666666666, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2144.0, "episode_reward_min": 2144.0, "episode_reward_mean": 2144.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2144.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5989208913221851, "mean_raw_obs_processing_ms": 0.08933967177822727, "mean_inference_ms": 1.4507798474737568, "mean_action_processing_ms": 0.040294726773880435}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 924000, "timers": {"sample_time_ms": 9996.481, "sample_throughput": 400.141, "learn_time_ms": 11715.472, "learn_throughput": 341.429, "update_time_ms": 2.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2814453125, "cur_lr": 5e-05, "total_loss": 8.228656515479088, "policy_loss": -0.021942220744676888, "vf_loss": 8.244068831205368, "vf_explained_var": 0.2981458306312561, "kl": 0.005095698234072188, "entropy": 0.1208477255422622, "entropy_coeff": 0.0}}, "num_steps_sampled": 924000, "num_steps_trained": 924000}, "done": false, "episodes_total": 92, "training_iteration": 231, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-16-17", "timestamp": 1618143377, "time_this_iter_s": 22.087589979171753, "time_total_s": 4724.4007222652435, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117bd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4724.4007222652435, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 57.878125, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2144.0, "episode_reward_min": 2144.0, "episode_reward_mean": 2144.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2144.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5989208913221851, "mean_raw_obs_processing_ms": 0.08933967177822727, "mean_inference_ms": 1.4507798474737568, "mean_action_processing_ms": 0.040294726773880435}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 928000, "timers": {"sample_time_ms": 9818.12, "sample_throughput": 407.41, "learn_time_ms": 11723.864, "learn_throughput": 341.184, "update_time_ms": 3.056}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2814453125, "cur_lr": 5e-05, "total_loss": 10.10959641635418, "policy_loss": -0.054363384493626654, "vf_loss": 10.14332140982151, "vf_explained_var": 0.5080747604370117, "kl": 0.01610552724741865, "entropy": 0.17589817196130753, "entropy_coeff": 0.0}}, "num_steps_sampled": 928000, "num_steps_trained": 928000}, "done": false, "episodes_total": 92, "training_iteration": 232, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-16-37", "timestamp": 1618143397, "time_this_iter_s": 20.09852385520935, "time_total_s": 4744.499246120453, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4744.499246120453, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 57.765517241379314, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2019.0, "episode_reward_min": 2019.0, "episode_reward_mean": 2019.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2019.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6002938389740149, "mean_raw_obs_processing_ms": 0.08965766096025936, "mean_inference_ms": 1.4511411342173013, "mean_action_processing_ms": 0.040313614006320685}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 932000, "timers": {"sample_time_ms": 9674.749, "sample_throughput": 413.447, "learn_time_ms": 11707.857, "learn_throughput": 341.651, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2814453125, "cur_lr": 5e-05, "total_loss": 6.794761583209038, "policy_loss": -0.029965807334519923, "vf_loss": 6.818450063467026, "vf_explained_var": 0.2796575725078583, "kl": 0.004898669016256463, "entropy": 0.1295714587904513, "entropy_coeff": 0.0}}, "num_steps_sampled": 932000, "num_steps_trained": 932000}, "done": false, "episodes_total": 93, "training_iteration": 233, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-16-59", "timestamp": 1618143419, "time_this_iter_s": 21.142643928527832, "time_total_s": 4765.641890048981, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4765.641890048981, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 58.123333333333335, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2019.0, "episode_reward_min": 2019.0, "episode_reward_mean": 2019.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2019.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6002938389740149, "mean_raw_obs_processing_ms": 0.08965766096025936, "mean_inference_ms": 1.4511411342173013, "mean_action_processing_ms": 0.040313614006320685}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 936000, "timers": {"sample_time_ms": 9640.49, "sample_throughput": 414.917, "learn_time_ms": 11701.894, "learn_throughput": 341.825, "update_time_ms": 3.025}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 5.540780201554298, "policy_loss": -0.02926583104999736, "vf_loss": 5.565081894397736, "vf_explained_var": 0.35486161708831787, "kl": 0.007747670970275067, "entropy": 0.12864509830251336, "entropy_coeff": 0.0}}, "num_steps_sampled": 936000, "num_steps_trained": 936000}, "done": false, "episodes_total": 93, "training_iteration": 234, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-17-20", "timestamp": 1618143440, "time_this_iter_s": 20.95747685432434, "time_total_s": 4786.599366903305, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4786.599366903305, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 58.86666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2035.0, "episode_reward_min": 2035.0, "episode_reward_mean": 2035.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2035.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5988165983192835, "mean_raw_obs_processing_ms": 0.08987359824150354, "mean_inference_ms": 1.4518087497855128, "mean_action_processing_ms": 0.04032171175289233}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 940000, "timers": {"sample_time_ms": 9413.028, "sample_throughput": 424.943, "learn_time_ms": 11698.975, "learn_throughput": 341.91, "update_time_ms": 3.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.20587857067585, "policy_loss": -0.032570093346294016, "vf_loss": 9.233078017830849, "vf_explained_var": 0.4328761100769043, "kl": 0.008382031839573756, "entropy": 0.14823719346895814, "entropy_coeff": 0.0}}, "num_steps_sampled": 940000, "num_steps_trained": 940000}, "done": false, "episodes_total": 94, "training_iteration": 235, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-17-39", "timestamp": 1618143459, "time_this_iter_s": 19.540767669677734, "time_total_s": 4806.140134572983, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711838d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4806.140134572983, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 58.66428571428572, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2035.0, "episode_reward_min": 2035.0, "episode_reward_mean": 2035.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2035.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5988165983192835, "mean_raw_obs_processing_ms": 0.08987359824150354, "mean_inference_ms": 1.4518087497855128, "mean_action_processing_ms": 0.04032171175289233}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 944000, "timers": {"sample_time_ms": 9228.86, "sample_throughput": 433.423, "learn_time_ms": 11702.775, "learn_throughput": 341.799, "update_time_ms": 3.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.585057526826859, "policy_loss": -0.03830080642364919, "vf_loss": 10.617020606994629, "vf_explained_var": 0.4509550929069519, "kl": 0.009891747511574067, "entropy": 0.16665275860577822, "entropy_coeff": 0.0}}, "num_steps_sampled": 944000, "num_steps_trained": 944000}, "done": false, "episodes_total": 94, "training_iteration": 236, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-17-59", "timestamp": 1618143479, "time_this_iter_s": 19.595365047454834, "time_total_s": 4825.735499620438, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ef10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4825.735499620438, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 58.51785714285715, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2035.0, "episode_reward_min": 2035.0, "episode_reward_mean": 2035.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2035.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5988165983192835, "mean_raw_obs_processing_ms": 0.08987359824150354, "mean_inference_ms": 1.4518087497855128, "mean_action_processing_ms": 0.04032171175289233}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 948000, "timers": {"sample_time_ms": 9198.367, "sample_throughput": 434.86, "learn_time_ms": 11714.99, "learn_throughput": 341.443, "update_time_ms": 3.286}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.521552473306656, "policy_loss": -0.046407402551267296, "vf_loss": 10.556570172309875, "vf_explained_var": 0.438755601644516, "kl": 0.01777635602047667, "entropy": 0.1796872024424374, "entropy_coeff": 0.0}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 94, "training_iteration": 237, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-18-18", "timestamp": 1618143498, "time_this_iter_s": 19.278289079666138, "time_total_s": 4845.013788700104, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4845.013788700104, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 57.925925925925924, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1773.0, "episode_reward_min": 1773.0, "episode_reward_mean": 1773.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1773.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.594696509402853, "mean_raw_obs_processing_ms": 0.09018305538703665, "mean_inference_ms": 1.4522362050589084, "mean_action_processing_ms": 0.04033705111665514}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 952000, "timers": {"sample_time_ms": 8763.841, "sample_throughput": 456.421, "learn_time_ms": 11729.447, "learn_throughput": 341.022, "update_time_ms": 3.427}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.136644929647446, "policy_loss": -0.037697616731747985, "vf_loss": 12.167706191539764, "vf_explained_var": 0.5082492828369141, "kl": 0.010357450373703614, "entropy": 0.15407302603125572, "entropy_coeff": 0.0}}, "num_steps_sampled": 952000, "num_steps_trained": 952000}, "done": false, "episodes_total": 95, "training_iteration": 238, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-18-38", "timestamp": 1618143518, "time_this_iter_s": 19.777169227600098, "time_total_s": 4864.790957927704, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114fd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4864.790957927704, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 58.646428571428565, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1773.0, "episode_reward_min": 1773.0, "episode_reward_mean": 1773.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1773.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.594696509402853, "mean_raw_obs_processing_ms": 0.09018305538703665, "mean_inference_ms": 1.4522362050589084, "mean_action_processing_ms": 0.04033705111665514}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 956000, "timers": {"sample_time_ms": 8571.501, "sample_throughput": 466.663, "learn_time_ms": 11719.835, "learn_throughput": 341.302, "update_time_ms": 3.427}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 11.711572721600533, "policy_loss": -0.04344702686648816, "vf_loss": 11.749732449650764, "vf_explained_var": 0.5127792358398438, "kl": 0.00825251558853779, "entropy": 0.1674915924668312, "entropy_coeff": 0.0}}, "num_steps_sampled": 956000, "num_steps_trained": 956000}, "done": false, "episodes_total": 95, "training_iteration": 239, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-18-57", "timestamp": 1618143537, "time_this_iter_s": 19.362688779830933, "time_total_s": 4884.153646707535, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e26d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4884.153646707535, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 57.53214285714285, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1697.0, "episode_reward_min": 1697.0, "episode_reward_mean": 1697.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1697.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5920559030616178, "mean_raw_obs_processing_ms": 0.09038532497894514, "mean_inference_ms": 1.4523309495256567, "mean_action_processing_ms": 0.04033785184492336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 960000, "timers": {"sample_time_ms": 8381.009, "sample_throughput": 477.27, "learn_time_ms": 11714.07, "learn_throughput": 341.47, "update_time_ms": 3.364}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.134373009204865, "policy_loss": -0.04073393909493461, "vf_loss": 12.168953448534012, "vf_explained_var": 0.45912668108940125, "kl": 0.00960398321331013, "entropy": 0.17515963315963745, "entropy_coeff": 0.0}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 96, "training_iteration": 240, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-19-16", "timestamp": 1618143556, "time_this_iter_s": 19.213939666748047, "time_total_s": 4903.367586374283, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ef10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4903.367586374283, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 58.75925925925925, "ram_util_percent": 27.299999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1697.0, "episode_reward_min": 1697.0, "episode_reward_mean": 1697.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1697.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5920559030616178, "mean_raw_obs_processing_ms": 0.09038532497894514, "mean_inference_ms": 1.4523309495256567, "mean_action_processing_ms": 0.04033785184492336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 964000, "timers": {"sample_time_ms": 8061.462, "sample_throughput": 496.188, "learn_time_ms": 11718.103, "learn_throughput": 341.352, "update_time_ms": 3.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.079701900482178, "policy_loss": -0.04336638801032677, "vf_loss": 12.116331487894058, "vf_explained_var": 0.3889859914779663, "kl": 0.010514518129639328, "entropy": 0.22229653131216764, "entropy_coeff": 0.0}}, "num_steps_sampled": 964000, "num_steps_trained": 964000}, "done": false, "episodes_total": 96, "training_iteration": 241, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-19-35", "timestamp": 1618143575, "time_this_iter_s": 18.933403253555298, "time_total_s": 4922.300989627838, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4922.300989627838, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 58.06071428571429, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1697.0, "episode_reward_min": 1697.0, "episode_reward_mean": 1697.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1697.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5920559030616178, "mean_raw_obs_processing_ms": 0.09038532497894514, "mean_inference_ms": 1.4523309495256567, "mean_action_processing_ms": 0.04033785184492336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 968000, "timers": {"sample_time_ms": 8026.519, "sample_throughput": 498.348, "learn_time_ms": 11712.778, "learn_throughput": 341.507, "update_time_ms": 3.341}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.377806887030602, "policy_loss": -0.03980679146479815, "vf_loss": 9.4117132127285, "vf_explained_var": 0.37364205718040466, "kl": 0.009208992240019143, "entropy": 0.15586136584170163, "entropy_coeff": 0.0}}, "num_steps_sampled": 968000, "num_steps_trained": 968000}, "done": false, "episodes_total": 96, "training_iteration": 242, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-19-55", "timestamp": 1618143595, "time_this_iter_s": 19.692728519439697, "time_total_s": 4941.993718147278, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4941.993718147278, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 58.17857142857143, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1699.0, "episode_reward_min": 1699.0, "episode_reward_mean": 1699.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1699.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5901894916639049, "mean_raw_obs_processing_ms": 0.09067177495225752, "mean_inference_ms": 1.4524681901507073, "mean_action_processing_ms": 0.04033996239658598}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 972000, "timers": {"sample_time_ms": 8041.589, "sample_throughput": 497.414, "learn_time_ms": 11722.373, "learn_throughput": 341.228, "update_time_ms": 3.354}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.304545685648918, "policy_loss": -0.0335681161377579, "vf_loss": 9.331820726394653, "vf_explained_var": 0.2498226761817932, "kl": 0.00982178543927148, "entropy": 0.12286903127096593, "entropy_coeff": 0.0}}, "num_steps_sampled": 972000, "num_steps_trained": 972000}, "done": false, "episodes_total": 97, "training_iteration": 243, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-20-17", "timestamp": 1618143617, "time_this_iter_s": 21.387528896331787, "time_total_s": 4963.38124704361, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4963.38124704361, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 58.220000000000006, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1699.0, "episode_reward_min": 1699.0, "episode_reward_mean": 1699.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1699.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5901894916639049, "mean_raw_obs_processing_ms": 0.09067177495225752, "mean_inference_ms": 1.4524681901507073, "mean_action_processing_ms": 0.04033996239658598}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 976000, "timers": {"sample_time_ms": 8004.108, "sample_throughput": 499.743, "learn_time_ms": 11717.917, "learn_throughput": 341.358, "update_time_ms": 3.358}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.611968025565147, "policy_loss": -0.04081838036654517, "vf_loss": 10.646067082881927, "vf_explained_var": 0.47133690118789673, "kl": 0.010487189167179167, "entropy": 0.15770918340422213, "entropy_coeff": 0.0}}, "num_steps_sampled": 976000, "num_steps_trained": 976000}, "done": false, "episodes_total": 97, "training_iteration": 244, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-20-37", "timestamp": 1618143637, "time_this_iter_s": 20.53615117073059, "time_total_s": 4983.91739821434, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7266809390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221fdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4983.91739821434, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 58.419999999999995, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2021.0, "episode_reward_min": 2021.0, "episode_reward_mean": 2021.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2021.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5913547242608641, "mean_raw_obs_processing_ms": 0.09087043486365774, "mean_inference_ms": 1.452570085252908, "mean_action_processing_ms": 0.04034038290689688}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 980000, "timers": {"sample_time_ms": 8233.874, "sample_throughput": 485.798, "learn_time_ms": 11701.858, "learn_throughput": 341.826, "update_time_ms": 3.237}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 8.107698380947113, "policy_loss": -0.03248404178884812, "vf_loss": 8.13379654288292, "vf_explained_var": 0.2518737316131592, "kl": 0.009966515135602094, "entropy": 0.12345016142353415, "entropy_coeff": 0.0}}, "num_steps_sampled": 980000, "num_steps_trained": 980000}, "done": false, "episodes_total": 98, "training_iteration": 245, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-20-59", "timestamp": 1618143659, "time_this_iter_s": 21.67750096321106, "time_total_s": 5005.594899177551, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ec10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221f990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5005.594899177551, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 57.88064516129033, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2021.0, "episode_reward_min": 2021.0, "episode_reward_mean": 2021.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2021.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5913547242608641, "mean_raw_obs_processing_ms": 0.09087043486365774, "mean_inference_ms": 1.452570085252908, "mean_action_processing_ms": 0.04034038290689688}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 984000, "timers": {"sample_time_ms": 8378.53, "sample_throughput": 477.411, "learn_time_ms": 11690.596, "learn_throughput": 342.155, "update_time_ms": 3.092}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 8.723704174160957, "policy_loss": -0.04384707525605336, "vf_loss": 8.759857788681984, "vf_explained_var": 0.6095383167266846, "kl": 0.012007617799099535, "entropy": 0.171139323618263, "entropy_coeff": 0.0}}, "num_steps_sampled": 984000, "num_steps_trained": 984000}, "done": false, "episodes_total": 98, "training_iteration": 246, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-21-20", "timestamp": 1618143680, "time_this_iter_s": 20.924126863479614, "time_total_s": 5026.519026041031, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221f690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5026.519026041031, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 58.43448275862069, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2021.0, "episode_reward_min": 2021.0, "episode_reward_mean": 2021.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2021.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5913547242608641, "mean_raw_obs_processing_ms": 0.09087043486365774, "mean_inference_ms": 1.452570085252908, "mean_action_processing_ms": 0.04034038290689688}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 988000, "timers": {"sample_time_ms": 8628.682, "sample_throughput": 463.57, "learn_time_ms": 11674.451, "learn_throughput": 342.629, "update_time_ms": 3.088}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 8.462575480341911, "policy_loss": -0.027223632263485342, "vf_loss": 8.485216364264488, "vf_explained_var": 0.42179736495018005, "kl": 0.007152355959988199, "entropy": 0.12797149480320513, "entropy_coeff": 0.0}}, "num_steps_sampled": 988000, "num_steps_trained": 988000}, "done": false, "episodes_total": 98, "training_iteration": 247, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-21-41", "timestamp": 1618143701, "time_this_iter_s": 21.618349313735962, "time_total_s": 5048.137375354767, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71721f75d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5048.137375354767, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 58.125806451612895, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1937.0, "episode_reward_min": 1937.0, "episode_reward_mean": 1937.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1937.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5929375901432513, "mean_raw_obs_processing_ms": 0.09117304475858656, "mean_inference_ms": 1.452776664594735, "mean_action_processing_ms": 0.04034643975351279}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 992000, "timers": {"sample_time_ms": 8755.622, "sample_throughput": 456.849, "learn_time_ms": 11649.03, "learn_throughput": 343.376, "update_time_ms": 2.971}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 6.8396165817976, "policy_loss": -0.03759434900712222, "vf_loss": 6.872206225991249, "vf_explained_var": 0.4287668466567993, "kl": 0.007810958260961343, "entropy": 0.1359919928945601, "entropy_coeff": 0.0}}, "num_steps_sampled": 992000, "num_steps_trained": 992000}, "done": false, "episodes_total": 99, "training_iteration": 248, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-22-02", "timestamp": 1618143722, "time_this_iter_s": 20.788283109664917, "time_total_s": 5068.925658464432, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5068.925658464432, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 58.2, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1937.0, "episode_reward_min": 1937.0, "episode_reward_mean": 1937.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1937.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5929375901432513, "mean_raw_obs_processing_ms": 0.09117304475858656, "mean_inference_ms": 1.452776664594735, "mean_action_processing_ms": 0.04034643975351279}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 996000, "timers": {"sample_time_ms": 8999.062, "sample_throughput": 444.491, "learn_time_ms": 11651.562, "learn_throughput": 343.302, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 5.530202500522137, "policy_loss": -0.029350966855417937, "vf_loss": 5.554073244333267, "vf_explained_var": 0.36695683002471924, "kl": 0.008553192717954516, "entropy": 0.11712323734536767, "entropy_coeff": 0.0}}, "num_steps_sampled": 996000, "num_steps_trained": 996000}, "done": false, "episodes_total": 99, "training_iteration": 249, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-22-24", "timestamp": 1618143744, "time_this_iter_s": 21.821632623672485, "time_total_s": 5090.747291088104, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5090.747291088104, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 58.04516129032258, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2098.0, "episode_reward_min": 2098.0, "episode_reward_mean": 2098.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2098.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5949668768711206, "mean_raw_obs_processing_ms": 0.09136301274198298, "mean_inference_ms": 1.4527223052599487, "mean_action_processing_ms": 0.04034482974565487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1000000, "timers": {"sample_time_ms": 9196.45, "sample_throughput": 434.95, "learn_time_ms": 11652.251, "learn_throughput": 343.281, "update_time_ms": 2.983}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.480280339717865, "policy_loss": -0.03591271591722034, "vf_loss": 7.51151217520237, "vf_explained_var": 0.4702473282814026, "kl": 0.007305527506105136, "entropy": 0.12436231854371727, "entropy_coeff": 0.0}}, "num_steps_sampled": 1000000, "num_steps_trained": 1000000}, "done": false, "episodes_total": 100, "training_iteration": 250, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-22-45", "timestamp": 1618143765, "time_this_iter_s": 21.19546103477478, "time_total_s": 5111.942752122879, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5111.942752122879, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 58.29999999999999, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2098.0, "episode_reward_min": 2098.0, "episode_reward_mean": 2098.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2098.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5949668768711206, "mean_raw_obs_processing_ms": 0.09136301274198298, "mean_inference_ms": 1.4527223052599487, "mean_action_processing_ms": 0.04034482974565487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1004000, "timers": {"sample_time_ms": 9458.075, "sample_throughput": 422.919, "learn_time_ms": 11636.733, "learn_throughput": 343.739, "update_time_ms": 2.879}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 292.47876739501953, "policy_loss": -0.029257564019644633, "vf_loss": 292.5020546913147, "vf_explained_var": -0.18865633010864258, "kl": 0.00931557803414762, "entropy": 0.1497910674661398, "entropy_coeff": 0.0}}, "num_steps_sampled": 1004000, "num_steps_trained": 1004000}, "done": false, "episodes_total": 100, "training_iteration": 251, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-23-07", "timestamp": 1618143787, "time_this_iter_s": 21.393075942993164, "time_total_s": 5133.335828065872, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ce50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5133.335828065872, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 58.18709677419354, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2098.0, "episode_reward_min": 2098.0, "episode_reward_mean": 2098.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2098.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5949668768711206, "mean_raw_obs_processing_ms": 0.09136301274198298, "mean_inference_ms": 1.4527223052599487, "mean_action_processing_ms": 0.04034482974565487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1008000, "timers": {"sample_time_ms": 9594.967, "sample_throughput": 416.885, "learn_time_ms": 11638.393, "learn_throughput": 343.69, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 123.00445604324341, "policy_loss": -0.039453394419979304, "vf_loss": 123.03787636756897, "vf_explained_var": -0.23116259276866913, "kl": 0.009414908476173878, "entropy": 0.15208122949115932, "entropy_coeff": 0.0}}, "num_steps_sampled": 1008000, "num_steps_trained": 1008000}, "done": false, "episodes_total": 100, "training_iteration": 252, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-23-28", "timestamp": 1618143808, "time_this_iter_s": 21.07828974723816, "time_total_s": 5154.41411781311, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710aaa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267431110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5154.41411781311, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 58.45333333333334, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1803.0, "episode_reward_min": -1803.0, "episode_reward_mean": -1803.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1803.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5967311400029481, "mean_raw_obs_processing_ms": 0.09164719303695855, "mean_inference_ms": 1.4528236616307815, "mean_action_processing_ms": 0.040346831854417335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1012000, "timers": {"sample_time_ms": 9560.69, "sample_throughput": 418.38, "learn_time_ms": 11646.314, "learn_throughput": 343.456, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 47.59439253807068, "policy_loss": -0.04159434512257576, "vf_loss": 47.6300790309906, "vf_explained_var": 0.047708772122859955, "kl": 0.009220817271852866, "entropy": 0.1443676284980029, "entropy_coeff": 0.0}}, "num_steps_sampled": 1012000, "num_steps_trained": 1012000}, "done": false, "episodes_total": 101, "training_iteration": 253, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-23-49", "timestamp": 1618143829, "time_this_iter_s": 21.132370948791504, "time_total_s": 5175.546488761902, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5175.546488761902, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 58.19333333333332, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1803.0, "episode_reward_min": -1803.0, "episode_reward_mean": -1803.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1803.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5967311400029481, "mean_raw_obs_processing_ms": 0.09164719303695855, "mean_inference_ms": 1.4528236616307815, "mean_action_processing_ms": 0.040346831854417335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1016000, "timers": {"sample_time_ms": 9799.269, "sample_throughput": 408.194, "learn_time_ms": 11643.749, "learn_throughput": 343.532, "update_time_ms": 2.869}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 18.062767326831818, "policy_loss": -0.028363150893710554, "vf_loss": 18.0864135324955, "vf_explained_var": 0.12237648665904999, "kl": 0.007362238698988222, "entropy": 0.10564460419118404, "entropy_coeff": 0.0}}, "num_steps_sampled": 1016000, "num_steps_trained": 1016000}, "done": false, "episodes_total": 101, "training_iteration": 254, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-24-12", "timestamp": 1618143852, "time_this_iter_s": 22.8960702419281, "time_total_s": 5198.44255900383, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711981d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5198.44255900383, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 57.89090909090909, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -2275.0, "episode_reward_min": -2275.0, "episode_reward_mean": -2275.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2275.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6008248611894031, "mean_raw_obs_processing_ms": 0.09183258982878133, "mean_inference_ms": 1.4527740645932052, "mean_action_processing_ms": 0.04034526810451597}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1020000, "timers": {"sample_time_ms": 9854.318, "sample_throughput": 405.913, "learn_time_ms": 11644.798, "learn_throughput": 343.501, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.175574749708176, "policy_loss": -0.04070282028988004, "vf_loss": 10.211474001407623, "vf_explained_var": 0.2191627323627472, "kl": 0.007497102873458061, "entropy": 0.10263294144533575, "entropy_coeff": 0.0}}, "num_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 102, "training_iteration": 255, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-24-34", "timestamp": 1618143874, "time_this_iter_s": 22.23885989189148, "time_total_s": 5220.681418895721, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5220.681418895721, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 57.921875, "ram_util_percent": 27.3}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -2275.0, "episode_reward_min": -2275.0, "episode_reward_mean": -2275.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2275.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6008248611894031, "mean_raw_obs_processing_ms": 0.09183258982878133, "mean_inference_ms": 1.4527740645932052, "mean_action_processing_ms": 0.04034526810451597}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1024000, "timers": {"sample_time_ms": 9964.183, "sample_throughput": 401.438, "learn_time_ms": 11633.854, "learn_throughput": 343.824, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.136584833264351, "policy_loss": -0.02875977210351266, "vf_loss": 7.160650312900543, "vf_explained_var": 0.2865103483200073, "kl": 0.007326702565478627, "entropy": 0.1093812973704189, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 102, "training_iteration": 256, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-24-56", "timestamp": 1618143896, "time_this_iter_s": 21.913513898849487, "time_total_s": 5242.594932794571, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72662f8ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5242.594932794571, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 58.08709677419353, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -2275.0, "episode_reward_min": -2275.0, "episode_reward_mean": -2275.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2275.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6008248611894031, "mean_raw_obs_processing_ms": 0.09183258982878133, "mean_inference_ms": 1.4527740645932052, "mean_action_processing_ms": 0.04034526810451597}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1028000, "timers": {"sample_time_ms": 9869.835, "sample_throughput": 405.275, "learn_time_ms": 11635.791, "learn_throughput": 343.767, "update_time_ms": 2.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.336342692375183, "policy_loss": -0.03325896250316873, "vf_loss": 14.363945007324219, "vf_explained_var": 0.570777177810669, "kl": 0.008828923862893134, "entropy": 0.13274314953014255, "entropy_coeff": 0.0}}, "num_steps_sampled": 1028000, "num_steps_trained": 1028000}, "done": false, "episodes_total": 102, "training_iteration": 257, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-25-17", "timestamp": 1618143917, "time_this_iter_s": 20.691295862197876, "time_total_s": 5263.286228656769, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711400d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5263.286228656769, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 58.04333333333333, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -2102.0, "episode_reward_min": -2102.0, "episode_reward_mean": -2102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6034009653359692, "mean_raw_obs_processing_ms": 0.0921050875416243, "mean_inference_ms": 1.4526123019388506, "mean_action_processing_ms": 0.04033818928986818}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1032000, "timers": {"sample_time_ms": 9935.561, "sample_throughput": 402.594, "learn_time_ms": 11640.555, "learn_throughput": 343.626, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 11.256329655647278, "policy_loss": -0.024112879997119308, "vf_loss": 11.275660753250122, "vf_explained_var": 0.3830174505710602, "kl": 0.007463001835276373, "entropy": 0.10592172271572053, "entropy_coeff": 0.0}}, "num_steps_sampled": 1032000, "num_steps_trained": 1032000}, "done": false, "episodes_total": 103, "training_iteration": 258, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-25-38", "timestamp": 1618143938, "time_this_iter_s": 21.494513988494873, "time_total_s": 5284.780742645264, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5284.780742645264, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 58.35333333333334, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -2102.0, "episode_reward_min": -2102.0, "episode_reward_mean": -2102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6034009653359692, "mean_raw_obs_processing_ms": 0.0921050875416243, "mean_inference_ms": 1.4526123019388506, "mean_action_processing_ms": 0.04033818928986818}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1036000, "timers": {"sample_time_ms": 9865.955, "sample_throughput": 405.435, "learn_time_ms": 11634.251, "learn_throughput": 343.812, "update_time_ms": 2.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.274315804243088, "policy_loss": -0.022987589065451175, "vf_loss": 7.292888343334198, "vf_explained_var": 0.2933604121208191, "kl": 0.006890523531183135, "entropy": 0.11884199199266732, "entropy_coeff": 0.0}}, "num_steps_sampled": 1036000, "num_steps_trained": 1036000}, "done": false, "episodes_total": 103, "training_iteration": 259, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-25-59", "timestamp": 1618143959, "time_this_iter_s": 21.064058303833008, "time_total_s": 5305.844800949097, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116eed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711429d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5305.844800949097, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 58.236666666666665, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1977.0, "episode_reward_min": -1977.0, "episode_reward_mean": -1977.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1977.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6032534532298556, "mean_raw_obs_processing_ms": 0.09228830083397963, "mean_inference_ms": 1.4525970549231222, "mean_action_processing_ms": 0.04033713955461388}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1040000, "timers": {"sample_time_ms": 9730.436, "sample_throughput": 411.081, "learn_time_ms": 11648.919, "learn_throughput": 343.379, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.06670680642128, "policy_loss": -0.030639255593996495, "vf_loss": 14.091703951358795, "vf_explained_var": 0.3708183765411377, "kl": 0.0088058665569406, "entropy": 0.14448400237597525, "entropy_coeff": 0.0}}, "num_steps_sampled": 1040000, "num_steps_trained": 1040000}, "done": false, "episodes_total": 104, "training_iteration": 260, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-26-19", "timestamp": 1618143979, "time_this_iter_s": 19.986752033233643, "time_total_s": 5325.83155298233, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ec10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5325.83155298233, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 58.19655172413793, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1977.0, "episode_reward_min": -1977.0, "episode_reward_mean": -1977.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1977.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6032534532298556, "mean_raw_obs_processing_ms": 0.09228830083397963, "mean_inference_ms": 1.4525970549231222, "mean_action_processing_ms": 0.04033713955461388}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1044000, "timers": {"sample_time_ms": 9598.307, "sample_throughput": 416.74, "learn_time_ms": 11658.891, "learn_throughput": 343.086, "update_time_ms": 2.877}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.721147418022156, "policy_loss": -0.038300807878840715, "vf_loss": 14.753536254167557, "vf_explained_var": 0.6288480758666992, "kl": 0.009226966634741984, "entropy": 0.19277798663824797, "entropy_coeff": 0.0}}, "num_steps_sampled": 1044000, "num_steps_trained": 1044000}, "done": false, "episodes_total": 104, "training_iteration": 261, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-26-40", "timestamp": 1618144000, "time_this_iter_s": 20.1737003326416, "time_total_s": 5346.005253314972, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710dfe90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711758d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5346.005253314972, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 57.85862068965517, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1977.0, "episode_reward_min": -1977.0, "episode_reward_mean": -1977.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1977.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6032534532298556, "mean_raw_obs_processing_ms": 0.09228830083397963, "mean_inference_ms": 1.4525970549231222, "mean_action_processing_ms": 0.04033713955461388}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1048000, "timers": {"sample_time_ms": 9648.887, "sample_throughput": 414.556, "learn_time_ms": 11680.192, "learn_throughput": 342.46, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.58515939116478, "policy_loss": -0.03013010451104492, "vf_loss": 14.609293162822723, "vf_explained_var": 0.36094748973846436, "kl": 0.009358550509205088, "entropy": 0.14871984929777682, "entropy_coeff": 0.0}}, "num_steps_sampled": 1048000, "num_steps_trained": 1048000}, "done": false, "episodes_total": 104, "training_iteration": 262, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-27-02", "timestamp": 1618144022, "time_this_iter_s": 21.797773122787476, "time_total_s": 5367.803026437759, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7172212510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5367.803026437759, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 58.699999999999996, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1661.0, "episode_reward_min": -1661.0, "episode_reward_mean": -1661.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6030130877648456, "mean_raw_obs_processing_ms": 0.09259018350658829, "mean_inference_ms": 1.4528504887242244, "mean_action_processing_ms": 0.04034265791749513}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1052000, "timers": {"sample_time_ms": 9556.253, "sample_throughput": 418.574, "learn_time_ms": 11661.116, "learn_throughput": 343.02, "update_time_ms": 2.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.29909098148346, "policy_loss": -0.03240917541552335, "vf_loss": 12.32541510462761, "vf_explained_var": 0.4977591037750244, "kl": 0.009497206658124924, "entropy": 0.16169963288120925, "entropy_coeff": 0.0}}, "num_steps_sampled": 1052000, "num_steps_trained": 1052000}, "done": false, "episodes_total": 105, "training_iteration": 263, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-27-22", "timestamp": 1618144042, "time_this_iter_s": 20.00911808013916, "time_total_s": 5387.812144517899, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221ff10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5387.812144517899, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 58.49310344827586, "ram_util_percent": 27.365517241379305}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1661.0, "episode_reward_min": -1661.0, "episode_reward_mean": -1661.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6030130877648456, "mean_raw_obs_processing_ms": 0.09259018350658829, "mean_inference_ms": 1.4528504887242244, "mean_action_processing_ms": 0.04034265791749513}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1056000, "timers": {"sample_time_ms": 9204.993, "sample_throughput": 434.547, "learn_time_ms": 11662.426, "learn_throughput": 342.982, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 16.00558516383171, "policy_loss": -0.02938228315906599, "vf_loss": 16.027802258729935, "vf_explained_var": 0.5354295969009399, "kl": 0.011183088936377317, "entropy": 0.20710270665585995, "entropy_coeff": 0.0}}, "num_steps_sampled": 1056000, "num_steps_trained": 1056000}, "done": false, "episodes_total": 105, "training_iteration": 264, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-27-41", "timestamp": 1618144061, "time_this_iter_s": 19.398723602294922, "time_total_s": 5407.2108681201935, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116cd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5407.2108681201935, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 58.88888888888888, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1291.0, "episode_reward_min": -1291.0, "episode_reward_mean": -1291.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1291.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6006430155197623, "mean_raw_obs_processing_ms": 0.09277480118101054, "mean_inference_ms": 1.4528801115456924, "mean_action_processing_ms": 0.04034070716687206}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1060000, "timers": {"sample_time_ms": 8901.651, "sample_throughput": 449.355, "learn_time_ms": 11668.406, "learn_throughput": 342.806, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 17.113931834697723, "policy_loss": -0.04034276184393093, "vf_loss": 17.148137241601944, "vf_explained_var": 0.5735698342323303, "kl": 0.009578948840498924, "entropy": 0.20795236015692353, "entropy_coeff": 0.0}}, "num_steps_sampled": 1060000, "num_steps_trained": 1060000}, "done": false, "episodes_total": 106, "training_iteration": 265, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-28-00", "timestamp": 1618144080, "time_this_iter_s": 19.26402711868286, "time_total_s": 5426.474895238876, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71721f7a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5426.474895238876, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 57.74642857142856, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1291.0, "episode_reward_min": -1291.0, "episode_reward_mean": -1291.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1291.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6006430155197623, "mean_raw_obs_processing_ms": 0.09277480118101054, "mean_inference_ms": 1.4528801115456924, "mean_action_processing_ms": 0.04034070716687206}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1064000, "timers": {"sample_time_ms": 8626.289, "sample_throughput": 463.699, "learn_time_ms": 11669.249, "learn_throughput": 342.781, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.192833811044693, "policy_loss": -0.03345295108738355, "vf_loss": 7.219192370772362, "vf_explained_var": 0.6582064032554626, "kl": 0.011072540262830444, "entropy": 0.22876013815402985, "entropy_coeff": 0.0}}, "num_steps_sampled": 1064000, "num_steps_trained": 1064000}, "done": false, "episodes_total": 106, "training_iteration": 266, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-28-19", "timestamp": 1618144099, "time_this_iter_s": 19.168344497680664, "time_total_s": 5445.643239736557, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118df10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5445.643239736557, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 58.788888888888884, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1291.0, "episode_reward_min": -1291.0, "episode_reward_mean": -1291.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1291.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6006430155197623, "mean_raw_obs_processing_ms": 0.09277480118101054, "mean_inference_ms": 1.4528801115456924, "mean_action_processing_ms": 0.04034070716687206}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1068000, "timers": {"sample_time_ms": 8432.057, "sample_throughput": 474.38, "learn_time_ms": 11664.389, "learn_throughput": 342.924, "update_time_ms": 2.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 5.079450465738773, "policy_loss": -0.04682784655597061, "vf_loss": 5.117569126188755, "vf_explained_var": 0.5819891691207886, "kl": 0.013592806877568364, "entropy": 0.358051223680377, "entropy_coeff": 0.0}}, "num_steps_sampled": 1068000, "num_steps_trained": 1068000}, "done": false, "episodes_total": 106, "training_iteration": 267, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-28-38", "timestamp": 1618144118, "time_this_iter_s": 18.703017234802246, "time_total_s": 5464.346256971359, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710c0e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72665cef50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5464.346256971359, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 57.96296296296296, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -628.0, "episode_reward_min": -628.0, "episode_reward_mean": -628.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-628.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5982477613276114, "mean_raw_obs_processing_ms": 0.09309927974915294, "mean_inference_ms": 1.4533964173147913, "mean_action_processing_ms": 0.04035425469545911}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1072000, "timers": {"sample_time_ms": 8461.446, "sample_throughput": 472.732, "learn_time_ms": 11660.823, "learn_throughput": 343.029, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.889297366142273, "policy_loss": -0.028806413407437503, "vf_loss": 14.913713216781616, "vf_explained_var": 0.46885448694229126, "kl": 0.006853025843156502, "entropy": 0.12945217220112681, "entropy_coeff": 0.0}}, "num_steps_sampled": 1072000, "num_steps_trained": 1072000}, "done": false, "episodes_total": 107, "training_iteration": 268, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-29-00", "timestamp": 1618144140, "time_this_iter_s": 21.75147247314453, "time_total_s": 5486.097729444504, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117bad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5486.097729444504, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 58.10000000000001, "ram_util_percent": 27.316129032258054}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -628.0, "episode_reward_min": -628.0, "episode_reward_mean": -628.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-628.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5982477613276114, "mean_raw_obs_processing_ms": 0.09309927974915294, "mean_inference_ms": 1.4533964173147913, "mean_action_processing_ms": 0.04035425469545911}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1076000, "timers": {"sample_time_ms": 8414.246, "sample_throughput": 475.384, "learn_time_ms": 11671.051, "learn_throughput": 342.728, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 15.51439967751503, "policy_loss": -0.02156513271620497, "vf_loss": 15.530750662088394, "vf_explained_var": 0.6104097962379456, "kl": 0.00813805680081714, "entropy": 0.12781643774360418, "entropy_coeff": 0.0}}, "num_steps_sampled": 1076000, "num_steps_trained": 1076000}, "done": false, "episodes_total": 107, "training_iteration": 269, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-29-21", "timestamp": 1618144161, "time_this_iter_s": 20.69334840774536, "time_total_s": 5506.791077852249, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114ec50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ecd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5506.791077852249, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 58.389655172413796, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1509.0, "episode_reward_min": -1509.0, "episode_reward_mean": -1509.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1509.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5994036884040108, "mean_raw_obs_processing_ms": 0.09330035418712458, "mean_inference_ms": 1.453574108253652, "mean_action_processing_ms": 0.040356517220536514}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1080000, "timers": {"sample_time_ms": 8622.511, "sample_throughput": 463.902, "learn_time_ms": 11650.627, "learn_throughput": 343.329, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 15.751175194978714, "policy_loss": -0.03647137206280604, "vf_loss": 15.781665980815887, "vf_explained_var": 0.47724175453186035, "kl": 0.009334396861959249, "entropy": 0.18357905279845, "entropy_coeff": 0.0}}, "num_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 108, "training_iteration": 270, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-29-43", "timestamp": 1618144183, "time_this_iter_s": 21.86470890045166, "time_total_s": 5528.655786752701, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117bfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5528.655786752701, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 58.20625, "ram_util_percent": 27.325}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1509.0, "episode_reward_min": -1509.0, "episode_reward_mean": -1509.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1509.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5994036884040108, "mean_raw_obs_processing_ms": 0.09330035418712458, "mean_inference_ms": 1.453574108253652, "mean_action_processing_ms": 0.040356517220536514}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1084000, "timers": {"sample_time_ms": 8524.836, "sample_throughput": 469.217, "learn_time_ms": 11642.99, "learn_throughput": 343.554, "update_time_ms": 2.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.60600283741951, "policy_loss": -0.03699905317625962, "vf_loss": 14.637072205543518, "vf_explained_var": 0.4950728416442871, "kl": 0.009254562799469568, "entropy": 0.18874309211969376, "entropy_coeff": 0.0}}, "num_steps_sampled": 1084000, "num_steps_trained": 1084000}, "done": false, "episodes_total": 108, "training_iteration": 271, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-30-02", "timestamp": 1618144202, "time_this_iter_s": 19.120578289031982, "time_total_s": 5547.776365041733, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110bad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710cae90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5547.776365041733, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 58.49629629629629, "ram_util_percent": 27.307407407407407}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1509.0, "episode_reward_min": -1509.0, "episode_reward_mean": -1509.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1509.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5994036884040108, "mean_raw_obs_processing_ms": 0.09330035418712458, "mean_inference_ms": 1.453574108253652, "mean_action_processing_ms": 0.040356517220536514}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1088000, "timers": {"sample_time_ms": 8527.268, "sample_throughput": 469.083, "learn_time_ms": 11611.907, "learn_throughput": 344.474, "update_time_ms": 2.958}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.826443061232567, "policy_loss": -0.030542515101842582, "vf_loss": 14.84878820180893, "vf_explained_var": 0.49587446451187134, "kl": 0.012794177047908306, "entropy": 0.19443942653015256, "entropy_coeff": 0.0}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 108, "training_iteration": 272, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-30-23", "timestamp": 1618144223, "time_this_iter_s": 21.5119047164917, "time_total_s": 5569.2882697582245, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5569.2882697582245, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 58.29677419354839, "ram_util_percent": 27.29999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1262.0, "episode_reward_min": -1262.0, "episode_reward_mean": -1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5987959749680402, "mean_raw_obs_processing_ms": 0.09357893434232438, "mean_inference_ms": 1.453579278928154, "mean_action_processing_ms": 0.04035467362234248}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1092000, "timers": {"sample_time_ms": 8550.954, "sample_throughput": 467.784, "learn_time_ms": 11630.309, "learn_throughput": 343.929, "update_time_ms": 2.944}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.839270621538162, "policy_loss": -0.03954201249871403, "vf_loss": 10.871550381183624, "vf_explained_var": 0.4925325810909271, "kl": 0.011334310212987475, "entropy": 0.2122684344649315, "entropy_coeff": 0.0}}, "num_steps_sampled": 1092000, "num_steps_trained": 1092000}, "done": false, "episodes_total": 109, "training_iteration": 273, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-30-44", "timestamp": 1618144244, "time_this_iter_s": 20.4297456741333, "time_total_s": 5589.718015432358, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5589.718015432358, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 58.36206896551724, "ram_util_percent": 27.39999999999999}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1262.0, "episode_reward_min": -1262.0, "episode_reward_mean": -1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5987959749680402, "mean_raw_obs_processing_ms": 0.09357893434232438, "mean_inference_ms": 1.453579278928154, "mean_action_processing_ms": 0.04035467362234248}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1096000, "timers": {"sample_time_ms": 8572.504, "sample_throughput": 466.608, "learn_time_ms": 11634.76, "learn_throughput": 343.797, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.127978399395943, "policy_loss": -0.04758619374479167, "vf_loss": 10.166451841592789, "vf_explained_var": 0.618537425994873, "kl": 0.014222723431885242, "entropy": 0.34054465498775244, "entropy_coeff": 0.0}}, "num_steps_sampled": 1096000, "num_steps_trained": 1096000}, "done": false, "episodes_total": 109, "training_iteration": 274, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-31-03", "timestamp": 1618144263, "time_this_iter_s": 19.659008026123047, "time_total_s": 5609.377023458481, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711193d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116cb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5609.377023458481, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 57.63214285714285, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1161.0, "episode_reward_min": -1161.0, "episode_reward_mean": -1161.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5976977560897114, "mean_raw_obs_processing_ms": 0.09376069410045487, "mean_inference_ms": 1.4535305878142535, "mean_action_processing_ms": 0.040353383312581446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1100000, "timers": {"sample_time_ms": 8672.004, "sample_throughput": 461.254, "learn_time_ms": 11627.875, "learn_throughput": 344.001, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.222886145114899, "policy_loss": -0.03780771262245253, "vf_loss": 12.253697216510773, "vf_explained_var": 0.5088769793510437, "kl": 0.01092011563014239, "entropy": 0.2846955908462405, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 110, "training_iteration": 275, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-31-24", "timestamp": 1618144284, "time_this_iter_s": 20.192398071289062, "time_total_s": 5629.56942152977, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5629.56942152977, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 58.431034482758626, "ram_util_percent": 27.303448275862063}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1161.0, "episode_reward_min": -1161.0, "episode_reward_mean": -1161.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5976977560897114, "mean_raw_obs_processing_ms": 0.09376069410045487, "mean_inference_ms": 1.4535305878142535, "mean_action_processing_ms": 0.040353383312581446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1104000, "timers": {"sample_time_ms": 8826.061, "sample_throughput": 453.203, "learn_time_ms": 11630.395, "learn_throughput": 343.926, "update_time_ms": 2.932}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 15.56188678741455, "policy_loss": -0.03697652692790143, "vf_loss": 15.593003392219543, "vf_explained_var": 0.533367931842804, "kl": 0.009145777192316018, "entropy": 0.26807809667661786, "entropy_coeff": 0.0}}, "num_steps_sampled": 1104000, "num_steps_trained": 1104000}, "done": false, "episodes_total": 110, "training_iteration": 276, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-31-44", "timestamp": 1618144304, "time_this_iter_s": 20.73661208152771, "time_total_s": 5650.306033611298, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5650.306033611298, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 58.510344827586216, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1161.0, "episode_reward_min": -1161.0, "episode_reward_mean": -1161.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5976977560897114, "mean_raw_obs_processing_ms": 0.09376069410045487, "mean_inference_ms": 1.4535305878142535, "mean_action_processing_ms": 0.040353383312581446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1108000, "timers": {"sample_time_ms": 9034.135, "sample_throughput": 442.765, "learn_time_ms": 11637.214, "learn_throughput": 343.725, "update_time_ms": 2.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.022850900888443, "policy_loss": -0.053913794516120106, "vf_loss": 10.06903786957264, "vf_explained_var": 0.5533588528633118, "kl": 0.012059582222718745, "entropy": 0.3045995943248272, "entropy_coeff": 0.0}}, "num_steps_sampled": 1108000, "num_steps_trained": 1108000}, "done": false, "episodes_total": 110, "training_iteration": 277, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-32-05", "timestamp": 1618144325, "time_this_iter_s": 20.858214139938354, "time_total_s": 5671.164247751236, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710c0a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5671.164247751236, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 58.129999999999995, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -768.0, "episode_reward_min": -768.0, "episode_reward_mean": -768.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5966300620346928, "mean_raw_obs_processing_ms": 0.09403228601105922, "mean_inference_ms": 1.453496813901144, "mean_action_processing_ms": 0.04034878919555817}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1112000, "timers": {"sample_time_ms": 8741.939, "sample_throughput": 457.564, "learn_time_ms": 11633.905, "learn_throughput": 343.823, "update_time_ms": 2.91}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 1.5495723448693752, "policy_loss": 0.0016682108980603516, "vf_loss": 1.5476803630590439, "vf_explained_var": -0.00804230384528637, "kl": 0.0003492580848387661, "entropy": 0.04271574690937996, "entropy_coeff": 0.0}}, "num_steps_sampled": 1112000, "num_steps_trained": 1112000}, "done": false, "episodes_total": 111, "training_iteration": 278, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-32-24", "timestamp": 1618144344, "time_this_iter_s": 18.80002450942993, "time_total_s": 5689.964272260666, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d6c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5689.964272260666, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 58.04444444444444, "ram_util_percent": 27.370370370370363}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -768.0, "episode_reward_min": -768.0, "episode_reward_mean": -768.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5966300620346928, "mean_raw_obs_processing_ms": 0.09403228601105922, "mean_inference_ms": 1.453496813901144, "mean_action_processing_ms": 0.04034878919555817}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1116000, "timers": {"sample_time_ms": 8561.757, "sample_throughput": 467.194, "learn_time_ms": 11639.799, "learn_throughput": 343.649, "update_time_ms": 2.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.320361328125, "cur_lr": 5e-05, "total_loss": 0.2864660348277539, "policy_loss": 0.003838151053059846, "vf_loss": 0.2824401529505849, "vf_explained_var": -0.009166475385427475, "kl": 0.0005860003668658464, "entropy": 0.048305319738574326, "entropy_coeff": 0.0}}, "num_steps_sampled": 1116000, "num_steps_trained": 1116000}, "done": false, "episodes_total": 111, "training_iteration": 279, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-32-43", "timestamp": 1618144363, "time_this_iter_s": 18.955878257751465, "time_total_s": 5708.920150518417, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5708.920150518417, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 58.870370370370374, "ram_util_percent": 27.392592592592585}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5937658260050886, "mean_raw_obs_processing_ms": 0.09420313130179252, "mean_inference_ms": 1.4533105280513932, "mean_action_processing_ms": 0.04034566193351336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1120000, "timers": {"sample_time_ms": 8252.462, "sample_throughput": 484.704, "learn_time_ms": 11644.715, "learn_throughput": 343.503, "update_time_ms": 2.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1601806640625, "cur_lr": 5e-05, "total_loss": 0.040871725912438706, "policy_loss": -0.007402349292533472, "vf_loss": 0.04638479114510119, "vf_explained_var": -0.045007504522800446, "kl": 0.011794722056947649, "entropy": 0.008607559400843456, "entropy_coeff": 0.0}}, "num_steps_sampled": 1120000, "num_steps_trained": 1120000}, "done": false, "episodes_total": 112, "training_iteration": 280, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-33-02", "timestamp": 1618144382, "time_this_iter_s": 18.823688745498657, "time_total_s": 5727.743839263916, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5727.743839263916, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 57.74444444444443, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5937658260050886, "mean_raw_obs_processing_ms": 0.09420313130179252, "mean_inference_ms": 1.4533105280513932, "mean_action_processing_ms": 0.04034566193351336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1124000, "timers": {"sample_time_ms": 8269.448, "sample_throughput": 483.708, "learn_time_ms": 11659.771, "learn_throughput": 343.06, "update_time_ms": 2.946}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1601806640625, "cur_lr": 5e-05, "total_loss": 0.004980323035852052, "policy_loss": -0.0039439156535081565, "vf_loss": 0.008920549342292361, "vf_explained_var": -0.04585268348455429, "kl": 2.3033432725583225e-05, "entropy": 0.007090083454386331, "entropy_coeff": 0.0}}, "num_steps_sampled": 1124000, "num_steps_trained": 1124000}, "done": false, "episodes_total": 112, "training_iteration": 281, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-33-21", "timestamp": 1618144401, "time_this_iter_s": 19.43893837928772, "time_total_s": 5747.182777643204, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffd350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267861150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5747.182777643204, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 58.88214285714285, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5937658260050886, "mean_raw_obs_processing_ms": 0.09420313130179252, "mean_inference_ms": 1.4533105280513932, "mean_action_processing_ms": 0.04034566193351336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1128000, "timers": {"sample_time_ms": 8013.504, "sample_throughput": 499.157, "learn_time_ms": 11662.711, "learn_throughput": 342.973, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08009033203125, "cur_lr": 5e-05, "total_loss": 0.00662590897991322, "policy_loss": 0.0002759007184067741, "vf_loss": 0.00609280289063463, "vf_explained_var": -0.01170324720442295, "kl": 0.0032114519126480445, "entropy": 0.002377201341005275, "entropy_coeff": 0.0}}, "num_steps_sampled": 1128000, "num_steps_trained": 1128000}, "done": false, "episodes_total": 112, "training_iteration": 282, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-33-40", "timestamp": 1618144420, "time_this_iter_s": 18.978598833084106, "time_total_s": 5766.161376476288, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71722128d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5766.161376476288, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 58.318518518518516, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5896592367221747, "mean_raw_obs_processing_ms": 0.0945254500113458, "mean_inference_ms": 1.453790004043354, "mean_action_processing_ms": 0.04036111812987529}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1132000, "timers": {"sample_time_ms": 7910.256, "sample_throughput": 505.673, "learn_time_ms": 11648.829, "learn_throughput": 343.382, "update_time_ms": 2.979}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040045166015625, "cur_lr": 5e-05, "total_loss": -0.0049223750829696655, "policy_loss": -0.005355473724193871, "vf_loss": 0.0004325282907302608, "vf_explained_var": -0.006377594545483589, "kl": 1.4278194697681101e-05, "entropy": 0.002988645763252862, "entropy_coeff": 0.0}}, "num_steps_sampled": 1132000, "num_steps_trained": 1132000}, "done": false, "episodes_total": 113, "training_iteration": 283, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-34-00", "timestamp": 1618144440, "time_this_iter_s": 19.2590012550354, "time_total_s": 5785.420377731323, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffda90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5785.420377731323, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 58.96296296296296, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5896592367221747, "mean_raw_obs_processing_ms": 0.0945254500113458, "mean_inference_ms": 1.453790004043354, "mean_action_processing_ms": 0.04036111812987529}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1136000, "timers": {"sample_time_ms": 7835.399, "sample_throughput": 510.504, "learn_time_ms": 11649.846, "learn_throughput": 343.352, "update_time_ms": 2.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0200225830078125, "cur_lr": 5e-05, "total_loss": -0.02755801210878417, "policy_loss": -0.03109445294830948, "vf_loss": 7.779649104122655e-05, "vf_explained_var": -0.006788322702050209, "kl": 0.1727376172784716, "entropy": 0.3016810454428196, "entropy_coeff": 0.0}}, "num_steps_sampled": 1136000, "num_steps_trained": 1136000}, "done": false, "episodes_total": 113, "training_iteration": 284, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-34-19", "timestamp": 1618144459, "time_this_iter_s": 18.91956329345703, "time_total_s": 5804.33994102478, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664b1f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5804.33994102478, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 57.93333333333333, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5869189656164426, "mean_raw_obs_processing_ms": 0.09472163888627001, "mean_inference_ms": 1.453758358222456, "mean_action_processing_ms": 0.040357395583875195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1140000, "timers": {"sample_time_ms": 7716.386, "sample_throughput": 518.377, "learn_time_ms": 11652.496, "learn_throughput": 343.274, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030033874511718753, "cur_lr": 5e-05, "total_loss": -0.08356048283167183, "policy_loss": -0.08572439636918716, "vf_loss": 1.709520361714567e-05, "vf_explained_var": -0.010885361582040787, "kl": 0.07148000292363577, "entropy": 0.39480136055499315, "entropy_coeff": 0.0}}, "num_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 114, "training_iteration": 285, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-34-38", "timestamp": 1618144478, "time_this_iter_s": 19.025032997131348, "time_total_s": 5823.364974021912, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710a9a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5823.364974021912, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 58.574999999999996, "ram_util_percent": 27.396428571428565}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5869189656164426, "mean_raw_obs_processing_ms": 0.09472163888627001, "mean_inference_ms": 1.453758358222456, "mean_action_processing_ms": 0.040357395583875195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1144000, "timers": {"sample_time_ms": 7676.689, "sample_throughput": 521.058, "learn_time_ms": 11653.507, "learn_throughput": 343.244, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04505081176757813, "cur_lr": 5e-05, "total_loss": 9.330134138464928, "policy_loss": -0.06466307438677177, "vf_loss": 9.393353059887886, "vf_explained_var": 0.500186562538147, "kl": 0.0320547127048485, "entropy": 0.32407087460160255, "entropy_coeff": 0.0}}, "num_steps_sampled": 1144000, "num_steps_trained": 1144000}, "done": false, "episodes_total": 114, "training_iteration": 286, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-34-58", "timestamp": 1618144498, "time_this_iter_s": 20.346231698989868, "time_total_s": 5843.7112057209015, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710cac90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5843.7112057209015, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 58.4448275862069, "ram_util_percent": 27.299999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5869189656164426, "mean_raw_obs_processing_ms": 0.09472163888627001, "mean_inference_ms": 1.453758358222456, "mean_action_processing_ms": 0.040357395583875195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1148000, "timers": {"sample_time_ms": 7495.334, "sample_throughput": 533.665, "learn_time_ms": 11644.155, "learn_throughput": 343.52, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06757621765136719, "cur_lr": 5e-05, "total_loss": 2.2362270168960094, "policy_loss": -0.05898517181049101, "vf_loss": 2.2872671633958817, "vf_explained_var": 0.606514573097229, "kl": 0.11757169151678681, "entropy": 0.3780159670859575, "entropy_coeff": 0.0}}, "num_steps_sampled": 1148000, "num_steps_trained": 1148000}, "done": false, "episodes_total": 114, "training_iteration": 287, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-35-17", "timestamp": 1618144517, "time_this_iter_s": 18.944651126861572, "time_total_s": 5862.655856847763, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710caf90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5862.655856847763, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 57.73703703703704, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -504.0, "episode_reward_min": -504.0, "episode_reward_mean": -504.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-504.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.584356162910786, "mean_raw_obs_processing_ms": 0.09499589241179088, "mean_inference_ms": 1.4537228429988986, "mean_action_processing_ms": 0.04035505750498442}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1152000, "timers": {"sample_time_ms": 7529.678, "sample_throughput": 531.231, "learn_time_ms": 11649.726, "learn_throughput": 343.356, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10136432647705079, "cur_lr": 5e-05, "total_loss": 3.4787654280662537, "policy_loss": -0.047194216487696394, "vf_loss": 3.522937022149563, "vf_explained_var": 0.7253588438034058, "kl": 0.029819559887982905, "entropy": 0.33716256357729435, "entropy_coeff": 0.0}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 115, "training_iteration": 288, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-35-36", "timestamp": 1618144536, "time_this_iter_s": 19.19909644126892, "time_total_s": 5881.854953289032, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119bc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5881.854953289032, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 58.75185185185185, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -504.0, "episode_reward_min": -504.0, "episode_reward_mean": -504.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-504.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.584356162910786, "mean_raw_obs_processing_ms": 0.09499589241179088, "mean_inference_ms": 1.4537228429988986, "mean_action_processing_ms": 0.04035505750498442}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1156000, "timers": {"sample_time_ms": 7579.848, "sample_throughput": 527.715, "learn_time_ms": 11639.514, "learn_throughput": 343.657, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1520464897155762, "cur_lr": 5e-05, "total_loss": 4.290140889585018, "policy_loss": -0.03377606347203255, "vf_loss": 4.322126269340515, "vf_explained_var": 0.5043701529502869, "kl": 0.011777174222515896, "entropy": 0.08974955580197275, "entropy_coeff": 0.0}}, "num_steps_sampled": 1156000, "num_steps_trained": 1156000}, "done": false, "episodes_total": 115, "training_iteration": 289, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-35-56", "timestamp": 1618144556, "time_this_iter_s": 19.3523108959198, "time_total_s": 5901.207264184952, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5901.207264184952, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 57.81428571428571, "ram_util_percent": 27.303571428571423}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -256.0, "episode_reward_min": -256.0, "episode_reward_mean": -256.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5821461260939825, "mean_raw_obs_processing_ms": 0.09518292089451884, "mean_inference_ms": 1.4536446254772426, "mean_action_processing_ms": 0.04035192907920016}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1160000, "timers": {"sample_time_ms": 7599.525, "sample_throughput": 526.349, "learn_time_ms": 11642.206, "learn_throughput": 343.578, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1520464897155762, "cur_lr": 5e-05, "total_loss": 1.8640705663710833, "policy_loss": -0.0027763588877860457, "vf_loss": 1.8667494785040617, "vf_explained_var": 0.26384833455085754, "kl": 0.0006407509389418919, "entropy": 0.004576363486194168, "entropy_coeff": 0.0}}, "num_steps_sampled": 1160000, "num_steps_trained": 1160000}, "done": false, "episodes_total": 116, "training_iteration": 290, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-36-15", "timestamp": 1618144575, "time_this_iter_s": 19.04698872566223, "time_total_s": 5920.254252910614, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710c0050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5920.254252910614, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 58.84074074074074, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -256.0, "episode_reward_min": -256.0, "episode_reward_mean": -256.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5821461260939825, "mean_raw_obs_processing_ms": 0.09518292089451884, "mean_inference_ms": 1.4536446254772426, "mean_action_processing_ms": 0.04035192907920016}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1164000, "timers": {"sample_time_ms": 7585.448, "sample_throughput": 527.325, "learn_time_ms": 11637.255, "learn_throughput": 343.724, "update_time_ms": 3.217}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0760232448577881, "cur_lr": 5e-05, "total_loss": 3.095646284520626, "policy_loss": -0.057140411459840834, "vf_loss": 3.1507535576820374, "vf_explained_var": 0.4477681517601013, "kl": 0.026744167204014957, "entropy": 0.3083998477086425, "entropy_coeff": 0.0}}, "num_steps_sampled": 1164000, "num_steps_trained": 1164000}, "done": false, "episodes_total": 116, "training_iteration": 291, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-36-34", "timestamp": 1618144594, "time_this_iter_s": 19.25336241722107, "time_total_s": 5939.507615327835, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffdb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5939.507615327835, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 57.63928571428572, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -256.0, "episode_reward_min": -256.0, "episode_reward_mean": -256.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5821461260939825, "mean_raw_obs_processing_ms": 0.09518292089451884, "mean_inference_ms": 1.4536446254772426, "mean_action_processing_ms": 0.04035192907920016}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1168000, "timers": {"sample_time_ms": 7581.735, "sample_throughput": 527.584, "learn_time_ms": 11635.074, "learn_throughput": 343.788, "update_time_ms": 3.203}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11403486728668213, "cur_lr": 5e-05, "total_loss": 2.5929752700030804, "policy_loss": -0.04681909232749604, "vf_loss": 2.636596627533436, "vf_explained_var": 0.36745089292526245, "kl": 0.028041881450917572, "entropy": 0.19421081990003586, "entropy_coeff": 0.0}}, "num_steps_sampled": 1168000, "num_steps_trained": 1168000}, "done": false, "episodes_total": 116, "training_iteration": 292, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-36-53", "timestamp": 1618144613, "time_this_iter_s": 18.92161726951599, "time_total_s": 5958.429232597351, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710a90d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710a9090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5958.429232597351, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 58.51111111111111, "ram_util_percent": 27.362962962962957}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -264.0, "episode_reward_min": -264.0, "episode_reward_mean": -264.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.578991930137281, "mean_raw_obs_processing_ms": 0.09543475431745538, "mean_inference_ms": 1.4534922312574827, "mean_action_processing_ms": 0.040341803399819284}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1172000, "timers": {"sample_time_ms": 7599.66, "sample_throughput": 526.339, "learn_time_ms": 11652.156, "learn_throughput": 343.284, "update_time_ms": 3.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.17105230093002322, "cur_lr": 5e-05, "total_loss": 1.8549775443971157, "policy_loss": -0.036576085549313575, "vf_loss": 1.8890640288591385, "vf_explained_var": 0.5105509757995605, "kl": 0.014554536755895242, "entropy": 0.136409527156502, "entropy_coeff": 0.0}}, "num_steps_sampled": 1172000, "num_steps_trained": 1172000}, "done": false, "episodes_total": 117, "training_iteration": 293, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-37-13", "timestamp": 1618144633, "time_this_iter_s": 19.608717679977417, "time_total_s": 5978.0379502773285, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ea90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267861150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5978.0379502773285, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 59.160714285714285, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -264.0, "episode_reward_min": -264.0, "episode_reward_mean": -264.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.578991930137281, "mean_raw_obs_processing_ms": 0.09543475431745538, "mean_inference_ms": 1.4534922312574827, "mean_action_processing_ms": 0.040341803399819284}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1176000, "timers": {"sample_time_ms": 7597.318, "sample_throughput": 526.502, "learn_time_ms": 11656.428, "learn_throughput": 343.158, "update_time_ms": 3.208}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.17105230093002322, "cur_lr": 5e-05, "total_loss": 1.5016242042183876, "policy_loss": -0.05293352040462196, "vf_loss": 1.549879752099514, "vf_explained_var": 0.5387707948684692, "kl": 0.027348176576197147, "entropy": 0.41683229338377714, "entropy_coeff": 0.0}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 117, "training_iteration": 294, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-37-32", "timestamp": 1618144652, "time_this_iter_s": 18.937976360321045, "time_total_s": 5996.9759266376495, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d6c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d6510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5996.9759266376495, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 57.91481481481482, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -264.0, "episode_reward_min": -264.0, "episode_reward_mean": -264.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57694470905015, "mean_raw_obs_processing_ms": 0.09560921454548613, "mean_inference_ms": 1.4532623201257167, "mean_action_processing_ms": 0.04033497002627362}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1180000, "timers": {"sample_time_ms": 7635.778, "sample_throughput": 523.85, "learn_time_ms": 11656.103, "learn_throughput": 343.168, "update_time_ms": 3.254}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5e-05, "total_loss": 1.2131206281483173, "policy_loss": -0.036724391247844324, "vf_loss": 1.244646580889821, "vf_explained_var": 0.6739290952682495, "kl": 0.020260606397641823, "entropy": 0.31498940847814083, "entropy_coeff": 0.0}}, "num_steps_sampled": 1180000, "num_steps_trained": 1180000}, "done": false, "episodes_total": 118, "training_iteration": 295, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-37-51", "timestamp": 1618144671, "time_this_iter_s": 19.408175706863403, "time_total_s": 6016.384102344513, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172246310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6016.384102344513, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 58.66296296296296, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -264.0, "episode_reward_min": -264.0, "episode_reward_mean": -264.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57694470905015, "mean_raw_obs_processing_ms": 0.09560921454548613, "mean_inference_ms": 1.4532623201257167, "mean_action_processing_ms": 0.04033497002627362}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1184000, "timers": {"sample_time_ms": 7489.107, "sample_throughput": 534.109, "learn_time_ms": 11655.935, "learn_throughput": 343.173, "update_time_ms": 3.252}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3848676770925522, "cur_lr": 5e-05, "total_loss": 1.00111254863441, "policy_loss": -0.07528234728670213, "vf_loss": 1.0507545061409473, "vf_explained_var": 0.594383955001831, "kl": 0.06662128027528524, "entropy": 0.4355301922187209, "entropy_coeff": 0.0}}, "num_steps_sampled": 1184000, "num_steps_trained": 1184000}, "done": false, "episodes_total": 118, "training_iteration": 296, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-38-10", "timestamp": 1618144690, "time_this_iter_s": 18.881118774414062, "time_total_s": 6035.265221118927, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffdcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6035.265221118927, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 57.974074074074075, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -264.0, "episode_reward_min": -264.0, "episode_reward_mean": -264.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57694470905015, "mean_raw_obs_processing_ms": 0.09560921454548613, "mean_inference_ms": 1.4532623201257167, "mean_action_processing_ms": 0.04033497002627362}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1188000, "timers": {"sample_time_ms": 7497.654, "sample_throughput": 533.5, "learn_time_ms": 11665.829, "learn_throughput": 342.882, "update_time_ms": 3.22}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.9977927152067423, "policy_loss": -0.048349138494813815, "vf_loss": 1.03768047131598, "vf_explained_var": 0.5850957632064819, "kl": 0.014656799263320863, "entropy": 0.46907944045960903, "entropy_coeff": 0.0}}, "num_steps_sampled": 1188000, "num_steps_trained": 1188000}, "done": false, "episodes_total": 118, "training_iteration": 297, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-38-29", "timestamp": 1618144709, "time_this_iter_s": 19.126251220703125, "time_total_s": 6054.39147233963, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ea10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6054.39147233963, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 58.557142857142864, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -193.0, "episode_reward_min": -193.0, "episode_reward_mean": -193.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5734576394382598, "mean_raw_obs_processing_ms": 0.0958756160153079, "mean_inference_ms": 1.4531356854541153, "mean_action_processing_ms": 0.04032989773257239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1192000, "timers": {"sample_time_ms": 7492.586, "sample_throughput": 533.861, "learn_time_ms": 11666.636, "learn_throughput": 342.858, "update_time_ms": 3.188}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.9203626625239849, "policy_loss": -0.04640178248519078, "vf_loss": 0.9572609700262547, "vf_explained_var": 0.42964327335357666, "kl": 0.0164619293063879, "entropy": 0.30798584036529064, "entropy_coeff": 0.0}}, "num_steps_sampled": 1192000, "num_steps_trained": 1192000}, "done": false, "episodes_total": 119, "training_iteration": 298, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-38-48", "timestamp": 1618144728, "time_this_iter_s": 19.15616750717163, "time_total_s": 6073.547639846802, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717223fa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6073.547639846802, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 58.025925925925925, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -193.0, "episode_reward_min": -193.0, "episode_reward_mean": -193.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5734576394382598, "mean_raw_obs_processing_ms": 0.0958756160153079, "mean_inference_ms": 1.4531356854541153, "mean_action_processing_ms": 0.04032989773257239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1196000, "timers": {"sample_time_ms": 7486.109, "sample_throughput": 534.323, "learn_time_ms": 11661.912, "learn_throughput": 342.997, "update_time_ms": 3.176}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.6259762113913894, "policy_loss": -0.049953147768974304, "vf_loss": 0.6656033471226692, "vf_explained_var": 0.5770485401153564, "kl": 0.01788670086534694, "entropy": 0.4163794545456767, "entropy_coeff": 0.0}}, "num_steps_sampled": 1196000, "num_steps_trained": 1196000}, "done": false, "episodes_total": 119, "training_iteration": 299, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-39-07", "timestamp": 1618144747, "time_this_iter_s": 19.238205194473267, "time_total_s": 6092.785845041275, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6092.785845041275, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 58.688888888888876, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -213.0, "episode_reward_min": -213.0, "episode_reward_mean": -213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5712506405514783, "mean_raw_obs_processing_ms": 0.09607027213813331, "mean_inference_ms": 1.4532997756041959, "mean_action_processing_ms": 0.04033332225278718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1200000, "timers": {"sample_time_ms": 7507.004, "sample_throughput": 532.836, "learn_time_ms": 11643.984, "learn_throughput": 343.525, "update_time_ms": 3.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.9267811942845583, "policy_loss": -0.05743648181669414, "vf_loss": 0.9744943622499704, "vf_explained_var": 0.5239954590797424, "kl": 0.016842707729665563, "entropy": 0.49803527537733316, "entropy_coeff": 0.0}}, "num_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 120, "training_iteration": 300, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-39-27", "timestamp": 1618144767, "time_this_iter_s": 19.07647728919983, "time_total_s": 6111.862322330475, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266809590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6111.862322330475, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 58.017857142857146, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -213.0, "episode_reward_min": -213.0, "episode_reward_mean": -213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5712506405514783, "mean_raw_obs_processing_ms": 0.09607027213813331, "mean_inference_ms": 1.4532997756041959, "mean_action_processing_ms": 0.04033332225278718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1204000, "timers": {"sample_time_ms": 7507.062, "sample_throughput": 532.832, "learn_time_ms": 11633.678, "learn_throughput": 343.829, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.7158760502934456, "policy_loss": -0.057517957931850106, "vf_loss": 0.7646928615868092, "vf_explained_var": 0.4674317240715027, "kl": 0.015072094247443601, "entropy": 0.4874856472015381, "entropy_coeff": 0.0}}, "num_steps_sampled": 1204000, "num_steps_trained": 1204000}, "done": false, "episodes_total": 120, "training_iteration": 301, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-39-46", "timestamp": 1618144786, "time_this_iter_s": 19.146008253097534, "time_total_s": 6131.008330583572, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6131.008330583572, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 58.7962962962963, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -213.0, "episode_reward_min": -213.0, "episode_reward_mean": -213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5712506405514783, "mean_raw_obs_processing_ms": 0.09607027213813331, "mean_inference_ms": 1.4532997756041959, "mean_action_processing_ms": 0.04033332225278718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1208000, "timers": {"sample_time_ms": 7533.003, "sample_throughput": 530.997, "learn_time_ms": 11646.385, "learn_throughput": 343.454, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.449819587636739, "policy_loss": -0.0576689995941706, "vf_loss": 0.4999442733824253, "vf_explained_var": 0.4971316456794739, "kl": 0.013068248052150011, "entropy": 0.5075277900323272, "entropy_coeff": 0.0}}, "num_steps_sampled": 1208000, "num_steps_trained": 1208000}, "done": false, "episodes_total": 120, "training_iteration": 302, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-40-05", "timestamp": 1618144805, "time_this_iter_s": 19.30864906311035, "time_total_s": 6150.316979646683, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221f810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6150.316979646683, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 58.65714285714285, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -148.0, "episode_reward_min": -148.0, "episode_reward_mean": -148.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-148.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.568156658811981, "mean_raw_obs_processing_ms": 0.09634625811279886, "mean_inference_ms": 1.453254381148598, "mean_action_processing_ms": 0.04032947990483205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1212000, "timers": {"sample_time_ms": 7506.49, "sample_throughput": 532.872, "learn_time_ms": 11641.481, "learn_throughput": 343.599, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.5333806262351573, "policy_loss": -0.05563542898744345, "vf_loss": 0.578776441514492, "vf_explained_var": 0.4180482029914856, "kl": 0.01773702263017185, "entropy": 0.5014959685504436, "entropy_coeff": 0.0}}, "num_steps_sampled": 1212000, "num_steps_trained": 1212000}, "done": false, "episodes_total": 121, "training_iteration": 303, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-40-24", "timestamp": 1618144824, "time_this_iter_s": 19.295869827270508, "time_total_s": 6169.612849473953, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266305fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6169.612849473953, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 58.162962962962965, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -148.0, "episode_reward_min": -148.0, "episode_reward_mean": -148.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-148.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.568156658811981, "mean_raw_obs_processing_ms": 0.09634625811279886, "mean_inference_ms": 1.453254381148598, "mean_action_processing_ms": 0.04032947990483205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1216000, "timers": {"sample_time_ms": 7530.77, "sample_throughput": 531.154, "learn_time_ms": 11632.214, "learn_throughput": 343.873, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.2642611633054912, "policy_loss": -0.02939739587600343, "vf_loss": 0.2854386568069458, "vf_explained_var": 0.4329414963722229, "kl": 0.014238488889532164, "entropy": 0.3313740575686097, "entropy_coeff": 0.0}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 121, "training_iteration": 304, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-40-44", "timestamp": 1618144844, "time_this_iter_s": 19.08831524848938, "time_total_s": 6188.701164722443, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6188.701164722443, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 58.78928571428571, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -70.0, "episode_reward_min": -70.0, "episode_reward_mean": -70.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5658782532048184, "mean_raw_obs_processing_ms": 0.09653690117204566, "mean_inference_ms": 1.4532466039583245, "mean_action_processing_ms": 0.04033047798065179}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1220000, "timers": {"sample_time_ms": 7492.442, "sample_throughput": 533.871, "learn_time_ms": 11626.132, "learn_throughput": 344.053, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.6484444113448262, "policy_loss": -0.05183299569762312, "vf_loss": 0.6906172661110759, "vf_explained_var": 0.3668191432952881, "kl": 0.016733280499465764, "entropy": 0.5305095845833421, "entropy_coeff": 0.0}}, "num_steps_sampled": 1220000, "num_steps_trained": 1220000}, "done": false, "episodes_total": 122, "training_iteration": 305, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-41-03", "timestamp": 1618144863, "time_this_iter_s": 18.96181559562683, "time_total_s": 6207.6629803180695, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6207.6629803180695, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 57.8074074074074, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -70.0, "episode_reward_min": -70.0, "episode_reward_mean": -70.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5658782532048184, "mean_raw_obs_processing_ms": 0.09653690117204566, "mean_inference_ms": 1.4532466039583245, "mean_action_processing_ms": 0.04033047798065179}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1224000, "timers": {"sample_time_ms": 7532.005, "sample_throughput": 531.067, "learn_time_ms": 11621.107, "learn_throughput": 344.201, "update_time_ms": 2.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.267967744381167, "policy_loss": -0.04775973892537877, "vf_loss": 0.3087389846332371, "vf_explained_var": 0.4263894557952881, "kl": 0.012105463654734194, "entropy": 0.3986099697649479, "entropy_coeff": 0.0}}, "num_steps_sampled": 1224000, "num_steps_trained": 1224000}, "done": false, "episodes_total": 122, "training_iteration": 306, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-41-22", "timestamp": 1618144882, "time_this_iter_s": 19.224063396453857, "time_total_s": 6226.887043714523, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6226.887043714523, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 58.851851851851855, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -70.0, "episode_reward_min": -70.0, "episode_reward_mean": -70.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5658782532048184, "mean_raw_obs_processing_ms": 0.09653690117204566, "mean_inference_ms": 1.4532466039583245, "mean_action_processing_ms": 0.04033047798065179}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1228000, "timers": {"sample_time_ms": 7539.096, "sample_throughput": 530.568, "learn_time_ms": 11620.958, "learn_throughput": 344.206, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.21788131562061608, "policy_loss": -0.043952155800070614, "vf_loss": 0.2522265096195042, "vf_explained_var": 0.3477667570114136, "kl": 0.01664114504819736, "entropy": 0.5528762433677912, "entropy_coeff": 0.0}}, "num_steps_sampled": 1228000, "num_steps_trained": 1228000}, "done": false, "episodes_total": 122, "training_iteration": 307, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-41-41", "timestamp": 1618144901, "time_this_iter_s": 19.198570728302002, "time_total_s": 6246.085614442825, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6246.085614442825, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 57.917857142857144, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -38.0, "episode_reward_min": -38.0, "episode_reward_mean": -38.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5626648623859181, "mean_raw_obs_processing_ms": 0.09682249324217812, "mean_inference_ms": 1.4532673319351783, "mean_action_processing_ms": 0.04033084617035935}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1232000, "timers": {"sample_time_ms": 7522.622, "sample_throughput": 531.729, "learn_time_ms": 11626.166, "learn_throughput": 344.052, "update_time_ms": 2.936}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.11226957413600758, "policy_loss": -0.05142812634585425, "vf_loss": 0.1558152218349278, "vf_explained_var": 0.3051479756832123, "kl": 0.01365401511429809, "entropy": 0.46883927192538977, "entropy_coeff": 0.0}}, "num_steps_sampled": 1232000, "num_steps_trained": 1232000}, "done": false, "episodes_total": 123, "training_iteration": 308, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-42-00", "timestamp": 1618144920, "time_this_iter_s": 19.042557954788208, "time_total_s": 6265.1281723976135, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172265210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6265.1281723976135, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 58.61111111111112, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -38.0, "episode_reward_min": -38.0, "episode_reward_mean": -38.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5626648623859181, "mean_raw_obs_processing_ms": 0.09682249324217812, "mean_inference_ms": 1.4532673319351783, "mean_action_processing_ms": 0.04033084617035935}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1236000, "timers": {"sample_time_ms": 7477.213, "sample_throughput": 534.959, "learn_time_ms": 11631.192, "learn_throughput": 343.903, "update_time_ms": 2.942}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.0631702957325615, "policy_loss": -0.0379100515274331, "vf_loss": 0.09755824692547321, "vf_explained_var": 0.5028642416000366, "kl": 0.006100979007896967, "entropy": 0.23652657587081194, "entropy_coeff": 0.0}}, "num_steps_sampled": 1236000, "num_steps_trained": 1236000}, "done": false, "episodes_total": 123, "training_iteration": 309, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-42-19", "timestamp": 1618144939, "time_this_iter_s": 18.83399271965027, "time_total_s": 6283.962165117264, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717223fad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6283.962165117264, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 57.944444444444436, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.560336311936218, "mean_raw_obs_processing_ms": 0.09701055194259726, "mean_inference_ms": 1.4532010583787172, "mean_action_processing_ms": 0.04032797214527767}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1240000, "timers": {"sample_time_ms": 7462.951, "sample_throughput": 535.981, "learn_time_ms": 11645.168, "learn_throughput": 343.49, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.13252159964758903, "policy_loss": -0.027889634831808507, "vf_loss": 0.15588894137181342, "vf_explained_var": 0.3461436629295349, "kl": 0.007833501338609494, "entropy": 0.31054991763085127, "entropy_coeff": 0.0}}, "num_steps_sampled": 1240000, "num_steps_trained": 1240000}, "done": false, "episodes_total": 124, "training_iteration": 310, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-42-38", "timestamp": 1618144958, "time_this_iter_s": 19.071421146392822, "time_total_s": 6303.033586263657, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6303.033586263657, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 59.10740740740741, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.560336311936218, "mean_raw_obs_processing_ms": 0.09701055194259726, "mean_inference_ms": 1.4532010583787172, "mean_action_processing_ms": 0.04032797214527767}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1244000, "timers": {"sample_time_ms": 7425.722, "sample_throughput": 538.668, "learn_time_ms": 11646.104, "learn_throughput": 343.462, "update_time_ms": 2.921}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.051630239497171715, "policy_loss": -0.051895265525672585, "vf_loss": 0.09396180231124163, "vf_explained_var": 0.506144642829895, "kl": 0.016566215112106875, "entropy": 0.44630226120352745, "entropy_coeff": 0.0}}, "num_steps_sampled": 1244000, "num_steps_trained": 1244000}, "done": false, "episodes_total": 124, "training_iteration": 311, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-42-57", "timestamp": 1618144977, "time_this_iter_s": 18.784186124801636, "time_total_s": 6321.817772388458, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6321.817772388458, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 57.87407407407407, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.560336311936218, "mean_raw_obs_processing_ms": 0.09701055194259726, "mean_inference_ms": 1.4532010583787172, "mean_action_processing_ms": 0.04032797214527767}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1248000, "timers": {"sample_time_ms": 7411.05, "sample_throughput": 539.735, "learn_time_ms": 11639.184, "learn_throughput": 343.667, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.0029119611135683954, "policy_loss": -0.006044139270670712, "vf_loss": 0.004906064088572748, "vf_explained_var": -0.03178822249174118, "kl": 0.007015460621914826, "entropy": 0.34070025756955147, "entropy_coeff": 0.0}}, "num_steps_sampled": 1248000, "num_steps_trained": 1248000}, "done": false, "episodes_total": 124, "training_iteration": 312, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-43-16", "timestamp": 1618144996, "time_this_iter_s": 19.093398094177246, "time_total_s": 6340.9111704826355, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711190d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6340.9111704826355, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -7.0, "episode_reward_min": -7.0, "episode_reward_mean": -7.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5567360322086637, "mean_raw_obs_processing_ms": 0.09728417590033739, "mean_inference_ms": 1.4530958649971617, "mean_action_processing_ms": 0.040323194199146414}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1252000, "timers": {"sample_time_ms": 7368.473, "sample_throughput": 542.853, "learn_time_ms": 11640.485, "learn_throughput": 343.628, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.04088824923383072, "policy_loss": -0.0392060806916561, "vf_loss": 0.07406054512830451, "vf_explained_var": 0.3024934232234955, "kl": 0.010451704074512236, "entropy": 0.37454602774232626, "entropy_coeff": 0.0}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 125, "training_iteration": 313, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-43-35", "timestamp": 1618145015, "time_this_iter_s": 18.87948441505432, "time_total_s": 6359.79065489769, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6359.79065489769, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 58.13703703703703, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -7.0, "episode_reward_min": -7.0, "episode_reward_mean": -7.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5567360322086637, "mean_raw_obs_processing_ms": 0.09728417590033739, "mean_inference_ms": 1.4530958649971617, "mean_action_processing_ms": 0.040323194199146414}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1256000, "timers": {"sample_time_ms": 7362.616, "sample_throughput": 543.285, "learn_time_ms": 11635.5, "learn_throughput": 343.776, "update_time_ms": 2.871}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.07153858023229986, "policy_loss": -0.05288885024492629, "vf_loss": 0.11166113265790045, "vf_explained_var": 0.5093538761138916, "kl": 0.022113747254479676, "entropy": 0.4505775598809123, "entropy_coeff": 0.0}}, "num_steps_sampled": 1256000, "num_steps_trained": 1256000}, "done": false, "episodes_total": 125, "training_iteration": 314, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-43-54", "timestamp": 1618145034, "time_this_iter_s": 18.98327136039734, "time_total_s": 6378.773926258087, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffd810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6378.773926258087, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 58.925925925925924, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -3.0, "episode_reward_min": -3.0, "episode_reward_mean": -3.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5544112895463214, "mean_raw_obs_processing_ms": 0.0974873376476329, "mean_inference_ms": 1.4532551017273634, "mean_action_processing_ms": 0.04032659811784127}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1260000, "timers": {"sample_time_ms": 7369.087, "sample_throughput": 542.808, "learn_time_ms": 11653.911, "learn_throughput": 343.232, "update_time_ms": 2.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.009242013562470675, "policy_loss": -0.02530915179522708, "vf_loss": 0.026728915865533054, "vf_explained_var": 0.16231626272201538, "kl": 0.009033120411913842, "entropy": 0.34687749203294516, "entropy_coeff": 0.0}}, "num_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 126, "training_iteration": 315, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-44-13", "timestamp": 1618145053, "time_this_iter_s": 19.21391010284424, "time_total_s": 6397.987836360931, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171073210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172265210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6397.987836360931, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 57.92857142857143, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -3.0, "episode_reward_min": -3.0, "episode_reward_mean": -3.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5544112895463214, "mean_raw_obs_processing_ms": 0.0974873376476329, "mean_inference_ms": 1.4532551017273634, "mean_action_processing_ms": 0.04032659811784127}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1264000, "timers": {"sample_time_ms": 7353.012, "sample_throughput": 543.995, "learn_time_ms": 11652.402, "learn_throughput": 343.277, "update_time_ms": 2.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.07800157560268417, "policy_loss": -0.03361090837279335, "vf_loss": 0.10340883361641318, "vf_explained_var": 0.3313368260860443, "kl": 0.009473557118326426, "entropy": 0.4485713252797723, "entropy_coeff": 0.0}}, "num_steps_sampled": 1264000, "num_steps_trained": 1264000}, "done": false, "episodes_total": 126, "training_iteration": 316, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-44-32", "timestamp": 1618145072, "time_this_iter_s": 19.050576210021973, "time_total_s": 6417.038412570953, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6417.038412570953, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 59.066666666666656, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -3.0, "episode_reward_min": -3.0, "episode_reward_mean": -3.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5544112895463214, "mean_raw_obs_processing_ms": 0.0974873376476329, "mean_inference_ms": 1.4532551017273634, "mean_action_processing_ms": 0.04032659811784127}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1268000, "timers": {"sample_time_ms": 7305.707, "sample_throughput": 547.517, "learn_time_ms": 11652.674, "learn_throughput": 343.269, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": -0.016957400366663933, "policy_loss": -0.05451973021263257, "vf_loss": 0.024195669597247615, "vf_explained_var": 0.30628788471221924, "kl": 0.015435791719937697, "entropy": 0.47546281572431326, "entropy_coeff": 0.0}}, "num_steps_sampled": 1268000, "num_steps_trained": 1268000}, "done": false, "episodes_total": 126, "training_iteration": 317, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-44-51", "timestamp": 1618145091, "time_this_iter_s": 18.725433349609375, "time_total_s": 6435.763845920563, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171073950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6435.763845920563, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 58.534615384615385, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -6.0, "episode_reward_min": -6.0, "episode_reward_mean": -6.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5507566801330304, "mean_raw_obs_processing_ms": 0.0977673682277938, "mean_inference_ms": 1.453298087657251, "mean_action_processing_ms": 0.040324050650782754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1272000, "timers": {"sample_time_ms": 7290.548, "sample_throughput": 548.656, "learn_time_ms": 11653.871, "learn_throughput": 343.234, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.07247380111948587, "policy_loss": -0.039421882887836546, "vf_loss": 0.10503256774973124, "vf_explained_var": 0.3840498626232147, "kl": 0.007925515252281912, "entropy": 0.45495990198105574, "entropy_coeff": 0.0}}, "num_steps_sampled": 1272000, "num_steps_trained": 1272000}, "done": false, "episodes_total": 127, "training_iteration": 318, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-45-10", "timestamp": 1618145110, "time_this_iter_s": 18.903565406799316, "time_total_s": 6454.667411327362, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d63d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72664da6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6454.667411327362, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 59.0037037037037, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -6.0, "episode_reward_min": -6.0, "episode_reward_mean": -6.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5507566801330304, "mean_raw_obs_processing_ms": 0.0977673682277938, "mean_inference_ms": 1.453298087657251, "mean_action_processing_ms": 0.040324050650782754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1276000, "timers": {"sample_time_ms": 7291.449, "sample_throughput": 548.588, "learn_time_ms": 11652.25, "learn_throughput": 343.281, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.03929388694814406, "policy_loss": -0.05189180845627561, "vf_loss": 0.08172275603283197, "vf_explained_var": 0.4716224670410156, "kl": 0.010927782059297897, "entropy": 0.44905781373381615, "entropy_coeff": 0.0}}, "num_steps_sampled": 1276000, "num_steps_trained": 1276000}, "done": false, "episodes_total": 127, "training_iteration": 319, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-45-29", "timestamp": 1618145129, "time_this_iter_s": 18.826848030090332, "time_total_s": 6473.494259357452, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6473.494259357452, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 58.092592592592595, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 5.0, "episode_reward_min": 5.0, "episode_reward_mean": 5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5485733933963667, "mean_raw_obs_processing_ms": 0.09796084894284968, "mean_inference_ms": 1.453354240244347, "mean_action_processing_ms": 0.040325340789419004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1280000, "timers": {"sample_time_ms": 7307.558, "sample_throughput": 547.378, "learn_time_ms": 11655.211, "learn_throughput": 343.194, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.03274955274537206, "policy_loss": -0.04169901314890012, "vf_loss": 0.06165762129239738, "vf_explained_var": 0.5062358975410461, "kl": 0.014770960697205737, "entropy": 0.41182275488972664, "entropy_coeff": 0.0}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 128, "training_iteration": 320, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-45-48", "timestamp": 1618145148, "time_this_iter_s": 19.265915632247925, "time_total_s": 6492.7601749897, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6492.7601749897, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 58.99285714285715, "ram_util_percent": 27.399999999999995}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 5.0, "episode_reward_min": 5.0, "episode_reward_mean": 5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5485733933963667, "mean_raw_obs_processing_ms": 0.09796084894284968, "mean_inference_ms": 1.453354240244347, "mean_action_processing_ms": 0.040325340789419004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1284000, "timers": {"sample_time_ms": 7315.139, "sample_throughput": 546.811, "learn_time_ms": 11662.251, "learn_throughput": 342.987, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.048218402138445526, "policy_loss": -0.029546553385443985, "vf_loss": 0.0692847587633878, "vf_explained_var": 0.5766074061393738, "kl": 0.009792916200240143, "entropy": 0.3669244544580579, "entropy_coeff": 0.0}}, "num_steps_sampled": 1284000, "num_steps_trained": 1284000}, "done": false, "episodes_total": 128, "training_iteration": 321, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-46-07", "timestamp": 1618145167, "time_this_iter_s": 18.93246102333069, "time_total_s": 6511.692636013031, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710a3250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6511.692636013031, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 57.903703703703705, "ram_util_percent": 27.43333333333333}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 5.0, "episode_reward_min": 5.0, "episode_reward_mean": 5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5485733933963667, "mean_raw_obs_processing_ms": 0.09796084894284968, "mean_inference_ms": 1.453354240244347, "mean_action_processing_ms": 0.040325340789419004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1288000, "timers": {"sample_time_ms": 7327.57, "sample_throughput": 545.884, "learn_time_ms": 11665.504, "learn_throughput": 342.891, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.011812411074060947, "policy_loss": -0.04238460073247552, "vf_loss": 0.03679138436564244, "vf_explained_var": 0.45965903997421265, "kl": 0.02009998873108998, "entropy": 0.4468940766528249, "entropy_coeff": 0.0}}, "num_steps_sampled": 1288000, "num_steps_trained": 1288000}, "done": false, "episodes_total": 128, "training_iteration": 322, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-46-26", "timestamp": 1618145186, "time_this_iter_s": 19.24960684776306, "time_total_s": 6530.942242860794, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6530.942242860794, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 59.05, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5452353620523898, "mean_raw_obs_processing_ms": 0.09824196139787159, "mean_inference_ms": 1.4533718573634848, "mean_action_processing_ms": 0.04032602285460441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1292000, "timers": {"sample_time_ms": 7332.122, "sample_throughput": 545.545, "learn_time_ms": 11656.479, "learn_throughput": 343.157, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.044073878845665604, "policy_loss": -0.007920169562567025, "vf_loss": 0.04870817263145, "vf_explained_var": 0.5209798216819763, "kl": 0.002529681190935662, "entropy": 0.2098485017195344, "entropy_coeff": 0.0}}, "num_steps_sampled": 1292000, "num_steps_trained": 1292000}, "done": false, "episodes_total": 129, "training_iteration": 323, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-46-45", "timestamp": 1618145205, "time_this_iter_s": 18.836952686309814, "time_total_s": 6549.779195547104, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710a4d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6549.779195547104, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 58.03461538461538, "ram_util_percent": 27.48076923076923}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5452353620523898, "mean_raw_obs_processing_ms": 0.09824196139787159, "mean_inference_ms": 1.4533718573634848, "mean_action_processing_ms": 0.04032602285460441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1296000, "timers": {"sample_time_ms": 7344.199, "sample_throughput": 544.648, "learn_time_ms": 11688.236, "learn_throughput": 342.224, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6494642050936819, "cur_lr": 5e-05, "total_loss": 0.08312543667852879, "policy_loss": -0.054953351500444114, "vf_loss": 0.12061178759904578, "vf_explained_var": 0.5663999319076538, "kl": 0.026894477516179904, "entropy": 0.4789708871394396, "entropy_coeff": 0.0}}, "num_steps_sampled": 1296000, "num_steps_trained": 1296000}, "done": false, "episodes_total": 129, "training_iteration": 324, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-47-05", "timestamp": 1618145225, "time_this_iter_s": 19.41739559173584, "time_total_s": 6569.19659113884, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172265210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6569.19659113884, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 59.271428571428565, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 13.0, "episode_reward_min": 13.0, "episode_reward_mean": 13.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5432287281354707, "mean_raw_obs_processing_ms": 0.09842736944156255, "mean_inference_ms": 1.4533231358016376, "mean_action_processing_ms": 0.040323568467121026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1300000, "timers": {"sample_time_ms": 7327.016, "sample_throughput": 545.925, "learn_time_ms": 11672.117, "learn_throughput": 342.697, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": 0.002975789422634989, "policy_loss": -0.01786844665184617, "vf_loss": 0.01327566233521793, "vf_explained_var": 0.5730855464935303, "kl": 0.00776904565282166, "entropy": 0.33890095725655556, "entropy_coeff": 0.0}}, "num_steps_sampled": 1300000, "num_steps_trained": 1300000}, "done": false, "episodes_total": 130, "training_iteration": 325, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-47-24", "timestamp": 1618145244, "time_this_iter_s": 18.87983989715576, "time_total_s": 6588.0764310359955, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6588.0764310359955, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 57.98518518518518, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 13.0, "episode_reward_min": 13.0, "episode_reward_mean": 13.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5432287281354707, "mean_raw_obs_processing_ms": 0.09842736944156255, "mean_inference_ms": 1.4533231358016376, "mean_action_processing_ms": 0.040323568467121026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1304000, "timers": {"sample_time_ms": 7349.107, "sample_throughput": 544.284, "learn_time_ms": 11681.346, "learn_throughput": 342.426, "update_time_ms": 2.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": -0.011578096135053784, "policy_loss": -0.025745266873855144, "vf_loss": 0.006153665417514276, "vf_explained_var": -0.004607571288943291, "kl": 0.008225760167988483, "entropy": 0.36992637999355793, "entropy_coeff": 0.0}}, "num_steps_sampled": 1304000, "num_steps_trained": 1304000}, "done": false, "episodes_total": 130, "training_iteration": 326, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-47-43", "timestamp": 1618145263, "time_this_iter_s": 19.36190629005432, "time_total_s": 6607.43833732605, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ca5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6607.43833732605, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 58.72142857142857, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 13.0, "episode_reward_min": 13.0, "episode_reward_mean": 13.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5432287281354707, "mean_raw_obs_processing_ms": 0.09842736944156255, "mean_inference_ms": 1.4533231358016376, "mean_action_processing_ms": 0.040323568467121026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1308000, "timers": {"sample_time_ms": 7394.609, "sample_throughput": 540.935, "learn_time_ms": 11712.671, "learn_throughput": 341.51, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": -0.01064038637559861, "policy_loss": -0.016602829797193408, "vf_loss": 0.0018034821951005142, "vf_explained_var": -0.09782159328460693, "kl": 0.004269115990609862, "entropy": 0.317969867028296, "entropy_coeff": 0.0}}, "num_steps_sampled": 1308000, "num_steps_trained": 1308000}, "done": false, "episodes_total": 130, "training_iteration": 327, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-48-02", "timestamp": 1618145282, "time_this_iter_s": 19.4953293800354, "time_total_s": 6626.933666706085, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6626.933666706085, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 58.98214285714285, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5400697646677541, "mean_raw_obs_processing_ms": 0.09874480632642854, "mean_inference_ms": 1.4537014242960007, "mean_action_processing_ms": 0.04033466607044179}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1312000, "timers": {"sample_time_ms": 7417.488, "sample_throughput": 539.266, "learn_time_ms": 11752.749, "learn_throughput": 340.346, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": -0.002434099733363837, "policy_loss": -0.003659139620140195, "vf_loss": 0.0002891360813919164, "vf_explained_var": -0.43274986743927, "kl": 0.0019213883806514787, "entropy": 0.3235850427299738, "entropy_coeff": 0.0}}, "num_steps_sampled": 1312000, "num_steps_trained": 1312000}, "done": false, "episodes_total": 131, "training_iteration": 328, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-48-22", "timestamp": 1618145302, "time_this_iter_s": 19.53308367729187, "time_total_s": 6646.466750383377, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717107ee10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717107ea90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6646.466750383377, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 58.33571428571428, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5400697646677541, "mean_raw_obs_processing_ms": 0.09874480632642854, "mean_inference_ms": 1.4537014242960007, "mean_action_processing_ms": 0.04033466607044179}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1316000, "timers": {"sample_time_ms": 7469.325, "sample_throughput": 535.524, "learn_time_ms": 11787.191, "learn_throughput": 339.351, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2435490769101307, "cur_lr": 5e-05, "total_loss": -0.03656809916719794, "policy_loss": -0.06934883270878345, "vf_loss": 0.018289479980012402, "vf_explained_var": 0.5670586824417114, "kl": 0.059500351548194885, "entropy": 0.2942668395116925, "entropy_coeff": 0.0}}, "num_steps_sampled": 1316000, "num_steps_trained": 1316000}, "done": false, "episodes_total": 131, "training_iteration": 329, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-48-42", "timestamp": 1618145322, "time_this_iter_s": 19.692779779434204, "time_total_s": 6666.159530162811, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117ba10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221fc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6666.159530162811, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 58.96071428571428, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5381482566563676, "mean_raw_obs_processing_ms": 0.09895135452673975, "mean_inference_ms": 1.4538970934466169, "mean_action_processing_ms": 0.04034009409698247}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1320000, "timers": {"sample_time_ms": 7458.238, "sample_throughput": 536.32, "learn_time_ms": 11787.473, "learn_throughput": 339.343, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.36532361536519603, "cur_lr": 5e-05, "total_loss": 0.03457320178858936, "policy_loss": -0.023848271783208475, "vf_loss": 0.051068919245153666, "vf_explained_var": 0.49658718705177307, "kl": 0.02012614006525837, "entropy": 0.21187565522268414, "entropy_coeff": 0.0}}, "num_steps_sampled": 1320000, "num_steps_trained": 1320000}, "done": false, "episodes_total": 132, "training_iteration": 330, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-49-01", "timestamp": 1618145341, "time_this_iter_s": 19.15691351890564, "time_total_s": 6685.316443681717, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119bb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6685.316443681717, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 58.074074074074076, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5381482566563676, "mean_raw_obs_processing_ms": 0.09895135452673975, "mean_inference_ms": 1.4538970934466169, "mean_action_processing_ms": 0.04034009409698247}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1324000, "timers": {"sample_time_ms": 7500.091, "sample_throughput": 533.327, "learn_time_ms": 11785.736, "learn_throughput": 339.393, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 0.0005914571229368448, "policy_loss": -0.006420675490517169, "vf_loss": 0.004885008587734774, "vf_explained_var": -0.012690600007772446, "kl": 0.00388171870304177, "entropy": 0.029665339476196095, "entropy_coeff": 0.0}}, "num_steps_sampled": 1324000, "num_steps_trained": 1324000}, "done": false, "episodes_total": 132, "training_iteration": 331, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-49-20", "timestamp": 1618145360, "time_this_iter_s": 19.332613706588745, "time_total_s": 6704.649057388306, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6704.649057388306, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 59.003571428571426, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5381482566563676, "mean_raw_obs_processing_ms": 0.09895135452673975, "mean_inference_ms": 1.4538970934466169, "mean_action_processing_ms": 0.04034009409698247}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1328000, "timers": {"sample_time_ms": 7458.42, "sample_throughput": 536.307, "learn_time_ms": 11785.335, "learn_throughput": 339.405, "update_time_ms": 3.027}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27399271152389704, "cur_lr": 5e-05, "total_loss": -0.006918932544067502, "policy_loss": -0.04728017118759453, "vf_loss": 0.0005864629574716673, "vf_explained_var": 0.10488859564065933, "kl": 0.1451672720722854, "entropy": 0.29930818174034357, "entropy_coeff": 0.0}}, "num_steps_sampled": 1328000, "num_steps_trained": 1328000}, "done": false, "episodes_total": 132, "training_iteration": 332, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-49-39", "timestamp": 1618145379, "time_this_iter_s": 18.830214738845825, "time_total_s": 6723.4792721271515, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffdbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ea50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6723.4792721271515, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 58.07037037037036, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5350587612875405, "mean_raw_obs_processing_ms": 0.09924267465038213, "mean_inference_ms": 1.4540561377190477, "mean_action_processing_ms": 0.04034136290236282}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1332000, "timers": {"sample_time_ms": 7489.054, "sample_throughput": 534.113, "learn_time_ms": 11782.759, "learn_throughput": 339.479, "update_time_ms": 3.084}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.41098906728584556, "cur_lr": 5e-05, "total_loss": -0.002258876047562808, "policy_loss": -0.003895497735356912, "vf_loss": 0.00036090083312956267, "vf_explained_var": -0.06413240730762482, "kl": 0.00310403147523175, "entropy": 0.3001676630228758, "entropy_coeff": 0.0}}, "num_steps_sampled": 1332000, "num_steps_trained": 1332000}, "done": false, "episodes_total": 133, "training_iteration": 333, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-49-58", "timestamp": 1618145398, "time_this_iter_s": 19.115753650665283, "time_total_s": 6742.595025777817, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6742.595025777817, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5350587612875405, "mean_raw_obs_processing_ms": 0.09924267465038213, "mean_inference_ms": 1.4540561377190477, "mean_action_processing_ms": 0.04034136290236282}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1336000, "timers": {"sample_time_ms": 7458.852, "sample_throughput": 536.276, "learn_time_ms": 11769.534, "learn_throughput": 339.861, "update_time_ms": 3.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20549453364292278, "cur_lr": 5e-05, "total_loss": -0.06855944800190628, "policy_loss": -0.1122807891224511, "vf_loss": 0.020327639009337872, "vf_explained_var": 0.29669201374053955, "kl": 0.1138409913983196, "entropy": 0.5202709976583719, "entropy_coeff": 0.0}}, "num_steps_sampled": 1336000, "num_steps_trained": 1336000}, "done": false, "episodes_total": 133, "training_iteration": 334, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-50-17", "timestamp": 1618145417, "time_this_iter_s": 18.98592233657837, "time_total_s": 6761.580948114395, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6761.580948114395, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 58.13703703703703, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5329518730316282, "mean_raw_obs_processing_ms": 0.09941802825688718, "mean_inference_ms": 1.4539527234177583, "mean_action_processing_ms": 0.040336664366324854}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1340000, "timers": {"sample_time_ms": 7451.936, "sample_throughput": 536.773, "learn_time_ms": 11778.227, "learn_throughput": 339.61, "update_time_ms": 3.197}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30824180046438415, "cur_lr": 5e-05, "total_loss": 0.004255247855326161, "policy_loss": -0.02969610341824591, "vf_loss": 0.02471783250803128, "vf_explained_var": 0.5839376449584961, "kl": 0.029955437290482223, "entropy": 0.45716795418411493, "entropy_coeff": 0.0}}, "num_steps_sampled": 1340000, "num_steps_trained": 1340000}, "done": false, "episodes_total": 134, "training_iteration": 335, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-50-36", "timestamp": 1618145436, "time_this_iter_s": 18.895007848739624, "time_total_s": 6780.475955963135, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6780.475955963135, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 58.814814814814824, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5329518730316282, "mean_raw_obs_processing_ms": 0.09941802825688718, "mean_inference_ms": 1.4539527234177583, "mean_action_processing_ms": 0.040336664366324854}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1344000, "timers": {"sample_time_ms": 7420.852, "sample_throughput": 539.022, "learn_time_ms": 11775.267, "learn_throughput": 339.695, "update_time_ms": 3.262}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 0.23639881191775203, "policy_loss": -0.0483693148707971, "vf_loss": 0.2782114646397531, "vf_explained_var": 0.5645801424980164, "kl": 0.014180765763740055, "entropy": 0.42110882978886366, "entropy_coeff": 0.0}}, "num_steps_sampled": 1344000, "num_steps_trained": 1344000}, "done": false, "episodes_total": 134, "training_iteration": 336, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-50-55", "timestamp": 1618145455, "time_this_iter_s": 19.022366523742676, "time_total_s": 6799.498322486877, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110bad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717225b210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6799.498322486877, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 57.87777777777779, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5329518730316282, "mean_raw_obs_processing_ms": 0.09941802825688718, "mean_inference_ms": 1.4539527234177583, "mean_action_processing_ms": 0.040336664366324854}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1348000, "timers": {"sample_time_ms": 7415.475, "sample_throughput": 539.412, "learn_time_ms": 11740.268, "learn_throughput": 340.708, "update_time_ms": 3.269}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 0.20607871655374765, "policy_loss": -0.05213073769118637, "vf_loss": 0.24824550934135914, "vf_explained_var": 0.5061429142951965, "kl": 0.02155006883549504, "entropy": 0.4834226006641984, "entropy_coeff": 0.0}}, "num_steps_sampled": 1348000, "num_steps_trained": 1348000}, "done": false, "episodes_total": 134, "training_iteration": 337, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-51-14", "timestamp": 1618145474, "time_this_iter_s": 19.090444326400757, "time_total_s": 6818.588766813278, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffd6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6818.588766813278, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 58.84814814814814, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 41.0, "episode_reward_min": 41.0, "episode_reward_mean": 41.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5300540472262338, "mean_raw_obs_processing_ms": 0.09969383757737584, "mean_inference_ms": 1.4538821955362178, "mean_action_processing_ms": 0.04033259242117868}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1352000, "timers": {"sample_time_ms": 7397.709, "sample_throughput": 540.708, "learn_time_ms": 11691.676, "learn_throughput": 342.124, "update_time_ms": 3.308}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 0.1129192557418719, "policy_loss": -0.041967289231251925, "vf_loss": 0.14894992136396468, "vf_explained_var": 0.6886144280433655, "kl": 0.008559839632653166, "entropy": 0.28495155181735754, "entropy_coeff": 0.0}}, "num_steps_sampled": 1352000, "num_steps_trained": 1352000}, "done": false, "episodes_total": 135, "training_iteration": 338, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-51-33", "timestamp": 1618145493, "time_this_iter_s": 18.870702028274536, "time_total_s": 6837.459468841553, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6837.459468841553, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 58.26296296296296, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 41.0, "episode_reward_min": 41.0, "episode_reward_mean": 41.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5300540472262338, "mean_raw_obs_processing_ms": 0.09969383757737584, "mean_inference_ms": 1.4538821955362178, "mean_action_processing_ms": 0.04033259242117868}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1356000, "timers": {"sample_time_ms": 7360.525, "sample_throughput": 543.439, "learn_time_ms": 11660.343, "learn_throughput": 343.043, "update_time_ms": 3.335}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 0.09762367745861411, "policy_loss": -0.043723430775571615, "vf_loss": 0.12427318864502013, "vf_explained_var": 0.6239420771598816, "kl": 0.02461836126167327, "entropy": 0.3129601590335369, "entropy_coeff": 0.0}}, "num_steps_sampled": 1356000, "num_steps_trained": 1356000}, "done": false, "episodes_total": 135, "training_iteration": 339, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-51-52", "timestamp": 1618145512, "time_this_iter_s": 19.00680661201477, "time_total_s": 6856.4662754535675, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717107e950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6856.4662754535675, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 58.90714285714285, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 23.0, "episode_reward_min": 23.0, "episode_reward_mean": 23.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5281521705615587, "mean_raw_obs_processing_ms": 0.099868674509739, "mean_inference_ms": 1.4537772019849922, "mean_action_processing_ms": 0.040327686396315454}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1360000, "timers": {"sample_time_ms": 7340.194, "sample_throughput": 544.945, "learn_time_ms": 11657.794, "learn_throughput": 343.118, "update_time_ms": 3.336}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 0.13426911644637585, "policy_loss": -0.017434751440305263, "vf_loss": 0.14520522905513644, "vf_explained_var": 0.3910229206085205, "kl": 0.0062467939424095675, "entropy": 0.40883591771125793, "entropy_coeff": 0.0}}, "num_steps_sampled": 1360000, "num_steps_trained": 1360000}, "done": false, "episodes_total": 136, "training_iteration": 340, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-52-11", "timestamp": 1618145531, "time_this_iter_s": 18.928736686706543, "time_total_s": 6875.395012140274, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fe90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117b0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6875.395012140274, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 57.92592592592593, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 23.0, "episode_reward_min": 23.0, "episode_reward_mean": 23.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5281521705615587, "mean_raw_obs_processing_ms": 0.099868674509739, "mean_inference_ms": 1.4537772019849922, "mean_action_processing_ms": 0.040327686396315454}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1364000, "timers": {"sample_time_ms": 7357.403, "sample_throughput": 543.67, "learn_time_ms": 11655.697, "learn_throughput": 343.18, "update_time_ms": 3.324}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 0.46011485205963254, "policy_loss": -0.03491010388825089, "vf_loss": 0.4879392860457301, "vf_explained_var": 0.4494006931781769, "kl": 0.0068110679858364165, "entropy": 0.4371337713673711, "entropy_coeff": 0.0}}, "num_steps_sampled": 1364000, "num_steps_trained": 1364000}, "done": false, "episodes_total": 136, "training_iteration": 341, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-52-31", "timestamp": 1618145551, "time_this_iter_s": 19.484973430633545, "time_total_s": 6894.879985570908, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6894.879985570908, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 58.72142857142858, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 23.0, "episode_reward_min": 23.0, "episode_reward_mean": 23.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5281521705615587, "mean_raw_obs_processing_ms": 0.099868674509739, "mean_inference_ms": 1.4537772019849922, "mean_action_processing_ms": 0.040327686396315454}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1368000, "timers": {"sample_time_ms": 7372.16, "sample_throughput": 542.582, "learn_time_ms": 11667.077, "learn_throughput": 342.845, "update_time_ms": 3.244}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 0.03278155386215076, "policy_loss": -0.00886494037695229, "vf_loss": 0.038755202549509704, "vf_explained_var": 0.43197521567344666, "kl": 0.0027792443634098163, "entropy": 0.10156045923940837, "entropy_coeff": 0.0}}, "num_steps_sampled": 1368000, "num_steps_trained": 1368000}, "done": false, "episodes_total": 136, "training_iteration": 342, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-52-50", "timestamp": 1618145570, "time_this_iter_s": 19.088656902313232, "time_total_s": 6913.968642473221, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ea10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710a4950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6913.968642473221, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 59.22222222222222, "ram_util_percent": 27.54074074074074}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 36.0, "episode_reward_min": 36.0, "episode_reward_mean": 36.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5255779392111661, "mean_raw_obs_processing_ms": 0.10014073685016765, "mean_inference_ms": 1.45369000212135, "mean_action_processing_ms": 0.04032381384950794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1372000, "timers": {"sample_time_ms": 7352.13, "sample_throughput": 544.06, "learn_time_ms": 11673.115, "learn_throughput": 342.668, "update_time_ms": 3.212}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.19230706745292991, "policy_loss": -0.03876844677142799, "vf_loss": 0.22413397673517466, "vf_explained_var": 0.6008623242378235, "kl": 0.01334505234262906, "entropy": 0.297452200204134, "entropy_coeff": 0.0}}, "num_steps_sampled": 1372000, "num_steps_trained": 1372000}, "done": false, "episodes_total": 137, "training_iteration": 343, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-53-09", "timestamp": 1618145589, "time_this_iter_s": 18.977909564971924, "time_total_s": 6932.946552038193, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbe510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fbe6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6932.946552038193, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 58.11851851851853, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 36.0, "episode_reward_min": 36.0, "episode_reward_mean": 36.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5255779392111661, "mean_raw_obs_processing_ms": 0.10014073685016765, "mean_inference_ms": 1.45369000212135, "mean_action_processing_ms": 0.04032381384950794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1376000, "timers": {"sample_time_ms": 7364.726, "sample_throughput": 543.13, "learn_time_ms": 11667.467, "learn_throughput": 342.834, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.19191750674508512, "policy_loss": -0.05600957045680843, "vf_loss": 0.2365327589213848, "vf_explained_var": 0.5180948972702026, "kl": 0.021905506495386362, "entropy": 0.17706459341570735, "entropy_coeff": 0.0}}, "num_steps_sampled": 1376000, "num_steps_trained": 1376000}, "done": false, "episodes_total": 137, "training_iteration": 344, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-53-28", "timestamp": 1618145608, "time_this_iter_s": 19.053256273269653, "time_total_s": 6951.999808311462, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d6290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6951.999808311462, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 59.08148148148149, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 58.0, "episode_reward_min": 58.0, "episode_reward_mean": 58.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5237033262510307, "mean_raw_obs_processing_ms": 0.10032474151686228, "mean_inference_ms": 1.4535598066109314, "mean_action_processing_ms": 0.04032238546932216}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1380000, "timers": {"sample_time_ms": 7367.075, "sample_throughput": 542.956, "learn_time_ms": 11675.487, "learn_throughput": 342.598, "update_time_ms": 3.211}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.4855439863167703, "policy_loss": -0.058625874982681125, "vf_loss": 0.5241166441701353, "vf_explained_var": 0.45369952917099, "kl": 0.02570143749471754, "entropy": 0.4156636269763112, "entropy_coeff": 0.0}}, "num_steps_sampled": 1380000, "num_steps_trained": 1380000}, "done": false, "episodes_total": 138, "training_iteration": 345, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-53-47", "timestamp": 1618145627, "time_this_iter_s": 19.00097680091858, "time_total_s": 6971.000785112381, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6971.000785112381, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 58.04074074074074, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 58.0, "episode_reward_min": 58.0, "episode_reward_mean": 58.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5237033262510307, "mean_raw_obs_processing_ms": 0.10032474151686228, "mean_inference_ms": 1.4535598066109314, "mean_action_processing_ms": 0.04032238546932216}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1384000, "timers": {"sample_time_ms": 7360.785, "sample_throughput": 543.42, "learn_time_ms": 11689.556, "learn_throughput": 342.186, "update_time_ms": 3.163}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 0.2181217207107693, "policy_loss": -0.04175260034389794, "vf_loss": 0.2505544666200876, "vf_explained_var": 0.5186671018600464, "kl": 0.00796326909767231, "entropy": 0.4166534226387739, "entropy_coeff": 0.0}}, "num_steps_sampled": 1384000, "num_steps_trained": 1384000}, "done": false, "episodes_total": 138, "training_iteration": 346, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-54-06", "timestamp": 1618145646, "time_this_iter_s": 19.100104331970215, "time_total_s": 6990.100889444351, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbead0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6990.100889444351, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 58.925, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 58.0, "episode_reward_min": 58.0, "episode_reward_mean": 58.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5237033262510307, "mean_raw_obs_processing_ms": 0.10032474151686228, "mean_inference_ms": 1.4535598066109314, "mean_action_processing_ms": 0.04032238546932216}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1388000, "timers": {"sample_time_ms": 7402.582, "sample_throughput": 540.352, "learn_time_ms": 11681.914, "learn_throughput": 342.41, "update_time_ms": 3.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 0.816759567707777, "policy_loss": -0.035716693091671914, "vf_loss": 0.844172727316618, "vf_explained_var": 0.3893652856349945, "kl": 0.007094897860952187, "entropy": 0.3498565126210451, "entropy_coeff": 0.0}}, "num_steps_sampled": 1388000, "num_steps_trained": 1388000}, "done": false, "episodes_total": 138, "training_iteration": 347, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-54-26", "timestamp": 1618145666, "time_this_iter_s": 19.434852600097656, "time_total_s": 7009.535742044449, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7009.535742044449, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 58.26296296296296, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 54.0, "episode_reward_min": 54.0, "episode_reward_mean": 54.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5210080480325257, "mean_raw_obs_processing_ms": 0.10061633226935121, "mean_inference_ms": 1.4536739719409786, "mean_action_processing_ms": 0.04032338279956275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1392000, "timers": {"sample_time_ms": 7402.453, "sample_throughput": 540.361, "learn_time_ms": 11686.704, "learn_throughput": 342.269, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 0.41786171309649944, "policy_loss": -0.024964253330836073, "vf_loss": 0.43565212562680244, "vf_explained_var": 0.5146507620811462, "kl": 0.006129624183813576, "entropy": 0.4000551523640752, "entropy_coeff": 0.0}}, "num_steps_sampled": 1392000, "num_steps_trained": 1392000}, "done": false, "episodes_total": 139, "training_iteration": 348, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-54-45", "timestamp": 1618145685, "time_this_iter_s": 18.915884256362915, "time_total_s": 7028.451626300812, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d60d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114eb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7028.451626300812, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 59.02222222222222, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 54.0, "episode_reward_min": 54.0, "episode_reward_mean": 54.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5210080480325257, "mean_raw_obs_processing_ms": 0.10061633226935121, "mean_inference_ms": 1.4536739719409786, "mean_action_processing_ms": 0.04032338279956275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1396000, "timers": {"sample_time_ms": 7457.685, "sample_throughput": 536.36, "learn_time_ms": 11687.288, "learn_throughput": 342.252, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 1.8679241761565208, "policy_loss": -0.03650658659171313, "vf_loss": 1.8941745162010193, "vf_explained_var": 0.46324270963668823, "kl": 0.008763346733758226, "entropy": 0.43066899292171, "entropy_coeff": 0.0}}, "num_steps_sampled": 1396000, "num_steps_trained": 1396000}, "done": false, "episodes_total": 139, "training_iteration": 349, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-55-04", "timestamp": 1618145704, "time_this_iter_s": 19.565673351287842, "time_total_s": 7048.0172996521, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710a4d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710a40d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7048.0172996521, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 58.09642857142858, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 179.0, "episode_reward_min": 179.0, "episode_reward_mean": 179.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.519567210806637, "mean_raw_obs_processing_ms": 0.10080362204125351, "mean_inference_ms": 1.4537293632740833, "mean_action_processing_ms": 0.04032242738783045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1400000, "timers": {"sample_time_ms": 7477.547, "sample_throughput": 534.935, "learn_time_ms": 11681.178, "learn_throughput": 342.431, "update_time_ms": 3.074}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 1.3252997864037752, "policy_loss": -0.039591123699210584, "vf_loss": 1.3574820384383202, "vf_explained_var": 0.5566921234130859, "kl": 0.006330444368359167, "entropy": 0.2775361854583025, "entropy_coeff": 0.0}}, "num_steps_sampled": 1400000, "num_steps_trained": 1400000}, "done": false, "episodes_total": 140, "training_iteration": 350, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-55-23", "timestamp": 1618145723, "time_this_iter_s": 19.0625901222229, "time_total_s": 7067.0798897743225, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbeed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fbec50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7067.0798897743225, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 59.03703703703704, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 179.0, "episode_reward_min": 179.0, "episode_reward_mean": 179.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.519567210806637, "mean_raw_obs_processing_ms": 0.10080362204125351, "mean_inference_ms": 1.4537293632740833, "mean_action_processing_ms": 0.04032242738783045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1404000, "timers": {"sample_time_ms": 7450.499, "sample_throughput": 536.877, "learn_time_ms": 11675.202, "learn_throughput": 342.607, "update_time_ms": 3.058}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 0.6331470953300595, "policy_loss": -0.025080973689910024, "vf_loss": 0.6501318588852882, "vf_explained_var": 0.34145820140838623, "kl": 0.0069177348632365465, "entropy": 0.36435010377317667, "entropy_coeff": 0.0}}, "num_steps_sampled": 1404000, "num_steps_trained": 1404000}, "done": false, "episodes_total": 140, "training_iteration": 351, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-55-42", "timestamp": 1618145742, "time_this_iter_s": 19.1514732837677, "time_total_s": 7086.23136305809, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717107ee50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172265210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7086.23136305809, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 57.80357142857143, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 179.0, "episode_reward_min": 179.0, "episode_reward_mean": 179.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.519567210806637, "mean_raw_obs_processing_ms": 0.10080362204125351, "mean_inference_ms": 1.4537293632740833, "mean_action_processing_ms": 0.04032242738783045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1408000, "timers": {"sample_time_ms": 7519.648, "sample_throughput": 531.94, "learn_time_ms": 11659.28, "learn_throughput": 343.074, "update_time_ms": 3.029}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 0.7018030434846878, "policy_loss": -0.022009118052665144, "vf_loss": 0.7180501045659184, "vf_explained_var": 0.6852203011512756, "kl": 0.004923327949654777, "entropy": 0.30388468876481056, "entropy_coeff": 0.0}}, "num_steps_sampled": 1408000, "num_steps_trained": 1408000}, "done": false, "episodes_total": 140, "training_iteration": 352, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-56-02", "timestamp": 1618145762, "time_this_iter_s": 19.622354984283447, "time_total_s": 7105.853718042374, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7105.853718042374, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 58.68571428571429, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 94.0, "episode_reward_min": 94.0, "episode_reward_mean": 94.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5174349730008762, "mean_raw_obs_processing_ms": 0.10107221145339783, "mean_inference_ms": 1.4535906083859225, "mean_action_processing_ms": 0.04031661446639274}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1412000, "timers": {"sample_time_ms": 7512.724, "sample_throughput": 532.43, "learn_time_ms": 11666.887, "learn_throughput": 342.851, "update_time_ms": 2.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 0.37083506118506193, "policy_loss": -0.02727091603446752, "vf_loss": 0.3897915706038475, "vf_explained_var": 0.5094592571258545, "kl": 0.014208342792699113, "entropy": 0.14158817962743342, "entropy_coeff": 0.0}}, "num_steps_sampled": 1412000, "num_steps_trained": 1412000}, "done": false, "episodes_total": 141, "training_iteration": 353, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-56-21", "timestamp": 1618145781, "time_this_iter_s": 18.984388828277588, "time_total_s": 7124.838106870651, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fbead0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7124.838106870651, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 58.685185185185176, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 94.0, "episode_reward_min": 94.0, "episode_reward_mean": 94.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5174349730008762, "mean_raw_obs_processing_ms": 0.10107221145339783, "mean_inference_ms": 1.4535906083859225, "mean_action_processing_ms": 0.04031661446639274}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1416000, "timers": {"sample_time_ms": 7517.503, "sample_throughput": 532.092, "learn_time_ms": 11657.518, "learn_throughput": 343.126, "update_time_ms": 2.977}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 0.7165475115180016, "policy_loss": -0.04378274848568253, "vf_loss": 0.7511000400409102, "vf_explained_var": 0.5464218258857727, "kl": 0.015773359016748145, "entropy": 0.40453839488327503, "entropy_coeff": 0.0}}, "num_steps_sampled": 1416000, "num_steps_trained": 1416000}, "done": false, "episodes_total": 141, "training_iteration": 354, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-56-40", "timestamp": 1618145800, "time_this_iter_s": 19.009636163711548, "time_total_s": 7143.847743034363, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbec90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7143.847743034363, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 58.455555555555556, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 89.0, "episode_reward_min": 89.0, "episode_reward_mean": 89.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157598307009279, "mean_raw_obs_processing_ms": 0.10124470337158117, "mean_inference_ms": 1.4534554361904255, "mean_action_processing_ms": 0.040311740808135064}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1420000, "timers": {"sample_time_ms": 7524.83, "sample_throughput": 531.574, "learn_time_ms": 11692.443, "learn_throughput": 342.101, "update_time_ms": 2.917}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 1.2146350964903831, "policy_loss": -0.035671609512064606, "vf_loss": 1.2425175067037344, "vf_explained_var": 0.4824683368206024, "kl": 0.013310834605363198, "entropy": 0.36991116777062416, "entropy_coeff": 0.0}}, "num_steps_sampled": 1420000, "num_steps_trained": 1420000}, "done": false, "episodes_total": 142, "training_iteration": 355, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-57-00", "timestamp": 1618145820, "time_this_iter_s": 19.424670457839966, "time_total_s": 7163.272413492203, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119bc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266306a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7163.272413492203, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 59.510714285714286, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 89.0, "episode_reward_min": 89.0, "episode_reward_mean": 89.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157598307009279, "mean_raw_obs_processing_ms": 0.10124470337158117, "mean_inference_ms": 1.4534554361904255, "mean_action_processing_ms": 0.040311740808135064}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1424000, "timers": {"sample_time_ms": 7526.22, "sample_throughput": 531.475, "learn_time_ms": 11678.134, "learn_throughput": 342.52, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 1.1408269368112087, "policy_loss": -0.03228614485124126, "vf_loss": 1.1670186165720224, "vf_explained_var": 0.5706677436828613, "kl": 0.010414750824566, "entropy": 0.3066175514832139, "entropy_coeff": 0.0}}, "num_steps_sampled": 1424000, "num_steps_trained": 1424000}, "done": false, "episodes_total": 142, "training_iteration": 356, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-57-19", "timestamp": 1618145839, "time_this_iter_s": 18.96890902519226, "time_total_s": 7182.241322517395, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717225b9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7182.241322517395, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 58.05925925925926, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 89.0, "episode_reward_min": 89.0, "episode_reward_mean": 89.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5157598307009279, "mean_raw_obs_processing_ms": 0.10124470337158117, "mean_inference_ms": 1.4534554361904255, "mean_action_processing_ms": 0.040311740808135064}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1428000, "timers": {"sample_time_ms": 7469.296, "sample_throughput": 535.526, "learn_time_ms": 11695.203, "learn_throughput": 342.021, "update_time_ms": 2.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 0.45845409482717514, "policy_loss": -0.0308555603842251, "vf_loss": 0.48338235076516867, "vf_explained_var": 0.5888930559158325, "kl": 0.010129078626050614, "entropy": 0.3001428381539881, "entropy_coeff": 0.0}}, "num_steps_sampled": 1428000, "num_steps_trained": 1428000}, "done": false, "episodes_total": 142, "training_iteration": 357, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-57-38", "timestamp": 1618145858, "time_this_iter_s": 19.038763523101807, "time_total_s": 7201.280086040497, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7201.280086040497, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 59.22222222222223, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 106.0, "episode_reward_min": 106.0, "episode_reward_mean": 106.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5130954790917155, "mean_raw_obs_processing_ms": 0.10151012936711618, "mean_inference_ms": 1.4532522771641798, "mean_action_processing_ms": 0.04030584006087304}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1432000, "timers": {"sample_time_ms": 7462.468, "sample_throughput": 536.016, "learn_time_ms": 11707.468, "learn_throughput": 341.662, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 0.7519117249175906, "policy_loss": -0.02263610385125503, "vf_loss": 0.7696799356490374, "vf_explained_var": 0.7346458435058594, "kl": 0.008318631858855952, "entropy": 0.23984201392158866, "entropy_coeff": 0.0}}, "num_steps_sampled": 1432000, "num_steps_trained": 1432000}, "done": false, "episodes_total": 143, "training_iteration": 358, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-57-57", "timestamp": 1618145877, "time_this_iter_s": 18.96779155731201, "time_total_s": 7220.247877597809, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116cf10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7220.247877597809, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 58.355555555555554, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 106.0, "episode_reward_min": 106.0, "episode_reward_mean": 106.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5130954790917155, "mean_raw_obs_processing_ms": 0.10151012936711618, "mean_inference_ms": 1.4532522771641798, "mean_action_processing_ms": 0.04030584006087304}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1436000, "timers": {"sample_time_ms": 7382.141, "sample_throughput": 541.848, "learn_time_ms": 11724.975, "learn_throughput": 341.152, "update_time_ms": 2.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 1.8727132119238377, "policy_loss": -0.05696434483979829, "vf_loss": 1.913545187562704, "vf_explained_var": 0.41380029916763306, "kl": 0.027568306599278003, "entropy": 0.3459682213142514, "entropy_coeff": 0.0}}, "num_steps_sampled": 1436000, "num_steps_trained": 1436000}, "done": false, "episodes_total": 143, "training_iteration": 359, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-58-16", "timestamp": 1618145896, "time_this_iter_s": 18.934306621551514, "time_total_s": 7239.18218421936, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7239.18218421936, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 58.55555555555556, "ram_util_percent": 27.503703703703703}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 305.0, "episode_reward_min": 305.0, "episode_reward_mean": 305.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5111779553963504, "mean_raw_obs_processing_ms": 0.10168123253815699, "mean_inference_ms": 1.453077330912474, "mean_action_processing_ms": 0.04030033779941201}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1440000, "timers": {"sample_time_ms": 7347.438, "sample_throughput": 544.407, "learn_time_ms": 11732.275, "learn_throughput": 340.94, "update_time_ms": 2.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 2.3071186803281307, "policy_loss": -0.03905959182884544, "vf_loss": 2.339049592614174, "vf_explained_var": 0.6047930717468262, "kl": 0.008121449121972546, "entropy": 0.281912284437567, "entropy_coeff": 0.0}}, "num_steps_sampled": 1440000, "num_steps_trained": 1440000}, "done": false, "episodes_total": 144, "training_iteration": 360, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-58-34", "timestamp": 1618145914, "time_this_iter_s": 18.789032220840454, "time_total_s": 7257.971216440201, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71719e2310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114e8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7257.971216440201, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 58.7074074074074, "ram_util_percent": 27.5}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 305.0, "episode_reward_min": 305.0, "episode_reward_mean": 305.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5111779553963504, "mean_raw_obs_processing_ms": 0.10168123253815699, "mean_inference_ms": 1.453077330912474, "mean_action_processing_ms": 0.04030033779941201}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1444000, "timers": {"sample_time_ms": 7364.823, "sample_throughput": 543.122, "learn_time_ms": 11740.147, "learn_throughput": 340.711, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 2.7224874198436737, "policy_loss": -0.03452253682189621, "vf_loss": 2.7472898215055466, "vf_explained_var": 0.6213347911834717, "kl": 0.011073766952904407, "entropy": 0.26709204399958253, "entropy_coeff": 0.0}}, "num_steps_sampled": 1444000, "num_steps_trained": 1444000}, "done": false, "episodes_total": 144, "training_iteration": 361, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-58-54", "timestamp": 1618145934, "time_this_iter_s": 19.406006336212158, "time_total_s": 7277.377222776413, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711753d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7277.377222776413, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 58.99285714285715, "ram_util_percent": 27.560714285714287}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 305.0, "episode_reward_min": 305.0, "episode_reward_mean": 305.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5111779553963504, "mean_raw_obs_processing_ms": 0.10168123253815699, "mean_inference_ms": 1.453077330912474, "mean_action_processing_ms": 0.04030033779941201}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1448000, "timers": {"sample_time_ms": 7341.297, "sample_throughput": 544.863, "learn_time_ms": 11751.728, "learn_throughput": 340.375, "update_time_ms": 2.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 1.0396219603717327, "policy_loss": -0.022058420785469934, "vf_loss": 1.0555021315813065, "vf_explained_var": 0.5039143562316895, "kl": 0.007038597788778134, "entropy": 0.18245164630934596, "entropy_coeff": 0.0}}, "num_steps_sampled": 1448000, "num_steps_trained": 1448000}, "done": false, "episodes_total": 144, "training_iteration": 362, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-59-13", "timestamp": 1618145953, "time_this_iter_s": 19.499987602233887, "time_total_s": 7296.877210378647, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffdf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7296.877210378647, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 58.10000000000001, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 206.0, "episode_reward_min": 206.0, "episode_reward_mean": 206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5096870687410997, "mean_raw_obs_processing_ms": 0.10195754798631837, "mean_inference_ms": 1.4530078101492339, "mean_action_processing_ms": 0.04029692532642566}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1452000, "timers": {"sample_time_ms": 7434.764, "sample_throughput": 538.013, "learn_time_ms": 11736.674, "learn_throughput": 340.812, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 1.459920957684517, "policy_loss": -0.03630947374040261, "vf_loss": 1.4834598079323769, "vf_explained_var": 0.6175609230995178, "kl": 0.014549026454915293, "entropy": 0.1555259837768972, "entropy_coeff": 0.0}}, "num_steps_sampled": 1452000, "num_steps_trained": 1452000}, "done": false, "episodes_total": 145, "training_iteration": 363, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-59-33", "timestamp": 1618145973, "time_this_iter_s": 19.768688440322876, "time_total_s": 7316.64589881897, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7316.64589881897, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 58.785714285714285, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 206.0, "episode_reward_min": 206.0, "episode_reward_mean": 206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5096870687410997, "mean_raw_obs_processing_ms": 0.10195754798631837, "mean_inference_ms": 1.4530078101492339, "mean_action_processing_ms": 0.04029692532642566}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1456000, "timers": {"sample_time_ms": 7521.96, "sample_throughput": 531.776, "learn_time_ms": 11752.811, "learn_throughput": 340.344, "update_time_ms": 2.829}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 3.5357630401849747, "policy_loss": -0.052333643077872694, "vf_loss": 3.57346174120903, "vf_explained_var": 0.4879307746887207, "kl": 0.016673012461978942, "entropy": 0.28810153855010867, "entropy_coeff": 0.0}}, "num_steps_sampled": 1456000, "num_steps_trained": 1456000}, "done": false, "episodes_total": 145, "training_iteration": 364, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_12-59-53", "timestamp": 1618145993, "time_this_iter_s": 20.04334592819214, "time_total_s": 7336.689244747162, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f726785e2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7336.689244747162, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 58.61724137931034, "ram_util_percent": 27.60000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 261.0, "episode_reward_min": 261.0, "episode_reward_mean": 261.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [261.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5087988289975199, "mean_raw_obs_processing_ms": 0.1021338919449193, "mean_inference_ms": 1.452813185642818, "mean_action_processing_ms": 0.04029138447580026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1460000, "timers": {"sample_time_ms": 7528.759, "sample_throughput": 531.296, "learn_time_ms": 11714.129, "learn_throughput": 341.468, "update_time_ms": 2.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 1.813715472817421, "policy_loss": -0.026596097770379856, "vf_loss": 1.8352828286588192, "vf_explained_var": 0.5508749485015869, "kl": 0.005729046191845555, "entropy": 0.11240198719315231, "entropy_coeff": 0.0}}, "num_steps_sampled": 1460000, "num_steps_trained": 1460000}, "done": false, "episodes_total": 146, "training_iteration": 365, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-00-12", "timestamp": 1618146012, "time_this_iter_s": 19.10563588142395, "time_total_s": 7355.794880628586, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7355.794880628586, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 58.025925925925925, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 261.0, "episode_reward_min": 261.0, "episode_reward_mean": 261.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [261.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5087988289975199, "mean_raw_obs_processing_ms": 0.1021338919449193, "mean_inference_ms": 1.452813185642818, "mean_action_processing_ms": 0.04029138447580026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1464000, "timers": {"sample_time_ms": 7515.676, "sample_throughput": 532.221, "learn_time_ms": 11734.491, "learn_throughput": 340.875, "update_time_ms": 2.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 0.12568443943746388, "policy_loss": -0.004337939550168812, "vf_loss": 0.13002220820635557, "vf_explained_var": -0.0010489597916603088, "kl": 1.9411271234837102e-07, "entropy": 0.003750236770429183, "entropy_coeff": 0.0}}, "num_steps_sampled": 1464000, "num_steps_trained": 1464000}, "done": false, "episodes_total": 146, "training_iteration": 366, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-00-31", "timestamp": 1618146031, "time_this_iter_s": 19.04112982749939, "time_total_s": 7374.836010456085, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ca3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7374.836010456085, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 59.281481481481485, "ram_util_percent": 27.551851851851854}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 261.0, "episode_reward_min": 261.0, "episode_reward_mean": 261.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [261.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5087988289975199, "mean_raw_obs_processing_ms": 0.1021338919449193, "mean_inference_ms": 1.452813185642818, "mean_action_processing_ms": 0.04029138447580026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1468000, "timers": {"sample_time_ms": 7552.631, "sample_throughput": 529.617, "learn_time_ms": 11726.475, "learn_throughput": 341.108, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4388833448018282, "cur_lr": 5e-05, "total_loss": 2.060424081981182, "policy_loss": -0.05194666446186602, "vf_loss": 2.103265181183815, "vf_explained_var": 0.6224808692932129, "kl": 0.020746984184370376, "entropy": 0.221731913741678, "entropy_coeff": 0.0}}, "num_steps_sampled": 1468000, "num_steps_trained": 1468000}, "done": false, "episodes_total": 146, "training_iteration": 367, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-00-51", "timestamp": 1618146051, "time_this_iter_s": 19.32453989982605, "time_total_s": 7394.160550355911, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710cacd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7394.160550355911, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 58.01428571428572, "ram_util_percent": 27.50357142857143}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 183.0, "episode_reward_min": 183.0, "episode_reward_mean": 183.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5064293596215402, "mean_raw_obs_processing_ms": 0.10241522517531647, "mean_inference_ms": 1.4528429230165087, "mean_action_processing_ms": 0.040289371560145934}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1472000, "timers": {"sample_time_ms": 7590.007, "sample_throughput": 527.009, "learn_time_ms": 11705.951, "learn_throughput": 341.707, "update_time_ms": 2.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6583250172027424, "cur_lr": 5e-05, "total_loss": 1.7406291253864765, "policy_loss": -0.04185177164617926, "vf_loss": 1.7673713825643063, "vf_explained_var": 0.5844901204109192, "kl": 0.022951453342102468, "entropy": 0.27156498609110713, "entropy_coeff": 0.0}}, "num_steps_sampled": 1472000, "num_steps_trained": 1472000}, "done": false, "episodes_total": 147, "training_iteration": 368, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-01-10", "timestamp": 1618146070, "time_this_iter_s": 19.139415740966797, "time_total_s": 7413.299966096878, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d6ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7413.299966096878, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 183.0, "episode_reward_min": 183.0, "episode_reward_mean": 183.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5064293596215402, "mean_raw_obs_processing_ms": 0.10241522517531647, "mean_inference_ms": 1.4528429230165087, "mean_action_processing_ms": 0.040289371560145934}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1476000, "timers": {"sample_time_ms": 7631.694, "sample_throughput": 524.13, "learn_time_ms": 11686.588, "learn_throughput": 342.273, "update_time_ms": 2.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 1.706421636044979, "policy_loss": -0.04105278287897818, "vf_loss": 1.7216453365981579, "vf_explained_var": 0.6129540205001831, "kl": 0.026156366104260087, "entropy": 0.22647906420752406, "entropy_coeff": 0.0}}, "num_steps_sampled": 1476000, "num_steps_trained": 1476000}, "done": false, "episodes_total": 147, "training_iteration": 369, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-01-29", "timestamp": 1618146089, "time_this_iter_s": 19.16049575805664, "time_total_s": 7432.460461854935, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267431110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7432.460461854935, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 57.99999999999999, "ram_util_percent": 27.50740740740741}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 146.0, "episode_reward_min": 146.0, "episode_reward_mean": 146.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.504759096919991, "mean_raw_obs_processing_ms": 0.1026014100310763, "mean_inference_ms": 1.4528755544324583, "mean_action_processing_ms": 0.0402890121639798}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1480000, "timers": {"sample_time_ms": 7648.062, "sample_throughput": 523.008, "learn_time_ms": 11681.571, "learn_throughput": 342.42, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4812312887061703, "cur_lr": 5e-05, "total_loss": 0.16139342612586915, "policy_loss": -0.003722962544998154, "vf_loss": 0.16286942409351468, "vf_explained_var": 0.3203877806663513, "kl": 0.0015169539628914208, "entropy": 0.04297665425110608, "entropy_coeff": 0.0}}, "num_steps_sampled": 1480000, "num_steps_trained": 1480000}, "done": false, "episodes_total": 148, "training_iteration": 370, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-01-48", "timestamp": 1618146108, "time_this_iter_s": 18.90518069267273, "time_total_s": 7451.365642547607, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fbe5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7451.365642547607, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 59.099999999999994, "ram_util_percent": 27.596296296296302}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 146.0, "episode_reward_min": 146.0, "episode_reward_mean": 146.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.504759096919991, "mean_raw_obs_processing_ms": 0.1026014100310763, "mean_inference_ms": 1.4528755544324583, "mean_action_processing_ms": 0.0402890121639798}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1484000, "timers": {"sample_time_ms": 7600.266, "sample_throughput": 526.297, "learn_time_ms": 11674.775, "learn_throughput": 342.619, "update_time_ms": 2.842}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7406156443530851, "cur_lr": 5e-05, "total_loss": 0.12734652822837234, "policy_loss": -0.004932569689117372, "vf_loss": 0.13038371864240617, "vf_explained_var": -0.020279347896575928, "kl": 0.0025591917333258607, "entropy": 0.027255834254901856, "entropy_coeff": 0.0}}, "num_steps_sampled": 1484000, "num_steps_trained": 1484000}, "done": false, "episodes_total": 148, "training_iteration": 371, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-02-07", "timestamp": 1618146127, "time_this_iter_s": 18.860564708709717, "time_total_s": 7470.226207256317, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fbe510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7470.226207256317, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 58.007407407407406, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 146.0, "episode_reward_min": 146.0, "episode_reward_mean": 146.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.504759096919991, "mean_raw_obs_processing_ms": 0.1026014100310763, "mean_inference_ms": 1.4528755544324583, "mean_action_processing_ms": 0.0402890121639798}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1488000, "timers": {"sample_time_ms": 7568.906, "sample_throughput": 528.478, "learn_time_ms": 11671.87, "learn_throughput": 342.704, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37030782217654257, "cur_lr": 5e-05, "total_loss": 0.33925539953634143, "policy_loss": -0.0358157129958272, "vf_loss": 0.3637525951489806, "vf_explained_var": 0.27668604254722595, "kl": 0.03056516477954574, "entropy": 0.19562044739723206, "entropy_coeff": 0.0}}, "num_steps_sampled": 1488000, "num_steps_trained": 1488000}, "done": false, "episodes_total": 148, "training_iteration": 372, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-02-26", "timestamp": 1618146146, "time_this_iter_s": 19.16195845603943, "time_total_s": 7489.388165712357, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7489.388165712357, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 58.75714285714286, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 53.0, "episode_reward_min": 53.0, "episode_reward_mean": 53.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5020626225990414, "mean_raw_obs_processing_ms": 0.10288424489840106, "mean_inference_ms": 1.4528271324834854, "mean_action_processing_ms": 0.040287844620270664}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1492000, "timers": {"sample_time_ms": 7459.999, "sample_throughput": 536.193, "learn_time_ms": 11668.008, "learn_throughput": 342.818, "update_time_ms": 2.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 0.6778121804818511, "policy_loss": -0.022206951398402452, "vf_loss": 0.6957869352772832, "vf_explained_var": 0.6654266119003296, "kl": 0.007619253083248623, "entropy": 0.2218479006551206, "entropy_coeff": 0.0}}, "num_steps_sampled": 1492000, "num_steps_trained": 1492000}, "done": false, "episodes_total": 149, "training_iteration": 373, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-02-45", "timestamp": 1618146165, "time_this_iter_s": 18.641019582748413, "time_total_s": 7508.029185295105, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114ff90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d6b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7508.029185295105, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 58.2, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 53.0, "episode_reward_min": 53.0, "episode_reward_mean": 53.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5020626225990414, "mean_raw_obs_processing_ms": 0.10288424489840106, "mean_inference_ms": 1.4528271324834854, "mean_action_processing_ms": 0.040287844620270664}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1496000, "timers": {"sample_time_ms": 7376.17, "sample_throughput": 542.287, "learn_time_ms": 11644.124, "learn_throughput": 343.521, "update_time_ms": 2.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 1.0114714689552784, "policy_loss": -0.03608888585586101, "vf_loss": 1.0373182222247124, "vf_explained_var": 0.7955722212791443, "kl": 0.018438970684655942, "entropy": 0.1853024261072278, "entropy_coeff": 0.0}}, "num_steps_sampled": 1496000, "num_steps_trained": 1496000}, "done": false, "episodes_total": 149, "training_iteration": 374, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-03-04", "timestamp": 1618146184, "time_this_iter_s": 18.966001749038696, "time_total_s": 7526.995187044144, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110b310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719c0050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7526.995187044144, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 59.15185185185185, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 71.0, "episode_reward_min": 71.0, "episode_reward_mean": 71.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5002896352820685, "mean_raw_obs_processing_ms": 0.1030779319858261, "mean_inference_ms": 1.4528844943302082, "mean_action_processing_ms": 0.04028850269600105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1500000, "timers": {"sample_time_ms": 7359.597, "sample_throughput": 543.508, "learn_time_ms": 11636.139, "learn_throughput": 343.757, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 1.524985246360302, "policy_loss": -0.010127794987056404, "vf_loss": 1.5308347139507532, "vf_explained_var": 0.028323568403720856, "kl": 0.007702259594225325, "entropy": 0.25380927696824074, "entropy_coeff": 0.0}}, "num_steps_sampled": 1500000, "num_steps_trained": 1500000}, "done": false, "episodes_total": 150, "training_iteration": 375, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-03-23", "timestamp": 1618146203, "time_this_iter_s": 18.85985517501831, "time_total_s": 7545.855042219162, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171077410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7545.855042219162, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 58.56666666666667, "ram_util_percent": 27.50740740740741}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 71.0, "episode_reward_min": 71.0, "episode_reward_mean": 71.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5002896352820685, "mean_raw_obs_processing_ms": 0.1030779319858261, "mean_inference_ms": 1.4528844943302082, "mean_action_processing_ms": 0.04028850269600105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1504000, "timers": {"sample_time_ms": 7358.764, "sample_throughput": 543.57, "learn_time_ms": 11621.603, "learn_throughput": 344.187, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 1.2733678985387087, "policy_loss": -0.025634417950641364, "vf_loss": 1.2919169906526804, "vf_explained_var": 0.49386507272720337, "kl": 0.01275572695885785, "entropy": 0.25408009346574545, "entropy_coeff": 0.0}}, "num_steps_sampled": 1504000, "num_steps_trained": 1504000}, "done": false, "episodes_total": 150, "training_iteration": 376, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-03-42", "timestamp": 1618146222, "time_this_iter_s": 18.88830327987671, "time_total_s": 7564.743345499039, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffdbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7564.743345499039, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 58.67407407407407, "ram_util_percent": 27.596296296296302}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 71.0, "episode_reward_min": 71.0, "episode_reward_mean": 71.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5002896352820685, "mean_raw_obs_processing_ms": 0.1030779319858261, "mean_inference_ms": 1.4528844943302082, "mean_action_processing_ms": 0.04028850269600105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1508000, "timers": {"sample_time_ms": 7314.263, "sample_throughput": 546.877, "learn_time_ms": 11611.845, "learn_throughput": 344.476, "update_time_ms": 2.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 3.9599145129323006, "policy_loss": -0.029709314403589815, "vf_loss": 3.9825685918331146, "vf_explained_var": 0.5738512277603149, "kl": 0.012701599829597399, "entropy": 0.24706408521160483, "entropy_coeff": 0.0}}, "num_steps_sampled": 1508000, "num_steps_trained": 1508000}, "done": false, "episodes_total": 150, "training_iteration": 377, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-04-00", "timestamp": 1618146240, "time_this_iter_s": 18.78331184387207, "time_total_s": 7583.526657342911, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d6e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7583.526657342911, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 58.53333333333334, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 466.0, "episode_reward_min": 466.0, "episode_reward_mean": 466.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4976293092668683, "mean_raw_obs_processing_ms": 0.10334326059524165, "mean_inference_ms": 1.4527437402696077, "mean_action_processing_ms": 0.04028293222995287}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1512000, "timers": {"sample_time_ms": 7269.238, "sample_throughput": 550.264, "learn_time_ms": 11645.663, "learn_throughput": 343.476, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 5.165210545063019, "policy_loss": -0.02088308852398768, "vf_loss": 5.181077651679516, "vf_explained_var": 0.76720130443573, "kl": 0.009030362343764864, "entropy": 0.18835402792319655, "entropy_coeff": 0.0}}, "num_steps_sampled": 1512000, "num_steps_trained": 1512000}, "done": false, "episodes_total": 151, "training_iteration": 378, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-04-19", "timestamp": 1618146259, "time_this_iter_s": 19.025558710098267, "time_total_s": 7602.552216053009, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71711426d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7602.552216053009, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 58.31481481481482, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 466.0, "episode_reward_min": 466.0, "episode_reward_mean": 466.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4976293092668683, "mean_raw_obs_processing_ms": 0.10334326059524165, "mean_inference_ms": 1.4527437402696077, "mean_action_processing_ms": 0.04028293222995287}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1516000, "timers": {"sample_time_ms": 7257.156, "sample_throughput": 551.18, "learn_time_ms": 11654.478, "learn_throughput": 343.216, "update_time_ms": 2.926}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 0.3464839851949364, "policy_loss": -0.019361909799044952, "vf_loss": 0.36159996734932065, "vf_explained_var": 0.7867406606674194, "kl": 0.007643961187568493, "entropy": 0.163935714866966, "entropy_coeff": 0.0}}, "num_steps_sampled": 1516000, "num_steps_trained": 1516000}, "done": false, "episodes_total": 151, "training_iteration": 379, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-04-39", "timestamp": 1618146279, "time_this_iter_s": 19.125389099121094, "time_total_s": 7621.67760515213, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171077250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710cabd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7621.67760515213, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 58.885714285714286, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 257.0, "episode_reward_min": 257.0, "episode_reward_mean": 257.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.495935162258331, "mean_raw_obs_processing_ms": 0.10352600605557762, "mean_inference_ms": 1.4526659633105272, "mean_action_processing_ms": 0.04028055998072595}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1520000, "timers": {"sample_time_ms": 7236.046, "sample_throughput": 552.788, "learn_time_ms": 11670.136, "learn_throughput": 342.755, "update_time_ms": 2.966}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 3.6764862537384033, "policy_loss": -0.05417199671501294, "vf_loss": 3.7130941823124886, "vf_explained_var": 0.557283341884613, "kl": 0.031620665453374386, "entropy": 0.19844231149181724, "entropy_coeff": 0.0}}, "num_steps_sampled": 1520000, "num_steps_trained": 1520000}, "done": false, "episodes_total": 152, "training_iteration": 380, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-04-57", "timestamp": 1618146297, "time_this_iter_s": 18.848264694213867, "time_total_s": 7640.525869846344, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711751d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7640.525869846344, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 59.13333333333332, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 257.0, "episode_reward_min": 257.0, "episode_reward_mean": 257.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.495935162258331, "mean_raw_obs_processing_ms": 0.10352600605557762, "mean_inference_ms": 1.4526659633105272, "mean_action_processing_ms": 0.04028055998072595}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1524000, "timers": {"sample_time_ms": 7226.27, "sample_throughput": 553.536, "learn_time_ms": 11677.803, "learn_throughput": 342.53, "update_time_ms": 2.935}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 3.186965897679329, "policy_loss": -0.042557676089927554, "vf_loss": 3.2212856113910675, "vf_explained_var": 0.5130212306976318, "kl": 0.009887274340144359, "entropy": 0.2634072657674551, "entropy_coeff": 0.0}}, "num_steps_sampled": 1524000, "num_steps_trained": 1524000}, "done": false, "episodes_total": 152, "training_iteration": 381, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-05-16", "timestamp": 1618146316, "time_this_iter_s": 18.83982825279236, "time_total_s": 7659.365698099136, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171075cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7659.365698099136, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 58.17777777777778, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 257.0, "episode_reward_min": 257.0, "episode_reward_mean": 257.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.495935162258331, "mean_raw_obs_processing_ms": 0.10352600605557762, "mean_inference_ms": 1.4526659633105272, "mean_action_processing_ms": 0.04028055998072595}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1528000, "timers": {"sample_time_ms": 7187.504, "sample_throughput": 556.521, "learn_time_ms": 11683.913, "learn_throughput": 342.351, "update_time_ms": 3.478}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 5.61325766146183, "policy_loss": -0.022040826617740095, "vf_loss": 5.62891797721386, "vf_explained_var": 0.5967354774475098, "kl": 0.007657978931092657, "entropy": 0.24999918043613434, "entropy_coeff": 0.0}}, "num_steps_sampled": 1528000, "num_steps_trained": 1528000}, "done": false, "episodes_total": 152, "training_iteration": 382, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-05-35", "timestamp": 1618146335, "time_this_iter_s": 18.835522651672363, "time_total_s": 7678.201220750809, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbe790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7678.201220750809, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 58.92222222222222, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 482.0, "episode_reward_min": 482.0, "episode_reward_mean": 482.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [482.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4933064407099045, "mean_raw_obs_processing_ms": 0.10379060140643752, "mean_inference_ms": 1.452495988260403, "mean_action_processing_ms": 0.04027489583654804}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1532000, "timers": {"sample_time_ms": 7204.639, "sample_throughput": 555.198, "learn_time_ms": 11686.126, "learn_throughput": 342.286, "update_time_ms": 3.477}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 2.66314597427845, "policy_loss": -0.05360475124325603, "vf_loss": 2.6925769485533237, "vf_explained_var": 0.556949257850647, "kl": 0.029013509047217667, "entropy": 0.22427227115258574, "entropy_coeff": 0.0}}, "num_steps_sampled": 1532000, "num_steps_trained": 1532000}, "done": false, "episodes_total": 153, "training_iteration": 383, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-05-54", "timestamp": 1618146354, "time_this_iter_s": 18.831907272338867, "time_total_s": 7697.033128023148, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ee50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7697.033128023148, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 58.369230769230775, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 482.0, "episode_reward_min": 482.0, "episode_reward_mean": 482.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [482.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4933064407099045, "mean_raw_obs_processing_ms": 0.10379060140643752, "mean_inference_ms": 1.452495988260403, "mean_action_processing_ms": 0.04027489583654804}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1536000, "timers": {"sample_time_ms": 7198.071, "sample_throughput": 555.704, "learn_time_ms": 11710.376, "learn_throughput": 341.577, "update_time_ms": 3.619}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 4.040464378893375, "policy_loss": -0.023264327261131257, "vf_loss": 4.055702328681946, "vf_explained_var": 0.4403582811355591, "kl": 0.006422186546842568, "entropy": 0.18684961926192045, "entropy_coeff": 0.0}}, "num_steps_sampled": 1536000, "num_steps_trained": 1536000}, "done": false, "episodes_total": 153, "training_iteration": 384, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-06-13", "timestamp": 1618146373, "time_this_iter_s": 19.14132571220398, "time_total_s": 7716.174453735352, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170f69610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170f69450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7716.174453735352, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 58.19285714285713, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 299.0, "episode_reward_min": 299.0, "episode_reward_mean": 299.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49168764642500845, "mean_raw_obs_processing_ms": 0.10397230694952522, "mean_inference_ms": 1.452436016448412, "mean_action_processing_ms": 0.040272846327732065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1540000, "timers": {"sample_time_ms": 7195.662, "sample_throughput": 555.89, "learn_time_ms": 11710.228, "learn_throughput": 341.582, "update_time_ms": 3.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 2.1829504929482937, "policy_loss": -0.01316336716990918, "vf_loss": 2.1918475963175297, "vf_explained_var": 0.468589186668396, "kl": 0.003413597194594331, "entropy": 0.16940860799513757, "entropy_coeff": 0.0}}, "num_steps_sampled": 1540000, "num_steps_trained": 1540000}, "done": false, "episodes_total": 154, "training_iteration": 385, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-06-32", "timestamp": 1618146392, "time_this_iter_s": 18.831717014312744, "time_total_s": 7735.006170749664, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711199d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7735.006170749664, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 59.088888888888896, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 299.0, "episode_reward_min": 299.0, "episode_reward_mean": 299.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49168764642500845, "mean_raw_obs_processing_ms": 0.10397230694952522, "mean_inference_ms": 1.452436016448412, "mean_action_processing_ms": 0.040272846327732065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1544000, "timers": {"sample_time_ms": 7204.237, "sample_throughput": 555.229, "learn_time_ms": 11708.222, "learn_throughput": 341.64, "update_time_ms": 3.587}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 4.39109194278717, "policy_loss": -0.024209877767134458, "vf_loss": 4.405911780893803, "vf_explained_var": 0.529668927192688, "kl": 0.015026589331682771, "entropy": 0.16431691590696573, "entropy_coeff": 0.0}}, "num_steps_sampled": 1544000, "num_steps_trained": 1544000}, "done": false, "episodes_total": 154, "training_iteration": 386, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-06-51", "timestamp": 1618146411, "time_this_iter_s": 18.95294427871704, "time_total_s": 7753.959115028381, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171077310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171077a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7753.959115028381, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 58.20740740740741, "ram_util_percent": 27.55555555555556}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 299.0, "episode_reward_min": 299.0, "episode_reward_mean": 299.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49168764642500845, "mean_raw_obs_processing_ms": 0.10397230694952522, "mean_inference_ms": 1.452436016448412, "mean_action_processing_ms": 0.040272846327732065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1548000, "timers": {"sample_time_ms": 7262.686, "sample_throughput": 550.76, "learn_time_ms": 11746.802, "learn_throughput": 340.518, "update_time_ms": 3.614}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 4.1128352880477905, "policy_loss": -0.02131288978853263, "vf_loss": 4.127715274691582, "vf_explained_var": 0.6124600768089294, "kl": 0.01029443416337017, "entropy": 0.11494871624745429, "entropy_coeff": 0.0}}, "num_steps_sampled": 1548000, "num_steps_trained": 1548000}, "done": false, "episodes_total": 154, "training_iteration": 387, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-07-11", "timestamp": 1618146431, "time_this_iter_s": 19.75155210494995, "time_total_s": 7773.710667133331, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116e650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7773.710667133331, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 59.61428571428571, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 375.0, "episode_reward_min": 375.0, "episode_reward_mean": 375.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4896252997699851, "mean_raw_obs_processing_ms": 0.10424855439777707, "mean_inference_ms": 1.4523391582990521, "mean_action_processing_ms": 0.04027237828942344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1552000, "timers": {"sample_time_ms": 7277.503, "sample_throughput": 549.639, "learn_time_ms": 11733.461, "learn_throughput": 340.905, "update_time_ms": 3.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 2.9355511777102947, "policy_loss": -0.02978209702996537, "vf_loss": 2.957484260201454, "vf_explained_var": 0.6259202361106873, "kl": 0.01256047742208466, "entropy": 0.2229224336333573, "entropy_coeff": 0.0}}, "num_steps_sampled": 1552000, "num_steps_trained": 1552000}, "done": false, "episodes_total": 155, "training_iteration": 388, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-07-30", "timestamp": 1618146450, "time_this_iter_s": 19.03888988494873, "time_total_s": 7792.74955701828, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7792.74955701828, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 58.22222222222222, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 375.0, "episode_reward_min": 375.0, "episode_reward_mean": 375.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4896252997699851, "mean_raw_obs_processing_ms": 0.10424855439777707, "mean_inference_ms": 1.4523391582990521, "mean_action_processing_ms": 0.04027237828942344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1556000, "timers": {"sample_time_ms": 7247.478, "sample_throughput": 551.916, "learn_time_ms": 11725.725, "learn_throughput": 341.13, "update_time_ms": 3.63}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 1.2859920039772987, "policy_loss": -0.02018871216569096, "vf_loss": 1.3029250260442495, "vf_explained_var": 0.6767871379852295, "kl": 0.005209974624449387, "entropy": 0.18432489689439535, "entropy_coeff": 0.0}}, "num_steps_sampled": 1556000, "num_steps_trained": 1556000}, "done": false, "episodes_total": 155, "training_iteration": 389, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-07-49", "timestamp": 1618146469, "time_this_iter_s": 18.747467756271362, "time_total_s": 7811.497024774551, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118da90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7811.497024774551, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 59.04074074074074, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 302.0, "episode_reward_min": 302.0, "episode_reward_mean": 302.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4879492379751816, "mean_raw_obs_processing_ms": 0.10442168468446461, "mean_inference_ms": 1.4521648155082962, "mean_action_processing_ms": 0.04026617562334026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1560000, "timers": {"sample_time_ms": 7249.996, "sample_throughput": 551.724, "learn_time_ms": 11701.469, "learn_throughput": 341.837, "update_time_ms": 3.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 5.178487829864025, "policy_loss": -0.06999081178219058, "vf_loss": 5.211616151034832, "vf_explained_var": 0.7086694240570068, "kl": 0.058989972225390375, "entropy": 0.24686854239553213, "entropy_coeff": 0.0}}, "num_steps_sampled": 1560000, "num_steps_trained": 1560000}, "done": false, "episodes_total": 156, "training_iteration": 390, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-08-07", "timestamp": 1618146487, "time_this_iter_s": 18.63280153274536, "time_total_s": 7830.129826307297, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170f69a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7830.129826307297, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 58.18888888888888, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 302.0, "episode_reward_min": 302.0, "episode_reward_mean": 302.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4879492379751816, "mean_raw_obs_processing_ms": 0.10442168468446461, "mean_inference_ms": 1.4521648155082962, "mean_action_processing_ms": 0.04026617562334026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1564000, "timers": {"sample_time_ms": 7273.926, "sample_throughput": 549.909, "learn_time_ms": 11694.414, "learn_throughput": 342.044, "update_time_ms": 3.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 6.130274683237076, "policy_loss": -0.029384839173872024, "vf_loss": 6.146526128053665, "vf_explained_var": 0.6276122331619263, "kl": 0.014011367718921974, "entropy": 0.2258216026239097, "entropy_coeff": 0.0}}, "num_steps_sampled": 1564000, "num_steps_trained": 1564000}, "done": false, "episodes_total": 156, "training_iteration": 391, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-08-26", "timestamp": 1618146506, "time_this_iter_s": 19.00849986076355, "time_total_s": 7849.13832616806, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7849.13832616806, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 302.0, "episode_reward_min": 302.0, "episode_reward_mean": 302.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4879492379751816, "mean_raw_obs_processing_ms": 0.10442168468446461, "mean_inference_ms": 1.4521648155082962, "mean_action_processing_ms": 0.04026617562334026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1568000, "timers": {"sample_time_ms": 7287.231, "sample_throughput": 548.905, "learn_time_ms": 11683.852, "learn_throughput": 342.353, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 5.4991273283958435, "policy_loss": -0.03482630627695471, "vf_loss": 5.526138007640839, "vf_explained_var": 0.5058771371841431, "kl": 0.008338044150150381, "entropy": 0.21388466283679008, "entropy_coeff": 0.0}}, "num_steps_sampled": 1568000, "num_steps_trained": 1568000}, "done": false, "episodes_total": 156, "training_iteration": 392, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-08-45", "timestamp": 1618146525, "time_this_iter_s": 18.860646724700928, "time_total_s": 7867.998972892761, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71721f7c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7867.998972892761, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 57.9925925925926, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 549.0, "episode_reward_min": 549.0, "episode_reward_mean": 549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48573090901158017, "mean_raw_obs_processing_ms": 0.10470537963923718, "mean_inference_ms": 1.4521802160446746, "mean_action_processing_ms": 0.040266771217781834}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1572000, "timers": {"sample_time_ms": 7328.429, "sample_throughput": 545.82, "learn_time_ms": 11687.223, "learn_throughput": 342.254, "update_time_ms": 3.055}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 4.427253261208534, "policy_loss": -0.01758355344645679, "vf_loss": 4.439669191837311, "vf_explained_var": 0.5708545446395874, "kl": 0.005513053874892648, "entropy": 0.15726064797490835, "entropy_coeff": 0.0}}, "num_steps_sampled": 1572000, "num_steps_trained": 1572000}, "done": false, "episodes_total": 157, "training_iteration": 393, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-09-05", "timestamp": 1618146545, "time_this_iter_s": 19.279287815093994, "time_total_s": 7887.278260707855, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171071b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71721f7bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7887.278260707855, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 59.10370370370371, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 549.0, "episode_reward_min": 549.0, "episode_reward_mean": 549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48573090901158017, "mean_raw_obs_processing_ms": 0.10470537963923718, "mean_inference_ms": 1.4521802160446746, "mean_action_processing_ms": 0.040266771217781834}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1576000, "timers": {"sample_time_ms": 7309.451, "sample_throughput": 547.237, "learn_time_ms": 11669.474, "learn_throughput": 342.775, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 3.173646543174982, "policy_loss": -0.012275298533495516, "vf_loss": 3.181553516536951, "vf_explained_var": 0.7915022969245911, "kl": 0.004660382837755606, "entropy": 0.1282121657859534, "entropy_coeff": 0.0}}, "num_steps_sampled": 1576000, "num_steps_trained": 1576000}, "done": false, "episodes_total": 157, "training_iteration": 394, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-09-23", "timestamp": 1618146563, "time_this_iter_s": 18.772414207458496, "time_total_s": 7906.050674915314, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7906.050674915314, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 58.15185185185185, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 288.0, "episode_reward_min": 288.0, "episode_reward_mean": 288.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4843431627475061, "mean_raw_obs_processing_ms": 0.10490141458323896, "mean_inference_ms": 1.452300035894996, "mean_action_processing_ms": 0.04026924509014423}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1580000, "timers": {"sample_time_ms": 7384.78, "sample_throughput": 541.655, "learn_time_ms": 11690.139, "learn_throughput": 342.169, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4686708374421866, "cur_lr": 5e-05, "total_loss": 5.010370448231697, "policy_loss": -0.030308530782349408, "vf_loss": 5.022365711629391, "vf_explained_var": 0.6899122595787048, "kl": 0.03907474392326549, "entropy": 0.13228307059034705, "entropy_coeff": 0.0}}, "num_steps_sampled": 1580000, "num_steps_trained": 1580000}, "done": false, "episodes_total": 158, "training_iteration": 395, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-09-43", "timestamp": 1618146583, "time_this_iter_s": 19.793752193450928, "time_total_s": 7925.844427108765, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d6290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7925.844427108765, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 59.11071428571429, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 288.0, "episode_reward_min": 288.0, "episode_reward_mean": 288.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4843431627475061, "mean_raw_obs_processing_ms": 0.10490141458323896, "mean_inference_ms": 1.452300035894996, "mean_action_processing_ms": 0.04026924509014423}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1584000, "timers": {"sample_time_ms": 7508.941, "sample_throughput": 532.698, "learn_time_ms": 11692.211, "learn_throughput": 342.108, "update_time_ms": 2.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 3.848894402384758, "policy_loss": -0.019760620169108734, "vf_loss": 3.8616246953606606, "vf_explained_var": 0.4950658679008484, "kl": 0.010000354603107553, "entropy": 0.09318542899563909, "entropy_coeff": 0.0}}, "num_steps_sampled": 1584000, "num_steps_trained": 1584000}, "done": false, "episodes_total": 158, "training_iteration": 396, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-10-03", "timestamp": 1618146603, "time_this_iter_s": 20.216127157211304, "time_total_s": 7946.060554265976, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d64d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7946.060554265976, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 59.12068965517242, "ram_util_percent": 27.60000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 288.0, "episode_reward_min": 288.0, "episode_reward_mean": 288.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4843431627475061, "mean_raw_obs_processing_ms": 0.10490141458323896, "mean_inference_ms": 1.452300035894996, "mean_action_processing_ms": 0.04026924509014423}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1588000, "timers": {"sample_time_ms": 7501.888, "sample_throughput": 533.199, "learn_time_ms": 11659.279, "learn_throughput": 343.074, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 3.7991100028157234, "policy_loss": -0.026910555199719965, "vf_loss": 3.815481074154377, "vf_explained_var": 0.5457502603530884, "kl": 0.014991992837167345, "entropy": 0.17559972824528813, "entropy_coeff": 0.0}}, "num_steps_sampled": 1588000, "num_steps_trained": 1588000}, "done": false, "episodes_total": 158, "training_iteration": 397, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-10-23", "timestamp": 1618146623, "time_this_iter_s": 19.350955724716187, "time_total_s": 7965.411509990692, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117b1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7965.411509990692, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 58.13928571428572, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 271.0, "episode_reward_min": 271.0, "episode_reward_mean": 271.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [271.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4829979026976489, "mean_raw_obs_processing_ms": 0.10518910264922836, "mean_inference_ms": 1.4523021542252106, "mean_action_processing_ms": 0.04026825525393676}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1592000, "timers": {"sample_time_ms": 7501.78, "sample_throughput": 533.207, "learn_time_ms": 11641.419, "learn_throughput": 343.601, "update_time_ms": 2.926}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 1.2916527185589075, "policy_loss": -0.025169851403916255, "vf_loss": 1.302579840645194, "vf_explained_var": 0.4780367612838745, "kl": 0.020259742508642375, "entropy": 0.21570239728316665, "entropy_coeff": 0.0}}, "num_steps_sampled": 1592000, "num_steps_trained": 1592000}, "done": false, "episodes_total": 159, "training_iteration": 398, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-10-42", "timestamp": 1618146642, "time_this_iter_s": 18.863791704177856, "time_total_s": 7984.27530169487, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7984.27530169487, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 59.218518518518515, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 271.0, "episode_reward_min": 271.0, "episode_reward_mean": 271.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [271.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4829979026976489, "mean_raw_obs_processing_ms": 0.10518910264922836, "mean_inference_ms": 1.4523021542252106, "mean_action_processing_ms": 0.04026825525393676}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1596000, "timers": {"sample_time_ms": 7498.761, "sample_throughput": 533.421, "learn_time_ms": 11637.551, "learn_throughput": 343.715, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0545093842449198, "cur_lr": 5e-05, "total_loss": 0.20486747659742832, "policy_loss": -0.01819579440052621, "vf_loss": 0.21637491416186094, "vf_explained_var": 0.03192348778247833, "kl": 0.006342622509691864, "entropy": 0.2914224434643984, "entropy_coeff": 0.0}}, "num_steps_sampled": 1596000, "num_steps_trained": 1596000}, "done": false, "episodes_total": 159, "training_iteration": 399, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-11-00", "timestamp": 1618146660, "time_this_iter_s": 18.678624629974365, "time_total_s": 8002.953926324844, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266306a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8002.953926324844, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 58.26153846153846, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 21.0, "episode_reward_min": 21.0, "episode_reward_mean": 21.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4813783278991213, "mean_raw_obs_processing_ms": 0.10537974104364672, "mean_inference_ms": 1.452325674370619, "mean_action_processing_ms": 0.0402673730412716}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1600000, "timers": {"sample_time_ms": 7534.95, "sample_throughput": 530.86, "learn_time_ms": 11661.071, "learn_throughput": 343.022, "update_time_ms": 2.849}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0545093842449198, "cur_lr": 5e-05, "total_loss": 0.017246428586076945, "policy_loss": 0.004909021896310151, "vf_loss": 0.01232006453210488, "vf_explained_var": -0.0015973709523677826, "kl": 1.644833480440866e-05, "entropy": 0.0075719715969171375, "entropy_coeff": 0.0}}, "num_steps_sampled": 1600000, "num_steps_trained": 1600000}, "done": false, "episodes_total": 160, "training_iteration": 400, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-11-20", "timestamp": 1618146680, "time_this_iter_s": 19.230519771575928, "time_total_s": 8022.18444609642, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8022.18444609642, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 59.21071428571429, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 21.0, "episode_reward_min": 21.0, "episode_reward_mean": 21.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4813783278991213, "mean_raw_obs_processing_ms": 0.10537974104364672, "mean_inference_ms": 1.452325674370619, "mean_action_processing_ms": 0.0402673730412716}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1604000, "timers": {"sample_time_ms": 7510.661, "sample_throughput": 532.576, "learn_time_ms": 11671.132, "learn_throughput": 342.726, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 0.0029756881995126605, "policy_loss": -0.0002494819345884025, "vf_loss": 0.0029460731348081026, "vf_explained_var": -0.2230740785598755, "kl": 0.0005293437510545118, "entropy": 0.013787406962364912, "entropy_coeff": 0.0}}, "num_steps_sampled": 1604000, "num_steps_trained": 1604000}, "done": false, "episodes_total": 160, "training_iteration": 401, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-11-39", "timestamp": 1618146699, "time_this_iter_s": 18.863615036010742, "time_total_s": 8041.048061132431, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710cab10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8041.048061132431, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 58.22592592592592, "ram_util_percent": 27.655555555555562}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 21.0, "episode_reward_min": 21.0, "episode_reward_mean": 21.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4813783278991213, "mean_raw_obs_processing_ms": 0.10537974104364672, "mean_inference_ms": 1.452325674370619, "mean_action_processing_ms": 0.0402673730412716}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1608000, "timers": {"sample_time_ms": 7528.224, "sample_throughput": 531.334, "learn_time_ms": 11669.168, "learn_throughput": 342.784, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.26362734606122995, "cur_lr": 5e-05, "total_loss": 0.0018089493678417057, "policy_loss": 0.0006686447013635188, "vf_loss": 0.000579245638618886, "vf_explained_var": -0.18277400732040405, "kl": 0.0021282291836541845, "entropy": 0.005656127483234741, "entropy_coeff": 0.0}}, "num_steps_sampled": 1608000, "num_steps_trained": 1608000}, "done": false, "episodes_total": 160, "training_iteration": 402, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-11-58", "timestamp": 1618146718, "time_this_iter_s": 19.01423954963684, "time_total_s": 8060.062300682068, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221f5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffdc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8060.062300682068, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 59.466666666666654, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47900071406266664, "mean_raw_obs_processing_ms": 0.10565261877216099, "mean_inference_ms": 1.4522239413408302, "mean_action_processing_ms": 0.040262228225060655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1612000, "timers": {"sample_time_ms": 7474.121, "sample_throughput": 535.18, "learn_time_ms": 11672.191, "learn_throughput": 342.695, "update_time_ms": 2.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13181367303061498, "cur_lr": 5e-05, "total_loss": -0.02547943906392902, "policy_loss": -0.02595872519304976, "vf_loss": 7.676689733671083e-05, "vf_explained_var": -0.014894390478730202, "kl": 0.0030537207435372693, "entropy": 0.01329360566160176, "entropy_coeff": 0.0}}, "num_steps_sampled": 1612000, "num_steps_trained": 1612000}, "done": false, "episodes_total": 161, "training_iteration": 403, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-12-16", "timestamp": 1618146736, "time_this_iter_s": 18.767525672912598, "time_total_s": 8078.8298263549805, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8078.8298263549805, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 58.329629629629636, "ram_util_percent": 27.607407407407415}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47900071406266664, "mean_raw_obs_processing_ms": 0.10565261877216099, "mean_inference_ms": 1.4522239413408302, "mean_action_processing_ms": 0.040262228225060655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1616000, "timers": {"sample_time_ms": 7468.624, "sample_throughput": 535.574, "learn_time_ms": 11684.685, "learn_throughput": 342.328, "update_time_ms": 2.875}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06590683651530749, "cur_lr": 5e-05, "total_loss": 0.8920343974605203, "policy_loss": -0.014416334306588396, "vf_loss": 0.9055037442594767, "vf_explained_var": 0.605543851852417, "kl": 0.01436868408927694, "entropy": 0.08476548281032592, "entropy_coeff": 0.0}}, "num_steps_sampled": 1616000, "num_steps_trained": 1616000}, "done": false, "episodes_total": 161, "training_iteration": 404, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-12-35", "timestamp": 1618146755, "time_this_iter_s": 18.84266495704651, "time_total_s": 8097.672491312027, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710756d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8097.672491312027, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 59.233333333333334, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 216.0, "episode_reward_min": 216.0, "episode_reward_mean": 216.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4777959889803952, "mean_raw_obs_processing_ms": 0.10582628899626861, "mean_inference_ms": 1.4521103319426858, "mean_action_processing_ms": 0.040257393894114875}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1620000, "timers": {"sample_time_ms": 7452.277, "sample_throughput": 536.749, "learn_time_ms": 11671.567, "learn_throughput": 342.713, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06590683651530749, "cur_lr": 5e-05, "total_loss": 2.7509793490171432, "policy_loss": -0.10955672283307649, "vf_loss": 2.8512218594551086, "vf_explained_var": 0.6356564164161682, "kl": 0.14132420695386827, "entropy": 0.28435506112873554, "entropy_coeff": 0.0}}, "num_steps_sampled": 1620000, "num_steps_trained": 1620000}, "done": false, "episodes_total": 162, "training_iteration": 405, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-12-55", "timestamp": 1618146775, "time_this_iter_s": 19.500638961791992, "time_total_s": 8117.173130273819, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717106c850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8117.173130273819, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 58.09999999999999, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 216.0, "episode_reward_min": 216.0, "episode_reward_mean": 216.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4777959889803952, "mean_raw_obs_processing_ms": 0.10582628899626861, "mean_inference_ms": 1.4521103319426858, "mean_action_processing_ms": 0.040257393894114875}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1624000, "timers": {"sample_time_ms": 7343.365, "sample_throughput": 544.709, "learn_time_ms": 11667.813, "learn_throughput": 342.823, "update_time_ms": 2.915}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09886025477296123, "cur_lr": 5e-05, "total_loss": 2.2089523784816265, "policy_loss": -0.05353034823201597, "vf_loss": 2.2481284141540527, "vf_explained_var": 0.268902063369751, "kl": 0.1451980797573924, "entropy": 0.27142752381041646, "entropy_coeff": 0.0}}, "num_steps_sampled": 1624000, "num_steps_trained": 1624000}, "done": false, "episodes_total": 162, "training_iteration": 406, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-13-14", "timestamp": 1618146794, "time_this_iter_s": 19.091996431350708, "time_total_s": 8136.26512670517, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffd6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8136.26512670517, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 216.0, "episode_reward_min": 216.0, "episode_reward_mean": 216.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4777959889803952, "mean_raw_obs_processing_ms": 0.10582628899626861, "mean_inference_ms": 1.4521103319426858, "mean_action_processing_ms": 0.040257393894114875}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1628000, "timers": {"sample_time_ms": 7302.561, "sample_throughput": 547.753, "learn_time_ms": 11657.825, "learn_throughput": 343.117, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.14829038215944185, "cur_lr": 5e-05, "total_loss": 1.8209096770733595, "policy_loss": -0.05780177598353475, "vf_loss": 1.8646073080599308, "vf_explained_var": 0.5369422435760498, "kl": 0.09511180780827999, "entropy": 0.2413384742103517, "entropy_coeff": 0.0}}, "num_steps_sampled": 1628000, "num_steps_trained": 1628000}, "done": false, "episodes_total": 162, "training_iteration": 407, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-13-33", "timestamp": 1618146813, "time_this_iter_s": 18.84596586227417, "time_total_s": 8155.111092567444, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717108e090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8155.111092567444, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 58.196296296296296, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 99.0, "episode_reward_min": 99.0, "episode_reward_mean": 99.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47560293346887617, "mean_raw_obs_processing_ms": 0.10610608127754677, "mean_inference_ms": 1.4520685856223872, "mean_action_processing_ms": 0.040256116780815226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1632000, "timers": {"sample_time_ms": 7294.998, "sample_throughput": 548.321, "learn_time_ms": 11666.607, "learn_throughput": 342.859, "update_time_ms": 2.934}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22243557323916277, "cur_lr": 5e-05, "total_loss": 1.089244658127427, "policy_loss": -0.0315184484643396, "vf_loss": 1.1135569233447313, "vf_explained_var": 0.18163779377937317, "kl": 0.03239681717241183, "entropy": 0.15845678048208356, "entropy_coeff": 0.0}}, "num_steps_sampled": 1632000, "num_steps_trained": 1632000}, "done": false, "episodes_total": 163, "training_iteration": 408, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-13-52", "timestamp": 1618146832, "time_this_iter_s": 18.87137770652771, "time_total_s": 8173.982470273972, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171075590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ce50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8173.982470273972, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 59.162962962962965, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 99.0, "episode_reward_min": 99.0, "episode_reward_mean": 99.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47560293346887617, "mean_raw_obs_processing_ms": 0.10610608127754677, "mean_inference_ms": 1.4520685856223872, "mean_action_processing_ms": 0.040256116780815226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1636000, "timers": {"sample_time_ms": 7316.094, "sample_throughput": 546.74, "learn_time_ms": 11674.93, "learn_throughput": 342.614, "update_time_ms": 2.984}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33365335985874417, "cur_lr": 5e-05, "total_loss": 3.58340135961771, "policy_loss": -0.015478441608138382, "vf_loss": 3.5930963903665543, "vf_explained_var": 0.80574631690979, "kl": 0.017333622265141457, "entropy": 0.1910420535132289, "entropy_coeff": 0.0}}, "num_steps_sampled": 1636000, "num_steps_trained": 1636000}, "done": false, "episodes_total": 163, "training_iteration": 409, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-14-11", "timestamp": 1618146851, "time_this_iter_s": 18.97589659690857, "time_total_s": 8192.95836687088, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110bc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8192.95836687088, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 58.28148148148148, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 241.0, "episode_reward_min": 241.0, "episode_reward_mean": 241.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4740967714923206, "mean_raw_obs_processing_ms": 0.10629390814988146, "mean_inference_ms": 1.452070190205253, "mean_action_processing_ms": 0.0402561278101238}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1640000, "timers": {"sample_time_ms": 7298.229, "sample_throughput": 548.078, "learn_time_ms": 11669.61, "learn_throughput": 342.771, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33365335985874417, "cur_lr": 5e-05, "total_loss": 3.088075891137123, "policy_loss": -0.005456867773318663, "vf_loss": 3.089091755449772, "vf_explained_var": 0.5440802574157715, "kl": 0.01331020438374253, "entropy": 0.08167512062937021, "entropy_coeff": 0.0}}, "num_steps_sampled": 1640000, "num_steps_trained": 1640000}, "done": false, "episodes_total": 164, "training_iteration": 410, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-14-30", "timestamp": 1618146870, "time_this_iter_s": 19.003011465072632, "time_total_s": 8211.961378335953, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717106c490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221fdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8211.961378335953, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 59.477777777777774, "ram_util_percent": 27.607407407407415}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 241.0, "episode_reward_min": 241.0, "episode_reward_mean": 241.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4740967714923206, "mean_raw_obs_processing_ms": 0.10629390814988146, "mean_inference_ms": 1.452070190205253, "mean_action_processing_ms": 0.0402561278101238}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1644000, "timers": {"sample_time_ms": 7323.181, "sample_throughput": 546.211, "learn_time_ms": 11673.044, "learn_throughput": 342.67, "update_time_ms": 3.003}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33365335985874417, "cur_lr": 5e-05, "total_loss": 6.560814157128334, "policy_loss": -0.029434601427055895, "vf_loss": 6.58502984046936, "vf_explained_var": 0.5174854397773743, "kl": 0.015641987120034173, "entropy": 0.13839352363720536, "entropy_coeff": 0.0}}, "num_steps_sampled": 1644000, "num_steps_trained": 1644000}, "done": false, "episodes_total": 164, "training_iteration": 411, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-14-49", "timestamp": 1618146889, "time_this_iter_s": 19.150136709213257, "time_total_s": 8231.111515045166, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8231.111515045166, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 58.4, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 241.0, "episode_reward_min": 241.0, "episode_reward_mean": 241.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4740967714923206, "mean_raw_obs_processing_ms": 0.10629390814988146, "mean_inference_ms": 1.452070190205253, "mean_action_processing_ms": 0.0402561278101238}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1648000, "timers": {"sample_time_ms": 7493.176, "sample_throughput": 533.819, "learn_time_ms": 11673.905, "learn_throughput": 342.645, "update_time_ms": 3.046}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33365335985874417, "cur_lr": 5e-05, "total_loss": 6.4827065616846085, "policy_loss": -0.03216712299035862, "vf_loss": 6.5072589963674545, "vf_explained_var": 0.6384466886520386, "kl": 0.02282220683991909, "entropy": 0.17361441953107715, "entropy_coeff": 0.0}}, "num_steps_sampled": 1648000, "num_steps_trained": 1648000}, "done": false, "episodes_total": 164, "training_iteration": 412, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-15-10", "timestamp": 1618146910, "time_this_iter_s": 20.726201057434082, "time_total_s": 8251.8377161026, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711404d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8251.8377161026, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 58.71000000000001, "ram_util_percent": 27.60000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 704.0, "episode_reward_min": 704.0, "episode_reward_mean": 704.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [704.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47340973517156604, "mean_raw_obs_processing_ms": 0.10658120747715381, "mean_inference_ms": 1.4521024786301395, "mean_action_processing_ms": 0.04025734122504805}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1652000, "timers": {"sample_time_ms": 7585.995, "sample_throughput": 527.287, "learn_time_ms": 11689.886, "learn_throughput": 342.176, "update_time_ms": 3.001}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 8.73596267402172, "policy_loss": -0.020322608383139595, "vf_loss": 8.749558210372925, "vf_explained_var": 0.5779288411140442, "kl": 0.013441041839541867, "entropy": 0.16442566271871328, "entropy_coeff": 0.0}}, "num_steps_sampled": 1652000, "num_steps_trained": 1652000}, "done": false, "episodes_total": 165, "training_iteration": 413, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-15-30", "timestamp": 1618146930, "time_this_iter_s": 19.85730743408203, "time_total_s": 8271.695023536682, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171071fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8271.695023536682, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 58.74285714285714, "ram_util_percent": 27.600000000000005}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 704.0, "episode_reward_min": 704.0, "episode_reward_mean": 704.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [704.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47340973517156604, "mean_raw_obs_processing_ms": 0.10658120747715381, "mean_inference_ms": 1.4521024786301395, "mean_action_processing_ms": 0.04025734122504805}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1656000, "timers": {"sample_time_ms": 7683.317, "sample_throughput": 520.608, "learn_time_ms": 11676.457, "learn_throughput": 342.57, "update_time_ms": 2.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 8.66038666665554, "policy_loss": -0.014878537214826792, "vf_loss": 8.669935524463654, "vf_explained_var": 0.5760476589202881, "kl": 0.010649085626937449, "entropy": 0.14890722138807178, "entropy_coeff": 0.0}}, "num_steps_sampled": 1656000, "num_steps_trained": 1656000}, "done": false, "episodes_total": 165, "training_iteration": 414, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-15-49", "timestamp": 1618146949, "time_this_iter_s": 19.681633949279785, "time_total_s": 8291.376657485962, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710753d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8291.376657485962, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 58.646428571428565, "ram_util_percent": 27.696428571428577}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 454.0, "episode_reward_min": 454.0, "episode_reward_mean": 454.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [454.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4724200644445181, "mean_raw_obs_processing_ms": 0.106770601067434, "mean_inference_ms": 1.4521132782849158, "mean_action_processing_ms": 0.040256713119056875}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1660000, "timers": {"sample_time_ms": 7637.017, "sample_throughput": 523.765, "learn_time_ms": 11674.648, "learn_throughput": 342.623, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 4.127562023699284, "policy_loss": -0.030608790984842926, "vf_loss": 4.145378232002258, "vf_explained_var": 0.31517183780670166, "kl": 0.025560619251336902, "entropy": 0.129071720642969, "entropy_coeff": 0.0}}, "num_steps_sampled": 1660000, "num_steps_trained": 1660000}, "done": false, "episodes_total": 166, "training_iteration": 415, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-16-08", "timestamp": 1618146968, "time_this_iter_s": 19.015770435333252, "time_total_s": 8310.392427921295, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8310.392427921295, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 59.19285714285716, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 454.0, "episode_reward_min": 454.0, "episode_reward_mean": 454.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [454.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4724200644445181, "mean_raw_obs_processing_ms": 0.106770601067434, "mean_inference_ms": 1.4521132782849158, "mean_action_processing_ms": 0.040256713119056875}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1664000, "timers": {"sample_time_ms": 7638.326, "sample_throughput": 523.675, "learn_time_ms": 11661.573, "learn_throughput": 343.007, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7507200596821744, "cur_lr": 5e-05, "total_loss": 5.666227638721466, "policy_loss": -0.05583482654765248, "vf_loss": 5.689679741859436, "vf_explained_var": 0.48814189434051514, "kl": 0.043135410582181066, "entropy": 0.2072492027655244, "entropy_coeff": 0.0}}, "num_steps_sampled": 1664000, "num_steps_trained": 1664000}, "done": false, "episodes_total": 166, "training_iteration": 416, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-16-27", "timestamp": 1618146987, "time_this_iter_s": 18.97151517868042, "time_total_s": 8329.363943099976, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71719e2f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8329.363943099976, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 58.17777777777778, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 454.0, "episode_reward_min": 454.0, "episode_reward_mean": 454.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [454.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4724200644445181, "mean_raw_obs_processing_ms": 0.106770601067434, "mean_inference_ms": 1.4521132782849158, "mean_action_processing_ms": 0.040256713119056875}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1668000, "timers": {"sample_time_ms": 7626.171, "sample_throughput": 524.51, "learn_time_ms": 11668.991, "learn_throughput": 342.789, "update_time_ms": 2.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 5.663621693849564, "policy_loss": -0.014040483511053026, "vf_loss": 5.673047825694084, "vf_explained_var": 0.6660919189453125, "kl": 0.004097721575817559, "entropy": 0.17059638327918947, "entropy_coeff": 0.0}}, "num_steps_sampled": 1668000, "num_steps_trained": 1668000}, "done": false, "episodes_total": 166, "training_iteration": 417, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-16-46", "timestamp": 1618147006, "time_this_iter_s": 18.79483938217163, "time_total_s": 8348.158782482147, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8348.158782482147, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 59.43333333333333, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 591.0, "episode_reward_min": 591.0, "episode_reward_mean": 591.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [591.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47026786116230845, "mean_raw_obs_processing_ms": 0.1070441623658429, "mean_inference_ms": 1.451998341722002, "mean_action_processing_ms": 0.04025359375684893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1672000, "timers": {"sample_time_ms": 7615.934, "sample_throughput": 525.215, "learn_time_ms": 11691.091, "learn_throughput": 342.141, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 6.561935484409332, "policy_loss": -0.02303721144562587, "vf_loss": 6.580100268125534, "vf_explained_var": 0.5767676830291748, "kl": 0.008653672382934019, "entropy": 0.1580810546875, "entropy_coeff": 0.0}}, "num_steps_sampled": 1672000, "num_steps_trained": 1672000}, "done": false, "episodes_total": 167, "training_iteration": 418, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-17-05", "timestamp": 1618147025, "time_this_iter_s": 18.993725299835205, "time_total_s": 8367.152507781982, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717221f490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8367.152507781982, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 59.06296296296296, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 591.0, "episode_reward_min": 591.0, "episode_reward_mean": 591.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [591.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47026786116230845, "mean_raw_obs_processing_ms": 0.1070441623658429, "mean_inference_ms": 1.451998341722002, "mean_action_processing_ms": 0.04025359375684893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1676000, "timers": {"sample_time_ms": 7701.256, "sample_throughput": 519.396, "learn_time_ms": 11683.623, "learn_throughput": 342.36, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 7.862465366721153, "policy_loss": -0.04685993044404313, "vf_loss": 7.895607516169548, "vf_explained_var": 0.54356849193573, "kl": 0.024363686417927966, "entropy": 0.13666036911308765, "entropy_coeff": 0.0}}, "num_steps_sampled": 1676000, "num_steps_trained": 1676000}, "done": false, "episodes_total": 167, "training_iteration": 419, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-17-25", "timestamp": 1618147045, "time_this_iter_s": 19.75332736968994, "time_total_s": 8386.905835151672, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116eed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8386.905835151672, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 59.192857142857136, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 796.0, "episode_reward_min": 796.0, "episode_reward_mean": 796.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [796.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46944255332368057, "mean_raw_obs_processing_ms": 0.10724261604488841, "mean_inference_ms": 1.4520056420631249, "mean_action_processing_ms": 0.040254800115189504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1680000, "timers": {"sample_time_ms": 7724.406, "sample_throughput": 517.839, "learn_time_ms": 11683.31, "learn_throughput": 342.369, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 8.298365354537964, "policy_loss": -0.03851539985043928, "vf_loss": 8.321444064378738, "vf_explained_var": 0.533947229385376, "kl": 0.018277868926816154, "entropy": 0.12184575549326837, "entropy_coeff": 0.0}}, "num_steps_sampled": 1680000, "num_steps_trained": 1680000}, "done": false, "episodes_total": 168, "training_iteration": 420, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-17-44", "timestamp": 1618147064, "time_this_iter_s": 19.22585368156433, "time_total_s": 8406.131688833237, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171075c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8406.131688833237, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 58.06296296296296, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 796.0, "episode_reward_min": 796.0, "episode_reward_mean": 796.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [796.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46944255332368057, "mean_raw_obs_processing_ms": 0.10724261604488841, "mean_inference_ms": 1.4520056420631249, "mean_action_processing_ms": 0.040254800115189504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1684000, "timers": {"sample_time_ms": 7719.595, "sample_throughput": 518.162, "learn_time_ms": 11674.31, "learn_throughput": 342.633, "update_time_ms": 2.871}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 5.415018759667873, "policy_loss": -0.02605196717195213, "vf_loss": 5.4127315282821655, "vf_explained_var": -0.0027300771325826645, "kl": 0.03355495590949431, "entropy": 0.10628349776379764, "entropy_coeff": 0.0}}, "num_steps_sampled": 1684000, "num_steps_trained": 1684000}, "done": false, "episodes_total": 168, "training_iteration": 421, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-18-03", "timestamp": 1618147083, "time_this_iter_s": 19.01214599609375, "time_total_s": 8425.14383482933, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71721f7c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8425.14383482933, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 59.14642857142858, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 796.0, "episode_reward_min": 796.0, "episode_reward_mean": 796.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [796.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46944255332368057, "mean_raw_obs_processing_ms": 0.10724261604488841, "mean_inference_ms": 1.4520056420631249, "mean_action_processing_ms": 0.040254800115189504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1688000, "timers": {"sample_time_ms": 7552.124, "sample_throughput": 529.652, "learn_time_ms": 11672.75, "learn_throughput": 342.678, "update_time_ms": 2.86}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2668401007136694, "cur_lr": 5e-05, "total_loss": 3.275268629193306, "policy_loss": -0.012371353921480477, "vf_loss": 3.284552328288555, "vf_explained_var": 0.6913254261016846, "kl": 0.002437296429889102, "entropy": 0.039761414751410484, "entropy_coeff": 0.0}}, "num_steps_sampled": 1688000, "num_steps_trained": 1688000}, "done": false, "episodes_total": 168, "training_iteration": 422, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-18-22", "timestamp": 1618147102, "time_this_iter_s": 19.033021450042725, "time_total_s": 8444.176856279373, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8444.176856279373, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 58.6, "ram_util_percent": 27.6962962962963}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 285.0, "episode_reward_min": 285.0, "episode_reward_mean": 285.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46788878876720225, "mean_raw_obs_processing_ms": 0.10752070669100215, "mean_inference_ms": 1.4519679404044914, "mean_action_processing_ms": 0.04025212221539652}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1692000, "timers": {"sample_time_ms": 7557.353, "sample_throughput": 529.286, "learn_time_ms": 11654.385, "learn_throughput": 343.218, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 6.922717958688736, "policy_loss": -0.027553281834116206, "vf_loss": 6.942468479275703, "vf_explained_var": 0.4610406756401062, "kl": 0.012318548542680219, "entropy": 0.09976564161479473, "entropy_coeff": 0.0}}, "num_steps_sampled": 1692000, "num_steps_trained": 1692000}, "done": false, "episodes_total": 169, "training_iteration": 423, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-18-42", "timestamp": 1618147122, "time_this_iter_s": 19.726252794265747, "time_total_s": 8463.903109073639, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171075a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171071d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8463.903109073639, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 59.13928571428573, "ram_util_percent": 27.68571428571429}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 285.0, "episode_reward_min": 285.0, "episode_reward_mean": 285.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46788878876720225, "mean_raw_obs_processing_ms": 0.10752070669100215, "mean_inference_ms": 1.4519679404044914, "mean_action_processing_ms": 0.04025212221539652}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1696000, "timers": {"sample_time_ms": 7477.879, "sample_throughput": 534.911, "learn_time_ms": 11662.019, "learn_throughput": 342.994, "update_time_ms": 2.926}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 3.6053132712841034, "policy_loss": -0.011871078400872648, "vf_loss": 3.612148329615593, "vf_explained_var": 0.5611562132835388, "kl": 0.007950479302962776, "entropy": 0.07958599110133946, "entropy_coeff": 0.0}}, "num_steps_sampled": 1696000, "num_steps_trained": 1696000}, "done": false, "episodes_total": 169, "training_iteration": 424, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-19-01", "timestamp": 1618147141, "time_this_iter_s": 18.96622061729431, "time_total_s": 8482.869329690933, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171140fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8482.869329690933, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 58.34814814814814, "ram_util_percent": 27.659259259259265}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4665372419639166, "mean_raw_obs_processing_ms": 0.10770163581884581, "mean_inference_ms": 1.4519243565991153, "mean_action_processing_ms": 0.04025118690017893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1700000, "timers": {"sample_time_ms": 7478.26, "sample_throughput": 534.884, "learn_time_ms": 11672.277, "learn_throughput": 342.692, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 4.082923077046871, "policy_loss": -0.010506682679988444, "vf_loss": 4.089753188192844, "vf_explained_var": 0.6234561204910278, "kl": 0.0058044182223966345, "entropy": 0.06972629844676703, "entropy_coeff": 0.0}}, "num_steps_sampled": 1700000, "num_steps_trained": 1700000}, "done": false, "episodes_total": 170, "training_iteration": 425, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-19-20", "timestamp": 1618147160, "time_this_iter_s": 19.124844074249268, "time_total_s": 8501.994173765182, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710caa10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8501.994173765182, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 59.25555555555556, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4665372419639166, "mean_raw_obs_processing_ms": 0.10770163581884581, "mean_inference_ms": 1.4519243565991153, "mean_action_processing_ms": 0.04025118690017893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1704000, "timers": {"sample_time_ms": 7448.954, "sample_throughput": 536.988, "learn_time_ms": 11688.457, "learn_throughput": 342.218, "update_time_ms": 2.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 3.3778494894504547, "policy_loss": -0.030475752078928053, "vf_loss": 3.3994640186429024, "vf_explained_var": 0.3426666855812073, "kl": 0.01398950896691531, "entropy": 0.15597435156814754, "entropy_coeff": 0.0}}, "num_steps_sampled": 1704000, "num_steps_trained": 1704000}, "done": false, "episodes_total": 170, "training_iteration": 426, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-19-39", "timestamp": 1618147179, "time_this_iter_s": 18.842628479003906, "time_total_s": 8520.836802244186, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8520.836802244186, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 58.46666666666667, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4665372419639166, "mean_raw_obs_processing_ms": 0.10770163581884581, "mean_inference_ms": 1.4519243565991153, "mean_action_processing_ms": 0.04025118690017893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1708000, "timers": {"sample_time_ms": 7482.778, "sample_throughput": 534.561, "learn_time_ms": 11709.059, "learn_throughput": 341.616, "update_time_ms": 2.99}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 1.5384837444871664, "policy_loss": -0.016135920712258667, "vf_loss": 1.5504203978925943, "vf_explained_var": 0.8220640420913696, "kl": 0.006629516668908764, "entropy": 0.08585769683122635, "entropy_coeff": 0.0}}, "num_steps_sampled": 1708000, "num_steps_trained": 1708000}, "done": false, "episodes_total": 170, "training_iteration": 427, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-19-58", "timestamp": 1618147198, "time_this_iter_s": 19.341508388519287, "time_total_s": 8540.178310632706, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8540.178310632706, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 59.399999999999984, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 287.0, "episode_reward_min": 287.0, "episode_reward_mean": 287.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4643720457044817, "mean_raw_obs_processing_ms": 0.10797862069417931, "mean_inference_ms": 1.4519246964513752, "mean_action_processing_ms": 0.04025080691095262}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1712000, "timers": {"sample_time_ms": 7484.604, "sample_throughput": 534.43, "learn_time_ms": 11687.302, "learn_throughput": 342.252, "update_time_ms": 2.946}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 4.260344184935093, "policy_loss": -0.014641003450378776, "vf_loss": 4.270420789718628, "vf_explained_var": 0.5930508971214294, "kl": 0.007206009162473492, "entropy": 0.13702949229627848, "entropy_coeff": 0.0}}, "num_steps_sampled": 1712000, "num_steps_trained": 1712000}, "done": false, "episodes_total": 171, "training_iteration": 428, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-20-17", "timestamp": 1618147217, "time_this_iter_s": 18.790426015853882, "time_total_s": 8558.96873664856, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171071310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171071410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8558.96873664856, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 58.148148148148145, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 287.0, "episode_reward_min": 287.0, "episode_reward_mean": 287.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4643720457044817, "mean_raw_obs_processing_ms": 0.10797862069417931, "mean_inference_ms": 1.4519246964513752, "mean_action_processing_ms": 0.04025080691095262}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1716000, "timers": {"sample_time_ms": 7395.616, "sample_throughput": 540.861, "learn_time_ms": 11691.937, "learn_throughput": 342.116, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6334200503568347, "cur_lr": 5e-05, "total_loss": 2.195963427424431, "policy_loss": -0.005088276026071981, "vf_loss": 2.1984801329672337, "vf_explained_var": 0.1378607302904129, "kl": 0.004059800863615237, "entropy": 0.13576087774708867, "entropy_coeff": 0.0}}, "num_steps_sampled": 1716000, "num_steps_trained": 1716000}, "done": false, "episodes_total": 171, "training_iteration": 429, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-20-36", "timestamp": 1618147236, "time_this_iter_s": 18.909613847732544, "time_total_s": 8577.878350496292, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717223fa90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8577.878350496292, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 59.53703703703703, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 73.0, "episode_reward_min": 73.0, "episode_reward_mean": 73.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.462914493388338, "mean_raw_obs_processing_ms": 0.10815634718598327, "mean_inference_ms": 1.4518879579029154, "mean_action_processing_ms": 0.04024795005319591}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1720000, "timers": {"sample_time_ms": 7357.531, "sample_throughput": 543.661, "learn_time_ms": 11685.107, "learn_throughput": 342.316, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.31671002517841734, "cur_lr": 5e-05, "total_loss": 3.0004707872867584, "policy_loss": -0.07003482518484816, "vf_loss": 3.0438276305794716, "vf_explained_var": 0.43504542112350464, "kl": 0.08423479623161256, "entropy": 0.2516942834481597, "entropy_coeff": 0.0}}, "num_steps_sampled": 1720000, "num_steps_trained": 1720000}, "done": false, "episodes_total": 172, "training_iteration": 430, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-20-55", "timestamp": 1618147255, "time_this_iter_s": 18.777729272842407, "time_total_s": 8596.656079769135, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8596.656079769135, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 58.311111111111124, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 73.0, "episode_reward_min": 73.0, "episode_reward_mean": 73.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.462914493388338, "mean_raw_obs_processing_ms": 0.10815634718598327, "mean_inference_ms": 1.4518879579029154, "mean_action_processing_ms": 0.04024795005319591}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1724000, "timers": {"sample_time_ms": 7357.425, "sample_throughput": 543.668, "learn_time_ms": 11678.958, "learn_throughput": 342.496, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.475065037767626, "cur_lr": 5e-05, "total_loss": 6.258239850401878, "policy_loss": -0.030280468170531094, "vf_loss": 6.282013088464737, "vf_explained_var": 0.5015844106674194, "kl": 0.013697443151613697, "entropy": 0.19582498399540782, "entropy_coeff": 0.0}}, "num_steps_sampled": 1724000, "num_steps_trained": 1724000}, "done": false, "episodes_total": 172, "training_iteration": 431, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-21-14", "timestamp": 1618147274, "time_this_iter_s": 18.948257446289062, "time_total_s": 8615.604337215424, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffdd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171142450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8615.604337215424, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 59.34074074074075, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 73.0, "episode_reward_min": 73.0, "episode_reward_mean": 73.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.462914493388338, "mean_raw_obs_processing_ms": 0.10815634718598327, "mean_inference_ms": 1.4518879579029154, "mean_action_processing_ms": 0.04024795005319591}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1728000, "timers": {"sample_time_ms": 7327.129, "sample_throughput": 545.916, "learn_time_ms": 11680.274, "learn_throughput": 342.458, "update_time_ms": 2.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.475065037767626, "cur_lr": 5e-05, "total_loss": 1.9376536756753922, "policy_loss": -0.027954042598139495, "vf_loss": 1.9613543786108494, "vf_explained_var": 0.4055679440498352, "kl": 0.008953156328061596, "entropy": 0.21957972878590226, "entropy_coeff": 0.0}}, "num_steps_sampled": 1728000, "num_steps_trained": 1728000}, "done": false, "episodes_total": 172, "training_iteration": 432, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-21-33", "timestamp": 1618147293, "time_this_iter_s": 18.743343114852905, "time_total_s": 8634.347680330276, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171071890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8634.347680330276, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 58.646153846153844, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 358.0, "episode_reward_min": 358.0, "episode_reward_mean": 358.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46154342762407413, "mean_raw_obs_processing_ms": 0.10844414863964613, "mean_inference_ms": 1.4519993079002536, "mean_action_processing_ms": 0.04024898168720427}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1732000, "timers": {"sample_time_ms": 7405.514, "sample_throughput": 540.138, "learn_time_ms": 11675.527, "learn_throughput": 342.597, "update_time_ms": 2.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.475065037767626, "cur_lr": 5e-05, "total_loss": 7.135093614459038, "policy_loss": -0.025454943475779146, "vf_loss": 7.150424897670746, "vf_explained_var": 0.6005613803863525, "kl": 0.021309964504325762, "entropy": 0.13377027912065387, "entropy_coeff": 0.0}}, "num_steps_sampled": 1732000, "num_steps_trained": 1732000}, "done": false, "episodes_total": 173, "training_iteration": 433, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-21-53", "timestamp": 1618147313, "time_this_iter_s": 20.459795236587524, "time_total_s": 8654.807475566864, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110b290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8654.807475566864, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 58.81333333333332, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 358.0, "episode_reward_min": 358.0, "episode_reward_mean": 358.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46154342762407413, "mean_raw_obs_processing_ms": 0.10844414863964613, "mean_inference_ms": 1.4519993079002536, "mean_action_processing_ms": 0.04024898168720427}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1736000, "timers": {"sample_time_ms": 7482.837, "sample_throughput": 534.557, "learn_time_ms": 11682.185, "learn_throughput": 342.402, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.712597556651439, "cur_lr": 5e-05, "total_loss": 8.623846724629402, "policy_loss": -0.03450530243571848, "vf_loss": 8.64711844921112, "vf_explained_var": 0.5292962789535522, "kl": 0.015764518233481795, "entropy": 0.11240160558372736, "entropy_coeff": 0.0}}, "num_steps_sampled": 1736000, "num_steps_trained": 1736000}, "done": false, "episodes_total": 173, "training_iteration": 434, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-22-13", "timestamp": 1618147333, "time_this_iter_s": 19.806461811065674, "time_total_s": 8674.61393737793, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8674.61393737793, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 59.00714285714286, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 888.0, "episode_reward_min": 888.0, "episode_reward_mean": 888.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [888.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4614716297521944, "mean_raw_obs_processing_ms": 0.10860379132493934, "mean_inference_ms": 1.4518084633862773, "mean_action_processing_ms": 0.04024225435198746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1740000, "timers": {"sample_time_ms": 7588.219, "sample_throughput": 527.133, "learn_time_ms": 11670.204, "learn_throughput": 342.753, "update_time_ms": 2.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.712597556651439, "cur_lr": 5e-05, "total_loss": 7.720381200313568, "policy_loss": -0.045847990666516125, "vf_loss": 7.743587538599968, "vf_explained_var": 0.5010230541229248, "kl": 0.03177348029566929, "entropy": 0.1265775712672621, "entropy_coeff": 0.0}}, "num_steps_sampled": 1740000, "num_steps_trained": 1740000}, "done": false, "episodes_total": 174, "training_iteration": 435, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-22-33", "timestamp": 1618147353, "time_this_iter_s": 20.059826374053955, "time_total_s": 8694.673763751984, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717119b5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8694.673763751984, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 58.189655172413794, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 888.0, "episode_reward_min": 888.0, "episode_reward_mean": 888.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [888.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4614716297521944, "mean_raw_obs_processing_ms": 0.10860379132493934, "mean_inference_ms": 1.4518084633862773, "mean_action_processing_ms": 0.04024225435198746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1744000, "timers": {"sample_time_ms": 7705.518, "sample_throughput": 519.108, "learn_time_ms": 11670.952, "learn_throughput": 342.731, "update_time_ms": 2.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0688963349771585, "cur_lr": 5e-05, "total_loss": 8.542615950107574, "policy_loss": -0.032933552109170705, "vf_loss": 8.55477948486805, "vf_explained_var": 0.5558929443359375, "kl": 0.019431122185778804, "entropy": 0.10524543072097003, "entropy_coeff": 0.0}}, "num_steps_sampled": 1744000, "num_steps_trained": 1744000}, "done": false, "episodes_total": 174, "training_iteration": 436, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-22-53", "timestamp": 1618147373, "time_this_iter_s": 20.02101731300354, "time_total_s": 8714.694781064987, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171119090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8714.694781064987, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 59.089285714285715, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 888.0, "episode_reward_min": 888.0, "episode_reward_mean": 888.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [888.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4614716297521944, "mean_raw_obs_processing_ms": 0.10860379132493934, "mean_inference_ms": 1.4518084633862773, "mean_action_processing_ms": 0.04024225435198746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1748000, "timers": {"sample_time_ms": 7678.368, "sample_throughput": 520.944, "learn_time_ms": 11659.434, "learn_throughput": 343.07, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0688963349771585, "cur_lr": 5e-05, "total_loss": 7.958572655916214, "policy_loss": -0.02657354000257328, "vf_loss": 7.976629346609116, "vf_explained_var": 0.5317682027816772, "kl": 0.007967917506903177, "entropy": 0.0949015092337504, "entropy_coeff": 0.0}}, "num_steps_sampled": 1748000, "num_steps_trained": 1748000}, "done": false, "episodes_total": 174, "training_iteration": 437, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-23-12", "timestamp": 1618147392, "time_this_iter_s": 18.954771280288696, "time_total_s": 8733.649552345276, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8733.649552345276, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 58.6962962962963, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1007.0, "episode_reward_min": 1007.0, "episode_reward_mean": 1007.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1007.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4603126333876941, "mean_raw_obs_processing_ms": 0.10888157904931364, "mean_inference_ms": 1.4518308504232065, "mean_action_processing_ms": 0.04024135416168155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1752000, "timers": {"sample_time_ms": 7754.063, "sample_throughput": 515.859, "learn_time_ms": 11653.76, "learn_throughput": 343.237, "update_time_ms": 2.951}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0688963349771585, "cur_lr": 5e-05, "total_loss": 9.180258870124817, "policy_loss": -0.025385665183421224, "vf_loss": 9.200595542788506, "vf_explained_var": 0.4531853199005127, "kl": 0.004723620833829045, "entropy": 0.08989499369636178, "entropy_coeff": 0.0}}, "num_steps_sampled": 1752000, "num_steps_trained": 1752000}, "done": false, "episodes_total": 175, "training_iteration": 438, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-23-32", "timestamp": 1618147412, "time_this_iter_s": 19.490721464157104, "time_total_s": 8753.140273809433, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8753.140273809433, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 59.29642857142857, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1007.0, "episode_reward_min": 1007.0, "episode_reward_mean": 1007.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1007.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4603126333876941, "mean_raw_obs_processing_ms": 0.10888157904931364, "mean_inference_ms": 1.4518308504232065, "mean_action_processing_ms": 0.04024135416168155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1756000, "timers": {"sample_time_ms": 7838.583, "sample_throughput": 510.296, "learn_time_ms": 11669.099, "learn_throughput": 342.786, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 9.216902196407318, "policy_loss": -0.024639264534926042, "vf_loss": 9.233862146735191, "vf_explained_var": 0.620326042175293, "kl": 0.014368640026077628, "entropy": 0.10115289874374866, "entropy_coeff": 0.0}}, "num_steps_sampled": 1756000, "num_steps_trained": 1756000}, "done": false, "episodes_total": 175, "training_iteration": 439, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-23-52", "timestamp": 1618147432, "time_this_iter_s": 19.908299684524536, "time_total_s": 8773.048573493958, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711757d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171063e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8773.048573493958, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 58.503571428571426, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 881.0, "episode_reward_min": 881.0, "episode_reward_mean": 881.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [881.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45957639141474305, "mean_raw_obs_processing_ms": 0.10905252283277395, "mean_inference_ms": 1.4517020521001758, "mean_action_processing_ms": 0.040237532045564656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1760000, "timers": {"sample_time_ms": 7855.526, "sample_throughput": 509.196, "learn_time_ms": 11668.075, "learn_throughput": 342.816, "update_time_ms": 3.056}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 7.456739500164986, "policy_loss": -0.029342955676838756, "vf_loss": 7.476828187704086, "vf_explained_var": 0.7753593325614929, "kl": 0.017315650125965476, "entropy": 0.0959332212805748, "entropy_coeff": 0.0}}, "num_steps_sampled": 1760000, "num_steps_trained": 1760000}, "done": false, "episodes_total": 176, "training_iteration": 440, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-24-11", "timestamp": 1618147451, "time_this_iter_s": 18.934664964675903, "time_total_s": 8791.983238458633, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171063890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114eb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8791.983238458633, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 58.94814814814816, "ram_util_percent": 27.6962962962963}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 881.0, "episode_reward_min": 881.0, "episode_reward_mean": 881.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [881.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45957639141474305, "mean_raw_obs_processing_ms": 0.10905252283277395, "mean_inference_ms": 1.4517020521001758, "mean_action_processing_ms": 0.040237532045564656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1764000, "timers": {"sample_time_ms": 7855.133, "sample_throughput": 509.221, "learn_time_ms": 11686.334, "learn_throughput": 342.28, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 8.783723279833794, "policy_loss": -0.029528677376220003, "vf_loss": 8.804125726222992, "vf_explained_var": 0.3308299779891968, "kl": 0.01707582791277673, "entropy": 0.10949128353968263, "entropy_coeff": 0.0}}, "num_steps_sampled": 1764000, "num_steps_trained": 1764000}, "done": false, "episodes_total": 176, "training_iteration": 441, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-24-30", "timestamp": 1618147470, "time_this_iter_s": 19.12689995765686, "time_total_s": 8811.11013841629, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717104cb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171183290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8811.11013841629, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 59.36071428571429, "ram_util_percent": 27.696428571428577}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 881.0, "episode_reward_min": 881.0, "episode_reward_mean": 881.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [881.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45957639141474305, "mean_raw_obs_processing_ms": 0.10905252283277395, "mean_inference_ms": 1.4517020521001758, "mean_action_processing_ms": 0.040237532045564656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1768000, "timers": {"sample_time_ms": 7882.771, "sample_throughput": 507.436, "learn_time_ms": 11686.687, "learn_throughput": 342.27, "update_time_ms": 3.107}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 9.413983434438705, "policy_loss": -0.020297035458497703, "vf_loss": 9.427884265780449, "vf_explained_var": 0.38594192266464233, "kl": 0.01196768535010051, "entropy": 0.11785935214720666, "entropy_coeff": 0.0}}, "num_steps_sampled": 1768000, "num_steps_trained": 1768000}, "done": false, "episodes_total": 176, "training_iteration": 442, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-24-49", "timestamp": 1618147489, "time_this_iter_s": 19.02367353439331, "time_total_s": 8830.133811950684, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171051e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114ef90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8830.133811950684, "timesteps_since_restore": 0, "iterations_since_restore": 442, "perf": {"cpu_util_percent": 58.34814814814815, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1072.0, "episode_reward_min": 1072.0, "episode_reward_mean": 1072.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1072.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45772574719659737, "mean_raw_obs_processing_ms": 0.10931487485735238, "mean_inference_ms": 1.4515841413048576, "mean_action_processing_ms": 0.04023436515713939}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1772000, "timers": {"sample_time_ms": 7717.405, "sample_throughput": 518.309, "learn_time_ms": 11717.978, "learn_throughput": 341.356, "update_time_ms": 3.14}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 6.152857944369316, "policy_loss": -0.021903014567214996, "vf_loss": 6.1674951910972595, "vf_explained_var": 0.36752021312713623, "kl": 0.013594823714811355, "entropy": 0.1329070006031543, "entropy_coeff": 0.0}}, "num_steps_sampled": 1772000, "num_steps_trained": 1772000}, "done": false, "episodes_total": 177, "training_iteration": 443, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-25-08", "timestamp": 1618147508, "time_this_iter_s": 19.122373819351196, "time_total_s": 8849.256185770035, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffded0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8849.256185770035, "timesteps_since_restore": 0, "iterations_since_restore": 443, "perf": {"cpu_util_percent": 58.6925925925926, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1072.0, "episode_reward_min": 1072.0, "episode_reward_mean": 1072.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1072.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45772574719659737, "mean_raw_obs_processing_ms": 0.10931487485735238, "mean_inference_ms": 1.4515841413048576, "mean_action_processing_ms": 0.04023436515713939}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1776000, "timers": {"sample_time_ms": 7652.248, "sample_throughput": 522.722, "learn_time_ms": 11709.741, "learn_throughput": 341.596, "update_time_ms": 3.14}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 5.921964526176453, "policy_loss": -0.0168873859802261, "vf_loss": 5.935246653854847, "vf_explained_var": 0.4462638199329376, "kl": 0.006745933438651264, "entropy": 0.0909805076662451, "entropy_coeff": 0.0}}, "num_steps_sampled": 1776000, "num_steps_trained": 1776000}, "done": false, "episodes_total": 177, "training_iteration": 444, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-25-27", "timestamp": 1618147527, "time_this_iter_s": 19.072082996368408, "time_total_s": 8868.328268766403, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171051bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8868.328268766403, "timesteps_since_restore": 0, "iterations_since_restore": 444, "perf": {"cpu_util_percent": 59.26071428571429, "ram_util_percent": 27.671428571428578}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 504.0, "episode_reward_min": 504.0, "episode_reward_mean": 504.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [504.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45635879949136554, "mean_raw_obs_processing_ms": 0.10949239553435565, "mean_inference_ms": 1.4515106412698864, "mean_action_processing_ms": 0.04023358490334654}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1780000, "timers": {"sample_time_ms": 7508.952, "sample_throughput": 532.698, "learn_time_ms": 11712.678, "learn_throughput": 341.51, "update_time_ms": 3.199}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 5.0746609047055244, "policy_loss": -0.017152970685856417, "vf_loss": 5.087003529071808, "vf_explained_var": 0.6513748168945312, "kl": 0.009000702426419593, "entropy": 0.22023336263373494, "entropy_coeff": 0.0}}, "num_steps_sampled": 1780000, "num_steps_trained": 1780000}, "done": false, "episodes_total": 178, "training_iteration": 445, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-25-46", "timestamp": 1618147546, "time_this_iter_s": 18.657941579818726, "time_total_s": 8886.986210346222, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fa2210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8886.986210346222, "timesteps_since_restore": 0, "iterations_since_restore": 445, "perf": {"cpu_util_percent": 58.357692307692304, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 504.0, "episode_reward_min": 504.0, "episode_reward_mean": 504.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [504.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45635879949136554, "mean_raw_obs_processing_ms": 0.10949239553435565, "mean_inference_ms": 1.4515106412698864, "mean_action_processing_ms": 0.04023358490334654}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1784000, "timers": {"sample_time_ms": 7386.291, "sample_throughput": 541.544, "learn_time_ms": 11718.741, "learn_throughput": 341.334, "update_time_ms": 3.161}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 5.343564324080944, "policy_loss": -0.030062349018407986, "vf_loss": 5.363972395658493, "vf_explained_var": 0.5532563924789429, "kl": 0.018064120755298063, "entropy": 0.2538322964683175, "entropy_coeff": 0.0}}, "num_steps_sampled": 1784000, "num_steps_trained": 1784000}, "done": false, "episodes_total": 178, "training_iteration": 446, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-26-05", "timestamp": 1618147565, "time_this_iter_s": 18.85779619216919, "time_total_s": 8905.844006538391, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fa2950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8905.844006538391, "timesteps_since_restore": 0, "iterations_since_restore": 446, "perf": {"cpu_util_percent": 59.311111111111124, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 504.0, "episode_reward_min": 504.0, "episode_reward_mean": 504.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [504.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45635879949136554, "mean_raw_obs_processing_ms": 0.10949239553435565, "mean_inference_ms": 1.4515106412698864, "mean_action_processing_ms": 0.04023358490334654}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1788000, "timers": {"sample_time_ms": 7384.516, "sample_throughput": 541.674, "learn_time_ms": 11705.344, "learn_throughput": 341.724, "update_time_ms": 3.169}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 4.592409774661064, "policy_loss": -0.011820630606962368, "vf_loss": 4.601570814847946, "vf_explained_var": 0.6841227412223816, "kl": 0.0049764642244554125, "entropy": 0.04536109062610194, "entropy_coeff": 0.0}}, "num_steps_sampled": 1788000, "num_steps_trained": 1788000}, "done": false, "episodes_total": 178, "training_iteration": 447, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-26-23", "timestamp": 1618147583, "time_this_iter_s": 18.804110527038574, "time_total_s": 8924.64811706543, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717105c810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171063810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8924.64811706543, "timesteps_since_restore": 0, "iterations_since_restore": 447, "perf": {"cpu_util_percent": 58.67407407407408, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 395.0, "episode_reward_min": 395.0, "episode_reward_mean": 395.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [395.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4543311769404751, "mean_raw_obs_processing_ms": 0.10976782808351192, "mean_inference_ms": 1.4515024730878976, "mean_action_processing_ms": 0.040230515447709725}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1792000, "timers": {"sample_time_ms": 7337.417, "sample_throughput": 545.151, "learn_time_ms": 11704.123, "learn_throughput": 341.76, "update_time_ms": 3.17}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.26722408374428963, "cur_lr": 5e-05, "total_loss": 6.796893194317818, "policy_loss": -0.032701122807338834, "vf_loss": 6.824394419789314, "vf_explained_var": 0.602205753326416, "kl": 0.01945938219432719, "entropy": 0.13229294144548476, "entropy_coeff": 0.0}}, "num_steps_sampled": 1792000, "num_steps_trained": 1792000}, "done": false, "episodes_total": 179, "training_iteration": 448, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-26-42", "timestamp": 1618147602, "time_this_iter_s": 19.00922465324402, "time_total_s": 8943.657341718674, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118ddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8943.657341718674, "timesteps_since_restore": 0, "iterations_since_restore": 448, "perf": {"cpu_util_percent": 59.548148148148144, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 395.0, "episode_reward_min": 395.0, "episode_reward_mean": 395.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [395.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4543311769404751, "mean_raw_obs_processing_ms": 0.10976782808351192, "mean_inference_ms": 1.4515024730878976, "mean_action_processing_ms": 0.040230515447709725}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1796000, "timers": {"sample_time_ms": 7298.983, "sample_throughput": 548.022, "learn_time_ms": 11720.904, "learn_throughput": 341.271, "update_time_ms": 3.126}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.26722408374428963, "cur_lr": 5e-05, "total_loss": 7.55507430434227, "policy_loss": -0.01064744807081297, "vf_loss": 7.558469511568546, "vf_explained_var": 0.576446533203125, "kl": 0.027139136829646304, "entropy": 0.1393956842366606, "entropy_coeff": 0.0}}, "num_steps_sampled": 1796000, "num_steps_trained": 1796000}, "done": false, "episodes_total": 179, "training_iteration": 449, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-27-02", "timestamp": 1618147622, "time_this_iter_s": 19.69089365005493, "time_total_s": 8963.348235368729, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717225b9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8963.348235368729, "timesteps_since_restore": 0, "iterations_since_restore": 449, "perf": {"cpu_util_percent": 58.767857142857146, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 378.0, "episode_reward_min": 378.0, "episode_reward_mean": 378.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45382708317852677, "mean_raw_obs_processing_ms": 0.1099545201748366, "mean_inference_ms": 1.4514870013160526, "mean_action_processing_ms": 0.040229189828574416}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1800000, "timers": {"sample_time_ms": 7395.571, "sample_throughput": 540.864, "learn_time_ms": 11713.444, "learn_throughput": 341.488, "update_time_ms": 3.044}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40083612561643445, "cur_lr": 5e-05, "total_loss": 4.027308385819197, "policy_loss": -0.060233410069486126, "vf_loss": 4.0454772636294365, "vf_explained_var": 0.7093337774276733, "kl": 0.10494195506908, "entropy": 0.23459160048514605, "entropy_coeff": 0.0}}, "num_steps_sampled": 1800000, "num_steps_trained": 1800000}, "done": false, "episodes_total": 180, "training_iteration": 450, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-27-22", "timestamp": 1618147642, "time_this_iter_s": 19.827720165252686, "time_total_s": 8983.175955533981, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711198d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ee10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8983.175955533981, "timesteps_since_restore": 0, "iterations_since_restore": 450, "perf": {"cpu_util_percent": 58.95172413793103, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 378.0, "episode_reward_min": 378.0, "episode_reward_mean": 378.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45382708317852677, "mean_raw_obs_processing_ms": 0.1099545201748366, "mean_inference_ms": 1.4514870013160526, "mean_action_processing_ms": 0.040229189828574416}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1804000, "timers": {"sample_time_ms": 7423.382, "sample_throughput": 538.838, "learn_time_ms": 11716.793, "learn_throughput": 341.39, "update_time_ms": 3.046}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5e-05, "total_loss": 7.652904883027077, "policy_loss": -0.05740369169507176, "vf_loss": 7.667716801166534, "vf_explained_var": 0.4853970408439636, "kl": 0.07083846046589315, "entropy": 0.17922385525889695, "entropy_coeff": 0.0}}, "num_steps_sampled": 1804000, "num_steps_trained": 1804000}, "done": false, "episodes_total": 180, "training_iteration": 451, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-27-42", "timestamp": 1618147662, "time_this_iter_s": 19.437708616256714, "time_total_s": 9002.613664150238, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114e590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171119750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9002.613664150238, "timesteps_since_restore": 0, "iterations_since_restore": 451, "perf": {"cpu_util_percent": 58.951851851851856, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 378.0, "episode_reward_min": 378.0, "episode_reward_mean": 378.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45382708317852677, "mean_raw_obs_processing_ms": 0.1099545201748366, "mean_inference_ms": 1.4514870013160526, "mean_action_processing_ms": 0.040229189828574416}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1808000, "timers": {"sample_time_ms": 7399.189, "sample_throughput": 540.6, "learn_time_ms": 11719.824, "learn_throughput": 341.302, "update_time_ms": 3.023}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9018812826369774, "cur_lr": 5e-05, "total_loss": 6.59384199231863, "policy_loss": -0.005833619274199009, "vf_loss": 6.597289100289345, "vf_explained_var": 0.341869592666626, "kl": 0.0026461517918505706, "entropy": 0.0553833392332308, "entropy_coeff": 0.0}}, "num_steps_sampled": 1808000, "num_steps_trained": 1808000}, "done": false, "episodes_total": 180, "training_iteration": 452, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-28-00", "timestamp": 1618147680, "time_this_iter_s": 18.811198949813843, "time_total_s": 9021.424863100052, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffdd10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7266306850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9021.424863100052, "timesteps_since_restore": 0, "iterations_since_restore": 452, "perf": {"cpu_util_percent": 58.888888888888886, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 359.0, "episode_reward_min": 359.0, "episode_reward_mean": 359.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4522055170805237, "mean_raw_obs_processing_ms": 0.11021010722352265, "mean_inference_ms": 1.4512990082613897, "mean_action_processing_ms": 0.04022190090535231}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1812000, "timers": {"sample_time_ms": 7409.198, "sample_throughput": 539.87, "learn_time_ms": 11717.594, "learn_throughput": 341.367, "update_time_ms": 2.983}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4509406413184887, "cur_lr": 5e-05, "total_loss": 7.85899992287159, "policy_loss": -0.020298261486459523, "vf_loss": 7.871965304017067, "vf_explained_var": 0.575335681438446, "kl": 0.01626156276324764, "entropy": 0.06080840574577451, "entropy_coeff": 0.0}}, "num_steps_sampled": 1812000, "num_steps_trained": 1812000}, "done": false, "episodes_total": 181, "training_iteration": 453, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-28-20", "timestamp": 1618147700, "time_this_iter_s": 19.19663667678833, "time_total_s": 9040.62149977684, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9040.62149977684, "timesteps_since_restore": 0, "iterations_since_restore": 453, "perf": {"cpu_util_percent": 59.12499999999999, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 359.0, "episode_reward_min": 359.0, "episode_reward_mean": 359.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4522055170805237, "mean_raw_obs_processing_ms": 0.11021010722352265, "mean_inference_ms": 1.4512990082613897, "mean_action_processing_ms": 0.04022190090535231}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1816000, "timers": {"sample_time_ms": 7389.015, "sample_throughput": 541.344, "learn_time_ms": 11708.942, "learn_throughput": 341.619, "update_time_ms": 2.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4509406413184887, "cur_lr": 5e-05, "total_loss": 4.883215896785259, "policy_loss": -0.029588555597001687, "vf_loss": 4.900914683938026, "vf_explained_var": 0.6352032423019409, "kl": 0.02636661328142509, "entropy": 0.09251685393974185, "entropy_coeff": 0.0}}, "num_steps_sampled": 1816000, "num_steps_trained": 1816000}, "done": false, "episodes_total": 181, "training_iteration": 454, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-28-38", "timestamp": 1618147718, "time_this_iter_s": 18.781708478927612, "time_total_s": 9059.403208255768, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9059.403208255768, "timesteps_since_restore": 0, "iterations_since_restore": 454, "perf": {"cpu_util_percent": 58.36296296296296, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 269.0, "episode_reward_min": 269.0, "episode_reward_mean": 269.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [269.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45096521174708676, "mean_raw_obs_processing_ms": 0.11039614637670958, "mean_inference_ms": 1.4512688320989573, "mean_action_processing_ms": 0.04022102779094757}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1820000, "timers": {"sample_time_ms": 7434.129, "sample_throughput": 538.059, "learn_time_ms": 11720.804, "learn_throughput": 341.274, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 5.046271346509457, "policy_loss": -0.009909171902108938, "vf_loss": 5.052049346268177, "vf_explained_var": 0.38142871856689453, "kl": 0.00610759504888847, "entropy": 0.14721653936430812, "entropy_coeff": 0.0}}, "num_steps_sampled": 1820000, "num_steps_trained": 1820000}, "done": false, "episodes_total": 182, "training_iteration": 455, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-28-58", "timestamp": 1618147738, "time_this_iter_s": 19.222689628601074, "time_total_s": 9078.625897884369, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171091090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9078.625897884369, "timesteps_since_restore": 0, "iterations_since_restore": 455, "perf": {"cpu_util_percent": 59.25185185185185, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 269.0, "episode_reward_min": 269.0, "episode_reward_mean": 269.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [269.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45096521174708676, "mean_raw_obs_processing_ms": 0.11039614637670958, "mean_inference_ms": 1.4512688320989573, "mean_action_processing_ms": 0.04022102779094757}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1824000, "timers": {"sample_time_ms": 7487.939, "sample_throughput": 534.192, "learn_time_ms": 11722.01, "learn_throughput": 341.238, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 10.946878224611282, "policy_loss": -0.012872094375779852, "vf_loss": 10.955541998147964, "vf_explained_var": 0.42124301195144653, "kl": 0.006221408577403054, "entropy": 0.08487565570976585, "entropy_coeff": 0.0}}, "num_steps_sampled": 1824000, "num_steps_trained": 1824000}, "done": false, "episodes_total": 182, "training_iteration": 456, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-29-17", "timestamp": 1618147757, "time_this_iter_s": 19.407532453536987, "time_total_s": 9098.033430337906, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171142290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171061910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9098.033430337906, "timesteps_since_restore": 0, "iterations_since_restore": 456, "perf": {"cpu_util_percent": 58.38571428571429, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 269.0, "episode_reward_min": 269.0, "episode_reward_mean": 269.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [269.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45096521174708676, "mean_raw_obs_processing_ms": 0.11039614637670958, "mean_inference_ms": 1.4512688320989573, "mean_action_processing_ms": 0.04022102779094757}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1828000, "timers": {"sample_time_ms": 7665.804, "sample_throughput": 521.798, "learn_time_ms": 11727.633, "learn_throughput": 341.075, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 6.088552266359329, "policy_loss": -0.027599003980867565, "vf_loss": 6.108825623989105, "vf_explained_var": 0.551884651184082, "kl": 0.010830222905497067, "entropy": 0.09581771783996373, "entropy_coeff": 0.0}}, "num_steps_sampled": 1828000, "num_steps_trained": 1828000}, "done": false, "episodes_total": 182, "training_iteration": 457, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-29-38", "timestamp": 1618147778, "time_this_iter_s": 20.63592028617859, "time_total_s": 9118.669350624084, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171198810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717225b0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9118.669350624084, "timesteps_since_restore": 0, "iterations_since_restore": 457, "perf": {"cpu_util_percent": 59.12413793103449, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1142.0, "episode_reward_min": 1142.0, "episode_reward_mean": 1142.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1142.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45088749705453723, "mean_raw_obs_processing_ms": 0.11067504520957844, "mean_inference_ms": 1.4512484615055719, "mean_action_processing_ms": 0.04022057221741305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1832000, "timers": {"sample_time_ms": 7778.236, "sample_throughput": 514.255, "learn_time_ms": 11756.763, "learn_throughput": 340.23, "update_time_ms": 2.877}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 10.015363186597824, "policy_loss": -0.018049860431347042, "vf_loss": 10.025693476200104, "vf_explained_var": 0.4070601761341095, "kl": 0.011412681880756281, "entropy": 0.08993659622501582, "entropy_coeff": 0.0}}, "num_steps_sampled": 1832000, "num_steps_trained": 1832000}, "done": false, "episodes_total": 183, "training_iteration": 458, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-29-58", "timestamp": 1618147798, "time_this_iter_s": 20.424887895584106, "time_total_s": 9139.094238519669, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71711759d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ea90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9139.094238519669, "timesteps_since_restore": 0, "iterations_since_restore": 458, "perf": {"cpu_util_percent": 59.293103448275865, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1142.0, "episode_reward_min": 1142.0, "episode_reward_mean": 1142.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1142.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45088749705453723, "mean_raw_obs_processing_ms": 0.11067504520957844, "mean_inference_ms": 1.4512484615055719, "mean_action_processing_ms": 0.04022057221741305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1836000, "timers": {"sample_time_ms": 7733.13, "sample_throughput": 517.255, "learn_time_ms": 11733.772, "learn_throughput": 340.896, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 6.376472666859627, "policy_loss": -0.004715764080174267, "vf_loss": 6.379684001207352, "vf_explained_var": 0.38104093074798584, "kl": 0.002224012137048703, "entropy": 0.05571468884591013, "entropy_coeff": 0.0}}, "num_steps_sampled": 1836000, "num_steps_trained": 1836000}, "done": false, "episodes_total": 183, "training_iteration": 459, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-30-17", "timestamp": 1618147817, "time_this_iter_s": 19.00864315032959, "time_total_s": 9158.102881669998, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114ec90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717119b310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9158.102881669998, "timesteps_since_restore": 0, "iterations_since_restore": 459, "perf": {"cpu_util_percent": 58.49629629629629, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 400.0, "episode_reward_min": 400.0, "episode_reward_mean": 400.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45010862611008584, "mean_raw_obs_processing_ms": 0.11087472684457117, "mean_inference_ms": 1.4513771101810597, "mean_action_processing_ms": 0.04022389187615454}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1840000, "timers": {"sample_time_ms": 7754.322, "sample_throughput": 515.841, "learn_time_ms": 11739.143, "learn_throughput": 340.74, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33820548098886655, "cur_lr": 5e-05, "total_loss": 7.482212856411934, "policy_loss": -0.02626620145747438, "vf_loss": 7.50360082089901, "vf_explained_var": 0.7042793035507202, "kl": 0.014424172361032106, "entropy": 0.07903730787802488, "entropy_coeff": 0.0}}, "num_steps_sampled": 1840000, "num_steps_trained": 1840000}, "done": false, "episodes_total": 184, "training_iteration": 460, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-30-37", "timestamp": 1618147837, "time_this_iter_s": 20.09370183944702, "time_total_s": 9178.196583509445, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171061150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171061510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9178.196583509445, "timesteps_since_restore": 0, "iterations_since_restore": 460, "perf": {"cpu_util_percent": 59.317241379310346, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 400.0, "episode_reward_min": 400.0, "episode_reward_mean": 400.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45010862611008584, "mean_raw_obs_processing_ms": 0.11087472684457117, "mean_inference_ms": 1.4513771101810597, "mean_action_processing_ms": 0.04022389187615454}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1844000, "timers": {"sample_time_ms": 7836.605, "sample_throughput": 510.425, "learn_time_ms": 11735.992, "learn_throughput": 340.832, "update_time_ms": 3.369}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33820548098886655, "cur_lr": 5e-05, "total_loss": 9.300122678279877, "policy_loss": -0.03667999361641705, "vf_loss": 9.32732318341732, "vf_explained_var": 0.6375046968460083, "kl": 0.02802824054379016, "entropy": 0.11897805356420577, "entropy_coeff": 0.0}}, "num_steps_sampled": 1844000, "num_steps_trained": 1844000}, "done": false, "episodes_total": 184, "training_iteration": 461, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-30-58", "timestamp": 1618147858, "time_this_iter_s": 20.2354679107666, "time_total_s": 9198.432051420212, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172246310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9198.432051420212, "timesteps_since_restore": 0, "iterations_since_restore": 461, "perf": {"cpu_util_percent": 58.11724137931035, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 400.0, "episode_reward_min": 400.0, "episode_reward_mean": 400.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45010862611008584, "mean_raw_obs_processing_ms": 0.11087472684457117, "mean_inference_ms": 1.4513771101810597, "mean_action_processing_ms": 0.04022389187615454}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1848000, "timers": {"sample_time_ms": 8065.939, "sample_throughput": 495.912, "learn_time_ms": 11737.297, "learn_throughput": 340.794, "update_time_ms": 3.393}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5073082214832998, "cur_lr": 5e-05, "total_loss": 9.680709108710289, "policy_loss": -0.03210510575445369, "vf_loss": 9.700163900852203, "vf_explained_var": 0.5091111063957214, "kl": 0.02493629019591026, "entropy": 0.1026723540853709, "entropy_coeff": 0.0}}, "num_steps_sampled": 1848000, "num_steps_trained": 1848000}, "done": false, "episodes_total": 184, "training_iteration": 462, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-31-19", "timestamp": 1618147879, "time_this_iter_s": 21.119908809661865, "time_total_s": 9219.551960229874, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d65d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116ec90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9219.551960229874, "timesteps_since_restore": 0, "iterations_since_restore": 462, "perf": {"cpu_util_percent": 58.776666666666664, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 879.0, "episode_reward_min": 879.0, "episode_reward_mean": 879.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [879.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45118920522108347, "mean_raw_obs_processing_ms": 0.11114271037698119, "mean_inference_ms": 1.4513179084049048, "mean_action_processing_ms": 0.040221690783748036}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1852000, "timers": {"sample_time_ms": 8272.455, "sample_throughput": 483.532, "learn_time_ms": 11727.789, "learn_throughput": 341.07, "update_time_ms": 3.396}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7609623322249497, "cur_lr": 5e-05, "total_loss": 8.191456779837608, "policy_loss": -0.02427453303243965, "vf_loss": 8.212243556976318, "vf_explained_var": 0.40398821234703064, "kl": 0.004583247173286509, "entropy": 0.06698031490668654, "entropy_coeff": 0.0}}, "num_steps_sampled": 1852000, "num_steps_trained": 1852000}, "done": false, "episodes_total": 185, "training_iteration": 463, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-31-40", "timestamp": 1618147900, "time_this_iter_s": 21.17008328437805, "time_total_s": 9240.722043514252, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717221fed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffdbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9240.722043514252, "timesteps_since_restore": 0, "iterations_since_restore": 463, "perf": {"cpu_util_percent": 58.8, "ram_util_percent": 27.70000000000001}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 879.0, "episode_reward_min": 879.0, "episode_reward_mean": 879.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [879.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45118920522108347, "mean_raw_obs_processing_ms": 0.11114271037698119, "mean_inference_ms": 1.4513179084049048, "mean_action_processing_ms": 0.040221690783748036}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1856000, "timers": {"sample_time_ms": 8366.818, "sample_throughput": 478.079, "learn_time_ms": 11730.037, "learn_throughput": 341.005, "update_time_ms": 3.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.38048116611247484, "cur_lr": 5e-05, "total_loss": 9.8017687946558, "policy_loss": -0.025637977523729205, "vf_loss": 9.82083123922348, "vf_explained_var": 0.5053630471229553, "kl": 0.01728271908359602, "entropy": 0.08013188873883337, "entropy_coeff": 0.0}}, "num_steps_sampled": 1856000, "num_steps_trained": 1856000}, "done": false, "episodes_total": 185, "training_iteration": 464, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-32-00", "timestamp": 1618147920, "time_this_iter_s": 19.751641750335693, "time_total_s": 9260.473685264587, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171063e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710637d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9260.473685264587, "timesteps_since_restore": 0, "iterations_since_restore": 464, "perf": {"cpu_util_percent": 59.1857142857143, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 882.0, "episode_reward_min": 882.0, "episode_reward_mean": 882.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [882.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4509799991183109, "mean_raw_obs_processing_ms": 0.1113316950030258, "mean_inference_ms": 1.451375049736144, "mean_action_processing_ms": 0.040222114554813344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1860000, "timers": {"sample_time_ms": 8475.777, "sample_throughput": 471.933, "learn_time_ms": 11722.643, "learn_throughput": 341.22, "update_time_ms": 3.599}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.38048116611247484, "cur_lr": 5e-05, "total_loss": 12.175160884857178, "policy_loss": -0.038668035122100264, "vf_loss": 12.201161473989487, "vf_explained_var": 0.523495078086853, "kl": 0.03329285990912467, "entropy": 0.1193650639615953, "entropy_coeff": 0.0}}, "num_steps_sampled": 1860000, "num_steps_trained": 1860000}, "done": false, "episodes_total": 186, "training_iteration": 465, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-32-20", "timestamp": 1618147940, "time_this_iter_s": 20.240617036819458, "time_total_s": 9280.714302301407, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116c290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9280.714302301407, "timesteps_since_restore": 0, "iterations_since_restore": 465, "perf": {"cpu_util_percent": 59.04827586206896, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 882.0, "episode_reward_min": 882.0, "episode_reward_mean": 882.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [882.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4509799991183109, "mean_raw_obs_processing_ms": 0.1113316950030258, "mean_inference_ms": 1.451375049736144, "mean_action_processing_ms": 0.040222114554813344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1864000, "timers": {"sample_time_ms": 8436.214, "sample_throughput": 474.146, "learn_time_ms": 11717.427, "learn_throughput": 341.372, "update_time_ms": 3.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5707217491687122, "cur_lr": 5e-05, "total_loss": 6.167754203081131, "policy_loss": -0.012385671579977497, "vf_loss": 6.176435738801956, "vf_explained_var": 0.6306395530700684, "kl": 0.0064901123332674615, "entropy": 0.0803857579594478, "entropy_coeff": 0.0}}, "num_steps_sampled": 1864000, "num_steps_trained": 1864000}, "done": false, "episodes_total": 186, "training_iteration": 466, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-32-39", "timestamp": 1618147959, "time_this_iter_s": 18.9570209980011, "time_total_s": 9299.671323299408, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717104c350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717104cb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9299.671323299408, "timesteps_since_restore": 0, "iterations_since_restore": 466, "perf": {"cpu_util_percent": 58.474074074074075, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 882.0, "episode_reward_min": 882.0, "episode_reward_mean": 882.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [882.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4509799991183109, "mean_raw_obs_processing_ms": 0.1113316950030258, "mean_inference_ms": 1.451375049736144, "mean_action_processing_ms": 0.040222114554813344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1868000, "timers": {"sample_time_ms": 8276.519, "sample_throughput": 483.295, "learn_time_ms": 11731.11, "learn_throughput": 340.974, "update_time_ms": 4.126}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5707217491687122, "cur_lr": 5e-05, "total_loss": 5.839782401919365, "policy_loss": -0.027322849084157497, "vf_loss": 5.854440852999687, "vf_explained_var": 0.5621005296707153, "kl": 0.02219016448361799, "entropy": 0.11709655239246786, "entropy_coeff": 0.0}}, "num_steps_sampled": 1868000, "num_steps_trained": 1868000}, "done": false, "episodes_total": 186, "training_iteration": 467, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-32-58", "timestamp": 1618147978, "time_this_iter_s": 19.181145906448364, "time_total_s": 9318.852469205856, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717105c510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717105c1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9318.852469205856, "timesteps_since_restore": 0, "iterations_since_restore": 467, "perf": {"cpu_util_percent": 58.48888888888889, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 592.0, "episode_reward_min": 592.0, "episode_reward_mean": 592.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [592.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4492875619769328, "mean_raw_obs_processing_ms": 0.11159282157892118, "mean_inference_ms": 1.4511882847796105, "mean_action_processing_ms": 0.0402154283549373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1872000, "timers": {"sample_time_ms": 8139.339, "sample_throughput": 491.44, "learn_time_ms": 11715.966, "learn_throughput": 341.414, "update_time_ms": 4.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8560826237530683, "cur_lr": 5e-05, "total_loss": 2.2890927083790302, "policy_loss": -0.01005171934957616, "vf_loss": 2.2942663207650185, "vf_explained_var": 0.40216273069381714, "kl": 0.005698202003259212, "entropy": 0.12350011570379138, "entropy_coeff": 0.0}}, "num_steps_sampled": 1872000, "num_steps_trained": 1872000}, "done": false, "episodes_total": 187, "training_iteration": 468, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-33-17", "timestamp": 1618147997, "time_this_iter_s": 18.902995824813843, "time_total_s": 9337.75546503067, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114fcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9337.75546503067, "timesteps_since_restore": 0, "iterations_since_restore": 468, "perf": {"cpu_util_percent": 59.670370370370364, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 592.0, "episode_reward_min": 592.0, "episode_reward_mean": 592.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [592.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4492875619769328, "mean_raw_obs_processing_ms": 0.11159282157892118, "mean_inference_ms": 1.4511882847796105, "mean_action_processing_ms": 0.0402154283549373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1876000, "timers": {"sample_time_ms": 8122.013, "sample_throughput": 492.489, "learn_time_ms": 11703.256, "learn_throughput": 341.785, "update_time_ms": 4.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8560826237530683, "cur_lr": 5e-05, "total_loss": 1.6337375231087208, "policy_loss": -0.02612289902754128, "vf_loss": 1.6555567793548107, "vf_explained_var": 0.6408770084381104, "kl": 0.005027131392125739, "entropy": 0.0664792611496523, "entropy_coeff": 0.0}}, "num_steps_sampled": 1876000, "num_steps_trained": 1876000}, "done": false, "episodes_total": 187, "training_iteration": 469, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-33-36", "timestamp": 1618148016, "time_this_iter_s": 18.708723545074463, "time_total_s": 9356.464188575745, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171063090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170ffd150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9356.464188575745, "timesteps_since_restore": 0, "iterations_since_restore": 469, "perf": {"cpu_util_percent": 58.407407407407405, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 255.0, "episode_reward_min": 255.0, "episode_reward_mean": 255.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44850703145914433, "mean_raw_obs_processing_ms": 0.11178025288272897, "mean_inference_ms": 1.4512032852797123, "mean_action_processing_ms": 0.04021365938436321}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1880000, "timers": {"sample_time_ms": 8111.966, "sample_throughput": 493.099, "learn_time_ms": 11703.385, "learn_throughput": 341.781, "update_time_ms": 4.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8560826237530683, "cur_lr": 5e-05, "total_loss": 5.352002531290054, "policy_loss": -0.020727098046336323, "vf_loss": 5.3689602836966515, "vf_explained_var": 0.8177872896194458, "kl": 0.0044030352491972735, "entropy": 0.05967977462569252, "entropy_coeff": 0.0}}, "num_steps_sampled": 1880000, "num_steps_trained": 1880000}, "done": false, "episodes_total": 188, "training_iteration": 470, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-33-56", "timestamp": 1618148036, "time_this_iter_s": 19.99246096611023, "time_total_s": 9376.456649541855, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9376.456649541855, "timesteps_since_restore": 0, "iterations_since_restore": 470, "perf": {"cpu_util_percent": 59.36206896551724, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 255.0, "episode_reward_min": 255.0, "episode_reward_mean": 255.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44850703145914433, "mean_raw_obs_processing_ms": 0.11178025288272897, "mean_inference_ms": 1.4512032852797123, "mean_action_processing_ms": 0.04021365938436321}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1884000, "timers": {"sample_time_ms": 8009.363, "sample_throughput": 499.415, "learn_time_ms": 11703.246, "learn_throughput": 341.786, "update_time_ms": 3.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42804131187653416, "cur_lr": 5e-05, "total_loss": 6.181953176856041, "policy_loss": -0.020305429730797186, "vf_loss": 6.200084492564201, "vf_explained_var": 0.6891672015190125, "kl": 0.005079205948277377, "entropy": 0.04984532424714416, "entropy_coeff": 0.0}}, "num_steps_sampled": 1884000, "num_steps_trained": 1884000}, "done": false, "episodes_total": 188, "training_iteration": 471, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-34-15", "timestamp": 1618148055, "time_this_iter_s": 19.200685262680054, "time_total_s": 9395.657334804535, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171061c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9395.657334804535, "timesteps_since_restore": 0, "iterations_since_restore": 471, "perf": {"cpu_util_percent": 59.170370370370364, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 255.0, "episode_reward_min": 255.0, "episode_reward_mean": 255.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [255.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44850703145914433, "mean_raw_obs_processing_ms": 0.11178025288272897, "mean_inference_ms": 1.4512032852797123, "mean_action_processing_ms": 0.04021365938436321}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1888000, "timers": {"sample_time_ms": 7791.658, "sample_throughput": 513.37, "learn_time_ms": 11691.999, "learn_throughput": 342.114, "update_time_ms": 3.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42804131187653416, "cur_lr": 5e-05, "total_loss": 0.7449225448071957, "policy_loss": 0.0029686581692658365, "vf_loss": 0.7419530563056469, "vf_explained_var": 0.0008326731622219086, "kl": 1.9233470922586093e-06, "entropy": 0.0005850617699252325, "entropy_coeff": 0.0}}, "num_steps_sampled": 1888000, "num_steps_trained": 1888000}, "done": false, "episodes_total": 188, "training_iteration": 472, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-34-34", "timestamp": 1618148074, "time_this_iter_s": 18.830512046813965, "time_total_s": 9414.487846851349, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171091550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710ca4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9414.487846851349, "timesteps_since_restore": 0, "iterations_since_restore": 472, "perf": {"cpu_util_percent": 58.9925925925926, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 350.0, "episode_reward_min": 350.0, "episode_reward_mean": 350.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44674105034724165, "mean_raw_obs_processing_ms": 0.11205403018594204, "mean_inference_ms": 1.451093873018841, "mean_action_processing_ms": 0.040209525653351404}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1892000, "timers": {"sample_time_ms": 7568.571, "sample_throughput": 528.501, "learn_time_ms": 11697.241, "learn_throughput": 341.961, "update_time_ms": 3.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.21402065593826708, "cur_lr": 5e-05, "total_loss": 0.13508238439681008, "policy_loss": 0.002769138664007187, "vf_loss": 0.1323126219213009, "vf_explained_var": -0.0007692892104387283, "kl": 2.9275101276482474e-06, "entropy": 0.0007228809472508146, "entropy_coeff": 0.0}}, "num_steps_sampled": 1892000, "num_steps_trained": 1892000}, "done": false, "episodes_total": 189, "training_iteration": 473, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-34-53", "timestamp": 1618148093, "time_this_iter_s": 18.99420189857483, "time_total_s": 9433.482048749924, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170f2ef10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9433.482048749924, "timesteps_since_restore": 0, "iterations_since_restore": 473, "perf": {"cpu_util_percent": 58.599999999999994, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 350.0, "episode_reward_min": 350.0, "episode_reward_mean": 350.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44674105034724165, "mean_raw_obs_processing_ms": 0.11205403018594204, "mean_inference_ms": 1.451093873018841, "mean_action_processing_ms": 0.040209525653351404}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1896000, "timers": {"sample_time_ms": 7545.125, "sample_throughput": 530.144, "learn_time_ms": 11706.205, "learn_throughput": 341.699, "update_time_ms": 3.669}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10701032796913354, "cur_lr": 5e-05, "total_loss": 4.281346328556538, "policy_loss": -0.020150379627011716, "vf_loss": 4.298327371478081, "vf_explained_var": 0.8590287566184998, "kl": 0.02961678383871913, "entropy": 0.05546377319842577, "entropy_coeff": 0.0}}, "num_steps_sampled": 1896000, "num_steps_trained": 1896000}, "done": false, "episodes_total": 189, "training_iteration": 474, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-35-13", "timestamp": 1618148113, "time_this_iter_s": 19.605183839797974, "time_total_s": 9453.087232589722, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717105cb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171053d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9453.087232589722, "timesteps_since_restore": 0, "iterations_since_restore": 474, "perf": {"cpu_util_percent": 59.33928571428572, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 466.0, "episode_reward_min": 466.0, "episode_reward_mean": 466.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44586677989196544, "mean_raw_obs_processing_ms": 0.11223480905395952, "mean_inference_ms": 1.451078952831186, "mean_action_processing_ms": 0.040208107465816045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1900000, "timers": {"sample_time_ms": 7423.427, "sample_throughput": 538.835, "learn_time_ms": 11718.553, "learn_throughput": 341.339, "update_time_ms": 3.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1605154919537003, "cur_lr": 5e-05, "total_loss": 7.083388581871986, "policy_loss": -0.039264649734832346, "vf_loss": 7.116226509213448, "vf_explained_var": 0.5668152570724487, "kl": 0.040037395956460387, "entropy": 0.11087371967732906, "entropy_coeff": 0.0}}, "num_steps_sampled": 1900000, "num_steps_trained": 1900000}, "done": false, "episodes_total": 190, "training_iteration": 475, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-35-32", "timestamp": 1618148132, "time_this_iter_s": 19.145093202590942, "time_total_s": 9472.232325792313, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717117bb10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717104cd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9472.232325792313, "timesteps_since_restore": 0, "iterations_since_restore": 475, "perf": {"cpu_util_percent": 58.62592592592592, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 466.0, "episode_reward_min": 466.0, "episode_reward_mean": 466.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44586677989196544, "mean_raw_obs_processing_ms": 0.11223480905395952, "mean_inference_ms": 1.451078952831186, "mean_action_processing_ms": 0.040208107465816045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1904000, "timers": {"sample_time_ms": 7431.936, "sample_throughput": 538.218, "learn_time_ms": 11708.898, "learn_throughput": 341.621, "update_time_ms": 3.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.24077323793055044, "cur_lr": 5e-05, "total_loss": 4.14396558701992, "policy_loss": -0.004795590532012284, "vf_loss": 4.148760758340359, "vf_explained_var": -0.0007484685629606247, "kl": 1.8477352770052136e-06, "entropy": 0.0005256474030375102, "entropy_coeff": 0.0}}, "num_steps_sampled": 1904000, "num_steps_trained": 1904000}, "done": false, "episodes_total": 190, "training_iteration": 476, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-35-51", "timestamp": 1618148151, "time_this_iter_s": 18.946490049362183, "time_total_s": 9491.178815841675, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170ffdf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717117ba90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9491.178815841675, "timesteps_since_restore": 0, "iterations_since_restore": 476, "perf": {"cpu_util_percent": 59.52962962962964, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 466.0, "episode_reward_min": 466.0, "episode_reward_mean": 466.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44586677989196544, "mean_raw_obs_processing_ms": 0.11223480905395952, "mean_inference_ms": 1.451078952831186, "mean_action_processing_ms": 0.040208107465816045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1908000, "timers": {"sample_time_ms": 7412.221, "sample_throughput": 539.649, "learn_time_ms": 11704.85, "learn_throughput": 341.739, "update_time_ms": 3.241}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.12038661896527522, "cur_lr": 5e-05, "total_loss": 0.8352533839643002, "policy_loss": 0.007862822385504842, "vf_loss": 0.8273855224251747, "vf_explained_var": -0.0005175452679395676, "kl": 4.193650198658361e-05, "entropy": 0.001185128019642434, "entropy_coeff": 0.0}}, "num_steps_sampled": 1908000, "num_steps_trained": 1908000}, "done": false, "episodes_total": 190, "training_iteration": 477, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-36-10", "timestamp": 1618148170, "time_this_iter_s": 18.942532300949097, "time_total_s": 9510.121348142624, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717110bd10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171075210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9510.121348142624, "timesteps_since_restore": 0, "iterations_since_restore": 477, "perf": {"cpu_util_percent": 58.62222222222222, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44419591532931857, "mean_raw_obs_processing_ms": 0.11250535715054398, "mean_inference_ms": 1.4510309141219948, "mean_action_processing_ms": 0.04020713380179368}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1912000, "timers": {"sample_time_ms": 7445.643, "sample_throughput": 537.227, "learn_time_ms": 11690.65, "learn_throughput": 342.154, "update_time_ms": 3.247}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06019330948263761, "cur_lr": 5e-05, "total_loss": 0.1298082428984344, "policy_loss": 0.000188495556358248, "vf_loss": 0.12960839038714767, "vf_explained_var": -0.0026799868792295456, "kl": 0.00018871982365453732, "entropy": 0.00025981935914387577, "entropy_coeff": 0.0}}, "num_steps_sampled": 1912000, "num_steps_trained": 1912000}, "done": false, "episodes_total": 191, "training_iteration": 478, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-36-29", "timestamp": 1618148189, "time_this_iter_s": 19.0949387550354, "time_total_s": 9529.21628689766, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171071810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710718d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9529.21628689766, "timesteps_since_restore": 0, "iterations_since_restore": 478, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44419591532931857, "mean_raw_obs_processing_ms": 0.11250535715054398, "mean_inference_ms": 1.4510309141219948, "mean_action_processing_ms": 0.04020713380179368}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1916000, "timers": {"sample_time_ms": 7458.027, "sample_throughput": 536.335, "learn_time_ms": 11695.669, "learn_throughput": 342.007, "update_time_ms": 3.201}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030096654741318805, "cur_lr": 5e-05, "total_loss": 0.023163158737588674, "policy_loss": 0.00013662799028679729, "vf_loss": 0.0230265207355842, "vf_explained_var": -0.006072519347071648, "kl": 4.2462849458857477e-07, "entropy": 0.0002784934363262437, "entropy_coeff": 0.0}}, "num_steps_sampled": 1916000, "num_steps_trained": 1916000}, "done": false, "episodes_total": 191, "training_iteration": 479, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-36-48", "timestamp": 1618148208, "time_this_iter_s": 18.884862422943115, "time_total_s": 9548.101149320602, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171140290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171063810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9548.101149320602, "timesteps_since_restore": 0, "iterations_since_restore": 479, "perf": {"cpu_util_percent": 58.38518518518518, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44308545708220387, "mean_raw_obs_processing_ms": 0.11269061395790515, "mean_inference_ms": 1.4509825108123633, "mean_action_processing_ms": 0.04020385970334093}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1920000, "timers": {"sample_time_ms": 7363.678, "sample_throughput": 543.207, "learn_time_ms": 11734.282, "learn_throughput": 340.882, "update_time_ms": 3.149}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015048327370659403, "cur_lr": 5e-05, "total_loss": 0.0021878418046981096, "policy_loss": -0.001488080306444317, "vf_loss": 0.0036757669804501347, "vf_explained_var": -0.00898294523358345, "kl": 1.0294060771798286e-05, "entropy": 0.0001588313102729444, "entropy_coeff": 0.0}}, "num_steps_sampled": 1920000, "num_steps_trained": 1920000}, "done": false, "episodes_total": 192, "training_iteration": 480, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-37-07", "timestamp": 1618148227, "time_this_iter_s": 19.434881925582886, "time_total_s": 9567.536031246185, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171175d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171198090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9567.536031246185, "timesteps_since_restore": 0, "iterations_since_restore": 480, "perf": {"cpu_util_percent": 60.02962962962964, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44308545708220387, "mean_raw_obs_processing_ms": 0.11269061395790515, "mean_inference_ms": 1.4509825108123633, "mean_action_processing_ms": 0.04020385970334093}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1924000, "timers": {"sample_time_ms": 7365.48, "sample_throughput": 543.074, "learn_time_ms": 11717.427, "learn_throughput": 341.372, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007524163685329701, "cur_lr": 5e-05, "total_loss": 3.4392643868923187, "policy_loss": -0.021026101196184754, "vf_loss": 3.459763325750828, "vf_explained_var": 0.7406946420669556, "kl": 0.07006229588296264, "entropy": 0.07271009287796915, "entropy_coeff": 0.0}}, "num_steps_sampled": 1924000, "num_steps_trained": 1924000}, "done": false, "episodes_total": 192, "training_iteration": 481, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-37-26", "timestamp": 1618148246, "time_this_iter_s": 19.053470373153687, "time_total_s": 9586.589501619339, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116e3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9586.589501619339, "timesteps_since_restore": 0, "iterations_since_restore": 481, "perf": {"cpu_util_percent": 58.43928571428571, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44308545708220387, "mean_raw_obs_processing_ms": 0.11269061395790515, "mean_inference_ms": 1.4509825108123633, "mean_action_processing_ms": 0.04020385970334093}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1928000, "timers": {"sample_time_ms": 7393.566, "sample_throughput": 541.011, "learn_time_ms": 11714.822, "learn_throughput": 341.448, "update_time_ms": 3.162}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.011286245527994551, "cur_lr": 5e-05, "total_loss": 5.445339530706406, "policy_loss": -0.05679960755514912, "vf_loss": 5.5010159611701965, "vf_explained_var": 0.5763291120529175, "kl": 0.09951803437434137, "entropy": 0.1299487694632262, "entropy_coeff": 0.0}}, "num_steps_sampled": 1928000, "num_steps_trained": 1928000}, "done": false, "episodes_total": 192, "training_iteration": 482, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-37-45", "timestamp": 1618148265, "time_this_iter_s": 19.085095643997192, "time_total_s": 9605.674597263336, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fd8750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fd8b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9605.674597263336, "timesteps_since_restore": 0, "iterations_since_restore": 482, "perf": {"cpu_util_percent": 59.97777777777778, "ram_util_percent": 27.700000000000003}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 467.0, "episode_reward_min": 467.0, "episode_reward_mean": 467.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [467.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4418084560863504, "mean_raw_obs_processing_ms": 0.11297605683641562, "mean_inference_ms": 1.450956319707287, "mean_action_processing_ms": 0.04020310662251193}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1932000, "timers": {"sample_time_ms": 7465.621, "sample_throughput": 535.789, "learn_time_ms": 11707.378, "learn_throughput": 341.665, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.016929368291991827, "cur_lr": 5e-05, "total_loss": 6.1373681128025055, "policy_loss": -0.027059327519964427, "vf_loss": 6.163953319191933, "vf_explained_var": 0.6785961389541626, "kl": 0.02800699937506579, "entropy": 0.08804988418705761, "entropy_coeff": 0.0}}, "num_steps_sampled": 1932000, "num_steps_trained": 1932000}, "done": false, "episodes_total": 193, "training_iteration": 483, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-38-05", "timestamp": 1618148285, "time_this_iter_s": 19.637078046798706, "time_total_s": 9625.311675310135, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710d6190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171071cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9625.311675310135, "timesteps_since_restore": 0, "iterations_since_restore": 483, "perf": {"cpu_util_percent": 58.26428571428571, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 467.0, "episode_reward_min": 467.0, "episode_reward_mean": 467.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [467.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4418084560863504, "mean_raw_obs_processing_ms": 0.11297605683641562, "mean_inference_ms": 1.450956319707287, "mean_action_processing_ms": 0.04020310662251193}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1936000, "timers": {"sample_time_ms": 7469.503, "sample_throughput": 535.511, "learn_time_ms": 11710.449, "learn_throughput": 341.575, "update_time_ms": 3.021}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.02539405243798774, "cur_lr": 5e-05, "total_loss": 8.795712158083916, "policy_loss": -0.0366668535862118, "vf_loss": 8.830558225512505, "vf_explained_var": 0.49951475858688354, "kl": 0.0717026824131608, "entropy": 0.10440183454193175, "entropy_coeff": 0.0}}, "num_steps_sampled": 1936000, "num_steps_trained": 1936000}, "done": false, "episodes_total": 193, "training_iteration": 484, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-38-25", "timestamp": 1618148305, "time_this_iter_s": 19.67173671722412, "time_total_s": 9644.983412027359, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171063e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7267ce2590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9644.983412027359, "timesteps_since_restore": 0, "iterations_since_restore": 484, "perf": {"cpu_util_percent": 59.33214285714285, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 762.0, "episode_reward_min": 762.0, "episode_reward_mean": 762.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [762.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44161344431589117, "mean_raw_obs_processing_ms": 0.11316579756641419, "mean_inference_ms": 1.4510464143347765, "mean_action_processing_ms": 0.040203932557214765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1940000, "timers": {"sample_time_ms": 7613.929, "sample_throughput": 525.353, "learn_time_ms": 11689.522, "learn_throughput": 342.187, "update_time_ms": 3.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03809107865698161, "cur_lr": 5e-05, "total_loss": 8.260019481182098, "policy_loss": -0.021412968984805048, "vf_loss": 8.280504912137985, "vf_explained_var": 0.5037830471992493, "kl": 0.024352404318051413, "entropy": 0.07058704155497253, "entropy_coeff": 0.0}}, "num_steps_sampled": 1940000, "num_steps_trained": 1940000}, "done": false, "episodes_total": 194, "training_iteration": 485, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-38-45", "timestamp": 1618148325, "time_this_iter_s": 20.380290269851685, "time_total_s": 9665.36370229721, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717116ea10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171063310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9665.36370229721, "timesteps_since_restore": 0, "iterations_since_restore": 485, "perf": {"cpu_util_percent": 59.268965517241384, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 762.0, "episode_reward_min": 762.0, "episode_reward_mean": 762.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [762.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44161344431589117, "mean_raw_obs_processing_ms": 0.11316579756641419, "mean_inference_ms": 1.4510464143347765, "mean_action_processing_ms": 0.040203932557214765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1944000, "timers": {"sample_time_ms": 7667.728, "sample_throughput": 521.667, "learn_time_ms": 11701.813, "learn_throughput": 341.827, "update_time_ms": 2.981}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05713661798547241, "cur_lr": 5e-05, "total_loss": 10.266003802418709, "policy_loss": -0.03348852327326313, "vf_loss": 10.297369211912155, "vf_explained_var": 0.5007702112197876, "kl": 0.03715383022790775, "entropy": 0.08952127071097493, "entropy_coeff": 0.0}}, "num_steps_sampled": 1944000, "num_steps_trained": 1944000}, "done": false, "episodes_total": 194, "training_iteration": 486, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-39-05", "timestamp": 1618148345, "time_this_iter_s": 19.607431411743164, "time_total_s": 9684.971133708954, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114ffd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9684.971133708954, "timesteps_since_restore": 0, "iterations_since_restore": 486, "perf": {"cpu_util_percent": 58.260714285714286, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 762.0, "episode_reward_min": 762.0, "episode_reward_mean": 762.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [762.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44161344431589117, "mean_raw_obs_processing_ms": 0.11316579756641419, "mean_inference_ms": 1.4510464143347765, "mean_action_processing_ms": 0.040203932557214765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1948000, "timers": {"sample_time_ms": 7739.64, "sample_throughput": 516.82, "learn_time_ms": 11700.196, "learn_throughput": 341.875, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08570492697820861, "cur_lr": 5e-05, "total_loss": 7.257313832640648, "policy_loss": -0.020518473989795893, "vf_loss": 7.276215642690659, "vf_explained_var": 0.4919407367706299, "kl": 0.01886277401354164, "entropy": 0.0683861505240202, "entropy_coeff": 0.0}}, "num_steps_sampled": 1948000, "num_steps_trained": 1948000}, "done": false, "episodes_total": 194, "training_iteration": 487, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-39-25", "timestamp": 1618148365, "time_this_iter_s": 19.64426851272583, "time_total_s": 9704.61540222168, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fd8750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717223fa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9704.61540222168, "timesteps_since_restore": 0, "iterations_since_restore": 487, "perf": {"cpu_util_percent": 59.56071428571429, "ram_util_percent": 27.700000000000006}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 724.0, "episode_reward_min": 724.0, "episode_reward_mean": 724.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [724.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44057451324098384, "mean_raw_obs_processing_ms": 0.11344374278804023, "mean_inference_ms": 1.451051494607294, "mean_action_processing_ms": 0.040203020633281954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1952000, "timers": {"sample_time_ms": 7739.651, "sample_throughput": 516.819, "learn_time_ms": 11746.799, "learn_throughput": 340.518, "update_time_ms": 3.091}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08570492697820861, "cur_lr": 5e-05, "total_loss": 12.775551557540894, "policy_loss": -0.01988353079650551, "vf_loss": 12.79031229019165, "vf_explained_var": 0.03216791898012161, "kl": 0.05977241508662701, "entropy": 0.09769875672645867, "entropy_coeff": 0.0}}, "num_steps_sampled": 1952000, "num_steps_trained": 1952000}, "done": false, "episodes_total": 195, "training_iteration": 488, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-39-44", "timestamp": 1618148384, "time_this_iter_s": 19.56364417076111, "time_total_s": 9724.17904639244, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbb790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118dcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9724.17904639244, "timesteps_since_restore": 0, "iterations_since_restore": 488, "perf": {"cpu_util_percent": 58.80357142857143, "ram_util_percent": 27.796428571428567}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 724.0, "episode_reward_min": 724.0, "episode_reward_mean": 724.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [724.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44057451324098384, "mean_raw_obs_processing_ms": 0.11344374278804023, "mean_inference_ms": 1.451051494607294, "mean_action_processing_ms": 0.040203020633281954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1956000, "timers": {"sample_time_ms": 7802.631, "sample_throughput": 512.648, "learn_time_ms": 11781.761, "learn_throughput": 339.508, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1285573904673129, "cur_lr": 5e-05, "total_loss": 3.158241458237171, "policy_loss": 0.0013441359624266624, "vf_loss": 3.156135607510805, "vf_explained_var": 0.463151216506958, "kl": 0.005925055709667504, "entropy": 0.01019427000755968, "entropy_coeff": 0.0}}, "num_steps_sampled": 1956000, "num_steps_trained": 1956000}, "done": false, "episodes_total": 195, "training_iteration": 489, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-40-04", "timestamp": 1618148404, "time_this_iter_s": 19.86327338218689, "time_total_s": 9744.042319774628, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7171183b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7172212b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9744.042319774628, "timesteps_since_restore": 0, "iterations_since_restore": 489, "perf": {"cpu_util_percent": 59.48620689655172, "ram_util_percent": 27.799999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 41.0, "episode_reward_min": 41.0, "episode_reward_mean": 41.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4395246851808994, "mean_raw_obs_processing_ms": 0.11367630802940427, "mean_inference_ms": 1.451473331947667, "mean_action_processing_ms": 0.0402158379947105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1960000, "timers": {"sample_time_ms": 7850.533, "sample_throughput": 509.52, "learn_time_ms": 11777.527, "learn_throughput": 339.63, "update_time_ms": 3.066}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1285573904673129, "cur_lr": 5e-05, "total_loss": 0.5030308598652482, "policy_loss": 0.0024314786423929036, "vf_loss": 0.5005568042397499, "vf_explained_var": -0.0007873959839344025, "kl": 0.00033121683850367845, "entropy": 0.003908706290530972, "entropy_coeff": 0.0}}, "num_steps_sampled": 1960000, "num_steps_trained": 1960000}, "done": false, "episodes_total": 196, "training_iteration": 490, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-40-24", "timestamp": 1618148424, "time_this_iter_s": 19.87184476852417, "time_total_s": 9763.914164543152, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71710ca090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717110b190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9763.914164543152, "timesteps_since_restore": 0, "iterations_since_restore": 490, "perf": {"cpu_util_percent": 59.949999999999996, "ram_util_percent": 27.799999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 41.0, "episode_reward_min": 41.0, "episode_reward_mean": 41.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4395246851808994, "mean_raw_obs_processing_ms": 0.11367630802940427, "mean_inference_ms": 1.451473331947667, "mean_action_processing_ms": 0.0402158379947105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1964000, "timers": {"sample_time_ms": 7877.968, "sample_throughput": 507.745, "learn_time_ms": 11798.729, "learn_throughput": 339.02, "update_time_ms": 3.086}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06427869523365645, "cur_lr": 5e-05, "total_loss": 0.08991349884308875, "policy_loss": -0.001286939630517736, "vf_loss": 0.09118682192638516, "vf_explained_var": -0.02244071289896965, "kl": 0.00021177392972049347, "entropy": 0.004809127931366675, "entropy_coeff": 0.0}}, "num_steps_sampled": 1964000, "num_steps_trained": 1964000}, "done": false, "episodes_total": 196, "training_iteration": 491, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-40-43", "timestamp": 1618148443, "time_this_iter_s": 19.539785385131836, "time_total_s": 9783.453949928284, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71710d6450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9783.453949928284, "timesteps_since_restore": 0, "iterations_since_restore": 491, "perf": {"cpu_util_percent": 58.73571428571429, "ram_util_percent": 27.799999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 41.0, "episode_reward_min": 41.0, "episode_reward_mean": 41.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4395246851808994, "mean_raw_obs_processing_ms": 0.11367630802940427, "mean_inference_ms": 1.451473331947667, "mean_action_processing_ms": 0.0402158379947105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1968000, "timers": {"sample_time_ms": 7984.269, "sample_throughput": 500.985, "learn_time_ms": 11817.515, "learn_throughput": 338.481, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.032139347616828226, "cur_lr": 5e-05, "total_loss": 4.167684257030487, "policy_loss": -0.04300044654519297, "vf_loss": 4.208084844052792, "vf_explained_var": 0.8702812194824219, "kl": 0.08089360990561545, "entropy": 0.1126770384144038, "entropy_coeff": 0.0}}, "num_steps_sampled": 1968000, "num_steps_trained": 1968000}, "done": false, "episodes_total": 196, "training_iteration": 492, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-41-04", "timestamp": 1618148464, "time_this_iter_s": 20.336105585098267, "time_total_s": 9803.790055513382, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717118d350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118de50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9803.790055513382, "timesteps_since_restore": 0, "iterations_since_restore": 492, "perf": {"cpu_util_percent": 59.08620689655172, "ram_util_percent": 27.799999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 535.0, "episode_reward_min": 535.0, "episode_reward_mean": 535.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [535.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4389728158790444, "mean_raw_obs_processing_ms": 0.11398381985191501, "mean_inference_ms": 1.4517085308106268, "mean_action_processing_ms": 0.040221869981464195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1972000, "timers": {"sample_time_ms": 8044.121, "sample_throughput": 497.258, "learn_time_ms": 11809.482, "learn_throughput": 338.711, "update_time_ms": 3.052}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04820902142524234, "cur_lr": 5e-05, "total_loss": 6.0845494121313095, "policy_loss": -0.052088639058638364, "vf_loss": 6.134014055132866, "vf_explained_var": 0.7532707452774048, "kl": 0.054428677656687796, "entropy": 0.14959768624976277, "entropy_coeff": 0.0}}, "num_steps_sampled": 1972000, "num_steps_trained": 1972000}, "done": false, "episodes_total": 197, "training_iteration": 493, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-41-24", "timestamp": 1618148484, "time_this_iter_s": 20.156022548675537, "time_total_s": 9823.946078062057, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114f210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7170fcc4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9823.946078062057, "timesteps_since_restore": 0, "iterations_since_restore": 493, "perf": {"cpu_util_percent": 59.62413793103448, "ram_util_percent": 27.703448275862076}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 535.0, "episode_reward_min": 535.0, "episode_reward_mean": 535.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [535.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4389728158790444, "mean_raw_obs_processing_ms": 0.11398381985191501, "mean_inference_ms": 1.4517085308106268, "mean_action_processing_ms": 0.040221869981464195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1976000, "timers": {"sample_time_ms": 7994.165, "sample_throughput": 500.365, "learn_time_ms": 11807.881, "learn_throughput": 338.757, "update_time_ms": 3.039}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.07231353213786351, "cur_lr": 5e-05, "total_loss": 7.662435054779053, "policy_loss": -0.037377781176473945, "vf_loss": 7.696817517280579, "vf_explained_var": 0.4617690443992615, "kl": 0.041422100621275604, "entropy": 0.1124359976965934, "entropy_coeff": 0.0}}, "num_steps_sampled": 1976000, "num_steps_trained": 1976000}, "done": false, "episodes_total": 197, "training_iteration": 494, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-41-43", "timestamp": 1618148503, "time_this_iter_s": 19.15908169746399, "time_total_s": 9843.105159759521, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fd8f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118de50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9843.105159759521, "timesteps_since_restore": 0, "iterations_since_restore": 494, "perf": {"cpu_util_percent": 58.47777777777778, "ram_util_percent": 27.799999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 689.0, "episode_reward_min": 689.0, "episode_reward_mean": 689.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [689.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43797702644704645, "mean_raw_obs_processing_ms": 0.11416737926696341, "mean_inference_ms": 1.4517095928347048, "mean_action_processing_ms": 0.04022543072487549}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1980000, "timers": {"sample_time_ms": 7867.006, "sample_throughput": 508.453, "learn_time_ms": 11811.051, "learn_throughput": 338.666, "update_time_ms": 3.055}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10847029820679527, "cur_lr": 5e-05, "total_loss": 7.562868043780327, "policy_loss": -0.03968915733275935, "vf_loss": 7.5967269986867905, "vf_explained_var": 0.6058644652366638, "kl": 0.053748641861602664, "entropy": 0.11208964465186, "entropy_coeff": 0.0}}, "num_steps_sampled": 1980000, "num_steps_trained": 1980000}, "done": false, "episodes_total": 198, "training_iteration": 495, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-42-02", "timestamp": 1618148522, "time_this_iter_s": 19.1408109664917, "time_total_s": 9862.245970726013, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fbbc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7171175490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9862.245970726013, "timesteps_since_restore": 0, "iterations_since_restore": 495, "perf": {"cpu_util_percent": 59.53928571428572, "ram_util_percent": 27.78214285714285}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 689.0, "episode_reward_min": 689.0, "episode_reward_mean": 689.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [689.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43797702644704645, "mean_raw_obs_processing_ms": 0.11416737926696341, "mean_inference_ms": 1.4517095928347048, "mean_action_processing_ms": 0.04022543072487549}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1984000, "timers": {"sample_time_ms": 7807.261, "sample_throughput": 512.344, "learn_time_ms": 11803.492, "learn_throughput": 338.883, "update_time_ms": 3.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1627054473101929, "cur_lr": 5e-05, "total_loss": 9.49013814330101, "policy_loss": -0.012846996251028031, "vf_loss": 9.501339107751846, "vf_explained_var": 0.48340824246406555, "kl": 0.010116894249222241, "entropy": 0.07900258142035455, "entropy_coeff": 0.0}}, "num_steps_sampled": 1984000, "num_steps_trained": 1984000}, "done": false, "episodes_total": 198, "training_iteration": 496, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-42-21", "timestamp": 1618148541, "time_this_iter_s": 18.933582067489624, "time_total_s": 9881.179552793503, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71722124d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9881.179552793503, "timesteps_since_restore": 0, "iterations_since_restore": 496, "perf": {"cpu_util_percent": 58.65185185185185, "ram_util_percent": 27.799999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 689.0, "episode_reward_min": 689.0, "episode_reward_mean": 689.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [689.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43797702644704645, "mean_raw_obs_processing_ms": 0.11416737926696341, "mean_inference_ms": 1.4517095928347048, "mean_action_processing_ms": 0.04022543072487549}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1988000, "timers": {"sample_time_ms": 7854.98, "sample_throughput": 509.231, "learn_time_ms": 11793.617, "learn_throughput": 339.167, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1627054473101929, "cur_lr": 5e-05, "total_loss": 7.567540153861046, "policy_loss": -0.03234353690641001, "vf_loss": 7.597878083586693, "vf_explained_var": 0.4966464042663574, "kl": 0.012327219010330737, "entropy": 0.06634122831746936, "entropy_coeff": 0.0}}, "num_steps_sampled": 1988000, "num_steps_trained": 1988000}, "done": false, "episodes_total": 198, "training_iteration": 497, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-42-41", "timestamp": 1618148561, "time_this_iter_s": 20.0232355594635, "time_total_s": 9901.202788352966, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f717114fc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717118d690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9901.202788352966, "timesteps_since_restore": 0, "iterations_since_restore": 497, "perf": {"cpu_util_percent": 59.53928571428571, "ram_util_percent": 27.799999999999994}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1032.0, "episode_reward_min": 1032.0, "episode_reward_mean": 1032.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1032.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43682665588101827, "mean_raw_obs_processing_ms": 0.11444365236037839, "mean_inference_ms": 1.451682961274384, "mean_action_processing_ms": 0.040226245055583996}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1992000, "timers": {"sample_time_ms": 7832.899, "sample_throughput": 510.667, "learn_time_ms": 11746.375, "learn_throughput": 340.531, "update_time_ms": 2.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1627054473101929, "cur_lr": 5e-05, "total_loss": 6.9636033326387405, "policy_loss": -0.020285759354010224, "vf_loss": 6.981352835893631, "vf_explained_var": 0.6409031748771667, "kl": 0.015588744136039168, "entropy": 0.09103824547491968, "entropy_coeff": 0.0}}, "num_steps_sampled": 1992000, "num_steps_trained": 1992000}, "done": false, "episodes_total": 199, "training_iteration": 498, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-43-00", "timestamp": 1618148580, "time_this_iter_s": 18.868195056915283, "time_total_s": 9920.070983409882, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fd8390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717116c0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9920.070983409882, "timesteps_since_restore": 0, "iterations_since_restore": 498, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 27.799999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 1032.0, "episode_reward_min": 1032.0, "episode_reward_mean": 1032.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1032.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43682665588101827, "mean_raw_obs_processing_ms": 0.11444365236037839, "mean_inference_ms": 1.451682961274384, "mean_action_processing_ms": 0.040226245055583996}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1996000, "timers": {"sample_time_ms": 7791.381, "sample_throughput": 513.388, "learn_time_ms": 11718.322, "learn_throughput": 341.346, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1627054473101929, "cur_lr": 5e-05, "total_loss": 7.050898984074593, "policy_loss": -0.02939932423760183, "vf_loss": 7.0740919560194016, "vf_explained_var": 0.5389190912246704, "kl": 0.03814420913113281, "entropy": 0.21406024601310492, "entropy_coeff": 0.0}}, "num_steps_sampled": 1996000, "num_steps_trained": 1996000}, "done": false, "episodes_total": 199, "training_iteration": 499, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-43-19", "timestamp": 1618148599, "time_this_iter_s": 19.169089555740356, "time_total_s": 9939.240072965622, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fccd50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114f750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9939.240072965622, "timesteps_since_restore": 0, "iterations_since_restore": 499, "perf": {"cpu_util_percent": 60.15555555555556, "ram_util_percent": 27.799999999999997}, "trial_id": "a4e1f_00000"}
{"episode_reward_max": 394.0, "episode_reward_min": 394.0, "episode_reward_mean": 394.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43567835290819906, "mean_raw_obs_processing_ms": 0.11463165857791614, "mean_inference_ms": 1.4517636215522332, "mean_action_processing_ms": 0.040228105458151864}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 2000000, "timers": {"sample_time_ms": 7730.309, "sample_throughput": 517.444, "learn_time_ms": 11687.783, "learn_throughput": 342.238, "update_time_ms": 2.882}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.24405817096528937, "cur_lr": 5e-05, "total_loss": 5.308943524956703, "policy_loss": -0.016638905421132222, "vf_loss": 5.322016172111034, "vf_explained_var": 0.5120481848716736, "kl": 0.014612205588491634, "entropy": 0.12964833760634065, "entropy_coeff": 0.0}}, "num_steps_sampled": 2000000, "num_steps_trained": 2000000}, "done": true, "episodes_total": 200, "training_iteration": 500, "experiment_id": "7a942fd85f1e4053b7de3da25ff98b22", "date": "2021-04-11_13-43-38", "timestamp": 1618148618, "time_this_iter_s": 18.957767009735107, "time_total_s": 9958.197839975357, "pid": 751, "hostname": "185d2eeac0d1", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 4, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f7170fd80d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f717114fc90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 4, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9958.197839975357, "timesteps_since_restore": 0, "iterations_since_restore": 500, "perf": {"cpu_util_percent": 58.61428571428571, "ram_util_percent": 27.799999999999994}, "trial_id": "a4e1f_00000"}
