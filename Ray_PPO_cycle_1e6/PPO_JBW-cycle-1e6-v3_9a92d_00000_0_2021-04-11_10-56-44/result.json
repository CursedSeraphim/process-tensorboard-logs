{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 4000, "timers": {"sample_time_ms": 15733.999, "sample_throughput": 254.227, "learn_time_ms": 16878.129, "learn_throughput": 236.993, "update_time_ms": 3.236}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.2799434382468462, "policy_loss": -0.04529239400289953, "vf_loss": 1.3222438897937536, "vf_explained_var": 0.26062285900115967, "kl": 0.014959671389078721, "entropy": 1.0833658911287785, "entropy_coeff": 0.0}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_10-57-49", "timestamp": 1618138669, "time_this_iter_s": 32.622798681259155, "time_total_s": 32.622798681259155, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47339d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b31910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.622798681259155, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.7, "ram_util_percent": 27.174468085106394}, "trial_id": "9a92d_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 8000, "timers": {"sample_time_ms": 13614.292, "sample_throughput": 293.809, "learn_time_ms": 16830.552, "learn_throughput": 237.663, "update_time_ms": 3.49}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.107815932482481, "policy_loss": -0.05428689898690209, "vf_loss": 1.1586871910840273, "vf_explained_var": 0.3346920907497406, "kl": 0.01707820623414591, "entropy": 1.0573115348815918, "entropy_coeff": 0.0}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_10-58-17", "timestamp": 1618138697, "time_this_iter_s": 28.288058280944824, "time_total_s": 60.91085696220398, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efca50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 60.91085696220398, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.879999999999995, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 75.0, "episode_reward_min": 75.0, "episode_reward_mean": 75.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7732092127304515, "mean_raw_obs_processing_ms": 0.08878011761501564, "mean_inference_ms": 2.2879268276563294, "mean_action_processing_ms": 0.05642084983594913}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12000, "timers": {"sample_time_ms": 12925.809, "sample_throughput": 309.458, "learn_time_ms": 16645.855, "learn_throughput": 240.3, "update_time_ms": 3.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.0833937153220177, "policy_loss": -0.05395240924553946, "vf_loss": 1.1334652677178383, "vf_explained_var": 0.22840115427970886, "kl": 0.019404286867938936, "entropy": 1.027345210313797, "entropy_coeff": 0.0}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_10-58-45", "timestamp": 1618138725, "time_this_iter_s": 27.83688521385193, "time_total_s": 88.74774217605591, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f049d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 88.74774217605591, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 60.3875, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 75.0, "episode_reward_min": 75.0, "episode_reward_mean": 75.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7732092127304515, "mean_raw_obs_processing_ms": 0.08878011761501564, "mean_inference_ms": 2.2879268276563294, "mean_action_processing_ms": 0.05642084983594913}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timers": {"sample_time_ms": 12654.781, "sample_throughput": 316.086, "learn_time_ms": 16767.417, "learn_throughput": 238.558, "update_time_ms": 3.739}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.4817735999822617, "policy_loss": -0.06515787483658642, "vf_loss": 1.5428650937974453, "vf_explained_var": 0.19295209646224976, "kl": 0.020331909938249737, "entropy": 0.9928107596933842, "entropy_coeff": 0.0}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 1, "training_iteration": 4, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_10-59-14", "timestamp": 1618138754, "time_this_iter_s": 28.989225387573242, "time_total_s": 117.73696756362915, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f042d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f107d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 117.73696756362915, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.47380952380953, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 241.0, "episode_reward_min": 241.0, "episode_reward_mean": 241.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6658839354556321, "mean_raw_obs_processing_ms": 0.08897876496327162, "mean_inference_ms": 2.2873882651120434, "mean_action_processing_ms": 0.05636887039925348}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 20000, "timers": {"sample_time_ms": 12491.875, "sample_throughput": 320.208, "learn_time_ms": 16779.577, "learn_throughput": 238.385, "update_time_ms": 3.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 1.8592157773673534, "policy_loss": -0.05364387697773054, "vf_loss": 1.9075467213988304, "vf_explained_var": 0.37491101026535034, "kl": 0.017709823849145323, "entropy": 0.9591278545558453, "entropy_coeff": 0.0}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 2, "training_iteration": 5, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_10-59-43", "timestamp": 1618138783, "time_this_iter_s": 28.683845281600952, "time_total_s": 146.4208128452301, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 146.4208128452301, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.19268292682927, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 241.0, "episode_reward_min": 241.0, "episode_reward_mean": 241.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6658839354556321, "mean_raw_obs_processing_ms": 0.08897876496327162, "mean_inference_ms": 2.2873882651120434, "mean_action_processing_ms": 0.05636887039925348}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timers": {"sample_time_ms": 12340.517, "sample_throughput": 324.136, "learn_time_ms": 16768.602, "learn_throughput": 238.541, "update_time_ms": 3.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 2.8324354961514473, "policy_loss": -0.05075802587089129, "vf_loss": 2.8786045908927917, "vf_explained_var": 0.39346083998680115, "kl": 0.015296593774110079, "entropy": 0.9267593901604414, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 2, "training_iteration": 6, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-00-11", "timestamp": 1618138811, "time_this_iter_s": 28.305986881256104, "time_total_s": 174.7267997264862, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f044d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f14210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 174.7267997264862, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 60.410000000000004, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 241.0, "episode_reward_min": 241.0, "episode_reward_mean": 241.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6658839354556321, "mean_raw_obs_processing_ms": 0.08897876496327162, "mean_inference_ms": 2.2873882651120434, "mean_action_processing_ms": 0.05636887039925348}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28000, "timers": {"sample_time_ms": 12359.938, "sample_throughput": 323.626, "learn_time_ms": 16702.644, "learn_throughput": 239.483, "update_time_ms": 3.566}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 3.24470803886652, "policy_loss": -0.054982864821795374, "vf_loss": 3.2947929203510284, "vf_explained_var": 0.22592175006866455, "kl": 0.01632638182491064, "entropy": 0.8764787074178457, "entropy_coeff": 0.0}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 2, "training_iteration": 7, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-00-40", "timestamp": 1618138840, "time_this_iter_s": 28.796546459197998, "time_total_s": 203.5233461856842, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f154d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 203.5233461856842, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 59.97073170731708, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 524.0, "episode_reward_min": 524.0, "episode_reward_mean": 524.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [524.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5867027207496133, "mean_raw_obs_processing_ms": 0.0894221062697618, "mean_inference_ms": 2.2843525166146614, "mean_action_processing_ms": 0.05662472917640147}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timers": {"sample_time_ms": 12164.721, "sample_throughput": 328.82, "learn_time_ms": 16744.168, "learn_throughput": 238.889, "update_time_ms": 3.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 2.71244452893734, "policy_loss": -0.059869305754546076, "vf_loss": 2.7665868774056435, "vf_explained_var": 0.5679983496665955, "kl": 0.01908977224957198, "entropy": 0.8641314227133989, "entropy_coeff": 0.0}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 3, "training_iteration": 8, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-01-08", "timestamp": 1618138868, "time_this_iter_s": 27.85013508796692, "time_total_s": 231.37348127365112, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f196d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 231.37348127365112, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 60.657500000000006, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 524.0, "episode_reward_min": 524.0, "episode_reward_mean": 524.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [524.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5867027207496133, "mean_raw_obs_processing_ms": 0.0894221062697618, "mean_inference_ms": 2.2843525166146614, "mean_action_processing_ms": 0.05662472917640147}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 36000, "timers": {"sample_time_ms": 12008.403, "sample_throughput": 333.1, "learn_time_ms": 16701.144, "learn_throughput": 239.505, "update_time_ms": 3.755}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 4.144904009997845, "policy_loss": -0.056565213919384405, "vf_loss": 4.197143577039242, "vf_explained_var": 0.6020389199256897, "kl": 0.014418799779377878, "entropy": 0.847679765895009, "entropy_coeff": 0.0}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 3, "training_iteration": 9, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-01-35", "timestamp": 1618138895, "time_this_iter_s": 27.126370906829834, "time_total_s": 258.49985218048096, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f1a490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f1a510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 258.49985218048096, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 60.21282051282052, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 513.0, "episode_reward_min": 513.0, "episode_reward_mean": 513.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [513.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5176633820677158, "mean_raw_obs_processing_ms": 0.08978199617275193, "mean_inference_ms": 2.289207627578323, "mean_action_processing_ms": 0.056552826167672834}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 40000, "timers": {"sample_time_ms": 11908.362, "sample_throughput": 335.898, "learn_time_ms": 16715.432, "learn_throughput": 239.3, "update_time_ms": 3.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.009316377341747, "policy_loss": -0.053399292286485434, "vf_loss": 5.058241635560989, "vf_explained_var": 0.49721771478652954, "kl": 0.014913299877662212, "entropy": 0.8131784088909626, "entropy_coeff": 0.0}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 4, "training_iteration": 10, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-02-03", "timestamp": 1618138923, "time_this_iter_s": 27.866333484649658, "time_total_s": 286.3661856651306, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f14910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f1ad10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 286.3661856651306, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 60.86410256410257, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 513.0, "episode_reward_min": 513.0, "episode_reward_mean": 513.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [513.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5176633820677158, "mean_raw_obs_processing_ms": 0.08978199617275193, "mean_inference_ms": 2.289207627578323, "mean_action_processing_ms": 0.056552826167672834}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44000, "timers": {"sample_time_ms": 11471.167, "sample_throughput": 348.7, "learn_time_ms": 16758.335, "learn_throughput": 238.687, "update_time_ms": 3.953}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 3.97994327545166, "policy_loss": -0.0576499110320583, "vf_loss": 4.033113181591034, "vf_explained_var": 0.3972167372703552, "kl": 0.014933407335774973, "entropy": 0.7637569308280945, "entropy_coeff": 0.0}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 4, "training_iteration": 11, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-02-32", "timestamp": 1618138952, "time_this_iter_s": 28.68776512145996, "time_total_s": 315.0539507865906, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f195d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 315.0539507865906, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 60.22926829268293, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 513.0, "episode_reward_min": 513.0, "episode_reward_mean": 513.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [513.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5176633820677158, "mean_raw_obs_processing_ms": 0.08978199617275193, "mean_inference_ms": 2.289207627578323, "mean_action_processing_ms": 0.056552826167672834}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timers": {"sample_time_ms": 11502.069, "sample_throughput": 347.764, "learn_time_ms": 16777.891, "learn_throughput": 238.409, "update_time_ms": 3.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.850945860147476, "policy_loss": -0.05485000927001238, "vf_loss": 6.90088178217411, "vf_explained_var": 0.28513529896736145, "kl": 0.01638022394035943, "entropy": 0.7146729696542025, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 4, "training_iteration": 12, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-03-01", "timestamp": 1618138981, "time_this_iter_s": 28.797725677490234, "time_total_s": 343.8516764640808, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 343.8516764640808, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 61.34634146341463, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 904.0, "episode_reward_min": 904.0, "episode_reward_mean": 904.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [904.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5232430392028171, "mean_raw_obs_processing_ms": 0.08994284387904931, "mean_inference_ms": 2.283996032872124, "mean_action_processing_ms": 0.056435402965378766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52000, "timers": {"sample_time_ms": 11604.468, "sample_throughput": 344.695, "learn_time_ms": 16801.055, "learn_throughput": 238.08, "update_time_ms": 3.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.798792332410812, "policy_loss": -0.04914893739623949, "vf_loss": 8.843135416507721, "vf_explained_var": 0.32880663871765137, "kl": 0.016019731032429263, "entropy": 0.6481923274695873, "entropy_coeff": 0.0}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 5, "training_iteration": 13, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-03-30", "timestamp": 1618139010, "time_this_iter_s": 29.09213638305664, "time_total_s": 372.94381284713745, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 372.94381284713745, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 60.18333333333334, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 904.0, "episode_reward_min": 904.0, "episode_reward_mean": 904.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [904.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5232430392028171, "mean_raw_obs_processing_ms": 0.08994284387904931, "mean_inference_ms": 2.283996032872124, "mean_action_processing_ms": 0.056435402965378766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 56000, "timers": {"sample_time_ms": 11545.906, "sample_throughput": 346.443, "learn_time_ms": 16772.513, "learn_throughput": 238.485, "update_time_ms": 3.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.915074080228806, "policy_loss": -0.04620581725612283, "vf_loss": 8.956967294216156, "vf_explained_var": 0.26704102754592896, "kl": 0.01437553740106523, "entropy": 0.5975451916456223, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 5, "training_iteration": 14, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-03-58", "timestamp": 1618139038, "time_this_iter_s": 28.113500833511353, "time_total_s": 401.0573136806488, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f106d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 401.0573136806488, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 60.5875, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1206.0, "episode_reward_min": 1206.0, "episode_reward_mean": 1206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.532968698212533, "mean_raw_obs_processing_ms": 0.09015103133189153, "mean_inference_ms": 2.283126870281837, "mean_action_processing_ms": 0.05645030828414822}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 60000, "timers": {"sample_time_ms": 11672.038, "sample_throughput": 342.699, "learn_time_ms": 16792.171, "learn_throughput": 238.206, "update_time_ms": 3.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.530685588717461, "policy_loss": -0.045756395382341, "vf_loss": 6.572290614247322, "vf_explained_var": 0.38773274421691895, "kl": 0.01383795845322311, "entropy": 0.5947682317346334, "entropy_coeff": 0.0}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 6, "training_iteration": 15, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-04-28", "timestamp": 1618139068, "time_this_iter_s": 30.137001037597656, "time_total_s": 431.19431471824646, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f1f710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 431.19431471824646, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 60.416279069767455, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1206.0, "episode_reward_min": 1206.0, "episode_reward_mean": 1206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.532968698212533, "mean_raw_obs_processing_ms": 0.09015103133189153, "mean_inference_ms": 2.283126870281837, "mean_action_processing_ms": 0.05645030828414822}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 64000, "timers": {"sample_time_ms": 11640.048, "sample_throughput": 343.641, "learn_time_ms": 16730.524, "learn_throughput": 239.084, "update_time_ms": 3.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.650877922773361, "policy_loss": -0.04646028735442087, "vf_loss": 6.693368226289749, "vf_explained_var": 0.4537959396839142, "kl": 0.01323325332487002, "entropy": 0.602821184322238, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 6, "training_iteration": 16, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-04-55", "timestamp": 1618139095, "time_this_iter_s": 27.380945444107056, "time_total_s": 458.5752601623535, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f14b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f145d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 458.5752601623535, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.830769230769235, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1206.0, "episode_reward_min": 1206.0, "episode_reward_mean": 1206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.532968698212533, "mean_raw_obs_processing_ms": 0.09015103133189153, "mean_inference_ms": 2.283126870281837, "mean_action_processing_ms": 0.05645030828414822}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 68000, "timers": {"sample_time_ms": 11482.359, "sample_throughput": 348.36, "learn_time_ms": 16819.486, "learn_throughput": 237.819, "update_time_ms": 3.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.555057376623154, "policy_loss": -0.05183286051033065, "vf_loss": 9.602611541748047, "vf_explained_var": 0.43842214345932007, "kl": 0.014262307522585616, "entropy": 0.5859877895563841, "entropy_coeff": 0.0}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 6, "training_iteration": 17, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-05-24", "timestamp": 1618139124, "time_this_iter_s": 28.106715440750122, "time_total_s": 486.68197560310364, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f1f110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f14050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 486.68197560310364, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.67, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 968.0, "episode_reward_min": 968.0, "episode_reward_mean": 968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4982367927611774, "mean_raw_obs_processing_ms": 0.0903370317453358, "mean_inference_ms": 2.2780733408791294, "mean_action_processing_ms": 0.05647554372549405}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timers": {"sample_time_ms": 11484.613, "sample_throughput": 348.292, "learn_time_ms": 16747.312, "learn_throughput": 238.844, "update_time_ms": 3.829}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.3569968193769455, "policy_loss": -0.036553226644173265, "vf_loss": 7.389404073357582, "vf_explained_var": 0.3464951813220978, "kl": 0.013819950690958649, "entropy": 0.5647237338125706, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 7, "training_iteration": 18, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-05-51", "timestamp": 1618139151, "time_this_iter_s": 27.145015716552734, "time_total_s": 513.8269913196564, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 513.8269913196564, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 60.499999999999986, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 968.0, "episode_reward_min": 968.0, "episode_reward_mean": 968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4982367927611774, "mean_raw_obs_processing_ms": 0.0903370317453358, "mean_inference_ms": 2.2780733408791294, "mean_action_processing_ms": 0.05647554372549405}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76000, "timers": {"sample_time_ms": 11485.587, "sample_throughput": 348.263, "learn_time_ms": 16779.175, "learn_throughput": 238.391, "update_time_ms": 3.648}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.495158396661282, "policy_loss": -0.042402091377880424, "vf_loss": 5.534437149763107, "vf_explained_var": 0.523516058921814, "kl": 0.010411036055302247, "entropy": 0.6293448135256767, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 7, "training_iteration": 19, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-06-18", "timestamp": 1618139178, "time_this_iter_s": 27.45253324508667, "time_total_s": 541.279524564743, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47339d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f194d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 541.279524564743, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 60.96410256410256, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1017.0, "episode_reward_min": 1017.0, "episode_reward_mean": 1017.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1017.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5033081411500285, "mean_raw_obs_processing_ms": 0.09066802773096745, "mean_inference_ms": 2.277359897077901, "mean_action_processing_ms": 0.05653484426640437}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 80000, "timers": {"sample_time_ms": 11702.92, "sample_throughput": 341.795, "learn_time_ms": 16737.023, "learn_throughput": 238.991, "update_time_ms": 3.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.066749423742294, "policy_loss": -0.04689622751902789, "vf_loss": 9.110307544469833, "vf_explained_var": 0.44253724813461304, "kl": 0.011126805504318327, "entropy": 0.45552994403988123, "entropy_coeff": 0.0}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 8, "training_iteration": 20, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-06-48", "timestamp": 1618139208, "time_this_iter_s": 29.613956689834595, "time_total_s": 570.8934812545776, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b6b3bb10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f2aaa85ff10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 570.8934812545776, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.3813953488372, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1017.0, "episode_reward_min": 1017.0, "episode_reward_mean": 1017.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1017.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5033081411500285, "mean_raw_obs_processing_ms": 0.09066802773096745, "mean_inference_ms": 2.277359897077901, "mean_action_processing_ms": 0.05653484426640437}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84000, "timers": {"sample_time_ms": 11875.018, "sample_throughput": 336.842, "learn_time_ms": 16628.877, "learn_throughput": 240.545, "update_time_ms": 3.428}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.489281624555588, "policy_loss": -0.04472869954770431, "vf_loss": 7.529721900820732, "vf_explained_var": 0.21097059547901154, "kl": 0.014294842112576589, "entropy": 0.43898359686136246, "entropy_coeff": 0.0}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 8, "training_iteration": 21, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-07-17", "timestamp": 1618139237, "time_this_iter_s": 29.32231307029724, "time_total_s": 600.2157943248749, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 600.2157943248749, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 60.12142857142857, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1017.0, "episode_reward_min": 1017.0, "episode_reward_mean": 1017.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1017.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5033081411500285, "mean_raw_obs_processing_ms": 0.09066802773096745, "mean_inference_ms": 2.277359897077901, "mean_action_processing_ms": 0.05653484426640437}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 88000, "timers": {"sample_time_ms": 12243.672, "sample_throughput": 326.699, "learn_time_ms": 16578.648, "learn_throughput": 241.274, "update_time_ms": 3.422}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.0817461013793945, "policy_loss": -0.04959596192929894, "vf_loss": 7.127750813961029, "vf_explained_var": 0.22608642280101776, "kl": 0.011970554012805223, "entropy": 0.43080924078822136, "entropy_coeff": 0.0}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 8, "training_iteration": 22, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-07-49", "timestamp": 1618139269, "time_this_iter_s": 31.97601008415222, "time_total_s": 632.1918044090271, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4f97c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 632.1918044090271, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 60.85333333333334, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1541.0, "episode_reward_min": 1541.0, "episode_reward_mean": 1541.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1541.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.585794692451483, "mean_raw_obs_processing_ms": 0.09098465127196838, "mean_inference_ms": 2.2745881124319762, "mean_action_processing_ms": 0.05646160940202899}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 92000, "timers": {"sample_time_ms": 12405.809, "sample_throughput": 322.43, "learn_time_ms": 16591.03, "learn_throughput": 241.094, "update_time_ms": 3.355}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.320184528827667, "policy_loss": -0.04077766777481884, "vf_loss": 5.357764184474945, "vf_explained_var": 0.1864875853061676, "kl": 0.010660147585440427, "entropy": 0.4045727429911494, "entropy_coeff": 0.0}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 9, "training_iteration": 23, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-08-20", "timestamp": 1618139300, "time_this_iter_s": 30.840089559555054, "time_total_s": 663.0318939685822, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 663.0318939685822, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 60.03181818181818, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1541.0, "episode_reward_min": 1541.0, "episode_reward_mean": 1541.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1541.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.585794692451483, "mean_raw_obs_processing_ms": 0.09098465127196838, "mean_inference_ms": 2.2745881124319762, "mean_action_processing_ms": 0.05646160940202899}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timers": {"sample_time_ms": 12578.832, "sample_throughput": 317.995, "learn_time_ms": 16598.058, "learn_throughput": 240.992, "update_time_ms": 3.411}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.943759471178055, "policy_loss": -0.04705158207798377, "vf_loss": 8.987206891179085, "vf_explained_var": 0.31887680292129517, "kl": 0.012013473198749125, "entropy": 0.4198119593784213, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 9, "training_iteration": 24, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-08-50", "timestamp": 1618139330, "time_this_iter_s": 29.91785740852356, "time_total_s": 692.9497513771057, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 692.9497513771057, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 60.7860465116279, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1583.0, "episode_reward_min": 1583.0, "episode_reward_mean": 1583.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5836824389896665, "mean_raw_obs_processing_ms": 0.09127329628955909, "mean_inference_ms": 2.2737937212417125, "mean_action_processing_ms": 0.05646913564509985}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 100000, "timers": {"sample_time_ms": 12368.778, "sample_throughput": 323.395, "learn_time_ms": 16531.39, "learn_throughput": 241.964, "update_time_ms": 3.364}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.0273517370224, "policy_loss": -0.041203481785487384, "vf_loss": 10.065028503537178, "vf_explained_var": 0.46576857566833496, "kl": 0.0117561479419237, "entropy": 0.404877508059144, "entropy_coeff": 0.0}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 10, "training_iteration": 25, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-09-17", "timestamp": 1618139357, "time_this_iter_s": 27.3733971118927, "time_total_s": 720.3231484889984, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ed5550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6ae90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 720.3231484889984, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 60.58205128205127, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1583.0, "episode_reward_min": 1583.0, "episode_reward_mean": 1583.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5836824389896665, "mean_raw_obs_processing_ms": 0.09127329628955909, "mean_inference_ms": 2.2737937212417125, "mean_action_processing_ms": 0.05646913564509985}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 104000, "timers": {"sample_time_ms": 12321.349, "sample_throughput": 324.64, "learn_time_ms": 16602.21, "learn_throughput": 240.932, "update_time_ms": 3.389}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.89398393034935, "policy_loss": -0.043789598043076694, "vf_loss": 8.934051126241684, "vf_explained_var": 0.4170629382133484, "kl": 0.012408702532411553, "entropy": 0.44555758871138096, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 10, "training_iteration": 26, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-09-45", "timestamp": 1618139385, "time_this_iter_s": 27.604644536972046, "time_total_s": 747.9277930259705, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb00d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 747.9277930259705, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 60.95250000000001, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1583.0, "episode_reward_min": 1583.0, "episode_reward_mean": 1583.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5836824389896665, "mean_raw_obs_processing_ms": 0.09127329628955909, "mean_inference_ms": 2.2737937212417125, "mean_action_processing_ms": 0.05646913564509985}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 108000, "timers": {"sample_time_ms": 12303.195, "sample_throughput": 325.119, "learn_time_ms": 16487.813, "learn_throughput": 242.603, "update_time_ms": 3.34}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 11.637857586145401, "policy_loss": -0.049065956933191046, "vf_loss": 11.682959496974945, "vf_explained_var": 0.4571828544139862, "kl": 0.013213861995609477, "entropy": 0.44905713200569153, "entropy_coeff": 0.0}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 10, "training_iteration": 27, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-10-12", "timestamp": 1618139412, "time_this_iter_s": 26.780216932296753, "time_total_s": 774.7080099582672, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 774.7080099582672, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.978947368421046, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1186.0, "episode_reward_min": 1186.0, "episode_reward_mean": 1186.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1186.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5530853743889542, "mean_raw_obs_processing_ms": 0.09159713092401066, "mean_inference_ms": 2.275091694026776, "mean_action_processing_ms": 0.056514201339353975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 112000, "timers": {"sample_time_ms": 12380.36, "sample_throughput": 323.092, "learn_time_ms": 16562.183, "learn_throughput": 241.514, "update_time_ms": 3.384}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 11.112215787172318, "policy_loss": -0.04868245852412656, "vf_loss": 11.157147735357285, "vf_explained_var": 0.4407409429550171, "kl": 0.012501857097959146, "entropy": 0.3953271573409438, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 11, "training_iteration": 28, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-10-41", "timestamp": 1618139441, "time_this_iter_s": 28.660486936569214, "time_total_s": 803.3684968948364, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 803.3684968948364, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 61.31463414634147, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1186.0, "episode_reward_min": 1186.0, "episode_reward_mean": 1186.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1186.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5530853743889542, "mean_raw_obs_processing_ms": 0.09159713092401066, "mean_inference_ms": 2.275091694026776, "mean_action_processing_ms": 0.056514201339353975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 116000, "timers": {"sample_time_ms": 12410.527, "sample_throughput": 322.307, "learn_time_ms": 16568.723, "learn_throughput": 241.419, "update_time_ms": 3.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.38381975889206, "policy_loss": -0.04759430105332285, "vf_loss": 10.428178280591965, "vf_explained_var": 0.4899308383464813, "kl": 0.010785495702293701, "entropy": 0.3547786558046937, "entropy_coeff": 0.0}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 11, "training_iteration": 29, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-11-08", "timestamp": 1618139468, "time_this_iter_s": 27.820141553878784, "time_total_s": 831.1886384487152, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f191d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 831.1886384487152, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.07435897435898, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1609.0, "episode_reward_min": 1609.0, "episode_reward_mean": 1609.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1609.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5462826902157611, "mean_raw_obs_processing_ms": 0.09189412110670461, "mean_inference_ms": 2.277347121862287, "mean_action_processing_ms": 0.056528186606567714}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timers": {"sample_time_ms": 12334.653, "sample_throughput": 324.29, "learn_time_ms": 16616.321, "learn_throughput": 240.727, "update_time_ms": 3.503}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.305910989642143, "policy_loss": -0.04039241524878889, "vf_loss": 10.342893853783607, "vf_explained_var": 0.4411393404006958, "kl": 0.011365515005309135, "entropy": 0.3602184718474746, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 12, "training_iteration": 30, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-11-38", "timestamp": 1618139498, "time_this_iter_s": 29.336308002471924, "time_total_s": 860.5249464511871, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ed5910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ed5c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 860.5249464511871, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 61.10476190476191, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1609.0, "episode_reward_min": 1609.0, "episode_reward_mean": 1609.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1609.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5462826902157611, "mean_raw_obs_processing_ms": 0.09189412110670461, "mean_inference_ms": 2.277347121862287, "mean_action_processing_ms": 0.056528186606567714}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124000, "timers": {"sample_time_ms": 12129.028, "sample_throughput": 329.787, "learn_time_ms": 16713.153, "learn_throughput": 239.332, "update_time_ms": 3.481}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 11.042620360851288, "policy_loss": -0.03863921118318103, "vf_loss": 11.077926754951477, "vf_explained_var": 0.6200116872787476, "kl": 0.011109275190392509, "entropy": 0.37247912492603064, "entropy_coeff": 0.0}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 12, "training_iteration": 31, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-12-06", "timestamp": 1618139526, "time_this_iter_s": 28.231444835662842, "time_total_s": 888.75639128685, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ebbe10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 888.75639128685, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.936585365853674, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1609.0, "episode_reward_min": 1609.0, "episode_reward_mean": 1609.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1609.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5462826902157611, "mean_raw_obs_processing_ms": 0.09189412110670461, "mean_inference_ms": 2.277347121862287, "mean_action_processing_ms": 0.056528186606567714}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 128000, "timers": {"sample_time_ms": 11628.511, "sample_throughput": 343.982, "learn_time_ms": 16725.297, "learn_throughput": 239.159, "update_time_ms": 3.472}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.04953907430172, "policy_loss": -0.038850002514664084, "vf_loss": 9.085323005914688, "vf_explained_var": 0.6217803955078125, "kl": 0.010220711468718946, "entropy": 0.5508521739393473, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 12, "training_iteration": 32, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-12-33", "timestamp": 1618139553, "time_this_iter_s": 27.095518589019775, "time_total_s": 915.8519098758698, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ebb550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 915.8519098758698, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 60.79210526315791, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 928.0, "episode_reward_min": 928.0, "episode_reward_mean": 928.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [928.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5200952879628509, "mean_raw_obs_processing_ms": 0.09223766602745279, "mean_inference_ms": 2.2765909601078427, "mean_action_processing_ms": 0.05649497480627477}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 132000, "timers": {"sample_time_ms": 11300.183, "sample_throughput": 353.977, "learn_time_ms": 16785.055, "learn_throughput": 238.307, "update_time_ms": 3.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.441496342420578, "policy_loss": -0.045323035679757595, "vf_loss": 7.483087345957756, "vf_explained_var": 0.6726675629615784, "kl": 0.012439634767360985, "entropy": 0.4993107756599784, "entropy_coeff": 0.0}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 13, "training_iteration": 33, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-13-01", "timestamp": 1618139581, "time_this_iter_s": 28.160154581069946, "time_total_s": 944.0120644569397, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 944.0120644569397, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 60.51463414634147, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 928.0, "episode_reward_min": 928.0, "episode_reward_mean": 928.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [928.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5200952879628509, "mean_raw_obs_processing_ms": 0.09223766602745279, "mean_inference_ms": 2.2765909601078427, "mean_action_processing_ms": 0.05649497480627477}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 136000, "timers": {"sample_time_ms": 11067.288, "sample_throughput": 361.425, "learn_time_ms": 16827.84, "learn_throughput": 237.701, "update_time_ms": 3.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.887200951576233, "policy_loss": -0.038493947533424944, "vf_loss": 9.921363741159439, "vf_explained_var": 0.42136824131011963, "kl": 0.01443750539328903, "entropy": 0.48564933985471725, "entropy_coeff": 0.0}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 13, "training_iteration": 34, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-13-29", "timestamp": 1618139609, "time_this_iter_s": 28.01149344444275, "time_total_s": 972.0235579013824, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 972.0235579013824, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 60.575, "ram_util_percent": 27.2}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 929.0, "episode_reward_min": 929.0, "episode_reward_mean": 929.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [929.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5158430038139237, "mean_raw_obs_processing_ms": 0.09240397288057962, "mean_inference_ms": 2.275380698888018, "mean_action_processing_ms": 0.05644208578507189}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 140000, "timers": {"sample_time_ms": 11200.671, "sample_throughput": 357.121, "learn_time_ms": 16863.48, "learn_throughput": 237.199, "update_time_ms": 3.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.023139342665672, "policy_loss": -0.03715045127319172, "vf_loss": 9.056908711791039, "vf_explained_var": 0.4811285734176636, "kl": 0.011270440620137379, "entropy": 0.3514526542276144, "entropy_coeff": 0.0}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 14, "training_iteration": 35, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-13-59", "timestamp": 1618139639, "time_this_iter_s": 29.058840036392212, "time_total_s": 1001.0823979377747, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e344d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1001.0823979377747, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.45853658536587, "ram_util_percent": 27.200000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 929.0, "episode_reward_min": 929.0, "episode_reward_mean": 929.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [929.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5158430038139237, "mean_raw_obs_processing_ms": 0.09240397288057962, "mean_inference_ms": 2.275380698888018, "mean_action_processing_ms": 0.05644208578507189}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timers": {"sample_time_ms": 11351.689, "sample_throughput": 352.37, "learn_time_ms": 16865.525, "learn_throughput": 237.17, "update_time_ms": 3.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.219376295804977, "policy_loss": -0.04915050743147731, "vf_loss": 7.262193724513054, "vf_explained_var": 0.3459971845149994, "kl": 0.021110317058628425, "entropy": 0.35852946154773235, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 14, "training_iteration": 36, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-14-28", "timestamp": 1618139668, "time_this_iter_s": 29.134591102600098, "time_total_s": 1030.2169890403748, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6ac50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1030.2169890403748, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 60.32142857142857, "ram_util_percent": 27.235714285714284}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 929.0, "episode_reward_min": 929.0, "episode_reward_mean": 929.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [929.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5158430038139237, "mean_raw_obs_processing_ms": 0.09240397288057962, "mean_inference_ms": 2.275380698888018, "mean_action_processing_ms": 0.05644208578507189}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 148000, "timers": {"sample_time_ms": 11586.004, "sample_throughput": 345.244, "learn_time_ms": 16904.534, "learn_throughput": 236.623, "update_time_ms": 3.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.66394230723381, "policy_loss": -0.042393993760924786, "vf_loss": 9.701233476400375, "vf_explained_var": 0.2779825031757355, "kl": 0.011339476055582054, "entropy": 0.2942663934081793, "entropy_coeff": 0.0}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 14, "training_iteration": 37, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-14-57", "timestamp": 1618139697, "time_this_iter_s": 29.51747989654541, "time_total_s": 1059.7344689369202, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb05d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1059.7344689369202, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 60.959523809523816, "ram_util_percent": 27.280952380952385}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1549.0, "episode_reward_min": 1549.0, "episode_reward_mean": 1549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.523039799320192, "mean_raw_obs_processing_ms": 0.09274122121322297, "mean_inference_ms": 2.2733369845051397, "mean_action_processing_ms": 0.05643964798036173}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 152000, "timers": {"sample_time_ms": 11529.418, "sample_throughput": 346.939, "learn_time_ms": 16915.582, "learn_throughput": 236.468, "update_time_ms": 3.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.41468197107315, "policy_loss": -0.04270467913011089, "vf_loss": 8.452275395393372, "vf_explained_var": 0.3914070725440979, "kl": 0.011358004063367844, "entropy": 0.3522497843950987, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 15, "training_iteration": 38, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-15-26", "timestamp": 1618139726, "time_this_iter_s": 28.20640993118286, "time_total_s": 1087.940878868103, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ed5b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1087.940878868103, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 60.67750000000001, "ram_util_percent": 27.205000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1549.0, "episode_reward_min": 1549.0, "episode_reward_mean": 1549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.523039799320192, "mean_raw_obs_processing_ms": 0.09274122121322297, "mean_inference_ms": 2.2733369845051397, "mean_action_processing_ms": 0.05643964798036173}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timers": {"sample_time_ms": 11986.304, "sample_throughput": 333.714, "learn_time_ms": 16964.619, "learn_throughput": 235.785, "update_time_ms": 3.591}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.527055814862251, "policy_loss": -0.04743991425493732, "vf_loss": 9.56756041944027, "vf_explained_var": 0.3144981861114502, "kl": 0.015411243337439373, "entropy": 0.2771798335015774, "entropy_coeff": 0.0}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 15, "training_iteration": 39, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-15-58", "timestamp": 1618139758, "time_this_iter_s": 32.87914681434631, "time_total_s": 1120.8200256824493, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f159d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1120.8200256824493, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 60.663829787234036, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1749.0, "episode_reward_min": 1749.0, "episode_reward_mean": 1749.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1749.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5617540714631245, "mean_raw_obs_processing_ms": 0.0929528864135395, "mean_inference_ms": 2.2721267461921273, "mean_action_processing_ms": 0.05640164678446544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 160000, "timers": {"sample_time_ms": 12157.863, "sample_throughput": 329.005, "learn_time_ms": 16993.365, "learn_throughput": 235.386, "update_time_ms": 3.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 5.604355908930302, "policy_loss": -0.03354663265054114, "vf_loss": 5.632949523627758, "vf_explained_var": 0.2867923974990845, "kl": 0.011006723972968757, "entropy": 0.28346346551552415, "entropy_coeff": 0.0}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 16, "training_iteration": 40, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-16-30", "timestamp": 1618139790, "time_this_iter_s": 31.338390350341797, "time_total_s": 1152.1584160327911, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec00d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1152.1584160327911, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 60.264444444444436, "ram_util_percent": 27.200000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1749.0, "episode_reward_min": 1749.0, "episode_reward_mean": 1749.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1749.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5617540714631245, "mean_raw_obs_processing_ms": 0.0929528864135395, "mean_inference_ms": 2.2721267461921273, "mean_action_processing_ms": 0.05640164678446544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 164000, "timers": {"sample_time_ms": 12626.557, "sample_throughput": 316.793, "learn_time_ms": 16955.356, "learn_throughput": 235.914, "update_time_ms": 3.723}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.345052555203438, "policy_loss": -0.051662820449564606, "vf_loss": 9.391381368041039, "vf_explained_var": 0.29321765899658203, "kl": 0.011853184099891223, "entropy": 0.28404247341677547, "entropy_coeff": 0.0}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 16, "training_iteration": 41, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-17-02", "timestamp": 1618139822, "time_this_iter_s": 32.54330325126648, "time_total_s": 1184.7017192840576, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1184.7017192840576, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 61.01956521739132, "ram_util_percent": 27.20217391304348}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1749.0, "episode_reward_min": 1749.0, "episode_reward_mean": 1749.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1749.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5617540714631245, "mean_raw_obs_processing_ms": 0.0929528864135395, "mean_inference_ms": 2.2721267461921273, "mean_action_processing_ms": 0.05640164678446544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timers": {"sample_time_ms": 12847.306, "sample_throughput": 311.349, "learn_time_ms": 16966.538, "learn_throughput": 235.758, "update_time_ms": 3.847}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.886849209666252, "policy_loss": -0.03234746883390471, "vf_loss": 8.913639932870865, "vf_explained_var": 0.3023262619972229, "kl": 0.012347957585006952, "entropy": 0.30746887950226665, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 16, "training_iteration": 42, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-17-32", "timestamp": 1618139852, "time_this_iter_s": 29.417304754257202, "time_total_s": 1214.1190240383148, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1214.1190240383148, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 60.36428571428572, "ram_util_percent": 27.211904761904766}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1633.0, "episode_reward_min": 1633.0, "episode_reward_mean": 1633.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1633.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.60115886782069, "mean_raw_obs_processing_ms": 0.09331714081146415, "mean_inference_ms": 2.273725591847585, "mean_action_processing_ms": 0.05638078828444893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 172000, "timers": {"sample_time_ms": 13233.309, "sample_throughput": 302.268, "learn_time_ms": 16973.659, "learn_throughput": 235.659, "update_time_ms": 3.626}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.482590332627296, "policy_loss": -0.03460349384113215, "vf_loss": 8.512945830821991, "vf_explained_var": 0.526373565196991, "kl": 0.009440299079869874, "entropy": 0.29297330928966403, "entropy_coeff": 0.0}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 17, "training_iteration": 43, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-18-04", "timestamp": 1618139884, "time_this_iter_s": 32.08160853385925, "time_total_s": 1246.200632572174, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1246.200632572174, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 60.69347826086957, "ram_util_percent": 27.243478260869562}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1633.0, "episode_reward_min": 1633.0, "episode_reward_mean": 1633.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1633.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.60115886782069, "mean_raw_obs_processing_ms": 0.09331714081146415, "mean_inference_ms": 2.273725591847585, "mean_action_processing_ms": 0.05638078828444893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 176000, "timers": {"sample_time_ms": 13438.334, "sample_throughput": 297.656, "learn_time_ms": 16903.938, "learn_throughput": 236.631, "update_time_ms": 3.581}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.392957150936127, "policy_loss": -0.03142690594540909, "vf_loss": 11.42099341750145, "vf_explained_var": 0.5080000758171082, "kl": 0.0075343886273913085, "entropy": 0.2908044848591089, "entropy_coeff": 0.0}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 17, "training_iteration": 44, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-18-33", "timestamp": 1618139913, "time_this_iter_s": 29.367435216903687, "time_total_s": 1275.5680677890778, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1275.5680677890778, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 61.05, "ram_util_percent": 27.290476190476188}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1744.0, "episode_reward_min": 1744.0, "episode_reward_mean": 1744.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6064524178428095, "mean_raw_obs_processing_ms": 0.0936150926349461, "mean_inference_ms": 2.2764368162313513, "mean_action_processing_ms": 0.05641035159142373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 180000, "timers": {"sample_time_ms": 13522.197, "sample_throughput": 295.81, "learn_time_ms": 16939.008, "learn_throughput": 236.141, "update_time_ms": 3.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.762004345655441, "policy_loss": -0.043206018628552556, "vf_loss": 10.800822630524635, "vf_explained_var": 0.5513604879379272, "kl": 0.009750518671353348, "entropy": 0.2930946066044271, "entropy_coeff": 0.0}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 18, "training_iteration": 45, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-19-04", "timestamp": 1618139944, "time_this_iter_s": 30.24972414970398, "time_total_s": 1305.8177919387817, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1305.8177919387817, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 60.58604651162791, "ram_util_percent": 27.2953488372093}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1744.0, "episode_reward_min": 1744.0, "episode_reward_mean": 1744.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6064524178428095, "mean_raw_obs_processing_ms": 0.0936150926349461, "mean_inference_ms": 2.2764368162313513, "mean_action_processing_ms": 0.05641035159142373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 184000, "timers": {"sample_time_ms": 13780.377, "sample_throughput": 290.268, "learn_time_ms": 16876.963, "learn_throughput": 237.009, "update_time_ms": 4.187}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.722964495420456, "policy_loss": -0.048101249121828005, "vf_loss": 8.765954196453094, "vf_explained_var": 0.21311645209789276, "kl": 0.011359073308994994, "entropy": 0.25179655384272337, "entropy_coeff": 0.0}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 18, "training_iteration": 46, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-19-35", "timestamp": 1618139975, "time_this_iter_s": 31.099826335906982, "time_total_s": 1336.9176182746887, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f107d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1336.9176182746887, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 60.07333333333333, "ram_util_percent": 27.23777777777777}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1744.0, "episode_reward_min": 1744.0, "episode_reward_mean": 1744.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6064524178428095, "mean_raw_obs_processing_ms": 0.0936150926349461, "mean_inference_ms": 2.2764368162313513, "mean_action_processing_ms": 0.05641035159142373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 188000, "timers": {"sample_time_ms": 13589.574, "sample_throughput": 294.343, "learn_time_ms": 16853.51, "learn_throughput": 237.339, "update_time_ms": 4.199}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.39940656721592, "policy_loss": -0.041710071614943445, "vf_loss": 8.437030553817749, "vf_explained_var": 0.3969970941543579, "kl": 0.009080067291506566, "entropy": 0.2561477543786168, "entropy_coeff": 0.0}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 18, "training_iteration": 47, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-20-02", "timestamp": 1618140002, "time_this_iter_s": 27.376587390899658, "time_total_s": 1364.2942056655884, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ed5a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ed5610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1364.2942056655884, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 60.54615384615385, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1855.0, "episode_reward_min": 1855.0, "episode_reward_mean": 1855.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1855.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6158166255527042, "mean_raw_obs_processing_ms": 0.09414616118170269, "mean_inference_ms": 2.2759616274697607, "mean_action_processing_ms": 0.05644320480530499}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timers": {"sample_time_ms": 13731.933, "sample_throughput": 291.292, "learn_time_ms": 16867.901, "learn_throughput": 237.137, "update_time_ms": 4.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.704852283000946, "policy_loss": -0.03583457111380994, "vf_loss": 7.7370811849832535, "vf_explained_var": 0.38871827721595764, "kl": 0.008012294580112211, "entropy": 0.250823131762445, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 19, "training_iteration": 48, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-20-32", "timestamp": 1618140032, "time_this_iter_s": 29.77317452430725, "time_total_s": 1394.0673801898956, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb1d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb1150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1394.0673801898956, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 61.26190476190476, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1855.0, "episode_reward_min": 1855.0, "episode_reward_mean": 1855.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1855.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6158166255527042, "mean_raw_obs_processing_ms": 0.09414616118170269, "mean_inference_ms": 2.2759616274697607, "mean_action_processing_ms": 0.05644320480530499}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 196000, "timers": {"sample_time_ms": 13298.15, "sample_throughput": 300.794, "learn_time_ms": 16860.452, "learn_throughput": 237.242, "update_time_ms": 4.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.327398538589478, "policy_loss": -0.03691924933809787, "vf_loss": 8.36035193502903, "vf_explained_var": 0.4086533486843109, "kl": 0.008813385124085471, "entropy": 0.27429397217929363, "entropy_coeff": 0.0}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 19, "training_iteration": 49, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-21-01", "timestamp": 1618140061, "time_this_iter_s": 28.471121549606323, "time_total_s": 1422.538501739502, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1422.538501739502, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 60.78536585365854, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1638.0, "episode_reward_min": 1638.0, "episode_reward_mean": 1638.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6118018316234712, "mean_raw_obs_processing_ms": 0.09437033794178258, "mean_inference_ms": 2.2762788886956598, "mean_action_processing_ms": 0.05644504338780491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 200000, "timers": {"sample_time_ms": 13137.036, "sample_throughput": 304.483, "learn_time_ms": 16813.197, "learn_throughput": 237.908, "update_time_ms": 4.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.22413283586502, "policy_loss": -0.0403833634336479, "vf_loss": 10.258020982146263, "vf_explained_var": 0.5356443524360657, "kl": 0.014433581236517057, "entropy": 0.26323205744847655, "entropy_coeff": 0.0}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 20, "training_iteration": 50, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-21-30", "timestamp": 1618140090, "time_this_iter_s": 29.252087354660034, "time_total_s": 1451.790589094162, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1451.790589094162, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 60.519047619047626, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1638.0, "episode_reward_min": 1638.0, "episode_reward_mean": 1638.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6118018316234712, "mean_raw_obs_processing_ms": 0.09437033794178258, "mean_inference_ms": 2.2762788886956598, "mean_action_processing_ms": 0.05644504338780491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 204000, "timers": {"sample_time_ms": 12717.627, "sample_throughput": 314.524, "learn_time_ms": 16844.97, "learn_throughput": 237.46, "update_time_ms": 4.078}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.430209815502167, "policy_loss": -0.037319619790650904, "vf_loss": 13.46235117316246, "vf_explained_var": 0.389106810092926, "kl": 0.011507497023558244, "entropy": 0.2659702356904745, "entropy_coeff": 0.0}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 20, "training_iteration": 51, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-21-59", "timestamp": 1618140119, "time_this_iter_s": 28.66175675392151, "time_total_s": 1480.4523458480835, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ed5650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1480.4523458480835, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 60.580487804878054, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1638.0, "episode_reward_min": 1638.0, "episode_reward_mean": 1638.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6118018316234712, "mean_raw_obs_processing_ms": 0.09437033794178258, "mean_inference_ms": 2.2762788886956598, "mean_action_processing_ms": 0.05644504338780491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 208000, "timers": {"sample_time_ms": 12534.419, "sample_throughput": 319.121, "learn_time_ms": 16829.075, "learn_throughput": 237.684, "update_time_ms": 3.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.94733390212059, "policy_loss": -0.033052907267119735, "vf_loss": 11.976230025291443, "vf_explained_var": 0.5173893570899963, "kl": 0.009236847297870554, "entropy": 0.3274661130271852, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 20, "training_iteration": 52, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-22-26", "timestamp": 1618140146, "time_this_iter_s": 27.421611309051514, "time_total_s": 1507.873957157135, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb1e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ed59d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1507.873957157135, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 60.971794871794884, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1396.0, "episode_reward_min": 1396.0, "episode_reward_mean": 1396.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1396.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6004356478636674, "mean_raw_obs_processing_ms": 0.09478109226956184, "mean_inference_ms": 2.2770852932525654, "mean_action_processing_ms": 0.05645702267827173}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 212000, "timers": {"sample_time_ms": 12278.827, "sample_throughput": 325.764, "learn_time_ms": 16730.276, "learn_throughput": 239.088, "update_time_ms": 3.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.83215582370758, "policy_loss": -0.03319089545402676, "vf_loss": 10.861363649368286, "vf_explained_var": 0.4201829433441162, "kl": 0.008851312610204332, "entropy": 0.23901452729478478, "entropy_coeff": 0.0}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 21, "training_iteration": 53, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-22-55", "timestamp": 1618140175, "time_this_iter_s": 28.548251628875732, "time_total_s": 1536.4222087860107, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1536.4222087860107, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 60.68780487804877, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1396.0, "episode_reward_min": 1396.0, "episode_reward_mean": 1396.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1396.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6004356478636674, "mean_raw_obs_processing_ms": 0.09478109226956184, "mean_inference_ms": 2.2770852932525654, "mean_action_processing_ms": 0.05645702267827173}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timers": {"sample_time_ms": 12120.67, "sample_throughput": 330.015, "learn_time_ms": 16702.898, "learn_throughput": 239.479, "update_time_ms": 3.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.636916607618332, "policy_loss": -0.042392330506118014, "vf_loss": 12.674165651202202, "vf_explained_var": 0.44225168228149414, "kl": 0.01142962854646612, "entropy": 0.25409936998039484, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 21, "training_iteration": 54, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-23-22", "timestamp": 1618140202, "time_this_iter_s": 27.50899863243103, "time_total_s": 1563.9312074184418, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1563.9312074184418, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 61.12820512820514, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1578.0, "episode_reward_min": 1578.0, "episode_reward_mean": 1578.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1578.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5871589620295622, "mean_raw_obs_processing_ms": 0.0950271600237788, "mean_inference_ms": 2.2783718475600225, "mean_action_processing_ms": 0.05648824417713718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 220000, "timers": {"sample_time_ms": 11874.847, "sample_throughput": 336.846, "learn_time_ms": 16638.069, "learn_throughput": 240.413, "update_time_ms": 4.046}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.970900148153305, "policy_loss": -0.037420635169837624, "vf_loss": 12.00453981757164, "vf_explained_var": 0.4995959401130676, "kl": 0.008402323015616275, "entropy": 0.28837778186425567, "entropy_coeff": 0.0}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 22, "training_iteration": 55, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-23-49", "timestamp": 1618140229, "time_this_iter_s": 27.145275592803955, "time_total_s": 1591.0764830112457, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f101d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1591.0764830112457, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 60.99487179487178, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1578.0, "episode_reward_min": 1578.0, "episode_reward_mean": 1578.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1578.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5871589620295622, "mean_raw_obs_processing_ms": 0.0950271600237788, "mean_inference_ms": 2.2783718475600225, "mean_action_processing_ms": 0.05648824417713718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 224000, "timers": {"sample_time_ms": 11482.261, "sample_throughput": 348.363, "learn_time_ms": 16681.986, "learn_throughput": 239.78, "update_time_ms": 3.422}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.93430271744728, "policy_loss": -0.03345495348912664, "vf_loss": 13.963400393724442, "vf_explained_var": 0.3940667510032654, "kl": 0.009683380820206366, "entropy": 0.2645616168156266, "entropy_coeff": 0.0}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 22, "training_iteration": 56, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-24-17", "timestamp": 1618140257, "time_this_iter_s": 27.609244346618652, "time_total_s": 1618.6857273578644, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f197d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1618.6857273578644, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 61.38974358974359, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1578.0, "episode_reward_min": 1578.0, "episode_reward_mean": 1578.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1578.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5871589620295622, "mean_raw_obs_processing_ms": 0.0950271600237788, "mean_inference_ms": 2.2783718475600225, "mean_action_processing_ms": 0.05648824417713718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228000, "timers": {"sample_time_ms": 11484.959, "sample_throughput": 348.282, "learn_time_ms": 16734.607, "learn_throughput": 239.026, "update_time_ms": 3.391}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.50756448507309, "policy_loss": -0.040372905088588595, "vf_loss": 12.54417136311531, "vf_explained_var": 0.5373082160949707, "kl": 0.00836858460388612, "entropy": 0.30579106323421, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 22, "training_iteration": 57, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-24-45", "timestamp": 1618140285, "time_this_iter_s": 27.92596459388733, "time_total_s": 1646.6116919517517, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1646.6116919517517, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 60.754999999999995, "ram_util_percent": 27.3}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1458.0, "episode_reward_min": 1458.0, "episode_reward_mean": 1458.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1458.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5920703644145175, "mean_raw_obs_processing_ms": 0.09545709924852724, "mean_inference_ms": 2.280351031971949, "mean_action_processing_ms": 0.05652271974346812}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 232000, "timers": {"sample_time_ms": 11845.046, "sample_throughput": 337.694, "learn_time_ms": 16693.591, "learn_throughput": 239.613, "update_time_ms": 3.365}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.291492357850075, "policy_loss": -0.03477650397690013, "vf_loss": 7.320961564779282, "vf_explained_var": 0.28030723333358765, "kl": 0.011793920639320277, "entropy": 0.17904490139335394, "entropy_coeff": 0.0}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 23, "training_iteration": 58, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-25-18", "timestamp": 1618140318, "time_this_iter_s": 32.96609616279602, "time_total_s": 1679.5777881145477, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1679.5777881145477, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 60.86382978723404, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1458.0, "episode_reward_min": 1458.0, "episode_reward_mean": 1458.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1458.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5920703644145175, "mean_raw_obs_processing_ms": 0.09545709924852724, "mean_inference_ms": 2.280351031971949, "mean_action_processing_ms": 0.05652271974346812}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 236000, "timers": {"sample_time_ms": 12225.873, "sample_throughput": 327.175, "learn_time_ms": 16639.421, "learn_throughput": 240.393, "update_time_ms": 3.359}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.708210930228233, "policy_loss": -0.02649452316109091, "vf_loss": 6.731001406908035, "vf_explained_var": 0.3063952326774597, "kl": 0.0082309773133602, "entropy": 0.1890207608230412, "entropy_coeff": 0.0}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 23, "training_iteration": 59, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-25-50", "timestamp": 1618140350, "time_this_iter_s": 31.73533844947815, "time_total_s": 1711.3131265640259, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1711.3131265640259, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 60.54444444444444, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1963.0, "episode_reward_min": 1963.0, "episode_reward_mean": 1963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6098046961364386, "mean_raw_obs_processing_ms": 0.09575470325913539, "mean_inference_ms": 2.2812251139167743, "mean_action_processing_ms": 0.056535676988148556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timers": {"sample_time_ms": 12354.763, "sample_throughput": 323.762, "learn_time_ms": 16650.694, "learn_throughput": 240.23, "update_time_ms": 3.286}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.970067530870438, "policy_loss": -0.029588813602458686, "vf_loss": 7.9960440546274185, "vf_explained_var": 0.34051600098609924, "kl": 0.008027378251426853, "entropy": 0.1904734279960394, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 24, "training_iteration": 60, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-26-20", "timestamp": 1618140380, "time_this_iter_s": 30.653265237808228, "time_total_s": 1741.966391801834, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1741.966391801834, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 60.72954545454545, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1963.0, "episode_reward_min": 1963.0, "episode_reward_mean": 1963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6098046961364386, "mean_raw_obs_processing_ms": 0.09575470325913539, "mean_inference_ms": 2.2812251139167743, "mean_action_processing_ms": 0.056535676988148556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 244000, "timers": {"sample_time_ms": 12440.441, "sample_throughput": 321.532, "learn_time_ms": 16620.026, "learn_throughput": 240.674, "update_time_ms": 3.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.143546402454376, "policy_loss": -0.03902783343801275, "vf_loss": 9.177927285432816, "vf_explained_var": 0.4171772003173828, "kl": 0.010326141695259139, "entropy": 0.20106299920007586, "entropy_coeff": 0.0}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 24, "training_iteration": 61, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-26-50", "timestamp": 1618140410, "time_this_iter_s": 29.21753454208374, "time_total_s": 1771.1839263439178, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1771.1839263439178, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 60.76190476190475, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1963.0, "episode_reward_min": 1963.0, "episode_reward_mean": 1963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6098046961364386, "mean_raw_obs_processing_ms": 0.09575470325913539, "mean_inference_ms": 2.2812251139167743, "mean_action_processing_ms": 0.056535676988148556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 248000, "timers": {"sample_time_ms": 12706.418, "sample_throughput": 314.802, "learn_time_ms": 16642.987, "learn_throughput": 240.341, "update_time_ms": 3.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.780214369297028, "policy_loss": -0.03251455558347516, "vf_loss": 8.80846457183361, "vf_explained_var": 0.3997945487499237, "kl": 0.009476110732066445, "entropy": 0.19829853298142552, "entropy_coeff": 0.0}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 24, "training_iteration": 62, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-27-20", "timestamp": 1618140440, "time_this_iter_s": 30.30932307243347, "time_total_s": 1801.4932494163513, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1801.4932494163513, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 61.35581395348838, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1906.0, "episode_reward_min": 1906.0, "episode_reward_mean": 1906.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1906.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6330470734249294, "mean_raw_obs_processing_ms": 0.09612886281839075, "mean_inference_ms": 2.2808286372738444, "mean_action_processing_ms": 0.056554182933024284}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 252000, "timers": {"sample_time_ms": 13160.496, "sample_throughput": 303.94, "learn_time_ms": 16681.176, "learn_throughput": 239.791, "update_time_ms": 3.534}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.053549617528915, "policy_loss": -0.027630378725007176, "vf_loss": 6.077738061547279, "vf_explained_var": 0.2612132430076599, "kl": 0.007648639322724193, "entropy": 0.16660271491855383, "entropy_coeff": 0.0}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 25, "training_iteration": 63, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-27-54", "timestamp": 1618140474, "time_this_iter_s": 33.46034264564514, "time_total_s": 1834.9535920619965, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b47339d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1834.9535920619965, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 60.7875, "ram_util_percent": 27.3}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1906.0, "episode_reward_min": 1906.0, "episode_reward_mean": 1906.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1906.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6330470734249294, "mean_raw_obs_processing_ms": 0.09612886281839075, "mean_inference_ms": 2.2808286372738444, "mean_action_processing_ms": 0.056554182933024284}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 256000, "timers": {"sample_time_ms": 13443.763, "sample_throughput": 297.536, "learn_time_ms": 16772.427, "learn_throughput": 238.487, "update_time_ms": 3.515}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.137578010559082, "policy_loss": -0.03381837654160336, "vf_loss": 9.165815934538841, "vf_explained_var": 0.4076567590236664, "kl": 0.012401172818499617, "entropy": 0.19168917182832956, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 25, "training_iteration": 64, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-28-25", "timestamp": 1618140505, "time_this_iter_s": 31.25439143180847, "time_total_s": 1866.207983493805, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1866.207983493805, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 60.371111111111105, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2049.0, "episode_reward_min": 2049.0, "episode_reward_mean": 2049.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2049.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6448539167978556, "mean_raw_obs_processing_ms": 0.0963823490354904, "mean_inference_ms": 2.2810203595410696, "mean_action_processing_ms": 0.05656201909294226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 260000, "timers": {"sample_time_ms": 13766.819, "sample_throughput": 290.554, "learn_time_ms": 16822.849, "learn_throughput": 237.772, "update_time_ms": 3.431}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.830278635025024, "policy_loss": -0.04715322668198496, "vf_loss": 8.868635669350624, "vf_explained_var": 0.28691500425338745, "kl": 0.019547038682503626, "entropy": 0.1926036300137639, "entropy_coeff": 0.0}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 26, "training_iteration": 65, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-28-56", "timestamp": 1618140536, "time_this_iter_s": 30.88220715522766, "time_total_s": 1897.0901906490326, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1897.0901906490326, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 61.065909090909095, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2049.0, "episode_reward_min": 2049.0, "episode_reward_mean": 2049.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2049.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6448539167978556, "mean_raw_obs_processing_ms": 0.0963823490354904, "mean_inference_ms": 2.2810203595410696, "mean_action_processing_ms": 0.05656201909294226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 264000, "timers": {"sample_time_ms": 14212.327, "sample_throughput": 281.446, "learn_time_ms": 16848.328, "learn_throughput": 237.412, "update_time_ms": 3.467}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.448279142379761, "policy_loss": -0.03459085838403553, "vf_loss": 6.478628411889076, "vf_explained_var": 0.3019412159919739, "kl": 0.009426008764421567, "entropy": 0.1801640596240759, "entropy_coeff": 0.0}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 26, "training_iteration": 66, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-29-28", "timestamp": 1618140568, "time_this_iter_s": 32.32038998603821, "time_total_s": 1929.4105806350708, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1929.4105806350708, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 61.27391304347826, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2049.0, "episode_reward_min": 2049.0, "episode_reward_mean": 2049.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2049.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6448539167978556, "mean_raw_obs_processing_ms": 0.0963823490354904, "mean_inference_ms": 2.2810203595410696, "mean_action_processing_ms": 0.05656201909294226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 268000, "timers": {"sample_time_ms": 14568.5, "sample_throughput": 274.565, "learn_time_ms": 16933.558, "learn_throughput": 236.217, "update_time_ms": 3.49}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 5.645549476146698, "policy_loss": -0.031136154691921547, "vf_loss": 5.673144042491913, "vf_explained_var": 0.3331735134124756, "kl": 0.007869941196986474, "entropy": 0.16452484484761953, "entropy_coeff": 0.0}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 26, "training_iteration": 67, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-30-01", "timestamp": 1618140601, "time_this_iter_s": 32.340983390808105, "time_total_s": 1961.751564025879, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1961.751564025879, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 60.61739130434782, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2027.0, "episode_reward_min": 2027.0, "episode_reward_mean": 2027.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2027.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6599122199306912, "mean_raw_obs_processing_ms": 0.0967813257519798, "mean_inference_ms": 2.282674690176824, "mean_action_processing_ms": 0.056599157352594694}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 272000, "timers": {"sample_time_ms": 14136.537, "sample_throughput": 282.955, "learn_time_ms": 16896.079, "learn_throughput": 236.741, "update_time_ms": 3.562}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.160611048340797, "policy_loss": -0.03032008052105084, "vf_loss": 6.1875312477350235, "vf_explained_var": 0.2899714708328247, "kl": 0.007555278221843764, "entropy": 0.1688819471746683, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 27, "training_iteration": 68, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-30-29", "timestamp": 1618140629, "time_this_iter_s": 28.27010464668274, "time_total_s": 1990.0216686725616, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb04d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1990.0216686725616, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 61.29, "ram_util_percent": 27.3}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2027.0, "episode_reward_min": 2027.0, "episode_reward_mean": 2027.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2027.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6599122199306912, "mean_raw_obs_processing_ms": 0.0967813257519798, "mean_inference_ms": 2.282674690176824, "mean_action_processing_ms": 0.056599157352594694}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 276000, "timers": {"sample_time_ms": 14117.825, "sample_throughput": 283.33, "learn_time_ms": 16988.701, "learn_throughput": 235.451, "update_time_ms": 3.779}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.623662084341049, "policy_loss": -0.03718947770539671, "vf_loss": 7.654714003205299, "vf_explained_var": 0.3298547565937042, "kl": 0.013639176118886098, "entropy": 0.17056207219138741, "entropy_coeff": 0.0}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 27, "training_iteration": 69, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-31-01", "timestamp": 1618140661, "time_this_iter_s": 32.474372148513794, "time_total_s": 2022.4960408210754, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47332d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb1490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2022.4960408210754, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 60.42765957446808, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2080.0, "episode_reward_min": 2080.0, "episode_reward_mean": 2080.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2080.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6631134294617945, "mean_raw_obs_processing_ms": 0.09699102741492284, "mean_inference_ms": 2.282643378547044, "mean_action_processing_ms": 0.05659216696470783}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 280000, "timers": {"sample_time_ms": 13833.531, "sample_throughput": 289.152, "learn_time_ms": 16934.124, "learn_throughput": 236.209, "update_time_ms": 3.825}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.456576466560364, "policy_loss": -0.023046675079967827, "vf_loss": 6.476503595709801, "vf_explained_var": 0.41546517610549927, "kl": 0.006932317686732858, "entropy": 0.17220956506207585, "entropy_coeff": 0.0}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 28, "training_iteration": 70, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-31-29", "timestamp": 1618140689, "time_this_iter_s": 27.268128633499146, "time_total_s": 2049.7641694545746, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efc7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2049.7641694545746, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 60.82564102564102, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2080.0, "episode_reward_min": 2080.0, "episode_reward_mean": 2080.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2080.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6631134294617945, "mean_raw_obs_processing_ms": 0.09699102741492284, "mean_inference_ms": 2.282643378547044, "mean_action_processing_ms": 0.05659216696470783}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 284000, "timers": {"sample_time_ms": 13958.491, "sample_throughput": 286.564, "learn_time_ms": 16889.071, "learn_throughput": 236.84, "update_time_ms": 3.574}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.85775762796402, "policy_loss": -0.03121705783996731, "vf_loss": 10.884748190641403, "vf_explained_var": 0.41089046001434326, "kl": 0.009392438238137402, "entropy": 0.20154512207955122, "entropy_coeff": 0.0}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 28, "training_iteration": 71, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-31-59", "timestamp": 1618140719, "time_this_iter_s": 30.008896589279175, "time_total_s": 2079.7730660438538, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2079.7730660438538, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 61.276744186046514, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2080.0, "episode_reward_min": 2080.0, "episode_reward_mean": 2080.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2080.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6631134294617945, "mean_raw_obs_processing_ms": 0.09699102741492284, "mean_inference_ms": 2.282643378547044, "mean_action_processing_ms": 0.05659216696470783}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 288000, "timers": {"sample_time_ms": 13789.22, "sample_throughput": 290.082, "learn_time_ms": 16903.702, "learn_throughput": 236.635, "update_time_ms": 3.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.221809923648834, "policy_loss": -0.03425655193859711, "vf_loss": 11.25264847278595, "vf_explained_var": 0.5380544662475586, "kl": 0.007595194663736038, "entropy": 0.2177073173224926, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 28, "training_iteration": 72, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-32-27", "timestamp": 1618140747, "time_this_iter_s": 28.763808250427246, "time_total_s": 2108.536874294281, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2108.536874294281, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 60.924390243902444, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1830.0, "episode_reward_min": 1830.0, "episode_reward_mean": 1830.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1830.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6665145252138465, "mean_raw_obs_processing_ms": 0.09738213766903947, "mean_inference_ms": 2.283174969292743, "mean_action_processing_ms": 0.05659897001370476}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 292000, "timers": {"sample_time_ms": 13442.449, "sample_throughput": 297.565, "learn_time_ms": 16853.148, "learn_throughput": 237.344, "update_time_ms": 3.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.532371610403061, "policy_loss": -0.034921079815831035, "vf_loss": 7.562786817550659, "vf_explained_var": 0.4664223790168762, "kl": 0.010013152044848539, "entropy": 0.19476826442405581, "entropy_coeff": 0.0}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 29, "training_iteration": 73, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-32-57", "timestamp": 1618140777, "time_this_iter_s": 29.48772692680359, "time_total_s": 2138.0246012210846, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f109d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2138.0246012210846, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 60.41428571428572, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1830.0, "episode_reward_min": 1830.0, "episode_reward_mean": 1830.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1830.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6665145252138465, "mean_raw_obs_processing_ms": 0.09738213766903947, "mean_inference_ms": 2.283174969292743, "mean_action_processing_ms": 0.05659897001370476}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 296000, "timers": {"sample_time_ms": 13123.871, "sample_throughput": 304.788, "learn_time_ms": 16763.402, "learn_throughput": 238.615, "update_time_ms": 3.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.720395684242249, "policy_loss": -0.033918365312274545, "vf_loss": 13.750420868396759, "vf_explained_var": 0.4092787802219391, "kl": 0.008651544267195277, "entropy": 0.2548299580812454, "entropy_coeff": 0.0}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 29, "training_iteration": 74, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-33-24", "timestamp": 1618140804, "time_this_iter_s": 27.1768639087677, "time_total_s": 2165.2014651298523, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efc390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2165.2014651298523, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 60.797435897435896, "ram_util_percent": 27.299999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1479.0, "episode_reward_min": 1479.0, "episode_reward_mean": 1479.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1479.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6553912958221964, "mean_raw_obs_processing_ms": 0.09760514864471326, "mean_inference_ms": 2.2830732409928425, "mean_action_processing_ms": 0.05658841423272119}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 300000, "timers": {"sample_time_ms": 12823.006, "sample_throughput": 311.939, "learn_time_ms": 16777.199, "learn_throughput": 238.419, "update_time_ms": 3.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.982240974903107, "policy_loss": -0.03357810206944123, "vf_loss": 13.011110007762909, "vf_explained_var": 0.4928426146507263, "kl": 0.010464648068591487, "entropy": 0.26421749452129006, "entropy_coeff": 0.0}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 30, "training_iteration": 75, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-33-52", "timestamp": 1618140832, "time_this_iter_s": 28.00605344772339, "time_total_s": 2193.2075185775757, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f155d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2193.2075185775757, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 60.63000000000001, "ram_util_percent": 27.3}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1479.0, "episode_reward_min": 1479.0, "episode_reward_mean": 1479.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1479.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6553912958221964, "mean_raw_obs_processing_ms": 0.09760514864471326, "mean_inference_ms": 2.2830732409928425, "mean_action_processing_ms": 0.05658841423272119}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 304000, "timers": {"sample_time_ms": 12509.495, "sample_throughput": 319.757, "learn_time_ms": 16780.576, "learn_throughput": 238.371, "update_time_ms": 3.754}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 14.757149964571, "policy_loss": -0.052427555492613465, "vf_loss": 14.79649305343628, "vf_explained_var": 0.3356584906578064, "kl": 0.029076801089104265, "entropy": 0.238091257866472, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 30, "training_iteration": 76, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-34-21", "timestamp": 1618140861, "time_this_iter_s": 29.21981382369995, "time_total_s": 2222.4273324012756, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec08d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f2aa8ed6a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2222.4273324012756, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 61.014634146341464, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1479.0, "episode_reward_min": 1479.0, "episode_reward_mean": 1479.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1479.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6553912958221964, "mean_raw_obs_processing_ms": 0.09760514864471326, "mean_inference_ms": 2.2830732409928425, "mean_action_processing_ms": 0.05658841423272119}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 308000, "timers": {"sample_time_ms": 12162.735, "sample_throughput": 328.873, "learn_time_ms": 16749.166, "learn_throughput": 238.818, "update_time_ms": 3.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.440703004598618, "policy_loss": -0.039828000182751566, "vf_loss": 10.475195407867432, "vf_explained_var": 0.5720986127853394, "kl": 0.00790458734263666, "entropy": 0.25972922099754214, "entropy_coeff": 0.0}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 30, "training_iteration": 77, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-34-50", "timestamp": 1618140890, "time_this_iter_s": 28.56101393699646, "time_total_s": 2250.988346338272, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e4c690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2250.988346338272, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1476.0, "episode_reward_min": 1476.0, "episode_reward_mean": 1476.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1476.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474235344459458, "mean_raw_obs_processing_ms": 0.0980012821485066, "mean_inference_ms": 2.283735270163968, "mean_action_processing_ms": 0.05659306938179236}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 312000, "timers": {"sample_time_ms": 12157.781, "sample_throughput": 329.007, "learn_time_ms": 16757.173, "learn_throughput": 238.704, "update_time_ms": 3.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.69399842619896, "policy_loss": -0.03927604196360335, "vf_loss": 11.727589905261993, "vf_explained_var": 0.4503619372844696, "kl": 0.008421438382356428, "entropy": 0.22246582712978125, "entropy_coeff": 0.0}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 31, "training_iteration": 78, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-35-18", "timestamp": 1618140918, "time_this_iter_s": 28.300760746002197, "time_total_s": 2279.2891070842743, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2279.2891070842743, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 60.73658536585366, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1476.0, "episode_reward_min": 1476.0, "episode_reward_mean": 1476.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1476.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474235344459458, "mean_raw_obs_processing_ms": 0.0980012821485066, "mean_inference_ms": 2.283735270163968, "mean_action_processing_ms": 0.05659306938179236}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 316000, "timers": {"sample_time_ms": 11725.695, "sample_throughput": 341.131, "learn_time_ms": 16661.273, "learn_throughput": 240.078, "update_time_ms": 3.521}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.205373734235764, "policy_loss": -0.03170758893247694, "vf_loss": 11.231410920619965, "vf_explained_var": 0.4862686097621918, "kl": 0.008400395352509804, "entropy": 0.3004901520907879, "entropy_coeff": 0.0}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 31, "training_iteration": 79, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-35-46", "timestamp": 1618140946, "time_this_iter_s": 27.19644856452942, "time_total_s": 2306.4855556488037, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2306.4855556488037, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 61.19736842105263, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1181.0, "episode_reward_min": 1181.0, "episode_reward_mean": 1181.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1181.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6379370050864427, "mean_raw_obs_processing_ms": 0.09821475748527782, "mean_inference_ms": 2.2831061057440403, "mean_action_processing_ms": 0.05659349309629614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 320000, "timers": {"sample_time_ms": 11737.803, "sample_throughput": 340.779, "learn_time_ms": 16773.894, "learn_throughput": 238.466, "update_time_ms": 3.546}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.620243936777115, "policy_loss": -0.035734326229430735, "vf_loss": 10.650762781500816, "vf_explained_var": 0.7445623874664307, "kl": 0.007726638985332102, "entropy": 0.3277086988091469, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 32, "training_iteration": 80, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-36-14", "timestamp": 1618140974, "time_this_iter_s": 28.51598572731018, "time_total_s": 2335.001541376114, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2335.001541376114, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 61.39999999999999, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1181.0, "episode_reward_min": 1181.0, "episode_reward_mean": 1181.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1181.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6379370050864427, "mean_raw_obs_processing_ms": 0.09821475748527782, "mean_inference_ms": 2.2831061057440403, "mean_action_processing_ms": 0.05659349309629614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 324000, "timers": {"sample_time_ms": 11731.865, "sample_throughput": 340.952, "learn_time_ms": 16882.37, "learn_throughput": 236.934, "update_time_ms": 3.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.738470315933228, "policy_loss": -0.029359685780946165, "vf_loss": 11.76271864771843, "vf_explained_var": 0.3704860806465149, "kl": 0.007572491595055908, "entropy": 0.1907024090178311, "entropy_coeff": 0.0}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 32, "training_iteration": 81, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-36-45", "timestamp": 1618141005, "time_this_iter_s": 31.035569429397583, "time_total_s": 2366.0371108055115, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2366.0371108055115, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 61.743181818181824, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1181.0, "episode_reward_min": 1181.0, "episode_reward_mean": 1181.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1181.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6379370050864427, "mean_raw_obs_processing_ms": 0.09821475748527782, "mean_inference_ms": 2.2831061057440403, "mean_action_processing_ms": 0.05659349309629614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 328000, "timers": {"sample_time_ms": 11669.367, "sample_throughput": 342.778, "learn_time_ms": 16925.015, "learn_throughput": 236.337, "update_time_ms": 3.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.223583027720451, "policy_loss": -0.05372636072570458, "vf_loss": 10.260551050305367, "vf_explained_var": 0.5101683139801025, "kl": 0.024827065877616405, "entropy": 0.23370879236608744, "entropy_coeff": 0.0}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 32, "training_iteration": 82, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-37-14", "timestamp": 1618141034, "time_this_iter_s": 28.566768884658813, "time_total_s": 2394.6038796901703, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2394.6038796901703, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1766.0, "episode_reward_min": 1766.0, "episode_reward_mean": 1766.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1766.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6396823194930988, "mean_raw_obs_processing_ms": 0.09856007947193889, "mean_inference_ms": 2.2827838209096845, "mean_action_processing_ms": 0.056600903601965}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 332000, "timers": {"sample_time_ms": 11641.348, "sample_throughput": 343.603, "learn_time_ms": 16981.568, "learn_throughput": 235.55, "update_time_ms": 3.567}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 9.62228037416935, "policy_loss": -0.029466720239724964, "vf_loss": 9.645957425236702, "vf_explained_var": 0.3513595461845398, "kl": 0.005718171058106236, "entropy": 0.17073499877005816, "entropy_coeff": 0.0}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 33, "training_iteration": 83, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-37-44", "timestamp": 1618141064, "time_this_iter_s": 29.77368688583374, "time_total_s": 2424.377566576004, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaad50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2424.377566576004, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 60.737209302325574, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1766.0, "episode_reward_min": 1766.0, "episode_reward_mean": 1766.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1766.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6396823194930988, "mean_raw_obs_processing_ms": 0.09856007947193889, "mean_inference_ms": 2.2827838209096845, "mean_action_processing_ms": 0.056600903601965}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 336000, "timers": {"sample_time_ms": 11982.074, "sample_throughput": 333.832, "learn_time_ms": 16999.935, "learn_throughput": 235.295, "update_time_ms": 3.562}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 10.065116435289383, "policy_loss": -0.049116314155980945, "vf_loss": 10.095006629824638, "vf_explained_var": 0.4103378653526306, "kl": 0.018988797077327035, "entropy": 0.1853608158417046, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 33, "training_iteration": 84, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-38-15", "timestamp": 1618141095, "time_this_iter_s": 30.766427516937256, "time_total_s": 2455.1439940929413, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2455.1439940929413, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 61.213636363636354, "ram_util_percent": 27.299999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1955.0, "episode_reward_min": 1955.0, "episode_reward_mean": 1955.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1955.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6464940929463611, "mean_raw_obs_processing_ms": 0.09878937962988535, "mean_inference_ms": 2.2835437459969046, "mean_action_processing_ms": 0.05660099323933802}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 340000, "timers": {"sample_time_ms": 12216.516, "sample_throughput": 327.426, "learn_time_ms": 16970.209, "learn_throughput": 235.707, "update_time_ms": 3.571}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 7.843733564019203, "policy_loss": -0.02986515301745385, "vf_loss": 7.86540824174881, "vf_explained_var": 0.27575963735580444, "kl": 0.0080895560386125, "entropy": 0.18483821023255587, "entropy_coeff": 0.0}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 34, "training_iteration": 85, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-38-45", "timestamp": 1618141125, "time_this_iter_s": 30.05353331565857, "time_total_s": 2485.1975274086, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6ac10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6aa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2485.1975274086, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 60.33953488372093, "ram_util_percent": 27.36976744186047}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1955.0, "episode_reward_min": 1955.0, "episode_reward_mean": 1955.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1955.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6464940929463611, "mean_raw_obs_processing_ms": 0.09878937962988535, "mean_inference_ms": 2.2835437459969046, "mean_action_processing_ms": 0.05660099323933802}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 344000, "timers": {"sample_time_ms": 12428.818, "sample_throughput": 321.833, "learn_time_ms": 16936.644, "learn_throughput": 236.174, "update_time_ms": 3.506}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 8.701152861118317, "policy_loss": -0.04079839063342661, "vf_loss": 8.729598298668861, "vf_explained_var": 0.3498854637145996, "kl": 0.012200609024148434, "entropy": 0.18076056288555264, "entropy_coeff": 0.0}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 34, "training_iteration": 86, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-39-16", "timestamp": 1618141156, "time_this_iter_s": 31.010059356689453, "time_total_s": 2516.2075867652893, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2516.2075867652893, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 61.09545454545455, "ram_util_percent": 27.325000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1955.0, "episode_reward_min": 1955.0, "episode_reward_mean": 1955.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1955.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6464940929463611, "mean_raw_obs_processing_ms": 0.09878937962988535, "mean_inference_ms": 2.2835437459969046, "mean_action_processing_ms": 0.05660099323933802}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 348000, "timers": {"sample_time_ms": 12607.17, "sample_throughput": 317.28, "learn_time_ms": 16896.922, "learn_throughput": 236.73, "update_time_ms": 3.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 5.798921659588814, "policy_loss": -0.029285002063261345, "vf_loss": 5.820348486304283, "vf_explained_var": 0.21632187068462372, "kl": 0.007761153312458191, "entropy": 0.15661068353801966, "entropy_coeff": 0.0}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 34, "training_iteration": 87, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-39-46", "timestamp": 1618141186, "time_this_iter_s": 29.94281315803528, "time_total_s": 2546.1503999233246, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2546.1503999233246, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 60.54883720930232, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1923.0, "episode_reward_min": 1923.0, "episode_reward_mean": 1923.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1923.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6569406157131545, "mean_raw_obs_processing_ms": 0.09907968980999203, "mean_inference_ms": 2.281592337453997, "mean_action_processing_ms": 0.05657103909949309}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 352000, "timers": {"sample_time_ms": 12731.41, "sample_throughput": 314.184, "learn_time_ms": 16891.564, "learn_throughput": 236.805, "update_time_ms": 3.518}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 9.024870872497559, "policy_loss": -0.05091319384519011, "vf_loss": 9.060081377625465, "vf_explained_var": 0.40745264291763306, "kl": 0.015508835218497552, "entropy": 0.20189038245007396, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 35, "training_iteration": 88, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-40-15", "timestamp": 1618141215, "time_this_iter_s": 29.486581087112427, "time_total_s": 2575.636981010437, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efcf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2575.636981010437, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 60.6642857142857, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1923.0, "episode_reward_min": 1923.0, "episode_reward_mean": 1923.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1923.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6569406157131545, "mean_raw_obs_processing_ms": 0.09907968980999203, "mean_inference_ms": 2.281592337453997, "mean_action_processing_ms": 0.05657103909949309}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 356000, "timers": {"sample_time_ms": 13056.737, "sample_throughput": 306.355, "learn_time_ms": 16846.439, "learn_throughput": 237.439, "update_time_ms": 3.515}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 10.797559723258018, "policy_loss": -0.032523296773433685, "vf_loss": 10.822967380285263, "vf_explained_var": 0.3840228319168091, "kl": 0.00702770882344339, "entropy": 0.16926686349324882, "entropy_coeff": 0.0}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 35, "training_iteration": 89, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-40-45", "timestamp": 1618141245, "time_this_iter_s": 29.997339725494385, "time_total_s": 2605.6343207359314, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2605.6343207359314, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 61.195348837209316, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2054.0, "episode_reward_min": 2054.0, "episode_reward_mean": 2054.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2054.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.665647489542479, "mean_raw_obs_processing_ms": 0.09934736378123675, "mean_inference_ms": 2.281117163963553, "mean_action_processing_ms": 0.056567441581986684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 360000, "timers": {"sample_time_ms": 13361.923, "sample_throughput": 299.358, "learn_time_ms": 16834.58, "learn_throughput": 237.606, "update_time_ms": 3.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 7.893900513648987, "policy_loss": -0.03369872487382963, "vf_loss": 7.918511062860489, "vf_explained_var": 0.44527894258499146, "kl": 0.008975913915492129, "entropy": 0.16202172497287393, "entropy_coeff": 0.0}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 36, "training_iteration": 90, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-41-17", "timestamp": 1618141277, "time_this_iter_s": 31.445248126983643, "time_total_s": 2637.079568862915, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2637.079568862915, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 60.56000000000001, "ram_util_percent": 27.40000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2054.0, "episode_reward_min": 2054.0, "episode_reward_mean": 2054.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2054.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.665647489542479, "mean_raw_obs_processing_ms": 0.09934736378123675, "mean_inference_ms": 2.281117163963553, "mean_action_processing_ms": 0.056567441581986684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 364000, "timers": {"sample_time_ms": 13209.729, "sample_throughput": 302.807, "learn_time_ms": 16792.149, "learn_throughput": 238.207, "update_time_ms": 3.493}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 9.321114629507065, "policy_loss": -0.03515855717705563, "vf_loss": 9.351330682635307, "vf_explained_var": 0.3687136173248291, "kl": 0.004881557732005604, "entropy": 0.17997959116473794, "entropy_coeff": 0.0}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 36, "training_iteration": 91, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-41-46", "timestamp": 1618141306, "time_this_iter_s": 29.092165231704712, "time_total_s": 2666.1717340946198, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2666.1717340946198, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 61.18780487804877, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2054.0, "episode_reward_min": 2054.0, "episode_reward_mean": 2054.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2054.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.665647489542479, "mean_raw_obs_processing_ms": 0.09934736378123675, "mean_inference_ms": 2.281117163963553, "mean_action_processing_ms": 0.056567441581986684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 368000, "timers": {"sample_time_ms": 13264.984, "sample_throughput": 301.546, "learn_time_ms": 16722.222, "learn_throughput": 239.203, "update_time_ms": 3.597}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.1925228536129, "policy_loss": -0.044789654086343944, "vf_loss": 11.228492885828018, "vf_explained_var": 0.44620388746261597, "kl": 0.017421798256691545, "entropy": 0.20006616180762649, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 36, "training_iteration": 92, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-42-14", "timestamp": 1618141334, "time_this_iter_s": 28.424179792404175, "time_total_s": 2694.595913887024, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2694.595913887024, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 61.18536585365853, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1845.0, "episode_reward_min": 1845.0, "episode_reward_mean": 1845.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1845.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6586524378942195, "mean_raw_obs_processing_ms": 0.09973572061784042, "mean_inference_ms": 2.2813496739158947, "mean_action_processing_ms": 0.05657850138126223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 372000, "timers": {"sample_time_ms": 13098.543, "sample_throughput": 305.377, "learn_time_ms": 16766.775, "learn_throughput": 238.567, "update_time_ms": 3.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.093677461147308, "policy_loss": -0.041087768506258726, "vf_loss": 11.128781259059906, "vf_explained_var": 0.5215115547180176, "kl": 0.011819447303423658, "entropy": 0.22303298953920603, "entropy_coeff": 0.0}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 37, "training_iteration": 93, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-42-43", "timestamp": 1618141363, "time_this_iter_s": 28.57223415374756, "time_total_s": 2723.1681480407715, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2723.1681480407715, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 60.8, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1845.0, "episode_reward_min": 1845.0, "episode_reward_mean": 1845.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1845.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6586524378942195, "mean_raw_obs_processing_ms": 0.09973572061784042, "mean_inference_ms": 2.2813496739158947, "mean_action_processing_ms": 0.05657850138126223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 376000, "timers": {"sample_time_ms": 12827.876, "sample_throughput": 311.821, "learn_time_ms": 16724.256, "learn_throughput": 239.174, "update_time_ms": 3.999}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 15.444496512413025, "policy_loss": -0.039717144711175933, "vf_loss": 15.477792173624039, "vf_explained_var": 0.5141216516494751, "kl": 0.012684265893767588, "entropy": 0.26494088349863887, "entropy_coeff": 0.0}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 37, "training_iteration": 94, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-43-11", "timestamp": 1618141391, "time_this_iter_s": 27.63465929031372, "time_total_s": 2750.802807331085, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2750.802807331085, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 61.21750000000001, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1347.0, "episode_reward_min": 1347.0, "episode_reward_mean": 1347.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1347.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.651363812611075, "mean_raw_obs_processing_ms": 0.09997839843612188, "mean_inference_ms": 2.281567962803569, "mean_action_processing_ms": 0.056585823650017235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 380000, "timers": {"sample_time_ms": 12588.443, "sample_throughput": 317.752, "learn_time_ms": 16739.768, "learn_throughput": 238.952, "update_time_ms": 4.248}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 13.323026716709137, "policy_loss": -0.03454277169657871, "vf_loss": 13.352528035640717, "vf_explained_var": 0.5701779723167419, "kl": 0.009958364928024821, "entropy": 0.2772956257686019, "entropy_coeff": 0.0}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 38, "training_iteration": 95, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-43-38", "timestamp": 1618141418, "time_this_iter_s": 27.821742057800293, "time_total_s": 2778.6245493888855, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efc590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2778.6245493888855, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 60.88500000000001, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1347.0, "episode_reward_min": 1347.0, "episode_reward_mean": 1347.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1347.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.651363812611075, "mean_raw_obs_processing_ms": 0.09997839843612188, "mean_inference_ms": 2.281567962803569, "mean_action_processing_ms": 0.056585823650017235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 384000, "timers": {"sample_time_ms": 12235.008, "sample_throughput": 326.931, "learn_time_ms": 16750.917, "learn_throughput": 238.793, "update_time_ms": 4.263}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 13.55216559767723, "policy_loss": -0.04658551109605469, "vf_loss": 13.590689420700073, "vf_explained_var": 0.4829224646091461, "kl": 0.015924139152048156, "entropy": 0.24625721294432878, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 38, "training_iteration": 96, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-44-06", "timestamp": 1618141446, "time_this_iter_s": 27.582606077194214, "time_total_s": 2806.2071554660797, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efc890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2806.2071554660797, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 61.071794871794886, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1347.0, "episode_reward_min": 1347.0, "episode_reward_mean": 1347.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1347.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.651363812611075, "mean_raw_obs_processing_ms": 0.09997839843612188, "mean_inference_ms": 2.281567962803569, "mean_action_processing_ms": 0.056585823650017235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 388000, "timers": {"sample_time_ms": 12074.066, "sample_throughput": 331.289, "learn_time_ms": 16723.947, "learn_throughput": 239.178, "update_time_ms": 4.26}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.850902259349823, "policy_loss": -0.034820163738913834, "vf_loss": 9.880652636289597, "vf_explained_var": 0.333662211894989, "kl": 0.010014286788646132, "entropy": 0.2076069046743214, "entropy_coeff": 0.0}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 38, "training_iteration": 97, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-44-34", "timestamp": 1618141474, "time_this_iter_s": 28.06377863883972, "time_total_s": 2834.2709341049194, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edadd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2834.2709341049194, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 61.05499999999999, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1516.0, "episode_reward_min": 1516.0, "episode_reward_mean": 1516.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1516.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6430997815935062, "mean_raw_obs_processing_ms": 0.100359731827935, "mean_inference_ms": 2.2817552957149405, "mean_action_processing_ms": 0.05659306452680795}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 392000, "timers": {"sample_time_ms": 11984.394, "sample_throughput": 333.767, "learn_time_ms": 16720.483, "learn_throughput": 239.228, "update_time_ms": 4.294}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 13.553913027048111, "policy_loss": -0.043495208432432264, "vf_loss": 13.589949429035187, "vf_explained_var": 0.5018404722213745, "kl": 0.014733346091816202, "entropy": 0.23874206794425845, "entropy_coeff": 0.0}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 39, "training_iteration": 98, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-45-03", "timestamp": 1618141503, "time_this_iter_s": 28.556031227111816, "time_total_s": 2862.8269653320312, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6afd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2862.8269653320312, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 60.84878048780487, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1516.0, "episode_reward_min": 1516.0, "episode_reward_mean": 1516.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1516.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6430997815935062, "mean_raw_obs_processing_ms": 0.100359731827935, "mean_inference_ms": 2.2817552957149405, "mean_action_processing_ms": 0.05659306452680795}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 396000, "timers": {"sample_time_ms": 11939.668, "sample_throughput": 335.018, "learn_time_ms": 16762.383, "learn_throughput": 238.63, "update_time_ms": 4.306}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 12.65687221288681, "policy_loss": -0.03298849178827368, "vf_loss": 12.683023929595947, "vf_explained_var": 0.5021243691444397, "kl": 0.01350502431159839, "entropy": 0.19440624117851257, "entropy_coeff": 0.0}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 39, "training_iteration": 99, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-45-33", "timestamp": 1618141533, "time_this_iter_s": 29.96871542930603, "time_total_s": 2892.7956807613373, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f150d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2892.7956807613373, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 61.28139534883721, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1613.0, "episode_reward_min": 1613.0, "episode_reward_mean": 1613.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1613.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.642113674747971, "mean_raw_obs_processing_ms": 0.1006423758717062, "mean_inference_ms": 2.2822718253482304, "mean_action_processing_ms": 0.05660254573328258}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 400000, "timers": {"sample_time_ms": 11661.403, "sample_throughput": 343.012, "learn_time_ms": 16749.093, "learn_throughput": 238.819, "update_time_ms": 4.232}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 14.143805176019669, "policy_loss": -0.03737700014607981, "vf_loss": 14.176389217376709, "vf_explained_var": 0.5855613946914673, "kl": 0.009467746567679569, "entropy": 0.24349862523376942, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 40, "training_iteration": 100, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-46-01", "timestamp": 1618141561, "time_this_iter_s": 28.530771255493164, "time_total_s": 2921.3264520168304, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6ad10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec08d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2921.3264520168304, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 61.643902439024394, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1613.0, "episode_reward_min": 1613.0, "episode_reward_mean": 1613.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1613.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.642113674747971, "mean_raw_obs_processing_ms": 0.1006423758717062, "mean_inference_ms": 2.2822718253482304, "mean_action_processing_ms": 0.05660254573328258}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 404000, "timers": {"sample_time_ms": 11565.584, "sample_throughput": 345.854, "learn_time_ms": 16730.056, "learn_throughput": 239.091, "update_time_ms": 4.213}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.709694981575012, "policy_loss": -0.04221762125962414, "vf_loss": 10.746655195951462, "vf_explained_var": 0.5181393623352051, "kl": 0.010385146015323699, "entropy": 0.24047343572601676, "entropy_coeff": 0.0}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 40, "training_iteration": 101, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-46-29", "timestamp": 1618141589, "time_this_iter_s": 27.945573329925537, "time_total_s": 2949.272025346756, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafe10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2949.272025346756, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 61.4125, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1613.0, "episode_reward_min": 1613.0, "episode_reward_mean": 1613.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1613.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.642113674747971, "mean_raw_obs_processing_ms": 0.1006423758717062, "mean_inference_ms": 2.2822718253482304, "mean_action_processing_ms": 0.05660254573328258}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 408000, "timers": {"sample_time_ms": 11460.733, "sample_throughput": 349.018, "learn_time_ms": 16761.036, "learn_throughput": 238.649, "update_time_ms": 4.141}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.930721640586853, "policy_loss": -0.04246463507297449, "vf_loss": 6.965713769197464, "vf_explained_var": 0.46467775106430054, "kl": 0.014760266349185258, "entropy": 0.3744701612740755, "entropy_coeff": 0.0}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 40, "training_iteration": 102, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-46-57", "timestamp": 1618141617, "time_this_iter_s": 27.680044889450073, "time_total_s": 2976.952070236206, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b31090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2976.952070236206, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 61.43333333333334, "ram_util_percent": 27.402564102564103}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 711.0, "episode_reward_min": 711.0, "episode_reward_mean": 711.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [711.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6295632907604541, "mean_raw_obs_processing_ms": 0.1010105177795894, "mean_inference_ms": 2.2838752106168134, "mean_action_processing_ms": 0.056631785844757775}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 412000, "timers": {"sample_time_ms": 11438.559, "sample_throughput": 349.694, "learn_time_ms": 16718.424, "learn_throughput": 239.257, "update_time_ms": 3.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.243242517113686, "policy_loss": -0.028448786062654108, "vf_loss": 6.26691147685051, "vf_explained_var": 0.643190324306488, "kl": 0.009441693211556412, "entropy": 0.3772182995453477, "entropy_coeff": 0.0}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 41, "training_iteration": 103, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-47-25", "timestamp": 1618141645, "time_this_iter_s": 27.906542778015137, "time_total_s": 3004.858613014221, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3004.858613014221, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 61.44615384615385, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 711.0, "episode_reward_min": 711.0, "episode_reward_mean": 711.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [711.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6295632907604541, "mean_raw_obs_processing_ms": 0.1010105177795894, "mean_inference_ms": 2.2838752106168134, "mean_action_processing_ms": 0.056631785844757775}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 416000, "timers": {"sample_time_ms": 11512.962, "sample_throughput": 347.434, "learn_time_ms": 16764.377, "learn_throughput": 238.601, "update_time_ms": 3.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 13.728994756937027, "policy_loss": -0.03780987544450909, "vf_loss": 13.761610001325607, "vf_explained_var": 0.6980980038642883, "kl": 0.010260729453875683, "entropy": 0.2387539274059236, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 41, "training_iteration": 104, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-47-54", "timestamp": 1618141674, "time_this_iter_s": 28.83378267288208, "time_total_s": 3033.6923956871033, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3033.6923956871033, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 60.67857142857143, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1435.0, "episode_reward_min": 1435.0, "episode_reward_mean": 1435.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1435.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6327307230716644, "mean_raw_obs_processing_ms": 0.10120221860472912, "mean_inference_ms": 2.283543720769563, "mean_action_processing_ms": 0.05661107106206429}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 420000, "timers": {"sample_time_ms": 11803.821, "sample_throughput": 338.873, "learn_time_ms": 16779.407, "learn_throughput": 238.387, "update_time_ms": 3.642}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 8.383467823266983, "policy_loss": -0.037338201800594106, "vf_loss": 8.41684627532959, "vf_explained_var": 0.29520535469055176, "kl": 0.007821621620678343, "entropy": 0.1517349046189338, "entropy_coeff": 0.0}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 42, "training_iteration": 105, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-48-25", "timestamp": 1618141705, "time_this_iter_s": 30.874103307724, "time_total_s": 3064.5664989948273, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3064.5664989948273, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 60.8840909090909, "ram_util_percent": 27.40000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1435.0, "episode_reward_min": 1435.0, "episode_reward_mean": 1435.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1435.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6327307230716644, "mean_raw_obs_processing_ms": 0.10120221860472912, "mean_inference_ms": 2.283543720769563, "mean_action_processing_ms": 0.05661107106206429}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 424000, "timers": {"sample_time_ms": 11865.81, "sample_throughput": 337.103, "learn_time_ms": 16836.5, "learn_throughput": 237.579, "update_time_ms": 3.997}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.09065791964531, "policy_loss": -0.034135257825255394, "vf_loss": 11.120154038071632, "vf_explained_var": 0.42720547318458557, "kl": 0.009163740134681575, "entropy": 0.18059013923630118, "entropy_coeff": 0.0}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 42, "training_iteration": 106, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-48-54", "timestamp": 1618141734, "time_this_iter_s": 28.78086566925049, "time_total_s": 3093.3473646640778, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafa10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3093.3473646640778, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 61.397560975609764, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1435.0, "episode_reward_min": 1435.0, "episode_reward_mean": 1435.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1435.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6327307230716644, "mean_raw_obs_processing_ms": 0.10120221860472912, "mean_inference_ms": 2.283543720769563, "mean_action_processing_ms": 0.05661107106206429}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 428000, "timers": {"sample_time_ms": 11929.649, "sample_throughput": 335.299, "learn_time_ms": 16872.736, "learn_throughput": 237.069, "update_time_ms": 3.987}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 14.073069661855698, "policy_loss": -0.0424531192984432, "vf_loss": 14.110938340425491, "vf_explained_var": 0.5012677907943726, "kl": 0.00905612461065175, "entropy": 0.20838600490242243, "entropy_coeff": 0.0}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 42, "training_iteration": 107, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-49-23", "timestamp": 1618141763, "time_this_iter_s": 29.06405520439148, "time_total_s": 3122.4114198684692, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3122.4114198684692, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 61.68292682926829, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1418.0, "episode_reward_min": 1418.0, "episode_reward_mean": 1418.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1418.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6239303212731844, "mean_raw_obs_processing_ms": 0.10157036007721802, "mean_inference_ms": 2.2848338141002005, "mean_action_processing_ms": 0.05662875952641578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 432000, "timers": {"sample_time_ms": 11780.025, "sample_throughput": 339.558, "learn_time_ms": 16885.532, "learn_throughput": 236.889, "update_time_ms": 3.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.568344846367836, "policy_loss": -0.039018044306430966, "vf_loss": 10.602314934134483, "vf_explained_var": 0.6850020289421082, "kl": 0.009971037899958901, "entropy": 0.3610031697899103, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 43, "training_iteration": 108, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-49-50", "timestamp": 1618141790, "time_this_iter_s": 27.187309741973877, "time_total_s": 3149.598729610443, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f198d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3149.598729610443, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 61.13076923076922, "ram_util_percent": 27.430769230769222}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1418.0, "episode_reward_min": 1418.0, "episode_reward_mean": 1418.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1418.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6239303212731844, "mean_raw_obs_processing_ms": 0.10157036007721802, "mean_inference_ms": 2.2848338141002005, "mean_action_processing_ms": 0.05662875952641578}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 436000, "timers": {"sample_time_ms": 11534.293, "sample_throughput": 346.792, "learn_time_ms": 16888.14, "learn_throughput": 236.853, "update_time_ms": 3.919}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 7.602681785821915, "policy_loss": -0.03767036003409885, "vf_loss": 7.635797470808029, "vf_explained_var": 0.6860380172729492, "kl": 0.008997010518214665, "entropy": 0.35156177543103695, "entropy_coeff": 0.0}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 43, "training_iteration": 109, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-50-18", "timestamp": 1618141818, "time_this_iter_s": 27.537786722183228, "time_total_s": 3177.1365163326263, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3df4f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3177.1365163326263, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 61.385000000000005, "ram_util_percent": 27.402499999999996}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 729.0, "episode_reward_min": 729.0, "episode_reward_mean": 729.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [729.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6163846236443018, "mean_raw_obs_processing_ms": 0.10183576175833675, "mean_inference_ms": 2.28495705409239, "mean_action_processing_ms": 0.056634019970733196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 440000, "timers": {"sample_time_ms": 11460.286, "sample_throughput": 349.031, "learn_time_ms": 16846.565, "learn_throughput": 237.437, "update_time_ms": 4.157}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.519025176763535, "policy_loss": -0.034489076293539256, "vf_loss": 11.548099279403687, "vf_explained_var": 0.6171938180923462, "kl": 0.010696668847231194, "entropy": 0.3036540234461427, "entropy_coeff": 0.0}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 44, "training_iteration": 110, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-50-45", "timestamp": 1618141845, "time_this_iter_s": 27.375354528427124, "time_total_s": 3204.5118708610535, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaaf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3204.5118708610535, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 61.31538461538462, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 729.0, "episode_reward_min": 729.0, "episode_reward_mean": 729.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [729.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6163846236443018, "mean_raw_obs_processing_ms": 0.10183576175833675, "mean_inference_ms": 2.28495705409239, "mean_action_processing_ms": 0.056634019970733196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 444000, "timers": {"sample_time_ms": 11458.465, "sample_throughput": 349.087, "learn_time_ms": 16858.542, "learn_throughput": 237.268, "update_time_ms": 4.197}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 16.62371662259102, "policy_loss": -0.03679097240092233, "vf_loss": 16.655118614435196, "vf_explained_var": 0.6571261286735535, "kl": 0.010645198432030156, "entropy": 0.24858598690479994, "entropy_coeff": 0.0}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 44, "training_iteration": 111, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-51-13", "timestamp": 1618141873, "time_this_iter_s": 28.04608964920044, "time_total_s": 3232.557960510254, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3232.557960510254, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 61.442499999999995, "ram_util_percent": 27.402499999999996}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 729.0, "episode_reward_min": 729.0, "episode_reward_mean": 729.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [729.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6163846236443018, "mean_raw_obs_processing_ms": 0.10183576175833675, "mean_inference_ms": 2.28495705409239, "mean_action_processing_ms": 0.056634019970733196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 448000, "timers": {"sample_time_ms": 11508.69, "sample_throughput": 347.563, "learn_time_ms": 16902.145, "learn_throughput": 236.656, "update_time_ms": 4.229}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.736529231071472, "policy_loss": -0.03602441673865542, "vf_loss": 11.765548974275589, "vf_explained_var": 0.5757174491882324, "kl": 0.01383648143382743, "entropy": 0.29367180773988366, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 44, "training_iteration": 112, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-51-42", "timestamp": 1618141902, "time_this_iter_s": 28.62272834777832, "time_total_s": 3261.180688858032, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec84d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3261.180688858032, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 61.643902439024394, "ram_util_percent": 27.44634146341464}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 942.0, "episode_reward_min": 942.0, "episode_reward_mean": 942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6055767567954161, "mean_raw_obs_processing_ms": 0.10220387463331213, "mean_inference_ms": 2.2860915863603166, "mean_action_processing_ms": 0.05665523466321358}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 452000, "timers": {"sample_time_ms": 11449.545, "sample_throughput": 349.359, "learn_time_ms": 16930.93, "learn_throughput": 236.254, "update_time_ms": 4.148}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.244868844747543, "policy_loss": -0.03583844337845221, "vf_loss": 6.275915719568729, "vf_explained_var": 0.45753270387649536, "kl": 0.009464840695727617, "entropy": 0.37845060788095, "entropy_coeff": 0.0}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 45, "training_iteration": 113, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-52-09", "timestamp": 1618141929, "time_this_iter_s": 27.60464572906494, "time_total_s": 3288.785334587097, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3df4dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3df4490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3288.785334587097, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 61.538461538461526, "ram_util_percent": 27.402564102564103}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 942.0, "episode_reward_min": 942.0, "episode_reward_mean": 942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6055767567954161, "mean_raw_obs_processing_ms": 0.10220387463331213, "mean_inference_ms": 2.2860915863603166, "mean_action_processing_ms": 0.05665523466321358}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 456000, "timers": {"sample_time_ms": 11383.65, "sample_throughput": 351.381, "learn_time_ms": 16973.779, "learn_throughput": 235.658, "update_time_ms": 4.195}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 15.69019204378128, "policy_loss": -0.037003004748839885, "vf_loss": 15.718047887086868, "vf_explained_var": 0.5277754664421082, "kl": 0.01806853778543882, "entropy": 0.23656011372804642, "entropy_coeff": 0.0}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 45, "training_iteration": 114, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-52-38", "timestamp": 1618141958, "time_this_iter_s": 28.607143878936768, "time_total_s": 3317.392478466034, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3317.392478466034, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 61.33170731707317, "ram_util_percent": 27.400000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1259.0, "episode_reward_min": 1259.0, "episode_reward_mean": 1259.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1259.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6054110738100754, "mean_raw_obs_processing_ms": 0.1024399691745652, "mean_inference_ms": 2.2861180690712715, "mean_action_processing_ms": 0.056660075472965865}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 460000, "timers": {"sample_time_ms": 11312.656, "sample_throughput": 353.586, "learn_time_ms": 16922.889, "learn_throughput": 236.366, "update_time_ms": 4.134}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 10.990984007716179, "policy_loss": -0.03793099336326122, "vf_loss": 11.021375268697739, "vf_explained_var": 0.4436436593532562, "kl": 0.014893801213474944, "entropy": 0.15907669719308615, "entropy_coeff": 0.0}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 46, "training_iteration": 115, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-53-08", "timestamp": 1618141988, "time_this_iter_s": 29.657876014709473, "time_total_s": 3347.0503544807434, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3347.0503544807434, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 60.67380952380953, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1259.0, "episode_reward_min": 1259.0, "episode_reward_mean": 1259.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1259.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6054110738100754, "mean_raw_obs_processing_ms": 0.1024399691745652, "mean_inference_ms": 2.2861180690712715, "mean_action_processing_ms": 0.056660075472965865}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 464000, "timers": {"sample_time_ms": 11472.26, "sample_throughput": 348.667, "learn_time_ms": 16880.696, "learn_throughput": 236.957, "update_time_ms": 3.936}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.603120535612106, "policy_loss": -0.07030974386725575, "vf_loss": 11.648785501718521, "vf_explained_var": 0.6859731078147888, "kl": 0.04868071776581928, "entropy": 0.1733189602382481, "entropy_coeff": 0.0}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 46, "training_iteration": 116, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-53-38", "timestamp": 1618142018, "time_this_iter_s": 29.956235885620117, "time_total_s": 3377.0065903663635, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3377.0065903663635, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 61.65581395348838, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1259.0, "episode_reward_min": 1259.0, "episode_reward_mean": 1259.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1259.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6054110738100754, "mean_raw_obs_processing_ms": 0.1024399691745652, "mean_inference_ms": 2.2861180690712715, "mean_action_processing_ms": 0.056660075472965865}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 468000, "timers": {"sample_time_ms": 11378.963, "sample_throughput": 351.526, "learn_time_ms": 16839.532, "learn_throughput": 237.536, "update_time_ms": 3.944}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 11.716490924358368, "policy_loss": -0.03439230204094201, "vf_loss": 11.74512904882431, "vf_explained_var": 0.5565690398216248, "kl": 0.0075775825753225945, "entropy": 0.21435710927471519, "entropy_coeff": 0.0}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 46, "training_iteration": 117, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-54-05", "timestamp": 1618142045, "time_this_iter_s": 27.719533920288086, "time_total_s": 3404.7261242866516, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edaf50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3404.7261242866516, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 61.4225, "ram_util_percent": 27.4}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1420.0, "episode_reward_min": 1420.0, "episode_reward_mean": 1420.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1420.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6053478222717711, "mean_raw_obs_processing_ms": 0.10278896955707004, "mean_inference_ms": 2.2862518241672336, "mean_action_processing_ms": 0.05666096753320311}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 472000, "timers": {"sample_time_ms": 11610.879, "sample_throughput": 344.504, "learn_time_ms": 16834.937, "learn_throughput": 237.601, "update_time_ms": 4.031}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 11.753184467554092, "policy_loss": -0.028601928730495274, "vf_loss": 11.772781997919083, "vf_explained_var": 0.474852591753006, "kl": 0.011857735982630402, "entropy": 0.15345003292895854, "entropy_coeff": 0.0}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 47, "training_iteration": 118, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-54-35", "timestamp": 1618142075, "time_this_iter_s": 29.460304260253906, "time_total_s": 3434.1864285469055, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3434.1864285469055, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 60.7904761904762, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1420.0, "episode_reward_min": 1420.0, "episode_reward_mean": 1420.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1420.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6053478222717711, "mean_raw_obs_processing_ms": 0.10278896955707004, "mean_inference_ms": 2.2862518241672336, "mean_action_processing_ms": 0.05666096753320311}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 476000, "timers": {"sample_time_ms": 11902.73, "sample_throughput": 336.057, "learn_time_ms": 16841.712, "learn_throughput": 237.506, "update_time_ms": 3.984}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 14.14966395497322, "policy_loss": -0.04392793733859435, "vf_loss": 14.178314477205276, "vf_explained_var": 0.4063025712966919, "kl": 0.020118455184274353, "entropy": 0.17597688548266888, "entropy_coeff": 0.0}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 47, "training_iteration": 119, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-55-05", "timestamp": 1618142105, "time_this_iter_s": 30.526646614074707, "time_total_s": 3464.71307516098, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3df4690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3464.71307516098, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 60.981395348837204, "ram_util_percent": 27.400000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1821.0, "episode_reward_min": 1821.0, "episode_reward_mean": 1821.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1821.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.606927892247793, "mean_raw_obs_processing_ms": 0.10299856861069386, "mean_inference_ms": 2.2864947481681566, "mean_action_processing_ms": 0.05666036225816406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 480000, "timers": {"sample_time_ms": 12010.827, "sample_throughput": 333.033, "learn_time_ms": 16837.175, "learn_throughput": 237.57, "update_time_ms": 3.699}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1390625, "cur_lr": 5e-05, "total_loss": 9.706691518425941, "policy_loss": -0.031768537213793024, "vf_loss": 9.733688458800316, "vf_explained_var": 0.3720495104789734, "kl": 0.004188896076811943, "entropy": 0.14196305791847408, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 48, "training_iteration": 120, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-55-34", "timestamp": 1618142134, "time_this_iter_s": 28.412896156311035, "time_total_s": 3493.1259713172913, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eafb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3493.1259713172913, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 61.22195121951219, "ram_util_percent": 27.45853658536586}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1821.0, "episode_reward_min": 1821.0, "episode_reward_mean": 1821.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1821.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.606927892247793, "mean_raw_obs_processing_ms": 0.10299856861069386, "mean_inference_ms": 2.2864947481681566, "mean_action_processing_ms": 0.05666036225816406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 484000, "timers": {"sample_time_ms": 12251.774, "sample_throughput": 326.483, "learn_time_ms": 16822.875, "learn_throughput": 237.771, "update_time_ms": 3.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.328668385744095, "policy_loss": -0.026442576898261905, "vf_loss": 7.349746122956276, "vf_explained_var": 0.3125585913658142, "kl": 0.009419708178029396, "entropy": 0.13120924937538803, "entropy_coeff": 0.0}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 48, "training_iteration": 121, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-56-04", "timestamp": 1618142164, "time_this_iter_s": 30.31278896331787, "time_total_s": 3523.438760280609, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f192d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eafe90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3523.438760280609, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 61.939534883720945, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1821.0, "episode_reward_min": 1821.0, "episode_reward_mean": 1821.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1821.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.606927892247793, "mean_raw_obs_processing_ms": 0.10299856861069386, "mean_inference_ms": 2.2864947481681566, "mean_action_processing_ms": 0.05666036225816406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 488000, "timers": {"sample_time_ms": 12439.978, "sample_throughput": 321.544, "learn_time_ms": 16758.157, "learn_throughput": 238.69, "update_time_ms": 3.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.134047642350197, "policy_loss": -0.02931773741147481, "vf_loss": 8.158582657575607, "vf_explained_var": 0.4345342218875885, "kl": 0.008397650395636447, "entropy": 0.140561566920951, "entropy_coeff": 0.0}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 48, "training_iteration": 122, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-56-34", "timestamp": 1618142194, "time_this_iter_s": 29.852831840515137, "time_total_s": 3553.2915921211243, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3553.2915921211243, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 61.06279069767444, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1926.0, "episode_reward_min": 1926.0, "episode_reward_mean": 1926.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1926.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6138306930818542, "mean_raw_obs_processing_ms": 0.10334947512444592, "mean_inference_ms": 2.2871106975264923, "mean_action_processing_ms": 0.056663242945406235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 492000, "timers": {"sample_time_ms": 12809.23, "sample_throughput": 312.275, "learn_time_ms": 16703.34, "learn_throughput": 239.473, "update_time_ms": 3.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.968400791287422, "policy_loss": -0.02245974657125771, "vf_loss": 8.986143231391907, "vf_explained_var": 0.3269425630569458, "kl": 0.008282628219603794, "entropy": 0.12583249679300934, "entropy_coeff": 0.0}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 49, "training_iteration": 123, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-57-05", "timestamp": 1618142225, "time_this_iter_s": 30.74617075920105, "time_total_s": 3584.0377628803253, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3584.0377628803253, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1926.0, "episode_reward_min": 1926.0, "episode_reward_mean": 1926.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1926.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6138306930818542, "mean_raw_obs_processing_ms": 0.10334947512444592, "mean_inference_ms": 2.2871106975264923, "mean_action_processing_ms": 0.056663242945406235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 496000, "timers": {"sample_time_ms": 12853.138, "sample_throughput": 311.208, "learn_time_ms": 16691.643, "learn_throughput": 239.641, "update_time_ms": 3.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.137205392122269, "policy_loss": -0.03073200531071052, "vf_loss": 8.163003757596016, "vf_explained_var": 0.3339357078075409, "kl": 0.00866282383503858, "entropy": 0.13822017423808575, "entropy_coeff": 0.0}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 49, "training_iteration": 124, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-57-34", "timestamp": 1618142254, "time_this_iter_s": 28.929380893707275, "time_total_s": 3612.9671437740326, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3612.9671437740326, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 61.63902439024391, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1761.0, "episode_reward_min": 1761.0, "episode_reward_mean": 1761.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1761.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6112048728089129, "mean_raw_obs_processing_ms": 0.10360351679580455, "mean_inference_ms": 2.287387244225756, "mean_action_processing_ms": 0.05666625515198677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 500000, "timers": {"sample_time_ms": 12707.292, "sample_throughput": 314.78, "learn_time_ms": 16709.397, "learn_throughput": 239.386, "update_time_ms": 3.801}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 12.873183757066727, "policy_loss": -0.035706843016669154, "vf_loss": 12.90373083949089, "vf_explained_var": 0.5434998869895935, "kl": 0.009059708565473557, "entropy": 0.19982952438294888, "entropy_coeff": 0.0}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 50, "training_iteration": 125, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-58-02", "timestamp": 1618142282, "time_this_iter_s": 28.374544143676758, "time_total_s": 3641.3416879177094, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3641.3416879177094, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 61.71707317073171, "ram_util_percent": 27.431707317073172}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1761.0, "episode_reward_min": 1761.0, "episode_reward_mean": 1761.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1761.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6112048728089129, "mean_raw_obs_processing_ms": 0.10360351679580455, "mean_inference_ms": 2.287387244225756, "mean_action_processing_ms": 0.05666625515198677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 504000, "timers": {"sample_time_ms": 12807.203, "sample_throughput": 312.324, "learn_time_ms": 16715.876, "learn_throughput": 239.293, "update_time_ms": 3.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.864183619618416, "policy_loss": -0.0448853543784935, "vf_loss": 7.898087725043297, "vf_explained_var": 0.3618117570877075, "kl": 0.01928117571515031, "entropy": 0.1348793946672231, "entropy_coeff": 0.0}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 50, "training_iteration": 126, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-58-33", "timestamp": 1618142313, "time_this_iter_s": 31.01182270050049, "time_total_s": 3672.35351061821, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3672.35351061821, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 61.12272727272728, "ram_util_percent": 27.402272727272734}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1761.0, "episode_reward_min": 1761.0, "episode_reward_mean": 1761.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1761.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6112048728089129, "mean_raw_obs_processing_ms": 0.10360351679580455, "mean_inference_ms": 2.287387244225756, "mean_action_processing_ms": 0.05666625515198677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 508000, "timers": {"sample_time_ms": 12970.071, "sample_throughput": 308.402, "learn_time_ms": 16703.543, "learn_throughput": 239.47, "update_time_ms": 3.738}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.811648324131966, "policy_loss": -0.027590065088588744, "vf_loss": 6.834409311413765, "vf_explained_var": 0.31643298268318176, "kl": 0.008478853254928254, "entropy": 0.13561952323652804, "entropy_coeff": 0.0}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 50, "training_iteration": 127, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-59-03", "timestamp": 1618142343, "time_this_iter_s": 29.23021674156189, "time_total_s": 3701.5837273597717, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1ad50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3701.5837273597717, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 61.25714285714285, "ram_util_percent": 27.404761904761905}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1911.0, "episode_reward_min": 1911.0, "episode_reward_mean": 1911.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1911.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6121230225870189, "mean_raw_obs_processing_ms": 0.10396979885131903, "mean_inference_ms": 2.288634017935574, "mean_action_processing_ms": 0.05667827151440972}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 512000, "timers": {"sample_time_ms": 12827.712, "sample_throughput": 311.825, "learn_time_ms": 16681.788, "learn_throughput": 239.782, "update_time_ms": 3.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 15.021551847457886, "policy_loss": -0.0979801524663344, "vf_loss": 15.066375076770782, "vf_explained_var": 0.5636811852455139, "kl": 0.09333464480005205, "entropy": 0.28602350829169154, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 51, "training_iteration": 128, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_11-59-31", "timestamp": 1618142371, "time_this_iter_s": 27.81944465637207, "time_total_s": 3729.403172016144, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3729.403172016144, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 61.433333333333344, "ram_util_percent": 27.46410256410256}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1911.0, "episode_reward_min": 1911.0, "episode_reward_mean": 1911.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1911.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6121230225870189, "mean_raw_obs_processing_ms": 0.10396979885131903, "mean_inference_ms": 2.288634017935574, "mean_action_processing_ms": 0.05667827151440972}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 516000, "timers": {"sample_time_ms": 12778.421, "sample_throughput": 313.028, "learn_time_ms": 16706.28, "learn_throughput": 239.431, "update_time_ms": 3.739}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.498618558049202, "policy_loss": -0.01963202381739393, "vf_loss": 8.513214960694313, "vf_explained_var": 0.3276726007461548, "kl": 0.005894756723137107, "entropy": 0.13077074894681573, "entropy_coeff": 0.0}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 51, "training_iteration": 129, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-00-01", "timestamp": 1618142401, "time_this_iter_s": 30.277060985565186, "time_total_s": 3759.680233001709, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3759.680233001709, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 60.769767441860466, "ram_util_percent": 27.47209302325582}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1642.0, "episode_reward_min": 1642.0, "episode_reward_mean": 1642.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1642.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164035887057792, "mean_raw_obs_processing_ms": 0.10420980770422253, "mean_inference_ms": 2.288580665220188, "mean_action_processing_ms": 0.05667614995653699}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 520000, "timers": {"sample_time_ms": 12971.22, "sample_throughput": 308.375, "learn_time_ms": 16723.82, "learn_throughput": 239.18, "update_time_ms": 3.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.130986392498016, "policy_loss": -0.0283356636937242, "vf_loss": 12.154448598623276, "vf_explained_var": 0.5647467374801636, "kl": 0.005704896197130438, "entropy": 0.1499697135295719, "entropy_coeff": 0.0}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 52, "training_iteration": 130, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-00-31", "timestamp": 1618142431, "time_this_iter_s": 30.52826976776123, "time_total_s": 3790.20850276947, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6ab90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3790.20850276947, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 60.89545454545455, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1642.0, "episode_reward_min": 1642.0, "episode_reward_mean": 1642.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1642.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164035887057792, "mean_raw_obs_processing_ms": 0.10420980770422253, "mean_inference_ms": 2.288580665220188, "mean_action_processing_ms": 0.05667614995653699}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 524000, "timers": {"sample_time_ms": 12846.061, "sample_throughput": 311.379, "learn_time_ms": 16744.043, "learn_throughput": 238.891, "update_time_ms": 4.122}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.84675569832325, "policy_loss": -0.02934638987062499, "vf_loss": 8.870750024914742, "vf_explained_var": 0.23131629824638367, "kl": 0.006264810494030826, "entropy": 0.12330862204544246, "entropy_coeff": 0.0}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 52, "training_iteration": 131, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-01-01", "timestamp": 1618142461, "time_this_iter_s": 29.262396574020386, "time_total_s": 3819.4708993434906, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3819.4708993434906, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 62.185714285714276, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1642.0, "episode_reward_min": 1642.0, "episode_reward_mean": 1642.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1642.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164035887057792, "mean_raw_obs_processing_ms": 0.10420980770422253, "mean_inference_ms": 2.288580665220188, "mean_action_processing_ms": 0.05667614995653699}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 528000, "timers": {"sample_time_ms": 12713.462, "sample_throughput": 314.627, "learn_time_ms": 16807.636, "learn_throughput": 237.987, "update_time_ms": 4.067}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.150237441062927, "policy_loss": -0.028355579532217234, "vf_loss": 10.172588884830475, "vf_explained_var": 0.3574953079223633, "kl": 0.007028272186289541, "entropy": 0.11624531983397901, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 52, "training_iteration": 132, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-01-30", "timestamp": 1618142490, "time_this_iter_s": 29.166927099227905, "time_total_s": 3848.6378264427185, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3848.6378264427185, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 61.23095238095239, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1963.0, "episode_reward_min": 1963.0, "episode_reward_mean": 1963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6119890236011979, "mean_raw_obs_processing_ms": 0.10455496842909473, "mean_inference_ms": 2.288998418842391, "mean_action_processing_ms": 0.05668888917971615}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 532000, "timers": {"sample_time_ms": 12405.948, "sample_throughput": 322.426, "learn_time_ms": 16856.384, "learn_throughput": 237.299, "update_time_ms": 4.098}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 11.066989868879318, "policy_loss": -0.03756612498546019, "vf_loss": 11.09794296324253, "vf_explained_var": 0.5743567943572998, "kl": 0.0077407221688190475, "entropy": 0.18955719843506813, "entropy_coeff": 0.0}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 53, "training_iteration": 133, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-01-58", "timestamp": 1618142518, "time_this_iter_s": 28.165159702301025, "time_total_s": 3876.8029861450195, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efcc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3876.8029861450195, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 61.80499999999999, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1963.0, "episode_reward_min": 1963.0, "episode_reward_mean": 1963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6119890236011979, "mean_raw_obs_processing_ms": 0.10455496842909473, "mean_inference_ms": 2.288998418842391, "mean_action_processing_ms": 0.05668888917971615}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 536000, "timers": {"sample_time_ms": 12313.397, "sample_throughput": 324.849, "learn_time_ms": 16845.875, "learn_throughput": 237.447, "update_time_ms": 3.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.772558510303497, "policy_loss": -0.036282774177379906, "vf_loss": 10.799426108598709, "vf_explained_var": 0.418804407119751, "kl": 0.011020890371582936, "entropy": 0.135737240081653, "entropy_coeff": 0.0}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 53, "training_iteration": 134, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-02-26", "timestamp": 1618142546, "time_this_iter_s": 27.894360780715942, "time_total_s": 3904.6973469257355, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b47332d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3904.6973469257355, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 61.585, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1653.0, "episode_reward_min": 1653.0, "episode_reward_mean": 1653.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1653.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6064740482363319, "mean_raw_obs_processing_ms": 0.10481170123941909, "mean_inference_ms": 2.2896311056133087, "mean_action_processing_ms": 0.05669769410408639}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 540000, "timers": {"sample_time_ms": 12262.636, "sample_throughput": 326.194, "learn_time_ms": 16820.601, "learn_throughput": 237.804, "update_time_ms": 3.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 6.69528391957283, "policy_loss": -0.041361761395819485, "vf_loss": 6.725036695599556, "vf_explained_var": 0.4499630033969879, "kl": 0.013588928763056174, "entropy": 0.14436464803293347, "entropy_coeff": 0.0}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 54, "training_iteration": 135, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-02-54", "timestamp": 1618142574, "time_this_iter_s": 27.613563776016235, "time_total_s": 3932.3109107017517, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec83d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3932.3109107017517, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 61.133333333333326, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1653.0, "episode_reward_min": 1653.0, "episode_reward_mean": 1653.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1653.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6064740482363319, "mean_raw_obs_processing_ms": 0.10481170123941909, "mean_inference_ms": 2.2896311056133087, "mean_action_processing_ms": 0.05669769410408639}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 544000, "timers": {"sample_time_ms": 11886.642, "sample_throughput": 336.512, "learn_time_ms": 16890.549, "learn_throughput": 236.819, "update_time_ms": 4.061}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.326925367116928, "policy_loss": -0.03320613456889987, "vf_loss": 7.354706600308418, "vf_explained_var": 0.3111296594142914, "kl": 0.0063501964541501366, "entropy": 0.14007778209634125, "entropy_coeff": 0.0}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 54, "training_iteration": 136, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-03-22", "timestamp": 1618142602, "time_this_iter_s": 27.956199169158936, "time_total_s": 3960.2671098709106, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3960.2671098709106, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 61.05999999999999, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1653.0, "episode_reward_min": 1653.0, "episode_reward_mean": 1653.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1653.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6064740482363319, "mean_raw_obs_processing_ms": 0.10481170123941909, "mean_inference_ms": 2.2896311056133087, "mean_action_processing_ms": 0.05669769410408639}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 548000, "timers": {"sample_time_ms": 11859.732, "sample_throughput": 337.276, "learn_time_ms": 16934.939, "learn_throughput": 236.198, "update_time_ms": 4.04}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.52606338262558, "policy_loss": -0.022807165689300746, "vf_loss": 7.543146193027496, "vf_explained_var": 0.4306144714355469, "kl": 0.006700502097373828, "entropy": 0.13622502190992236, "entropy_coeff": 0.0}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 54, "training_iteration": 137, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-03-51", "timestamp": 1618142631, "time_this_iter_s": 29.405517578125, "time_total_s": 3989.6726274490356, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4f97e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3989.6726274490356, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 61.919047619047625, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1758.0, "episode_reward_min": 1758.0, "episode_reward_mean": 1758.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1758.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6046173080375257, "mean_raw_obs_processing_ms": 0.10511902929165871, "mean_inference_ms": 2.2893599283559145, "mean_action_processing_ms": 0.05669193519059707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 552000, "timers": {"sample_time_ms": 12029.18, "sample_throughput": 332.525, "learn_time_ms": 17061.591, "learn_throughput": 234.445, "update_time_ms": 4.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.432172313332558, "policy_loss": -0.02462898872909136, "vf_loss": 7.452084198594093, "vf_explained_var": 0.3263466954231262, "kl": 0.005521605420653941, "entropy": 0.12051289691589773, "entropy_coeff": 0.0}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 55, "training_iteration": 138, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-04-22", "timestamp": 1618142662, "time_this_iter_s": 30.784707069396973, "time_total_s": 4020.4573345184326, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb04d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4020.4573345184326, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 60.777272727272724, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1758.0, "episode_reward_min": 1758.0, "episode_reward_mean": 1758.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1758.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6046173080375257, "mean_raw_obs_processing_ms": 0.10511902929165871, "mean_inference_ms": 2.2893599283559145, "mean_action_processing_ms": 0.05669193519059707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 556000, "timers": {"sample_time_ms": 11969.757, "sample_throughput": 334.176, "learn_time_ms": 17047.414, "learn_throughput": 234.64, "update_time_ms": 3.967}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.797551438212395, "policy_loss": -0.024264394654892385, "vf_loss": 7.8166690319776535, "vf_explained_var": 0.29699310660362244, "kl": 0.006024492591677699, "entropy": 0.11769328452646732, "entropy_coeff": 0.0}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 55, "training_iteration": 139, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-04-52", "timestamp": 1618142692, "time_this_iter_s": 29.541292905807495, "time_total_s": 4049.99862742424, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edab50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4049.99862742424, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 61.5095238095238, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2093.0, "episode_reward_min": 2093.0, "episode_reward_mean": 2093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6086724115452041, "mean_raw_obs_processing_ms": 0.10536293262917239, "mean_inference_ms": 2.2899366614262977, "mean_action_processing_ms": 0.05670980050813168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 560000, "timers": {"sample_time_ms": 12065.447, "sample_throughput": 331.525, "learn_time_ms": 17029.263, "learn_throughput": 234.89, "update_time_ms": 3.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 5.310188002884388, "policy_loss": -0.029082903842208907, "vf_loss": 5.332270860671997, "vf_explained_var": 0.20529557764530182, "kl": 0.008193922461941838, "entropy": 0.1162067879922688, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 56, "training_iteration": 140, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-05-23", "timestamp": 1618142723, "time_this_iter_s": 31.291192770004272, "time_total_s": 4081.2898201942444, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4081.2898201942444, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 61.855555555555554, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2093.0, "episode_reward_min": 2093.0, "episode_reward_mean": 2093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6086724115452041, "mean_raw_obs_processing_ms": 0.10536293262917239, "mean_inference_ms": 2.2899366614262977, "mean_action_processing_ms": 0.05670980050813168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 564000, "timers": {"sample_time_ms": 11963.688, "sample_throughput": 334.345, "learn_time_ms": 17010.667, "learn_throughput": 235.147, "update_time_ms": 3.723}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.600032135844231, "policy_loss": -0.02815443283179775, "vf_loss": 7.620182573795319, "vf_explained_var": 0.39854079484939575, "kl": 0.009369011313538067, "entropy": 0.1387350286822766, "entropy_coeff": 0.0}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 56, "training_iteration": 141, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-05-51", "timestamp": 1618142751, "time_this_iter_s": 28.055639266967773, "time_total_s": 4109.345459461212, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4109.345459461212, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 61.5425, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2093.0, "episode_reward_min": 2093.0, "episode_reward_mean": 2093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6086724115452041, "mean_raw_obs_processing_ms": 0.10536293262917239, "mean_inference_ms": 2.2899366614262977, "mean_action_processing_ms": 0.05670980050813168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 568000, "timers": {"sample_time_ms": 12010.052, "sample_throughput": 333.054, "learn_time_ms": 16997.487, "learn_throughput": 235.329, "update_time_ms": 3.719}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.789080649614334, "policy_loss": -0.023138324380852282, "vf_loss": 9.80769994854927, "vf_explained_var": 0.493572473526001, "kl": 0.005289961271046195, "entropy": 0.12392771476879716, "entropy_coeff": 0.0}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 56, "training_iteration": 142, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-06-21", "timestamp": 1618142781, "time_this_iter_s": 29.499688625335693, "time_total_s": 4138.845148086548, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4fd2b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4138.845148086548, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 61.42619047619048, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1839.0, "episode_reward_min": 1839.0, "episode_reward_mean": 1839.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1839.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6041902849066805, "mean_raw_obs_processing_ms": 0.10569614575385759, "mean_inference_ms": 2.290006936436244, "mean_action_processing_ms": 0.056721307219989754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 572000, "timers": {"sample_time_ms": 12020.613, "sample_throughput": 332.762, "learn_time_ms": 17043.526, "learn_throughput": 234.693, "update_time_ms": 3.731}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.968960553407669, "policy_loss": -0.03382990730460733, "vf_loss": 8.997864335775375, "vf_explained_var": 0.4087713360786438, "kl": 0.005766434915130958, "entropy": 0.14298262703232467, "entropy_coeff": 0.0}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 57, "training_iteration": 143, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-06-49", "timestamp": 1618142809, "time_this_iter_s": 28.72980523109436, "time_total_s": 4167.574953317642, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4167.574953317642, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 62.29512195121952, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1839.0, "episode_reward_min": 1839.0, "episode_reward_mean": 1839.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1839.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6041902849066805, "mean_raw_obs_processing_ms": 0.10569614575385759, "mean_inference_ms": 2.290006936436244, "mean_action_processing_ms": 0.056721307219989754}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 576000, "timers": {"sample_time_ms": 12472.494, "sample_throughput": 320.706, "learn_time_ms": 17044.129, "learn_throughput": 234.685, "update_time_ms": 3.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 5.2013057470321655, "policy_loss": -0.029351326811593026, "vf_loss": 5.223719097673893, "vf_explained_var": 0.2285158485174179, "kl": 0.00812123813375365, "entropy": 0.12391708535142243, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 57, "training_iteration": 144, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-07-22", "timestamp": 1618142842, "time_this_iter_s": 32.42273783683777, "time_total_s": 4199.99769115448, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4199.99769115448, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 61.832608695652176, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2045.0, "episode_reward_min": 2045.0, "episode_reward_mean": 2045.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2045.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6111771515884188, "mean_raw_obs_processing_ms": 0.10593252621304643, "mean_inference_ms": 2.2910190671762773, "mean_action_processing_ms": 0.056729680118263084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 580000, "timers": {"sample_time_ms": 12743.287, "sample_throughput": 313.891, "learn_time_ms": 17051.182, "learn_throughput": 234.588, "update_time_ms": 3.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 6.301514700055122, "policy_loss": -0.024310857814271003, "vf_loss": 6.320651978254318, "vf_explained_var": 0.2966770827770233, "kl": 0.006055955986084882, "entropy": 0.11919889762066305, "entropy_coeff": 0.0}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 58, "training_iteration": 145, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-07-52", "timestamp": 1618142872, "time_this_iter_s": 30.396615982055664, "time_total_s": 4230.394307136536, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4230.394307136536, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 61.04545454545453, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2045.0, "episode_reward_min": 2045.0, "episode_reward_mean": 2045.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2045.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6111771515884188, "mean_raw_obs_processing_ms": 0.10593252621304643, "mean_inference_ms": 2.2910190671762773, "mean_action_processing_ms": 0.056729680118263084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 584000, "timers": {"sample_time_ms": 12977.399, "sample_throughput": 308.228, "learn_time_ms": 16997.56, "learn_throughput": 235.328, "update_time_ms": 3.511}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 9.597375303506851, "policy_loss": -0.03097053151577711, "vf_loss": 9.622834220528603, "vf_explained_var": 0.5052187442779541, "kl": 0.006451623383327387, "entropy": 0.1488318017218262, "entropy_coeff": 0.0}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 58, "training_iteration": 146, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-08-22", "timestamp": 1618142902, "time_this_iter_s": 29.759918451309204, "time_total_s": 4260.154225587845, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4260.154225587845, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 61.36190476190477, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2045.0, "episode_reward_min": 2045.0, "episode_reward_mean": 2045.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2045.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6111771515884188, "mean_raw_obs_processing_ms": 0.10593252621304643, "mean_inference_ms": 2.2910190671762773, "mean_action_processing_ms": 0.056729680118263084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 588000, "timers": {"sample_time_ms": 13325.554, "sample_throughput": 300.175, "learn_time_ms": 16968.881, "learn_throughput": 235.726, "update_time_ms": 3.501}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 5.40280644595623, "policy_loss": -0.032962240919005126, "vf_loss": 5.431709676980972, "vf_explained_var": 0.30677127838134766, "kl": 0.004751188324007671, "entropy": 0.11204248992726207, "entropy_coeff": 0.0}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 58, "training_iteration": 147, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-08-55", "timestamp": 1618142935, "time_this_iter_s": 32.595837354660034, "time_total_s": 4292.750062942505, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eb0b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4292.750062942505, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 61.33404255319149, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2044.0, "episode_reward_min": 2044.0, "episode_reward_mean": 2044.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2044.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184745829369502, "mean_raw_obs_processing_ms": 0.10627783482076844, "mean_inference_ms": 2.290880303266717, "mean_action_processing_ms": 0.056723408636523365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 592000, "timers": {"sample_time_ms": 13296.998, "sample_throughput": 300.82, "learn_time_ms": 16850.953, "learn_throughput": 237.375, "update_time_ms": 3.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 11.421650290489197, "policy_loss": -0.027081514184828848, "vf_loss": 11.44308277964592, "vf_explained_var": 0.40420448780059814, "kl": 0.01322508297744207, "entropy": 0.15729545522481203, "entropy_coeff": 0.0}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 59, "training_iteration": 148, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-09-24", "timestamp": 1618142964, "time_this_iter_s": 29.316200494766235, "time_total_s": 4322.066263437271, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1aa10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4322.066263437271, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 61.04761904761905, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2044.0, "episode_reward_min": 2044.0, "episode_reward_mean": 2044.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2044.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184745829369502, "mean_raw_obs_processing_ms": 0.10627783482076844, "mean_inference_ms": 2.290880303266717, "mean_action_processing_ms": 0.056723408636523365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 596000, "timers": {"sample_time_ms": 13155.342, "sample_throughput": 304.059, "learn_time_ms": 16801.853, "learn_throughput": 238.069, "update_time_ms": 3.563}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 10.458846509456635, "policy_loss": -0.03398868450312875, "vf_loss": 10.487403735518456, "vf_explained_var": 0.2856084406375885, "kl": 0.012715549339191057, "entropy": 0.12092471471987665, "entropy_coeff": 0.0}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 59, "training_iteration": 149, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-09-52", "timestamp": 1618142992, "time_this_iter_s": 27.630530834197998, "time_total_s": 4349.696794271469, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e349d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4349.696794271469, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 61.833333333333336, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2094.0, "episode_reward_min": 2094.0, "episode_reward_mean": 2094.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2094.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6215423572311422, "mean_raw_obs_processing_ms": 0.10650861393232924, "mean_inference_ms": 2.290832900424958, "mean_action_processing_ms": 0.05672799748799532}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 600000, "timers": {"sample_time_ms": 13231.537, "sample_throughput": 302.308, "learn_time_ms": 16837.525, "learn_throughput": 237.565, "update_time_ms": 3.546}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 5.620259806513786, "policy_loss": -0.026382438314612955, "vf_loss": 5.643478594720364, "vf_explained_var": 0.21852678060531616, "kl": 0.007406470591377001, "entropy": 0.10836392524652183, "entropy_coeff": 0.0}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 60, "training_iteration": 150, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-10-24", "timestamp": 1618143024, "time_this_iter_s": 32.4123637676239, "time_total_s": 4382.109158039093, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4382.109158039093, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 62.1086956521739, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2094.0, "episode_reward_min": 2094.0, "episode_reward_mean": 2094.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2094.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6215423572311422, "mean_raw_obs_processing_ms": 0.10650861393232924, "mean_inference_ms": 2.290832900424958, "mean_action_processing_ms": 0.05672799748799532}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 604000, "timers": {"sample_time_ms": 13336.991, "sample_throughput": 299.918, "learn_time_ms": 16805.909, "learn_throughput": 238.012, "update_time_ms": 3.461}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 8.665906503796577, "policy_loss": -0.025632318458519876, "vf_loss": 8.686397090554237, "vf_explained_var": 0.45601874589920044, "kl": 0.01203731499845162, "entropy": 0.14150185696780682, "entropy_coeff": 0.0}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 60, "training_iteration": 151, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-10-53", "timestamp": 1618143053, "time_this_iter_s": 28.79776954650879, "time_total_s": 4410.906927585602, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b47337d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4410.906927585602, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 61.06904761904762, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2094.0, "episode_reward_min": 2094.0, "episode_reward_mean": 2094.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2094.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6215423572311422, "mean_raw_obs_processing_ms": 0.10650861393232924, "mean_inference_ms": 2.290832900424958, "mean_action_processing_ms": 0.05672799748799532}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 608000, "timers": {"sample_time_ms": 13283.567, "sample_throughput": 301.124, "learn_time_ms": 16738.787, "learn_throughput": 238.966, "update_time_ms": 3.506}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 11.270670056343079, "policy_loss": -0.035633397550554946, "vf_loss": 11.302463442087173, "vf_explained_var": 0.5406287908554077, "kl": 0.008990001297206618, "entropy": 0.1594317692797631, "entropy_coeff": 0.0}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 60, "training_iteration": 152, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-11-21", "timestamp": 1618143081, "time_this_iter_s": 28.294560432434082, "time_total_s": 4439.201488018036, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4439.201488018036, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 61.3125, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1867.0, "episode_reward_min": 1867.0, "episode_reward_mean": 1867.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1867.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6214834939846398, "mean_raw_obs_processing_ms": 0.10684529506238906, "mean_inference_ms": 2.290285648413633, "mean_action_processing_ms": 0.05672581993468701}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 612000, "timers": {"sample_time_ms": 13464.418, "sample_throughput": 297.079, "learn_time_ms": 16660.394, "learn_throughput": 240.09, "update_time_ms": 3.563}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 8.836919903755188, "policy_loss": -0.030863103573210537, "vf_loss": 8.862478792667389, "vf_explained_var": 0.3654724359512329, "kl": 0.012418305122992024, "entropy": 0.12933571357280016, "entropy_coeff": 0.0}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 61, "training_iteration": 153, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-11-51", "timestamp": 1618143111, "time_this_iter_s": 29.7501540184021, "time_total_s": 4468.951642036438, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4468.951642036438, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 61.2860465116279, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1867.0, "episode_reward_min": 1867.0, "episode_reward_mean": 1867.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1867.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6214834939846398, "mean_raw_obs_processing_ms": 0.10684529506238906, "mean_inference_ms": 2.290285648413633, "mean_action_processing_ms": 0.05672581993468701}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 616000, "timers": {"sample_time_ms": 12999.905, "sample_throughput": 307.695, "learn_time_ms": 16625.956, "learn_throughput": 240.588, "update_time_ms": 3.531}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 14.02152693271637, "policy_loss": -0.0407729183207266, "vf_loss": 14.055611938238144, "vf_explained_var": 0.5162209272384644, "kl": 0.01565631317498628, "entropy": 0.18917613895609975, "entropy_coeff": 0.0}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 61, "training_iteration": 154, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-12-19", "timestamp": 1618143139, "time_this_iter_s": 27.430132389068604, "time_total_s": 4496.381774425507, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4496.381774425507, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 61.82307692307692, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1805.0, "episode_reward_min": 1805.0, "episode_reward_mean": 1805.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1805.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6187010526579042, "mean_raw_obs_processing_ms": 0.10706804564847787, "mean_inference_ms": 2.290706334991323, "mean_action_processing_ms": 0.05672718712165746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 620000, "timers": {"sample_time_ms": 12869.138, "sample_throughput": 310.821, "learn_time_ms": 16655.857, "learn_throughput": 240.156, "update_time_ms": 3.493}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 14.664201259613037, "policy_loss": -0.03937645739642903, "vf_loss": 14.69938451051712, "vf_explained_var": 0.519044041633606, "kl": 0.009816145233344287, "entropy": 0.1575857971329242, "entropy_coeff": 0.0}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 62, "training_iteration": 155, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-12-48", "timestamp": 1618143168, "time_this_iter_s": 29.385812759399414, "time_total_s": 4525.767587184906, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1ac90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4525.767587184906, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 61.538095238095245, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1805.0, "episode_reward_min": 1805.0, "episode_reward_mean": 1805.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1805.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6187010526579042, "mean_raw_obs_processing_ms": 0.10706804564847787, "mean_inference_ms": 2.290706334991323, "mean_action_processing_ms": 0.05672718712165746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 624000, "timers": {"sample_time_ms": 12760.903, "sample_throughput": 313.457, "learn_time_ms": 16625.703, "learn_throughput": 240.591, "update_time_ms": 3.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 14.516938656568527, "policy_loss": -0.03607936837943271, "vf_loss": 14.549173802137375, "vf_explained_var": 0.6769231557846069, "kl": 0.008999472629511729, "entropy": 0.17007661703974009, "entropy_coeff": 0.0}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 62, "training_iteration": 156, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-13-16", "timestamp": 1618143196, "time_this_iter_s": 28.374907732009888, "time_total_s": 4554.142494916916, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4554.142494916916, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 61.49750000000002, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1805.0, "episode_reward_min": 1805.0, "episode_reward_mean": 1805.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1805.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6187010526579042, "mean_raw_obs_processing_ms": 0.10706804564847787, "mean_inference_ms": 2.290706334991323, "mean_action_processing_ms": 0.05672718712165746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 628000, "timers": {"sample_time_ms": 12316.321, "sample_throughput": 324.772, "learn_time_ms": 16650.99, "learn_throughput": 240.226, "update_time_ms": 3.507}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 16.100477904081345, "policy_loss": -0.033287320664385334, "vf_loss": 16.13059189915657, "vf_explained_var": 0.41574645042419434, "kl": 0.007428736469591968, "entropy": 0.13859730563126504, "entropy_coeff": 0.0}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 62, "training_iteration": 157, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-13-45", "timestamp": 1618143225, "time_this_iter_s": 28.407023191452026, "time_total_s": 4582.549518108368, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4582.549518108368, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 61.736585365853664, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1772.0, "episode_reward_min": 1772.0, "episode_reward_mean": 1772.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1772.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6137747668925871, "mean_raw_obs_processing_ms": 0.10743943021507509, "mean_inference_ms": 2.291118071937224, "mean_action_processing_ms": 0.05673705174483715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 632000, "timers": {"sample_time_ms": 12174.427, "sample_throughput": 328.558, "learn_time_ms": 16635.958, "learn_throughput": 240.443, "update_time_ms": 3.457}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 13.470135688781738, "policy_loss": -0.02745149878319353, "vf_loss": 13.493477553129196, "vf_explained_var": 0.34093397855758667, "kl": 0.009621274613891728, "entropy": 0.16212537977844477, "entropy_coeff": 0.0}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 63, "training_iteration": 158, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-14-13", "timestamp": 1618143253, "time_this_iter_s": 27.74935269355774, "time_total_s": 4610.298870801926, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4610.298870801926, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 61.72307692307692, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1772.0, "episode_reward_min": 1772.0, "episode_reward_mean": 1772.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1772.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6137747668925871, "mean_raw_obs_processing_ms": 0.10743943021507509, "mean_inference_ms": 2.291118071937224, "mean_action_processing_ms": 0.05673705174483715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 636000, "timers": {"sample_time_ms": 12092.829, "sample_throughput": 330.775, "learn_time_ms": 16667.74, "learn_throughput": 239.985, "update_time_ms": 3.451}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 9.491720512509346, "policy_loss": -0.043117122375406325, "vf_loss": 9.530687928199768, "vf_explained_var": 0.4638059437274933, "kl": 0.009714881394756958, "entropy": 0.2271545184776187, "entropy_coeff": 0.0}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 63, "training_iteration": 159, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-14-40", "timestamp": 1618143280, "time_this_iter_s": 27.1312518119812, "time_total_s": 4637.430122613907, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db87d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4637.430122613907, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 61.98205128205129, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1483.0, "episode_reward_min": 1483.0, "episode_reward_mean": 1483.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1483.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6128850487521993, "mean_raw_obs_processing_ms": 0.10765104274407059, "mean_inference_ms": 2.2908918374416243, "mean_action_processing_ms": 0.05673653931532286}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 640000, "timers": {"sample_time_ms": 11918.592, "sample_throughput": 335.61, "learn_time_ms": 16668.744, "learn_throughput": 239.97, "update_time_ms": 3.434}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 9.562442064285278, "policy_loss": -0.02067702796193771, "vf_loss": 9.57982712984085, "vf_explained_var": 0.1980915665626526, "kl": 0.007706972741289064, "entropy": 0.11872580437920988, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 64, "training_iteration": 160, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-15-10", "timestamp": 1618143310, "time_this_iter_s": 30.673314571380615, "time_total_s": 4668.1034371852875, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4668.1034371852875, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 61.3840909090909, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1483.0, "episode_reward_min": 1483.0, "episode_reward_mean": 1483.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1483.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6128850487521993, "mean_raw_obs_processing_ms": 0.10765104274407059, "mean_inference_ms": 2.2908918374416243, "mean_action_processing_ms": 0.05673653931532286}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 644000, "timers": {"sample_time_ms": 12095.469, "sample_throughput": 330.702, "learn_time_ms": 16741.264, "learn_throughput": 238.931, "update_time_ms": 3.486}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 5.654310896992683, "policy_loss": -0.030561303021386266, "vf_loss": 5.681024461984634, "vf_explained_var": 0.36317840218544006, "kl": 0.009008007778902538, "entropy": 0.1199186141602695, "entropy_coeff": 0.0}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 64, "training_iteration": 161, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-15-42", "timestamp": 1618143342, "time_this_iter_s": 31.287861347198486, "time_total_s": 4699.391298532486, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4699.391298532486, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 61.940000000000005, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1483.0, "episode_reward_min": 1483.0, "episode_reward_mean": 1483.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1483.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6128850487521993, "mean_raw_obs_processing_ms": 0.10765104274407059, "mean_inference_ms": 2.2908918374416243, "mean_action_processing_ms": 0.05673653931532286}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 648000, "timers": {"sample_time_ms": 12120.211, "sample_throughput": 330.027, "learn_time_ms": 16742.985, "learn_throughput": 238.906, "update_time_ms": 3.398}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 6.331735908985138, "policy_loss": -0.026897111209109426, "vf_loss": 6.355097487568855, "vf_explained_var": 0.4421522617340088, "kl": 0.008277208151412196, "entropy": 0.13148580281995237, "entropy_coeff": 0.0}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 64, "training_iteration": 162, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-16-10", "timestamp": 1618143370, "time_this_iter_s": 28.55434560775757, "time_total_s": 4727.9456441402435, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4727.9456441402435, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 61.75749999999999, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6156477477602392, "mean_raw_obs_processing_ms": 0.108007713688961, "mean_inference_ms": 2.291610453497818, "mean_action_processing_ms": 0.05674056444168954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 652000, "timers": {"sample_time_ms": 12178.244, "sample_throughput": 328.455, "learn_time_ms": 16735.893, "learn_throughput": 239.007, "update_time_ms": 3.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 8.033145129680634, "policy_loss": -0.0294393579242751, "vf_loss": 8.058369427919388, "vf_explained_var": 0.33602339029312134, "kl": 0.009868255292531103, "entropy": 0.1168769362848252, "entropy_coeff": 0.0}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 65, "training_iteration": 163, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-16-41", "timestamp": 1618143401, "time_this_iter_s": 30.260987997055054, "time_total_s": 4758.206632137299, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eb0bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f109d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4758.206632137299, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 61.199999999999996, "ram_util_percent": 27.50909090909091}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6156477477602392, "mean_raw_obs_processing_ms": 0.108007713688961, "mean_inference_ms": 2.291610453497818, "mean_action_processing_ms": 0.05674056444168954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 656000, "timers": {"sample_time_ms": 12199.695, "sample_throughput": 327.877, "learn_time_ms": 16710.615, "learn_throughput": 239.369, "update_time_ms": 3.335}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 9.889920562505722, "policy_loss": -0.029737707052845508, "vf_loss": 9.915260374546051, "vf_explained_var": 0.38353535532951355, "kl": 0.010296162814483978, "entropy": 0.151095240842551, "entropy_coeff": 0.0}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 65, "training_iteration": 164, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-17-08", "timestamp": 1618143428, "time_this_iter_s": 27.396141290664673, "time_total_s": 4785.602773427963, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efca10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4785.602773427963, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 62.38717948717949, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184510502050451, "mean_raw_obs_processing_ms": 0.10823494955616218, "mean_inference_ms": 2.2920971188573716, "mean_action_processing_ms": 0.056756669082524504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 660000, "timers": {"sample_time_ms": 12540.631, "sample_throughput": 318.963, "learn_time_ms": 16746.068, "learn_throughput": 238.862, "update_time_ms": 3.418}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 7.010212451219559, "policy_loss": -0.022952847182750702, "vf_loss": 7.029147997498512, "vf_explained_var": 0.21706382930278778, "kl": 0.009405132484971546, "entropy": 0.11326340329833329, "entropy_coeff": 0.0}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 66, "training_iteration": 165, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-17-41", "timestamp": 1618143461, "time_this_iter_s": 33.15728998184204, "time_total_s": 4818.760063409805, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f154d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4818.760063409805, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 61.67021276595746, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184510502050451, "mean_raw_obs_processing_ms": 0.10823494955616218, "mean_inference_ms": 2.2920971188573716, "mean_action_processing_ms": 0.056756669082524504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 664000, "timers": {"sample_time_ms": 12672.722, "sample_throughput": 315.639, "learn_time_ms": 16713.015, "learn_throughput": 239.334, "update_time_ms": 3.333}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 12.576817631721497, "policy_loss": -0.03843755851266906, "vf_loss": 12.610233396291733, "vf_explained_var": 0.5527855157852173, "kl": 0.011756664840504527, "entropy": 0.17314878338947892, "entropy_coeff": 0.0}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 66, "training_iteration": 166, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-18-11", "timestamp": 1618143491, "time_this_iter_s": 29.364230394363403, "time_total_s": 4848.124293804169, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4848.124293804169, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 61.58095238095238, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184510502050451, "mean_raw_obs_processing_ms": 0.10823494955616218, "mean_inference_ms": 2.2920971188573716, "mean_action_processing_ms": 0.056756669082524504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 668000, "timers": {"sample_time_ms": 12791.707, "sample_throughput": 312.703, "learn_time_ms": 16722.689, "learn_throughput": 239.196, "update_time_ms": 3.346}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 11.160513788461685, "policy_loss": -0.029480380762834102, "vf_loss": 11.186599731445312, "vf_explained_var": 0.40016040205955505, "kl": 0.007946832411107607, "entropy": 0.12512289150618017, "entropy_coeff": 0.0}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 66, "training_iteration": 167, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-18-40", "timestamp": 1618143520, "time_this_iter_s": 29.688207626342773, "time_total_s": 4877.8125014305115, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1aa90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4877.8125014305115, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 61.32142857142857, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1871.0, "episode_reward_min": 1871.0, "episode_reward_mean": 1871.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1871.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6171696503257705, "mean_raw_obs_processing_ms": 0.10855085463208677, "mean_inference_ms": 2.2921626794809757, "mean_action_processing_ms": 0.056749980709853945}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 672000, "timers": {"sample_time_ms": 12743.458, "sample_throughput": 313.887, "learn_time_ms": 16785.368, "learn_throughput": 238.303, "update_time_ms": 3.38}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 11.394167393445969, "policy_loss": -0.049548758775927126, "vf_loss": 11.434341460466385, "vf_explained_var": 0.40885722637176514, "kl": 0.02194690762553364, "entropy": 0.14103555749170482, "entropy_coeff": 0.0}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 67, "training_iteration": 168, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-19-08", "timestamp": 1618143548, "time_this_iter_s": 27.89416217803955, "time_total_s": 4905.706663608551, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f151d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4905.706663608551, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 61.69500000000001, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1871.0, "episode_reward_min": 1871.0, "episode_reward_mean": 1871.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1871.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6171696503257705, "mean_raw_obs_processing_ms": 0.10855085463208677, "mean_inference_ms": 2.2921626794809757, "mean_action_processing_ms": 0.056749980709853945}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 676000, "timers": {"sample_time_ms": 12953.146, "sample_throughput": 308.805, "learn_time_ms": 16825.676, "learn_throughput": 237.732, "update_time_ms": 3.29}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.290146201848984, "policy_loss": -0.03784811694640666, "vf_loss": 12.319842159748077, "vf_explained_var": 0.39377766847610474, "kl": 0.012723541352897882, "entropy": 0.15550499642267823, "entropy_coeff": 0.0}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 67, "training_iteration": 169, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-19-38", "timestamp": 1618143578, "time_this_iter_s": 29.630560636520386, "time_total_s": 4935.337224245071, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1add0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4935.337224245071, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 61.42790697674419, "ram_util_percent": 27.52790697674418}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1759.0, "episode_reward_min": 1759.0, "episode_reward_mean": 1759.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1759.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6157572221500103, "mean_raw_obs_processing_ms": 0.10878019919913495, "mean_inference_ms": 2.2924185514098405, "mean_action_processing_ms": 0.05675404701382749}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 680000, "timers": {"sample_time_ms": 12743.619, "sample_throughput": 313.883, "learn_time_ms": 16852.516, "learn_throughput": 237.353, "update_time_ms": 3.293}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.215119540691376, "policy_loss": -0.033217645541299134, "vf_loss": 10.242354601621628, "vf_explained_var": 0.44284743070602417, "kl": 0.009337312774732709, "entropy": 0.14925704477354884, "entropy_coeff": 0.0}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 68, "training_iteration": 170, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-20-07", "timestamp": 1618143607, "time_this_iter_s": 28.847336769104004, "time_total_s": 4964.184561014175, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4964.184561014175, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 62.05121951219513, "ram_util_percent": 27.56341463414634}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1759.0, "episode_reward_min": 1759.0, "episode_reward_mean": 1759.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1759.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6157572221500103, "mean_raw_obs_processing_ms": 0.10878019919913495, "mean_inference_ms": 2.2924185514098405, "mean_action_processing_ms": 0.05675404701382749}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 684000, "timers": {"sample_time_ms": 12461.23, "sample_throughput": 320.996, "learn_time_ms": 16888.814, "learn_throughput": 236.843, "update_time_ms": 3.242}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.733942463994026, "policy_loss": -0.04177033674204722, "vf_loss": 10.769988238811493, "vf_explained_var": 0.5898329019546509, "kl": 0.00893460628867615, "entropy": 0.16899878857657313, "entropy_coeff": 0.0}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 68, "training_iteration": 171, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-20-36", "timestamp": 1618143636, "time_this_iter_s": 28.83307695388794, "time_total_s": 4993.017637968063, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4993.017637968063, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 61.87073170731707, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1759.0, "episode_reward_min": 1759.0, "episode_reward_mean": 1759.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1759.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6157572221500103, "mean_raw_obs_processing_ms": 0.10878019919913495, "mean_inference_ms": 2.2924185514098405, "mean_action_processing_ms": 0.05675404701382749}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 688000, "timers": {"sample_time_ms": 12680.847, "sample_throughput": 315.436, "learn_time_ms": 16870.344, "learn_throughput": 237.102, "update_time_ms": 3.332}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 11.94731655716896, "policy_loss": -0.026119007234228775, "vf_loss": 11.969162330031395, "vf_explained_var": 0.3279646039009094, "kl": 0.006669703630905133, "entropy": 0.12929901434108615, "entropy_coeff": 0.0}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 68, "training_iteration": 172, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-21-06", "timestamp": 1618143666, "time_this_iter_s": 30.569678783416748, "time_total_s": 5023.58731675148, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc6b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5023.58731675148, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 62.24772727272727, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1908.0, "episode_reward_min": 1908.0, "episode_reward_mean": 1908.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1908.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.619383686924437, "mean_raw_obs_processing_ms": 0.10913466244627588, "mean_inference_ms": 2.292798320443242, "mean_action_processing_ms": 0.05676423397834121}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 692000, "timers": {"sample_time_ms": 12801.298, "sample_throughput": 312.468, "learn_time_ms": 16913.005, "learn_throughput": 236.504, "update_time_ms": 3.468}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.0911659598350525, "policy_loss": -0.038209429185371846, "vf_loss": 7.124357238411903, "vf_explained_var": 0.3253433406352997, "kl": 0.007832073766621761, "entropy": 0.11503544636070728, "entropy_coeff": 0.0}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 69, "training_iteration": 173, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-21-38", "timestamp": 1618143698, "time_this_iter_s": 31.890227556228638, "time_total_s": 5055.477544307709, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5055.477544307709, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 61.026666666666664, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1908.0, "episode_reward_min": 1908.0, "episode_reward_mean": 1908.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1908.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.619383686924437, "mean_raw_obs_processing_ms": 0.10913466244627588, "mean_inference_ms": 2.292798320443242, "mean_action_processing_ms": 0.05676423397834121}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 696000, "timers": {"sample_time_ms": 12851.334, "sample_throughput": 311.252, "learn_time_ms": 16977.767, "learn_throughput": 235.602, "update_time_ms": 3.45}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 11.347837120294571, "policy_loss": -0.04231142462231219, "vf_loss": 11.380402565002441, "vf_explained_var": 0.5066970586776733, "kl": 0.015210724377539009, "entropy": 0.14997119246982038, "entropy_coeff": 0.0}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 69, "training_iteration": 174, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-22-07", "timestamp": 1618143727, "time_this_iter_s": 28.5480899810791, "time_total_s": 5084.025634288788, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec03d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5084.025634288788, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 61.673170731707316, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1784.0, "episode_reward_min": 1784.0, "episode_reward_mean": 1784.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1784.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164189565357157, "mean_raw_obs_processing_ms": 0.10937739959373997, "mean_inference_ms": 2.292844527146826, "mean_action_processing_ms": 0.056768973859264465}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 700000, "timers": {"sample_time_ms": 12387.46, "sample_throughput": 322.907, "learn_time_ms": 16927.089, "learn_throughput": 236.308, "update_time_ms": 3.443}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.25569424033165, "policy_loss": -0.02576617489103228, "vf_loss": 12.277133733034134, "vf_explained_var": 0.41141819953918457, "kl": 0.006753009685780853, "entropy": 0.1572119847405702, "entropy_coeff": 0.0}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 70, "training_iteration": 175, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-22-35", "timestamp": 1618143755, "time_this_iter_s": 28.00640559196472, "time_total_s": 5112.032039880753, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f150d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5112.032039880753, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 62.05, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1784.0, "episode_reward_min": 1784.0, "episode_reward_mean": 1784.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1784.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164189565357157, "mean_raw_obs_processing_ms": 0.10937739959373997, "mean_inference_ms": 2.292844527146826, "mean_action_processing_ms": 0.056768973859264465}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 704000, "timers": {"sample_time_ms": 12538.27, "sample_throughput": 319.023, "learn_time_ms": 16964.89, "learn_throughput": 235.781, "update_time_ms": 3.508}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 13.906280040740967, "policy_loss": -0.036202688643243164, "vf_loss": 13.936364203691483, "vf_explained_var": 0.4997510313987732, "kl": 0.009549655762384646, "entropy": 0.15135279879905283, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 70, "training_iteration": 176, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-23-06", "timestamp": 1618143786, "time_this_iter_s": 31.253485202789307, "time_total_s": 5143.285525083542, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f044d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e348d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5143.285525083542, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 62.375555555555565, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1784.0, "episode_reward_min": 1784.0, "episode_reward_mean": 1784.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1784.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164189565357157, "mean_raw_obs_processing_ms": 0.10937739959373997, "mean_inference_ms": 2.292844527146826, "mean_action_processing_ms": 0.056768973859264465}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 708000, "timers": {"sample_time_ms": 12477.21, "sample_throughput": 320.584, "learn_time_ms": 16939.765, "learn_throughput": 236.131, "update_time_ms": 3.469}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.126475661993027, "policy_loss": -0.03125943796476349, "vf_loss": 14.15328362584114, "vf_explained_var": 0.4713270664215088, "kl": 0.006947286412469111, "entropy": 0.14403925533406436, "entropy_coeff": 0.0}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 70, "training_iteration": 177, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-23-35", "timestamp": 1618143815, "time_this_iter_s": 28.826594591140747, "time_total_s": 5172.112119674683, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5172.112119674683, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 61.956097560975614, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1748.0, "episode_reward_min": 1748.0, "episode_reward_mean": 1748.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1748.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6162470667122667, "mean_raw_obs_processing_ms": 0.10975215698430008, "mean_inference_ms": 2.2945408127945095, "mean_action_processing_ms": 0.0567948566344031}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 712000, "timers": {"sample_time_ms": 12586.189, "sample_throughput": 317.809, "learn_time_ms": 16905.955, "learn_throughput": 236.603, "update_time_ms": 3.49}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.652197152376175, "policy_loss": -0.037031536776339635, "vf_loss": 12.683063268661499, "vf_explained_var": 0.5386739373207092, "kl": 0.00962244940456003, "entropy": 0.1763159749098122, "entropy_coeff": 0.0}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 71, "training_iteration": 178, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-24-04", "timestamp": 1618143844, "time_this_iter_s": 28.64202117919922, "time_total_s": 5200.754140853882, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc6690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5200.754140853882, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 61.826829268292684, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1748.0, "episode_reward_min": 1748.0, "episode_reward_mean": 1748.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1748.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6162470667122667, "mean_raw_obs_processing_ms": 0.10975215698430008, "mean_inference_ms": 2.2945408127945095, "mean_action_processing_ms": 0.0567948566344031}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 716000, "timers": {"sample_time_ms": 12660.949, "sample_throughput": 315.932, "learn_time_ms": 16909.42, "learn_throughput": 236.555, "update_time_ms": 3.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.52772043645382, "policy_loss": -0.0341982392128557, "vf_loss": 9.554403066635132, "vf_explained_var": 0.3095614016056061, "kl": 0.011729762816685252, "entropy": 0.1474785532336682, "entropy_coeff": 0.0}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 71, "training_iteration": 179, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-24-34", "timestamp": 1618143874, "time_this_iter_s": 30.412804126739502, "time_total_s": 5231.166944980621, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5231.166944980621, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 61.62558139534884, "ram_util_percent": 27.52558139534883}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2033.0, "episode_reward_min": 2033.0, "episode_reward_mean": 2033.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2033.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6202922388268118, "mean_raw_obs_processing_ms": 0.11001175661128401, "mean_inference_ms": 2.295265163633606, "mean_action_processing_ms": 0.05680389528380327}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 720000, "timers": {"sample_time_ms": 13014.028, "sample_throughput": 307.361, "learn_time_ms": 16840.958, "learn_throughput": 237.516, "update_time_ms": 3.468}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.11341655254364, "policy_loss": -0.03129555651685223, "vf_loss": 10.136415094137192, "vf_explained_var": 0.3685784637928009, "kl": 0.012949495503562503, "entropy": 0.14046678179875016, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 72, "training_iteration": 180, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-25-06", "timestamp": 1618143906, "time_this_iter_s": 31.691770315170288, "time_total_s": 5262.858715295792, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5262.858715295792, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 61.78666666666667, "ram_util_percent": 27.597777777777768}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2033.0, "episode_reward_min": 2033.0, "episode_reward_mean": 2033.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2033.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6202922388268118, "mean_raw_obs_processing_ms": 0.11001175661128401, "mean_inference_ms": 2.295265163633606, "mean_action_processing_ms": 0.05680389528380327}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 724000, "timers": {"sample_time_ms": 13320.077, "sample_throughput": 300.299, "learn_time_ms": 16781.603, "learn_throughput": 238.356, "update_time_ms": 3.561}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 8.47708261013031, "policy_loss": -0.026066774094942957, "vf_loss": 8.49888551235199, "vf_explained_var": 0.43855810165405273, "kl": 0.006654882789007388, "entropy": 0.13396821590140462, "entropy_coeff": 0.0}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 72, "training_iteration": 181, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-25-37", "timestamp": 1618143937, "time_this_iter_s": 31.297289848327637, "time_total_s": 5294.156005144119, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f154d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5294.156005144119, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 61.21333333333333, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2033.0, "episode_reward_min": 2033.0, "episode_reward_mean": 2033.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2033.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6202922388268118, "mean_raw_obs_processing_ms": 0.11001175661128401, "mean_inference_ms": 2.295265163633606, "mean_action_processing_ms": 0.05680389528380327}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 728000, "timers": {"sample_time_ms": 13315.242, "sample_throughput": 300.408, "learn_time_ms": 16852.078, "learn_throughput": 237.359, "update_time_ms": 3.547}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.130176305770874, "policy_loss": -0.0272147951181978, "vf_loss": 12.150860041379929, "vf_explained_var": 0.42410188913345337, "kl": 0.010193293739575893, "entropy": 0.1366567648947239, "entropy_coeff": 0.0}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 72, "training_iteration": 182, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-26-09", "timestamp": 1618143969, "time_this_iter_s": 31.226123571395874, "time_total_s": 5325.382128715515, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6aa90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5325.382128715515, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 62.351111111111116, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6269761012133453, "mean_raw_obs_processing_ms": 0.11033458469448522, "mean_inference_ms": 2.294826608146989, "mean_action_processing_ms": 0.05679475114174492}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 732000, "timers": {"sample_time_ms": 13201.361, "sample_throughput": 302.999, "learn_time_ms": 16816.387, "learn_throughput": 237.863, "update_time_ms": 3.429}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.909110248088837, "policy_loss": -0.03459798317635432, "vf_loss": 12.931499570608139, "vf_explained_var": 0.41342830657958984, "kl": 0.019054430900723673, "entropy": 0.13512452761642635, "entropy_coeff": 0.0}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 73, "training_iteration": 183, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-26-39", "timestamp": 1618143999, "time_this_iter_s": 30.39926290512085, "time_total_s": 5355.781391620636, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6afd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5355.781391620636, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 61.32093023255813, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2024.0, "episode_reward_min": 2024.0, "episode_reward_mean": 2024.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6269761012133453, "mean_raw_obs_processing_ms": 0.11033458469448522, "mean_inference_ms": 2.294826608146989, "mean_action_processing_ms": 0.05679475114174492}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 736000, "timers": {"sample_time_ms": 13217.467, "sample_throughput": 302.63, "learn_time_ms": 16835.106, "learn_throughput": 237.599, "update_time_ms": 3.394}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.39478574693203, "policy_loss": -0.018647994671482593, "vf_loss": 7.4092696607112885, "vf_explained_var": 0.3207545876502991, "kl": 0.006498964983620681, "entropy": 0.12144371261820197, "entropy_coeff": 0.0}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 73, "training_iteration": 184, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-27-08", "timestamp": 1618144028, "time_this_iter_s": 28.88813281059265, "time_total_s": 5384.669524431229, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5384.669524431229, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 62.14146341463415, "ram_util_percent": 27.558536585365857}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1894.0, "episode_reward_min": 1894.0, "episode_reward_mean": 1894.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1894.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.626084653432509, "mean_raw_obs_processing_ms": 0.11056511700355925, "mean_inference_ms": 2.2950774336980935, "mean_action_processing_ms": 0.056798584966874725}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 740000, "timers": {"sample_time_ms": 13365.64, "sample_throughput": 299.275, "learn_time_ms": 16856.608, "learn_throughput": 237.296, "update_time_ms": 3.321}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.159750670194626, "policy_loss": -0.03286676108837128, "vf_loss": 9.184559747576714, "vf_explained_var": 0.3556157350540161, "kl": 0.01257607460138388, "entropy": 0.1400989885441959, "entropy_coeff": 0.0}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 74, "training_iteration": 185, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-27-38", "timestamp": 1618144058, "time_this_iter_s": 29.696621656417847, "time_total_s": 5414.3661460876465, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1abd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5414.3661460876465, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 61.793023255813964, "ram_util_percent": 27.502325581395347}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1894.0, "episode_reward_min": 1894.0, "episode_reward_mean": 1894.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1894.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.626084653432509, "mean_raw_obs_processing_ms": 0.11056511700355925, "mean_inference_ms": 2.2950774336980935, "mean_action_processing_ms": 0.056798584966874725}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 744000, "timers": {"sample_time_ms": 13541.302, "sample_throughput": 295.393, "learn_time_ms": 16831.685, "learn_throughput": 237.647, "update_time_ms": 3.366}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 6.156036838889122, "policy_loss": -0.01647778326878324, "vf_loss": 6.167553834617138, "vf_explained_var": 0.21877050399780273, "kl": 0.007742393878288567, "entropy": 0.11679150606505573, "entropy_coeff": 0.0}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 74, "training_iteration": 186, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-28-10", "timestamp": 1618144090, "time_this_iter_s": 32.759501934051514, "time_total_s": 5447.125648021698, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5447.125648021698, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 61.86170212765956, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1894.0, "episode_reward_min": 1894.0, "episode_reward_mean": 1894.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1894.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.626084653432509, "mean_raw_obs_processing_ms": 0.11056511700355925, "mean_inference_ms": 2.2950774336980935, "mean_action_processing_ms": 0.056798584966874725}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 748000, "timers": {"sample_time_ms": 13595.016, "sample_throughput": 294.225, "learn_time_ms": 16852.068, "learn_throughput": 237.36, "update_time_ms": 3.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.839698553085327, "policy_loss": -0.02397957118228078, "vf_loss": 7.859529510140419, "vf_explained_var": 0.4185943007469177, "kl": 0.006475015907199122, "entropy": 0.12170351133681834, "entropy_coeff": 0.0}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 74, "training_iteration": 187, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-28-40", "timestamp": 1618144120, "time_this_iter_s": 29.57094693183899, "time_total_s": 5476.696594953537, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f105d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5476.696594953537, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 61.82857142857142, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2087.0, "episode_reward_min": 2087.0, "episode_reward_mean": 2087.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2087.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6326492905859459, "mean_raw_obs_processing_ms": 0.11094266356075776, "mean_inference_ms": 2.295734472728701, "mean_action_processing_ms": 0.05684178040011548}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 752000, "timers": {"sample_time_ms": 13818.467, "sample_throughput": 289.468, "learn_time_ms": 16862.504, "learn_throughput": 237.213, "update_time_ms": 3.575}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 6.242727667093277, "policy_loss": -0.022523607243783772, "vf_loss": 6.260487526655197, "vf_explained_var": 0.27186909317970276, "kl": 0.007434889645082876, "entropy": 0.11984664970077574, "entropy_coeff": 0.0}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 75, "training_iteration": 188, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-29-11", "timestamp": 1618144151, "time_this_iter_s": 30.986950159072876, "time_total_s": 5507.68354511261, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5507.68354511261, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 61.79545454545455, "ram_util_percent": 27.554545454545448}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2087.0, "episode_reward_min": 2087.0, "episode_reward_mean": 2087.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2087.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6326492905859459, "mean_raw_obs_processing_ms": 0.11094266356075776, "mean_inference_ms": 2.295734472728701, "mean_action_processing_ms": 0.05684178040011548}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 756000, "timers": {"sample_time_ms": 13805.175, "sample_throughput": 289.746, "learn_time_ms": 16932.179, "learn_throughput": 236.237, "update_time_ms": 3.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.621432960033417, "policy_loss": -0.0241668256057892, "vf_loss": 9.641577377915382, "vf_explained_var": 0.4029471278190613, "kl": 0.006278015849602525, "entropy": 0.1108224205672741, "entropy_coeff": 0.0}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 75, "training_iteration": 189, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-29-42", "timestamp": 1618144182, "time_this_iter_s": 30.9848530292511, "time_total_s": 5538.668398141861, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47338d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5538.668398141861, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 62.609090909090924, "ram_util_percent": 27.556818181818173}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2080.0, "episode_reward_min": 2080.0, "episode_reward_mean": 2080.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2080.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6339498030580362, "mean_raw_obs_processing_ms": 0.11118086942673817, "mean_inference_ms": 2.2957555202758435, "mean_action_processing_ms": 0.05684142758650934}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 760000, "timers": {"sample_time_ms": 13588.719, "sample_throughput": 294.362, "learn_time_ms": 16953.014, "learn_throughput": 235.946, "update_time_ms": 3.752}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.156951665878296, "policy_loss": -0.018941823102068156, "vf_loss": 10.170841678977013, "vf_explained_var": 0.5261792540550232, "kl": 0.007884450271376409, "entropy": 0.12584813963621855, "entropy_coeff": 0.0}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 76, "training_iteration": 190, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-30-12", "timestamp": 1618144212, "time_this_iter_s": 29.74075150489807, "time_total_s": 5568.409149646759, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5568.409149646759, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 61.49767441860465, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2080.0, "episode_reward_min": 2080.0, "episode_reward_mean": 2080.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2080.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6339498030580362, "mean_raw_obs_processing_ms": 0.11118086942673817, "mean_inference_ms": 2.2957555202758435, "mean_action_processing_ms": 0.05684142758650934}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 764000, "timers": {"sample_time_ms": 13636.206, "sample_throughput": 293.337, "learn_time_ms": 16985.92, "learn_throughput": 235.489, "update_time_ms": 3.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.9906897097826, "policy_loss": -0.04074347112327814, "vf_loss": 8.021966934204102, "vf_explained_var": 0.34720492362976074, "kl": 0.014774361392483115, "entropy": 0.1252853034529835, "entropy_coeff": 0.0}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 76, "training_iteration": 191, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-30-44", "timestamp": 1618144244, "time_this_iter_s": 32.100085735321045, "time_total_s": 5600.50923538208, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5600.50923538208, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 62.160869565217375, "ram_util_percent": 27.59347826086955}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2080.0, "episode_reward_min": 2080.0, "episode_reward_mean": 2080.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2080.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6339498030580362, "mean_raw_obs_processing_ms": 0.11118086942673817, "mean_inference_ms": 2.2957555202758435, "mean_action_processing_ms": 0.05684142758650934}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 768000, "timers": {"sample_time_ms": 13736.859, "sample_throughput": 291.187, "learn_time_ms": 16960.354, "learn_throughput": 235.844, "update_time_ms": 3.703}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 5.187299147248268, "policy_loss": -0.02812159451423213, "vf_loss": 5.210882246494293, "vf_explained_var": 0.22605326771736145, "kl": 0.007083326505380683, "entropy": 0.10910206334665418, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 76, "training_iteration": 192, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-31-16", "timestamp": 1618144276, "time_this_iter_s": 31.972379207611084, "time_total_s": 5632.481614589691, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1ac50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5632.481614589691, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 61.09333333333333, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2217.0, "episode_reward_min": 2217.0, "episode_reward_mean": 2217.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2217.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.642042352461195, "mean_raw_obs_processing_ms": 0.11156147041384988, "mean_inference_ms": 2.297037791565046, "mean_action_processing_ms": 0.056866283702578194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 772000, "timers": {"sample_time_ms": 13882.675, "sample_throughput": 288.129, "learn_time_ms": 16975.522, "learn_throughput": 235.633, "update_time_ms": 3.748}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 5.855409771203995, "policy_loss": -0.03130785870598629, "vf_loss": 5.882484450936317, "vf_explained_var": 0.2209799587726593, "kl": 0.006607016650377773, "entropy": 0.10011838283389807, "entropy_coeff": 0.0}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 77, "training_iteration": 193, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-31-48", "timestamp": 1618144308, "time_this_iter_s": 32.00393867492676, "time_total_s": 5664.485553264618, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5664.485553264618, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 62.676086956521736, "ram_util_percent": 27.571739130434782}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2217.0, "episode_reward_min": 2217.0, "episode_reward_mean": 2217.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2217.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.642042352461195, "mean_raw_obs_processing_ms": 0.11156147041384988, "mean_inference_ms": 2.297037791565046, "mean_action_processing_ms": 0.056866283702578194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 776000, "timers": {"sample_time_ms": 13888.239, "sample_throughput": 288.013, "learn_time_ms": 16981.447, "learn_throughput": 235.551, "update_time_ms": 3.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 6.935746684670448, "policy_loss": -0.03132041322533041, "vf_loss": 6.963224530220032, "vf_explained_var": 0.3027965724468231, "kl": 0.005997201253194362, "entropy": 0.10837943467777222, "entropy_coeff": 0.0}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 77, "training_iteration": 194, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-32-17", "timestamp": 1618144337, "time_this_iter_s": 29.004342079162598, "time_total_s": 5693.4898953437805, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5693.4898953437805, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 62.11463414634146, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2038.0, "episode_reward_min": 2038.0, "episode_reward_mean": 2038.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2038.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6390735606447882, "mean_raw_obs_processing_ms": 0.11182414017443829, "mean_inference_ms": 2.297531985763526, "mean_action_processing_ms": 0.05688336274987126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 780000, "timers": {"sample_time_ms": 13756.636, "sample_throughput": 290.769, "learn_time_ms": 17003.284, "learn_throughput": 235.249, "update_time_ms": 3.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.466249793767929, "policy_loss": -0.029295978660229594, "vf_loss": 9.491496697068214, "vf_explained_var": 0.3910827338695526, "kl": 0.006319426218396984, "entropy": 0.13138924236409366, "entropy_coeff": 0.0}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 78, "training_iteration": 195, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-32-46", "timestamp": 1618144366, "time_this_iter_s": 28.6069393157959, "time_total_s": 5722.096834659576, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5722.096834659576, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 62.20975609756098, "ram_util_percent": 27.536585365853657}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2038.0, "episode_reward_min": 2038.0, "episode_reward_mean": 2038.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2038.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6390735606447882, "mean_raw_obs_processing_ms": 0.11182414017443829, "mean_inference_ms": 2.297531985763526, "mean_action_processing_ms": 0.05688336274987126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 784000, "timers": {"sample_time_ms": 13456.497, "sample_throughput": 297.254, "learn_time_ms": 17042.098, "learn_throughput": 234.713, "update_time_ms": 3.869}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.281118005514145, "policy_loss": -0.029979534854646772, "vf_loss": 9.30656835436821, "vf_explained_var": 0.43003225326538086, "kl": 0.007069075989420526, "entropy": 0.1309363793116063, "entropy_coeff": 0.0}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 78, "training_iteration": 196, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-33-16", "timestamp": 1618144396, "time_this_iter_s": 30.151265621185303, "time_total_s": 5752.248100280762, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f191d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5752.248100280762, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 61.81395348837211, "ram_util_percent": 27.548837209302324}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2038.0, "episode_reward_min": 2038.0, "episode_reward_mean": 2038.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2038.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6390735606447882, "mean_raw_obs_processing_ms": 0.11182414017443829, "mean_inference_ms": 2.297531985763526, "mean_action_processing_ms": 0.05688336274987126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 788000, "timers": {"sample_time_ms": 13485.345, "sample_throughput": 296.618, "learn_time_ms": 17111.893, "learn_throughput": 233.756, "update_time_ms": 4.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.048659831285477, "policy_loss": -0.03161266993265599, "vf_loss": 10.075175642967224, "vf_explained_var": 0.576746940612793, "kl": 0.007954807777423412, "entropy": 0.15201303409412503, "entropy_coeff": 0.0}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 78, "training_iteration": 197, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-33-47", "timestamp": 1618144427, "time_this_iter_s": 30.56428813934326, "time_total_s": 5782.812388420105, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6af10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5782.812388420105, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 62.19772727272728, "ram_util_percent": 27.502272727272725}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1917.0, "episode_reward_min": 1917.0, "episode_reward_mean": 1917.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1917.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6403914301695435, "mean_raw_obs_processing_ms": 0.11217785859708804, "mean_inference_ms": 2.29760713593442, "mean_action_processing_ms": 0.05688725589428136}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 792000, "timers": {"sample_time_ms": 13341.036, "sample_throughput": 299.827, "learn_time_ms": 17098.921, "learn_throughput": 233.933, "update_time_ms": 3.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 8.270583271980286, "policy_loss": -0.029915368009824306, "vf_loss": 8.296085521578789, "vf_explained_var": 0.2629461884498596, "kl": 0.0068876250079483725, "entropy": 0.11441607202868909, "entropy_coeff": 0.0}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 79, "training_iteration": 198, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-34-16", "timestamp": 1618144456, "time_this_iter_s": 29.407930374145508, "time_total_s": 5812.2203187942505, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5812.2203187942505, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 62.43095238095238, "ram_util_percent": 27.50238095238095}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1917.0, "episode_reward_min": 1917.0, "episode_reward_mean": 1917.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1917.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6403914301695435, "mean_raw_obs_processing_ms": 0.11217785859708804, "mean_inference_ms": 2.29760713593442, "mean_action_processing_ms": 0.05688725589428136}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 796000, "timers": {"sample_time_ms": 13122.284, "sample_throughput": 304.825, "learn_time_ms": 17036.768, "learn_throughput": 234.786, "update_time_ms": 3.879}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 8.141119882464409, "policy_loss": -0.02777205128222704, "vf_loss": 8.164210483431816, "vf_explained_var": 0.4365042448043823, "kl": 0.007306380946829449, "entropy": 0.13615628401748836, "entropy_coeff": 0.0}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 79, "training_iteration": 199, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-34-44", "timestamp": 1618144484, "time_this_iter_s": 28.170018672943115, "time_total_s": 5840.390337467194, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5840.390337467194, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 61.985, "ram_util_percent": 27.5}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1939.0, "episode_reward_min": 1939.0, "episode_reward_mean": 1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6393146456837726, "mean_raw_obs_processing_ms": 0.11240997359704914, "mean_inference_ms": 2.297711857765306, "mean_action_processing_ms": 0.056887452720621075}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 800000, "timers": {"sample_time_ms": 13171.94, "sample_throughput": 303.676, "learn_time_ms": 17034.275, "learn_throughput": 234.821, "update_time_ms": 3.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.407674223184586, "policy_loss": -0.02624802617356181, "vf_loss": 10.42979995906353, "vf_explained_var": 0.4832882881164551, "kl": 0.006433529240894131, "entropy": 0.12694295635446906, "entropy_coeff": 0.0}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 80, "training_iteration": 200, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-35-14", "timestamp": 1618144514, "time_this_iter_s": 30.21290349960327, "time_total_s": 5870.603240966797, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5870.603240966797, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 62.45348837209303, "ram_util_percent": 27.597674418604647}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1939.0, "episode_reward_min": 1939.0, "episode_reward_mean": 1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6393146456837726, "mean_raw_obs_processing_ms": 0.11240997359704914, "mean_inference_ms": 2.297711857765306, "mean_action_processing_ms": 0.056887452720621075}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 804000, "timers": {"sample_time_ms": 13383.568, "sample_throughput": 298.874, "learn_time_ms": 17012.624, "learn_throughput": 235.12, "update_time_ms": 3.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 4.150345228612423, "policy_loss": -0.026342192228185013, "vf_loss": 4.172512248158455, "vf_explained_var": 0.2640431225299835, "kl": 0.006516329012811184, "entropy": 0.1014571855776012, "entropy_coeff": 0.0}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 80, "training_iteration": 201, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-35-49", "timestamp": 1618144549, "time_this_iter_s": 34.00102734565735, "time_total_s": 5904.604268312454, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f157d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5904.604268312454, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 62.00204081632652, "ram_util_percent": 27.553061224489795}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1939.0, "episode_reward_min": 1939.0, "episode_reward_mean": 1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6393146456837726, "mean_raw_obs_processing_ms": 0.11240997359704914, "mean_inference_ms": 2.297711857765306, "mean_action_processing_ms": 0.056887452720621075}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 808000, "timers": {"sample_time_ms": 13260.853, "sample_throughput": 301.64, "learn_time_ms": 17020.85, "learn_throughput": 235.006, "update_time_ms": 3.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 5.864296153187752, "policy_loss": -0.03114140819525346, "vf_loss": 5.890530489385128, "vf_explained_var": 0.32683390378952026, "kl": 0.007658553135115653, "entropy": 0.11220406927168369, "entropy_coeff": 0.0}}, "num_steps_sampled": 808000, "num_steps_trained": 808000}, "done": false, "episodes_total": 80, "training_iteration": 202, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-36-19", "timestamp": 1618144579, "time_this_iter_s": 30.831464767456055, "time_total_s": 5935.43573307991, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5935.43573307991, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 61.72954545454545, "ram_util_percent": 27.597727272727266}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2181.0, "episode_reward_min": 2181.0, "episode_reward_mean": 2181.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2181.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6443797192184696, "mean_raw_obs_processing_ms": 0.11278376789239568, "mean_inference_ms": 2.2980987115667904, "mean_action_processing_ms": 0.05690166231949638}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 812000, "timers": {"sample_time_ms": 12902.808, "sample_throughput": 310.01, "learn_time_ms": 17069.802, "learn_throughput": 234.332, "update_time_ms": 3.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 12.333382546901703, "policy_loss": -0.025415062031242996, "vf_loss": 12.353470385074615, "vf_explained_var": 0.4018428921699524, "kl": 0.008314164777402766, "entropy": 0.1421401014085859, "entropy_coeff": 0.0}}, "num_steps_sampled": 812000, "num_steps_trained": 812000}, "done": false, "episodes_total": 81, "training_iteration": 203, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-36-48", "timestamp": 1618144608, "time_this_iter_s": 28.918020963668823, "time_total_s": 5964.353754043579, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d72650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d72610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5964.353754043579, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 62.61463414634146, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2181.0, "episode_reward_min": 2181.0, "episode_reward_mean": 2181.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2181.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6443797192184696, "mean_raw_obs_processing_ms": 0.11278376789239568, "mean_inference_ms": 2.2980987115667904, "mean_action_processing_ms": 0.05690166231949638}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 816000, "timers": {"sample_time_ms": 13231.259, "sample_throughput": 302.314, "learn_time_ms": 17010.037, "learn_throughput": 235.155, "update_time_ms": 3.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.091281369328499, "policy_loss": -0.030016640143003315, "vf_loss": 7.1169253289699554, "vf_explained_var": 0.32222825288772583, "kl": 0.006824682932347059, "entropy": 0.11581521900370717, "entropy_coeff": 0.0}}, "num_steps_sampled": 816000, "num_steps_trained": 816000}, "done": false, "episodes_total": 81, "training_iteration": 204, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-37-20", "timestamp": 1618144640, "time_this_iter_s": 31.69482159614563, "time_total_s": 5996.048575639725, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d72150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5996.048575639725, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 62.728888888888896, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2053.0, "episode_reward_min": 2053.0, "episode_reward_mean": 2053.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2053.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6501072538342548, "mean_raw_obs_processing_ms": 0.11304029920468124, "mean_inference_ms": 2.2987429954287655, "mean_action_processing_ms": 0.05690978280017154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 820000, "timers": {"sample_time_ms": 13622.162, "sample_throughput": 293.639, "learn_time_ms": 17019.853, "learn_throughput": 235.02, "update_time_ms": 3.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.90503790974617, "policy_loss": -0.03016835101880133, "vf_loss": 7.930834740400314, "vf_explained_var": 0.3774344027042389, "kl": 0.006822789517173078, "entropy": 0.11212021391838789, "entropy_coeff": 0.0}}, "num_steps_sampled": 820000, "num_steps_trained": 820000}, "done": false, "episodes_total": 82, "training_iteration": 205, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-37-53", "timestamp": 1618144673, "time_this_iter_s": 32.6134889125824, "time_total_s": 6028.662064552307, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec86d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6028.662064552307, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 61.461702127659564, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2053.0, "episode_reward_min": 2053.0, "episode_reward_mean": 2053.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2053.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6501072538342548, "mean_raw_obs_processing_ms": 0.11304029920468124, "mean_inference_ms": 2.2987429954287655, "mean_action_processing_ms": 0.05690978280017154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 824000, "timers": {"sample_time_ms": 13701.061, "sample_throughput": 291.948, "learn_time_ms": 17058.387, "learn_throughput": 234.489, "update_time_ms": 3.725}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.480787768959999, "policy_loss": -0.03248352266382426, "vf_loss": 10.503474399447441, "vf_explained_var": 0.3740895688533783, "kl": 0.015290541050489992, "entropy": 0.12789755151607096, "entropy_coeff": 0.0}}, "num_steps_sampled": 824000, "num_steps_trained": 824000}, "done": false, "episodes_total": 82, "training_iteration": 206, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-38-24", "timestamp": 1618144704, "time_this_iter_s": 31.317317008972168, "time_total_s": 6059.979381561279, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6059.979381561279, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 62.58181818181819, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2053.0, "episode_reward_min": 2053.0, "episode_reward_mean": 2053.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2053.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6501072538342548, "mean_raw_obs_processing_ms": 0.11304029920468124, "mean_inference_ms": 2.2987429954287655, "mean_action_processing_ms": 0.05690978280017154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 828000, "timers": {"sample_time_ms": 13696.262, "sample_throughput": 292.05, "learn_time_ms": 16978.331, "learn_throughput": 235.594, "update_time_ms": 3.563}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.872299984097481, "policy_loss": -0.02859084092779085, "vf_loss": 7.896701529622078, "vf_explained_var": 0.42581677436828613, "kl": 0.006538378540426493, "entropy": 0.1239184180740267, "entropy_coeff": 0.0}}, "num_steps_sampled": 828000, "num_steps_trained": 828000}, "done": false, "episodes_total": 82, "training_iteration": 207, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-38-54", "timestamp": 1618144734, "time_this_iter_s": 29.70932173728943, "time_total_s": 6089.688703298569, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6aa90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6ae10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6089.688703298569, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 62.083720930232566, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1943.0, "episode_reward_min": 1943.0, "episode_reward_mean": 1943.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1943.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6531819613381896, "mean_raw_obs_processing_ms": 0.11337447466557629, "mean_inference_ms": 2.2987105753298676, "mean_action_processing_ms": 0.05691300254875816}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 832000, "timers": {"sample_time_ms": 13779.546, "sample_throughput": 290.285, "learn_time_ms": 16963.393, "learn_throughput": 235.802, "update_time_ms": 3.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 9.23551720380783, "policy_loss": -0.0189773392630741, "vf_loss": 9.250618025660515, "vf_explained_var": 0.3701118230819702, "kl": 0.006050296047760639, "entropy": 0.11002489156089723, "entropy_coeff": 0.0}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 83, "training_iteration": 208, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-39-24", "timestamp": 1618144764, "time_this_iter_s": 30.09114980697632, "time_total_s": 6119.779853105545, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6119.779853105545, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 61.65348837209303, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1943.0, "episode_reward_min": 1943.0, "episode_reward_mean": 1943.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1943.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6531819613381896, "mean_raw_obs_processing_ms": 0.11337447466557629, "mean_inference_ms": 2.2987105753298676, "mean_action_processing_ms": 0.05691300254875816}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 836000, "timers": {"sample_time_ms": 14078.531, "sample_throughput": 284.121, "learn_time_ms": 16983.254, "learn_throughput": 235.526, "update_time_ms": 3.52}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 6.754212945699692, "policy_loss": -0.019108240958303213, "vf_loss": 6.768759995698929, "vf_explained_var": 0.28500524163246155, "kl": 0.0071188807633006945, "entropy": 0.10955302976071835, "entropy_coeff": 0.0}}, "num_steps_sampled": 836000, "num_steps_trained": 836000}, "done": false, "episodes_total": 83, "training_iteration": 209, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-39-55", "timestamp": 1618144795, "time_this_iter_s": 31.361213207244873, "time_total_s": 6151.14106631279, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6151.14106631279, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 62.23555555555556, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1714.0, "episode_reward_min": 1714.0, "episode_reward_mean": 1714.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1714.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6526237169043602, "mean_raw_obs_processing_ms": 0.11363026454338769, "mean_inference_ms": 2.2987970244732483, "mean_action_processing_ms": 0.056918976211692715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 840000, "timers": {"sample_time_ms": 13833.569, "sample_throughput": 289.152, "learn_time_ms": 16929.448, "learn_throughput": 236.275, "update_time_ms": 3.474}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 19.184169679880142, "policy_loss": -0.06977767392527312, "vf_loss": 19.198044776916504, "vf_explained_var": 0.6206522583961487, "kl": 0.08724910416640341, "entropy": 0.2610089872032404, "entropy_coeff": 0.0}}, "num_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 84, "training_iteration": 210, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-40-23", "timestamp": 1618144823, "time_this_iter_s": 27.219808340072632, "time_total_s": 6178.360874652863, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6178.360874652863, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 61.38157894736841, "ram_util_percent": 27.600000000000005}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1714.0, "episode_reward_min": 1714.0, "episode_reward_mean": 1714.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1714.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6526237169043602, "mean_raw_obs_processing_ms": 0.11363026454338769, "mean_inference_ms": 2.2987970244732483, "mean_action_processing_ms": 0.056918976211692715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 844000, "timers": {"sample_time_ms": 13531.506, "sample_throughput": 295.606, "learn_time_ms": 16893.303, "learn_throughput": 236.78, "update_time_ms": 3.397}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 13.12820279598236, "policy_loss": -0.03380579827353358, "vf_loss": 13.15564638376236, "vf_explained_var": 0.6144854426383972, "kl": 0.006619874875468668, "entropy": 0.1480445449706167, "entropy_coeff": 0.0}}, "num_steps_sampled": 844000, "num_steps_trained": 844000}, "done": false, "episodes_total": 84, "training_iteration": 211, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-40-53", "timestamp": 1618144853, "time_this_iter_s": 30.619834661483765, "time_total_s": 6208.980709314346, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6208.980709314346, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 63.05681818181817, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1714.0, "episode_reward_min": 1714.0, "episode_reward_mean": 1714.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1714.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6526237169043602, "mean_raw_obs_processing_ms": 0.11363026454338769, "mean_inference_ms": 2.2987970244732483, "mean_action_processing_ms": 0.056918976211692715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 848000, "timers": {"sample_time_ms": 13402.03, "sample_throughput": 298.462, "learn_time_ms": 16870.337, "learn_throughput": 237.103, "update_time_ms": 3.372}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 10.47824427485466, "policy_loss": -0.031337883265223354, "vf_loss": 10.504381895065308, "vf_explained_var": 0.4675559103488922, "kl": 0.0054107639589346945, "entropy": 0.110005120979622, "entropy_coeff": 0.0}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 84, "training_iteration": 212, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-41-23", "timestamp": 1618144883, "time_this_iter_s": 29.303863286972046, "time_total_s": 6238.284572601318, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f101d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6238.284572601318, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 62.2357142857143, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1824.0, "episode_reward_min": 1824.0, "episode_reward_mean": 1824.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1824.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.655994742845321, "mean_raw_obs_processing_ms": 0.11401072572776327, "mean_inference_ms": 2.299165337466754, "mean_action_processing_ms": 0.05692636805339228}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 852000, "timers": {"sample_time_ms": 13728.189, "sample_throughput": 291.371, "learn_time_ms": 16895.895, "learn_throughput": 236.744, "update_time_ms": 3.303}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 12.932081758975983, "policy_loss": -0.04463320295326412, "vf_loss": 12.961132317781448, "vf_explained_var": 0.4880765676498413, "kl": 0.016213526570936665, "entropy": 0.13210603897459805, "entropy_coeff": 0.0}}, "num_steps_sampled": 852000, "num_steps_trained": 852000}, "done": false, "episodes_total": 85, "training_iteration": 213, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-41-55", "timestamp": 1618144915, "time_this_iter_s": 32.43299889564514, "time_total_s": 6270.7175714969635, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6270.7175714969635, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 61.647826086956506, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1824.0, "episode_reward_min": 1824.0, "episode_reward_mean": 1824.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1824.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.655994742845321, "mean_raw_obs_processing_ms": 0.11401072572776327, "mean_inference_ms": 2.299165337466754, "mean_action_processing_ms": 0.05692636805339228}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 856000, "timers": {"sample_time_ms": 13570.41, "sample_throughput": 294.759, "learn_time_ms": 16941.112, "learn_throughput": 236.112, "update_time_ms": 3.364}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 11.218809753656387, "policy_loss": -0.0221357339178212, "vf_loss": 11.236400753259659, "vf_explained_var": 0.38373154401779175, "kl": 0.004728744155727327, "entropy": 0.1034174794331193, "entropy_coeff": 0.0}}, "num_steps_sampled": 856000, "num_steps_trained": 856000}, "done": false, "episodes_total": 85, "training_iteration": 214, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-42-26", "timestamp": 1618144946, "time_this_iter_s": 30.56514859199524, "time_total_s": 6301.282720088959, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6301.282720088959, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 62.377272727272725, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2116.0, "episode_reward_min": 2116.0, "episode_reward_mean": 2116.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2116.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6612858956264681, "mean_raw_obs_processing_ms": 0.11425115585214039, "mean_inference_ms": 2.299454174870712, "mean_action_processing_ms": 0.05693785428594158}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 860000, "timers": {"sample_time_ms": 13696.615, "sample_throughput": 292.043, "learn_time_ms": 16910.931, "learn_throughput": 236.533, "update_time_ms": 3.278}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 5.115271642804146, "policy_loss": -0.025615469843614846, "vf_loss": 5.136234037578106, "vf_explained_var": 0.18836769461631775, "kl": 0.009682876770966686, "entropy": 0.1017947921063751, "entropy_coeff": 0.0}}, "num_steps_sampled": 860000, "num_steps_trained": 860000}, "done": false, "episodes_total": 86, "training_iteration": 215, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-42-59", "timestamp": 1618144979, "time_this_iter_s": 33.56863737106323, "time_total_s": 6334.851357460022, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaac50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6334.851357460022, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 61.86041666666666, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2116.0, "episode_reward_min": 2116.0, "episode_reward_mean": 2116.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2116.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6612858956264681, "mean_raw_obs_processing_ms": 0.11425115585214039, "mean_inference_ms": 2.299454174870712, "mean_action_processing_ms": 0.05693785428594158}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 864000, "timers": {"sample_time_ms": 13665.381, "sample_throughput": 292.71, "learn_time_ms": 16880.203, "learn_throughput": 236.964, "update_time_ms": 3.296}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.587577551603317, "policy_loss": -0.033233226742595434, "vf_loss": 8.614090666174889, "vf_explained_var": 0.4059488773345947, "kl": 0.0139844469667878, "entropy": 0.12424643826670945, "entropy_coeff": 0.0}}, "num_steps_sampled": 864000, "num_steps_trained": 864000}, "done": false, "episodes_total": 86, "training_iteration": 216, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-43-30", "timestamp": 1618145010, "time_this_iter_s": 30.697530508041382, "time_total_s": 6365.548887968063, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6365.548887968063, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 61.90909090909091, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2116.0, "episode_reward_min": 2116.0, "episode_reward_mean": 2116.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2116.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6612858956264681, "mean_raw_obs_processing_ms": 0.11425115585214039, "mean_inference_ms": 2.299454174870712, "mean_action_processing_ms": 0.05693785428594158}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 868000, "timers": {"sample_time_ms": 13769.586, "sample_throughput": 290.495, "learn_time_ms": 16843.398, "learn_throughput": 237.482, "update_time_ms": 3.312}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.536280170083046, "policy_loss": -0.03190596465719864, "vf_loss": 8.564459338784218, "vf_explained_var": 0.29646986722946167, "kl": 0.0077553369192173705, "entropy": 0.10543235065415502, "entropy_coeff": 0.0}}, "num_steps_sampled": 868000, "num_steps_trained": 868000}, "done": false, "episodes_total": 86, "training_iteration": 217, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-44-00", "timestamp": 1618145040, "time_this_iter_s": 30.38303565979004, "time_total_s": 6395.931923627853, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6395.931923627853, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 61.79302325581394, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2096.0, "episode_reward_min": 2096.0, "episode_reward_mean": 2096.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2096.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6654915677642754, "mean_raw_obs_processing_ms": 0.1146209992522177, "mean_inference_ms": 2.3004850409081197, "mean_action_processing_ms": 0.056954274789034066}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 872000, "timers": {"sample_time_ms": 13923.104, "sample_throughput": 287.292, "learn_time_ms": 16951.845, "learn_throughput": 235.963, "update_time_ms": 3.331}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.165795087814331, "policy_loss": -0.03506763925543055, "vf_loss": 8.194390460848808, "vf_explained_var": 0.34453341364860535, "kl": 0.013468426273902878, "entropy": 0.11198424594476819, "entropy_coeff": 0.0}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 87, "training_iteration": 218, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-44-33", "timestamp": 1618145073, "time_this_iter_s": 32.719725131988525, "time_total_s": 6428.651648759842, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f2aa9d6be10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6428.651648759842, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 62.34680851063829, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2096.0, "episode_reward_min": 2096.0, "episode_reward_mean": 2096.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2096.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6654915677642754, "mean_raw_obs_processing_ms": 0.1146209992522177, "mean_inference_ms": 2.3004850409081197, "mean_action_processing_ms": 0.056954274789034066}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 876000, "timers": {"sample_time_ms": 13953.647, "sample_throughput": 286.663, "learn_time_ms": 16937.716, "learn_throughput": 236.159, "update_time_ms": 3.291}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 10.912653267383575, "policy_loss": -0.03219669021200389, "vf_loss": 10.939926534891129, "vf_explained_var": 0.36769893765449524, "kl": 0.010245661076623946, "entropy": 0.11333900480531156, "entropy_coeff": 0.0}}, "num_steps_sampled": 876000, "num_steps_trained": 876000}, "done": false, "episodes_total": 87, "training_iteration": 219, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-45-05", "timestamp": 1618145105, "time_this_iter_s": 31.534823894500732, "time_total_s": 6460.186472654343, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6460.186472654343, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 61.68666666666667, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2172.0, "episode_reward_min": 2172.0, "episode_reward_mean": 2172.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2172.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6696398397269416, "mean_raw_obs_processing_ms": 0.11486076881642178, "mean_inference_ms": 2.3006623875884973, "mean_action_processing_ms": 0.05696678705214837}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 880000, "timers": {"sample_time_ms": 14355.583, "sample_throughput": 278.637, "learn_time_ms": 17005.537, "learn_throughput": 235.218, "update_time_ms": 3.312}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 6.660161674022675, "policy_loss": -0.02067783969687298, "vf_loss": 6.677579715847969, "vf_explained_var": 0.35796648263931274, "kl": 0.006783726388675859, "entropy": 0.09948934079147875, "entropy_coeff": 0.0}}, "num_steps_sampled": 880000, "num_steps_trained": 880000}, "done": false, "episodes_total": 88, "training_iteration": 220, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-45-37", "timestamp": 1618145137, "time_this_iter_s": 31.91753649711609, "time_total_s": 6492.104009151459, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaac50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6492.104009151459, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 62.324444444444445, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2172.0, "episode_reward_min": 2172.0, "episode_reward_mean": 2172.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2172.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6696398397269416, "mean_raw_obs_processing_ms": 0.11486076881642178, "mean_inference_ms": 2.3006623875884973, "mean_action_processing_ms": 0.05696678705214837}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 884000, "timers": {"sample_time_ms": 14255.356, "sample_throughput": 280.596, "learn_time_ms": 16975.349, "learn_throughput": 235.636, "update_time_ms": 3.335}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 5.343382656574249, "policy_loss": -0.026164121460169554, "vf_loss": 5.365497812628746, "vf_explained_var": 0.2694992125034332, "kl": 0.008425675016042078, "entropy": 0.10357128269970417, "entropy_coeff": 0.0}}, "num_steps_sampled": 884000, "num_steps_trained": 884000}, "done": false, "episodes_total": 88, "training_iteration": 221, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-46-06", "timestamp": 1618145166, "time_this_iter_s": 29.31137990951538, "time_total_s": 6521.415389060974, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6521.415389060974, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 61.9595238095238, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2172.0, "episode_reward_min": 2172.0, "episode_reward_mean": 2172.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2172.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6696398397269416, "mean_raw_obs_processing_ms": 0.11486076881642178, "mean_inference_ms": 2.3006623875884973, "mean_action_processing_ms": 0.05696678705214837}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 888000, "timers": {"sample_time_ms": 14514.842, "sample_throughput": 275.58, "learn_time_ms": 17009.058, "learn_throughput": 235.169, "update_time_ms": 3.416}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 4.7553466111421585, "policy_loss": -0.029754179704468697, "vf_loss": 4.781194515526295, "vf_explained_var": 0.24111950397491455, "kl": 0.008128971894620918, "entropy": 0.10533815179951489, "entropy_coeff": 0.0}}, "num_steps_sampled": 888000, "num_steps_trained": 888000}, "done": false, "episodes_total": 88, "training_iteration": 222, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-46-38", "timestamp": 1618145198, "time_this_iter_s": 32.239763021469116, "time_total_s": 6553.655152082443, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edab10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6553.655152082443, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 62.84130434782608, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2189.0, "episode_reward_min": 2189.0, "episode_reward_mean": 2189.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2189.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6741526558257056, "mean_raw_obs_processing_ms": 0.11521002417031286, "mean_inference_ms": 2.301413160582181, "mean_action_processing_ms": 0.056985199447905005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 892000, "timers": {"sample_time_ms": 14531.131, "sample_throughput": 275.271, "learn_time_ms": 16929.526, "learn_throughput": 236.274, "update_time_ms": 3.475}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.399428650736809, "policy_loss": -0.029240627598483115, "vf_loss": 8.424117684364319, "vf_explained_var": 0.2828347980976105, "kl": 0.009471647121245041, "entropy": 0.10446497285738587, "entropy_coeff": 0.0}}, "num_steps_sampled": 892000, "num_steps_trained": 892000}, "done": false, "episodes_total": 89, "training_iteration": 223, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-47-10", "timestamp": 1618145230, "time_this_iter_s": 31.802679538726807, "time_total_s": 6585.45783162117, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6585.45783162117, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 62.13478260869566, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2189.0, "episode_reward_min": 2189.0, "episode_reward_mean": 2189.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2189.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6741526558257056, "mean_raw_obs_processing_ms": 0.11521002417031286, "mean_inference_ms": 2.301413160582181, "mean_action_processing_ms": 0.056985199447905005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 896000, "timers": {"sample_time_ms": 14650.506, "sample_throughput": 273.028, "learn_time_ms": 16990.638, "learn_throughput": 235.424, "update_time_ms": 3.435}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.7651626765728, "policy_loss": -0.02161827465170063, "vf_loss": 8.783201441168785, "vf_explained_var": 0.3783077597618103, "kl": 0.007448940577887697, "entropy": 0.11272749002091587, "entropy_coeff": 0.0}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 89, "training_iteration": 224, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-47-43", "timestamp": 1618145263, "time_this_iter_s": 32.3712432384491, "time_total_s": 6617.829074859619, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6617.829074859619, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 62.97173913043477, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2166.0, "episode_reward_min": 2166.0, "episode_reward_mean": 2166.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2166.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6773934912167047, "mean_raw_obs_processing_ms": 0.11544719610727193, "mean_inference_ms": 2.3015233960976107, "mean_action_processing_ms": 0.05698594251834905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 900000, "timers": {"sample_time_ms": 14370.527, "sample_throughput": 278.347, "learn_time_ms": 16948.174, "learn_throughput": 236.014, "update_time_ms": 3.541}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 6.931751787662506, "policy_loss": -0.02920322527643293, "vf_loss": 6.957829013466835, "vf_explained_var": 0.4196818470954895, "kl": 0.006504978475277312, "entropy": 0.10426226374693215, "entropy_coeff": 0.0}}, "num_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 90, "training_iteration": 225, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-48-13", "timestamp": 1618145293, "time_this_iter_s": 30.34922695159912, "time_total_s": 6648.178301811218, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6648.178301811218, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 61.66976744186046, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2166.0, "episode_reward_min": 2166.0, "episode_reward_mean": 2166.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2166.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6773934912167047, "mean_raw_obs_processing_ms": 0.11544719610727193, "mean_inference_ms": 2.3015233960976107, "mean_action_processing_ms": 0.05698594251834905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 904000, "timers": {"sample_time_ms": 14392.483, "sample_throughput": 277.923, "learn_time_ms": 16955.56, "learn_throughput": 235.911, "update_time_ms": 3.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 13.39567705988884, "policy_loss": -0.03512956912163645, "vf_loss": 13.426025807857513, "vf_explained_var": 0.49849674105644226, "kl": 0.009948391292709857, "entropy": 0.13692002487368882, "entropy_coeff": 0.0}}, "num_steps_sampled": 904000, "num_steps_trained": 904000}, "done": false, "episodes_total": 90, "training_iteration": 226, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-48-44", "timestamp": 1618145324, "time_this_iter_s": 30.995224475860596, "time_total_s": 6679.173526287079, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6679.173526287079, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 62.12222222222222, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2166.0, "episode_reward_min": 2166.0, "episode_reward_mean": 2166.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2166.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6773934912167047, "mean_raw_obs_processing_ms": 0.11544719610727193, "mean_inference_ms": 2.3015233960976107, "mean_action_processing_ms": 0.05698594251834905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 908000, "timers": {"sample_time_ms": 14467.608, "sample_throughput": 276.48, "learn_time_ms": 17046.806, "learn_throughput": 234.648, "update_time_ms": 3.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 9.693301916122437, "policy_loss": -0.030988145881565288, "vf_loss": 9.720579713582993, "vf_explained_var": 0.4517925977706909, "kl": 0.007721499685430899, "entropy": 0.1120803136145696, "entropy_coeff": 0.0}}, "num_steps_sampled": 908000, "num_steps_trained": 908000}, "done": false, "episodes_total": 90, "training_iteration": 227, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-49-16", "timestamp": 1618145356, "time_this_iter_s": 32.051456928253174, "time_total_s": 6711.224983215332, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6711.224983215332, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 62.58, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1976.0, "episode_reward_min": 1976.0, "episode_reward_mean": 1976.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1976.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6820040416999135, "mean_raw_obs_processing_ms": 0.11581011515363548, "mean_inference_ms": 2.302114373035723, "mean_action_processing_ms": 0.05699858642738142}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 912000, "timers": {"sample_time_ms": 14411.425, "sample_throughput": 277.558, "learn_time_ms": 17004.63, "learn_throughput": 235.23, "update_time_ms": 3.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 11.497386366128922, "policy_loss": -0.03853253769921139, "vf_loss": 11.527783364057541, "vf_explained_var": 0.42873114347457886, "kl": 0.01692980813095346, "entropy": 0.12340748426504433, "entropy_coeff": 0.0}}, "num_steps_sampled": 912000, "num_steps_trained": 912000}, "done": false, "episodes_total": 91, "training_iteration": 228, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-49-48", "timestamp": 1618145388, "time_this_iter_s": 31.731595516204834, "time_total_s": 6742.956578731537, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec0890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6742.956578731537, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 62.07826086956523, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1976.0, "episode_reward_min": 1976.0, "episode_reward_mean": 1976.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1976.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6820040416999135, "mean_raw_obs_processing_ms": 0.11581011515363548, "mean_inference_ms": 2.302114373035723, "mean_action_processing_ms": 0.05699858642738142}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 916000, "timers": {"sample_time_ms": 14591.545, "sample_throughput": 274.131, "learn_time_ms": 16969.016, "learn_throughput": 235.724, "update_time_ms": 3.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.117967188358307, "policy_loss": -0.022715969680575654, "vf_loss": 8.13687638938427, "vf_explained_var": 0.3987616300582886, "kl": 0.007921852869912982, "entropy": 0.10349739354569465, "entropy_coeff": 0.0}}, "num_steps_sampled": 916000, "num_steps_trained": 916000}, "done": false, "episodes_total": 91, "training_iteration": 229, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-50-21", "timestamp": 1618145421, "time_this_iter_s": 32.97112703323364, "time_total_s": 6775.9277057647705, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6775.9277057647705, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 61.512765957446824, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2208.0, "episode_reward_min": 2208.0, "episode_reward_mean": 2208.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2208.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6881028434213067, "mean_raw_obs_processing_ms": 0.11604875073646996, "mean_inference_ms": 2.3022227268576643, "mean_action_processing_ms": 0.05699892690108468}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 920000, "timers": {"sample_time_ms": 14617.394, "sample_throughput": 273.647, "learn_time_ms": 16946.62, "learn_throughput": 236.035, "update_time_ms": 3.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 7.368852213025093, "policy_loss": -0.029083670757245272, "vf_loss": 7.393993943929672, "vf_explained_var": 0.3309595286846161, "kl": 0.008203003802918829, "entropy": 0.1001598087605089, "entropy_coeff": 0.0}}, "num_steps_sampled": 920000, "num_steps_trained": 920000}, "done": false, "episodes_total": 92, "training_iteration": 230, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-50-53", "timestamp": 1618145453, "time_this_iter_s": 31.953125715255737, "time_total_s": 6807.880831480026, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6807.880831480026, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 63.03333333333331, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2208.0, "episode_reward_min": 2208.0, "episode_reward_mean": 2208.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2208.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6881028434213067, "mean_raw_obs_processing_ms": 0.11604875073646996, "mean_inference_ms": 2.3022227268576643, "mean_action_processing_ms": 0.05699892690108468}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 924000, "timers": {"sample_time_ms": 14570.168, "sample_throughput": 274.534, "learn_time_ms": 16986.659, "learn_throughput": 235.479, "update_time_ms": 3.774}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 11.624607652425766, "policy_loss": -0.032397989474702626, "vf_loss": 11.652568757534027, "vf_explained_var": 0.5418365001678467, "kl": 0.009233247474185191, "entropy": 0.1260824422352016, "entropy_coeff": 0.0}}, "num_steps_sampled": 924000, "num_steps_trained": 924000}, "done": false, "episodes_total": 92, "training_iteration": 231, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-51-22", "timestamp": 1618145482, "time_this_iter_s": 29.244858264923096, "time_total_s": 6837.125689744949, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1acd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6837.125689744949, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 62.13095238095238, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2208.0, "episode_reward_min": 2208.0, "episode_reward_mean": 2208.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2208.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6881028434213067, "mean_raw_obs_processing_ms": 0.11604875073646996, "mean_inference_ms": 2.3022227268576643, "mean_action_processing_ms": 0.05699892690108468}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 928000, "timers": {"sample_time_ms": 14438.347, "sample_throughput": 277.04, "learn_time_ms": 17025.765, "learn_throughput": 234.938, "update_time_ms": 3.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 13.892467439174652, "policy_loss": -0.0352701258379966, "vf_loss": 13.923216730356216, "vf_explained_var": 0.6361187696456909, "kl": 0.009407668097992428, "entropy": 0.13748805737122893, "entropy_coeff": 0.0}}, "num_steps_sampled": 928000, "num_steps_trained": 928000}, "done": false, "episodes_total": 92, "training_iteration": 232, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-51-54", "timestamp": 1618145514, "time_this_iter_s": 31.31528067588806, "time_total_s": 6868.440970420837, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6868.440970420837, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 62.086666666666666, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1911.0, "episode_reward_min": 1911.0, "episode_reward_mean": 1911.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1911.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6899964438347232, "mean_raw_obs_processing_ms": 0.11638468013998535, "mean_inference_ms": 2.302214624240161, "mean_action_processing_ms": 0.05700231466041707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 932000, "timers": {"sample_time_ms": 14347.212, "sample_throughput": 278.8, "learn_time_ms": 17068.422, "learn_throughput": 234.351, "update_time_ms": 3.947}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 9.011329740285873, "policy_loss": -0.02780413208529353, "vf_loss": 9.034881249070168, "vf_explained_var": 0.37217122316360474, "kl": 0.00884980232513044, "entropy": 0.11977083701640368, "entropy_coeff": 0.0}}, "num_steps_sampled": 932000, "num_steps_trained": 932000}, "done": false, "episodes_total": 93, "training_iteration": 233, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-52-25", "timestamp": 1618145545, "time_this_iter_s": 31.31372356414795, "time_total_s": 6899.754693984985, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efce50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4f97f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6899.754693984985, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 62.477777777777774, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1911.0, "episode_reward_min": 1911.0, "episode_reward_mean": 1911.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1911.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6899964438347232, "mean_raw_obs_processing_ms": 0.11638468013998535, "mean_inference_ms": 2.302214624240161, "mean_action_processing_ms": 0.05700231466041707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 936000, "timers": {"sample_time_ms": 14371.998, "sample_throughput": 278.319, "learn_time_ms": 16991.698, "learn_throughput": 235.409, "update_time_ms": 3.978}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 9.356630980968475, "policy_loss": -0.023985039326362312, "vf_loss": 9.377243489027023, "vf_explained_var": 0.3176301419734955, "kl": 0.007018129046628019, "entropy": 0.10252070892602205, "entropy_coeff": 0.0}}, "num_steps_sampled": 936000, "num_steps_trained": 936000}, "done": false, "episodes_total": 93, "training_iteration": 234, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-52-57", "timestamp": 1618145577, "time_this_iter_s": 31.85500931739807, "time_total_s": 6931.609703302383, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6abd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6931.609703302383, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 61.8511111111111, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2210.0, "episode_reward_min": 2210.0, "episode_reward_mean": 2210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6943442389582525, "mean_raw_obs_processing_ms": 0.11663540977002058, "mean_inference_ms": 2.302668319841409, "mean_action_processing_ms": 0.05700790498903864}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 940000, "timers": {"sample_time_ms": 14513.45, "sample_throughput": 275.606, "learn_time_ms": 17039.871, "learn_throughput": 234.744, "update_time_ms": 3.955}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.399801075458527, "policy_loss": -0.03745329548837617, "vf_loss": 8.430516421794891, "vf_explained_var": 0.27455011010169983, "kl": 0.014021758455783129, "entropy": 0.11102997418493032, "entropy_coeff": 0.0}}, "num_steps_sampled": 940000, "num_steps_trained": 940000}, "done": false, "episodes_total": 94, "training_iteration": 235, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-53-29", "timestamp": 1618145609, "time_this_iter_s": 32.24120473861694, "time_total_s": 6963.850908041, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1acd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6963.850908041, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 62.30217391304348, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2210.0, "episode_reward_min": 2210.0, "episode_reward_mean": 2210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6943442389582525, "mean_raw_obs_processing_ms": 0.11663540977002058, "mean_inference_ms": 2.302668319841409, "mean_action_processing_ms": 0.05700790498903864}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 944000, "timers": {"sample_time_ms": 14673.642, "sample_throughput": 272.598, "learn_time_ms": 17057.601, "learn_throughput": 234.5, "update_time_ms": 3.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 5.3495888486504555, "policy_loss": -0.022324521793052554, "vf_loss": 5.368480928242207, "vf_explained_var": 0.28409141302108765, "kl": 0.007142809859942645, "entropy": 0.09836479113437235, "entropy_coeff": 0.0}}, "num_steps_sampled": 944000, "num_steps_trained": 944000}, "done": false, "episodes_total": 94, "training_iteration": 236, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-54-02", "timestamp": 1618145642, "time_this_iter_s": 32.781473875045776, "time_total_s": 6996.632381916046, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6996.632381916046, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 61.868085106382985, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2210.0, "episode_reward_min": 2210.0, "episode_reward_mean": 2210.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2210.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6943442389582525, "mean_raw_obs_processing_ms": 0.11663540977002058, "mean_inference_ms": 2.302668319841409, "mean_action_processing_ms": 0.05700790498903864}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 948000, "timers": {"sample_time_ms": 14387.399, "sample_throughput": 278.021, "learn_time_ms": 16975.903, "learn_throughput": 235.628, "update_time_ms": 3.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 5.247197970747948, "policy_loss": -0.022385982214473188, "vf_loss": 5.265503853559494, "vf_explained_var": 0.32726186513900757, "kl": 0.00849067495437339, "entropy": 0.12086785468272865, "entropy_coeff": 0.0}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 94, "training_iteration": 237, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-54-30", "timestamp": 1618145670, "time_this_iter_s": 28.365243673324585, "time_total_s": 7024.997625589371, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7024.997625589371, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 61.947500000000005, "ram_util_percent": 27.6}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2068.0, "episode_reward_min": 2068.0, "episode_reward_mean": 2068.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2068.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6976386040428136, "mean_raw_obs_processing_ms": 0.11701344948105973, "mean_inference_ms": 2.3029588565331687, "mean_action_processing_ms": 0.05701686425718394}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 952000, "timers": {"sample_time_ms": 14407.224, "sample_throughput": 277.638, "learn_time_ms": 16961.258, "learn_throughput": 235.832, "update_time_ms": 3.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.436582162976265, "policy_loss": -0.03572235052706674, "vf_loss": 8.467788249254227, "vf_explained_var": 0.37248560786247253, "kl": 0.009398194873938337, "entropy": 0.11082326713949442, "entropy_coeff": 0.0}}, "num_steps_sampled": 952000, "num_steps_trained": 952000}, "done": false, "episodes_total": 95, "training_iteration": 238, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-55-02", "timestamp": 1618145702, "time_this_iter_s": 31.784969091415405, "time_total_s": 7056.782594680786, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7056.782594680786, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 62.728260869565226, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2068.0, "episode_reward_min": 2068.0, "episode_reward_mean": 2068.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2068.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6976386040428136, "mean_raw_obs_processing_ms": 0.11701344948105973, "mean_inference_ms": 2.3029588565331687, "mean_action_processing_ms": 0.05701686425718394}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 956000, "timers": {"sample_time_ms": 13974.648, "sample_throughput": 286.233, "learn_time_ms": 17026.754, "learn_throughput": 234.924, "update_time_ms": 3.947}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 13.716804444789886, "policy_loss": -0.087775336811319, "vf_loss": 13.764974474906921, "vf_explained_var": 0.7019023299217224, "kl": 0.08241764036938548, "entropy": 0.24660007329657674, "entropy_coeff": 0.0}}, "num_steps_sampled": 956000, "num_steps_trained": 956000}, "done": false, "episodes_total": 95, "training_iteration": 239, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-55-31", "timestamp": 1618145731, "time_this_iter_s": 29.299007415771484, "time_total_s": 7086.081602096558, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7086.081602096558, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 62.44047619047619, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1794.0, "episode_reward_min": 1794.0, "episode_reward_mean": 1794.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1794.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6959853380486153, "mean_raw_obs_processing_ms": 0.11724903514531824, "mean_inference_ms": 2.3035301281249447, "mean_action_processing_ms": 0.057029040108836936}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 960000, "timers": {"sample_time_ms": 13749.416, "sample_throughput": 290.921, "learn_time_ms": 17082.463, "learn_throughput": 234.158, "update_time_ms": 3.999}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 12.718131214380264, "policy_loss": -0.03055479223257862, "vf_loss": 12.742651611566544, "vf_explained_var": 0.3638051748275757, "kl": 0.008371742413146421, "entropy": 0.1132013713940978, "entropy_coeff": 0.0}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 96, "training_iteration": 240, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-56-02", "timestamp": 1618145762, "time_this_iter_s": 30.264661073684692, "time_total_s": 7116.346263170242, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6abd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7116.346263170242, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 62.665116279069764, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1794.0, "episode_reward_min": 1794.0, "episode_reward_mean": 1794.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1794.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6959853380486153, "mean_raw_obs_processing_ms": 0.11724903514531824, "mean_inference_ms": 2.3035301281249447, "mean_action_processing_ms": 0.057029040108836936}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 964000, "timers": {"sample_time_ms": 13903.816, "sample_throughput": 287.691, "learn_time_ms": 17113.781, "learn_throughput": 233.73, "update_time_ms": 4.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 11.388938874006271, "policy_loss": -0.019362533057574183, "vf_loss": 11.40358167886734, "vf_explained_var": 0.5137225389480591, "kl": 0.006547500372107606, "entropy": 0.11148410721216351, "entropy_coeff": 0.0}}, "num_steps_sampled": 964000, "num_steps_trained": 964000}, "done": false, "episodes_total": 96, "training_iteration": 241, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-56-33", "timestamp": 1618145793, "time_this_iter_s": 31.09893250465393, "time_total_s": 7147.445195674896, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6af10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7147.445195674896, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 61.76363636363636, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1794.0, "episode_reward_min": 1794.0, "episode_reward_mean": 1794.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1794.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6959853380486153, "mean_raw_obs_processing_ms": 0.11724903514531824, "mean_inference_ms": 2.3035301281249447, "mean_action_processing_ms": 0.057029040108836936}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 968000, "timers": {"sample_time_ms": 14146.665, "sample_throughput": 282.752, "learn_time_ms": 17076.636, "learn_throughput": 234.238, "update_time_ms": 4.06}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 5.989341959357262, "policy_loss": -0.022512690571602434, "vf_loss": 6.007880717515945, "vf_explained_var": 0.312651127576828, "kl": 0.005513195486855693, "entropy": 0.09020282188430429, "entropy_coeff": 0.0}}, "num_steps_sampled": 968000, "num_steps_trained": 968000}, "done": false, "episodes_total": 96, "training_iteration": 242, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-57-06", "timestamp": 1618145826, "time_this_iter_s": 33.37028384208679, "time_total_s": 7180.815479516983, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47330d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edab90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7180.815479516983, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 62.864583333333336, "ram_util_percent": 27.602083333333336}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2236.0, "episode_reward_min": 2236.0, "episode_reward_mean": 2236.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2236.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7040685569608248, "mean_raw_obs_processing_ms": 0.11762722643207955, "mean_inference_ms": 2.3042191201778417, "mean_action_processing_ms": 0.05704079850552765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 972000, "timers": {"sample_time_ms": 14445.612, "sample_throughput": 276.901, "learn_time_ms": 17033.091, "learn_throughput": 234.837, "update_time_ms": 4.007}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 5.52398194372654, "policy_loss": -0.02633836562745273, "vf_loss": 5.545272469520569, "vf_explained_var": 0.20075762271881104, "kl": 0.007003114282269962, "entropy": 0.09122829930856824, "entropy_coeff": 0.0}}, "num_steps_sampled": 972000, "num_steps_trained": 972000}, "done": false, "episodes_total": 97, "training_iteration": 243, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-57-40", "timestamp": 1618145860, "time_this_iter_s": 33.86754369735718, "time_total_s": 7214.68302321434, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7214.68302321434, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 62.116666666666674, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2236.0, "episode_reward_min": 2236.0, "episode_reward_mean": 2236.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2236.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7040685569608248, "mean_raw_obs_processing_ms": 0.11762722643207955, "mean_inference_ms": 2.3042191201778417, "mean_action_processing_ms": 0.05704079850552765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 976000, "timers": {"sample_time_ms": 14708.561, "sample_throughput": 271.95, "learn_time_ms": 17071.473, "learn_throughput": 234.309, "update_time_ms": 3.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 3.240064926445484, "policy_loss": -0.02688284611213021, "vf_loss": 3.2623759359121323, "vf_explained_var": 0.2312488555908203, "kl": 0.006342613807646558, "entropy": 0.09048070665448904, "entropy_coeff": 0.0}}, "num_steps_sampled": 976000, "num_steps_trained": 976000}, "done": false, "episodes_total": 97, "training_iteration": 244, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-58-15", "timestamp": 1618145895, "time_this_iter_s": 34.863216161727905, "time_total_s": 7249.546239376068, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda0d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7249.546239376068, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 62.016000000000005, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2374.0, "episode_reward_min": 2374.0, "episode_reward_mean": 2374.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2374.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7096574735838101, "mean_raw_obs_processing_ms": 0.11789070551019355, "mean_inference_ms": 2.304837722634763, "mean_action_processing_ms": 0.057048705334660235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 980000, "timers": {"sample_time_ms": 14619.087, "sample_throughput": 273.615, "learn_time_ms": 17086.742, "learn_throughput": 234.1, "update_time_ms": 3.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 4.721506118774414, "policy_loss": -0.02939470752608031, "vf_loss": 4.744995661079884, "vf_explained_var": 0.286442369222641, "kl": 0.008192374792997725, "entropy": 0.10635922593064606, "entropy_coeff": 0.0}}, "num_steps_sampled": 980000, "num_steps_trained": 980000}, "done": false, "episodes_total": 98, "training_iteration": 245, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-58-47", "timestamp": 1618145927, "time_this_iter_s": 31.498473405838013, "time_total_s": 7281.044712781906, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f192d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f105d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7281.044712781906, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 62.973333333333336, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2374.0, "episode_reward_min": 2374.0, "episode_reward_mean": 2374.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2374.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7096574735838101, "mean_raw_obs_processing_ms": 0.11789070551019355, "mean_inference_ms": 2.304837722634763, "mean_action_processing_ms": 0.057048705334660235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 984000, "timers": {"sample_time_ms": 14568.763, "sample_throughput": 274.56, "learn_time_ms": 17098.972, "learn_throughput": 233.932, "update_time_ms": 3.794}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 6.931170091032982, "policy_loss": -0.025376669073011726, "vf_loss": 6.951998680830002, "vf_explained_var": 0.45927807688713074, "kl": 0.0063096326412050985, "entropy": 0.1075661201030016, "entropy_coeff": 0.0}}, "num_steps_sampled": 984000, "num_steps_trained": 984000}, "done": false, "episodes_total": 98, "training_iteration": 246, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-59-19", "timestamp": 1618145959, "time_this_iter_s": 32.390610694885254, "time_total_s": 7313.435323476791, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7313.435323476791, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 61.4063829787234, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2374.0, "episode_reward_min": 2374.0, "episode_reward_mean": 2374.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2374.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7096574735838101, "mean_raw_obs_processing_ms": 0.11789070551019355, "mean_inference_ms": 2.304837722634763, "mean_action_processing_ms": 0.057048705334660235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 988000, "timers": {"sample_time_ms": 14873.795, "sample_throughput": 268.929, "learn_time_ms": 17116.019, "learn_throughput": 233.699, "update_time_ms": 3.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 6.157249808311462, "policy_loss": -0.028133048705058172, "vf_loss": 6.180703207850456, "vf_explained_var": 0.2596147060394287, "kl": 0.006492322216217872, "entropy": 0.0980160275939852, "entropy_coeff": 0.0}}, "num_steps_sampled": 988000, "num_steps_trained": 988000}, "done": false, "episodes_total": 98, "training_iteration": 247, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_12-59-51", "timestamp": 1618145991, "time_this_iter_s": 31.58836317062378, "time_total_s": 7345.023686647415, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e17f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7345.023686647415, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 63.155555555555566, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2322.0, "episode_reward_min": 2322.0, "episode_reward_mean": 2322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7126198521678736, "mean_raw_obs_processing_ms": 0.11825306978213124, "mean_inference_ms": 2.305028574363222, "mean_action_processing_ms": 0.057056996535296216}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 992000, "timers": {"sample_time_ms": 14611.771, "sample_throughput": 273.752, "learn_time_ms": 17138.5, "learn_throughput": 233.393, "update_time_ms": 3.832}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 11.530555665493011, "policy_loss": -0.03451222868170589, "vf_loss": 11.559059411287308, "vf_explained_var": 0.6319185495376587, "kl": 0.008335548816830851, "entropy": 0.13483907119370997, "entropy_coeff": 0.0}}, "num_steps_sampled": 992000, "num_steps_trained": 992000}, "done": false, "episodes_total": 99, "training_iteration": 248, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-00-20", "timestamp": 1618146020, "time_this_iter_s": 29.384518146514893, "time_total_s": 7374.40820479393, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e12cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e12910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7374.40820479393, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 62.73809523809524, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 2322.0, "episode_reward_min": 2322.0, "episode_reward_mean": 2322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7126198521678736, "mean_raw_obs_processing_ms": 0.11825306978213124, "mean_inference_ms": 2.305028574363222, "mean_action_processing_ms": 0.057056996535296216}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 996000, "timers": {"sample_time_ms": 14664.878, "sample_throughput": 272.761, "learn_time_ms": 17095.957, "learn_throughput": 233.973, "update_time_ms": 3.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 12.52033807337284, "policy_loss": -0.03734967636410147, "vf_loss": 12.551463812589645, "vf_explained_var": 0.6475800275802612, "kl": 0.008634452009573579, "entropy": 0.15807678643614054, "entropy_coeff": 0.0}}, "num_steps_sampled": 996000, "num_steps_trained": 996000}, "done": false, "episodes_total": 99, "training_iteration": 249, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-00-50", "timestamp": 1618146050, "time_this_iter_s": 29.405943155288696, "time_total_s": 7403.814147949219, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d732d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7403.814147949219, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 62.79761904761905, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1566.0, "episode_reward_min": 1566.0, "episode_reward_mean": 1566.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1566.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.710044206824003, "mean_raw_obs_processing_ms": 0.11849321198545622, "mean_inference_ms": 2.3052851219018438, "mean_action_processing_ms": 0.05706289569398602}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1000000, "timers": {"sample_time_ms": 14498.042, "sample_throughput": 275.899, "learn_time_ms": 17029.946, "learn_throughput": 234.88, "update_time_ms": 3.807}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 13.867031902074814, "policy_loss": -0.03845457898569293, "vf_loss": 13.900763094425201, "vf_explained_var": 0.42835766077041626, "kl": 0.006552863043907564, "entropy": 0.18037286261096597, "entropy_coeff": 0.0}}, "num_steps_sampled": 1000000, "num_steps_trained": 1000000}, "done": false, "episodes_total": 100, "training_iteration": 250, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-01-18", "timestamp": 1618146078, "time_this_iter_s": 27.930413722991943, "time_total_s": 7431.744561672211, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b47338d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7431.744561672211, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 61.76410256410256, "ram_util_percent": 27.6}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1566.0, "episode_reward_min": 1566.0, "episode_reward_mean": 1566.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1566.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.710044206824003, "mean_raw_obs_processing_ms": 0.11849321198545622, "mean_inference_ms": 2.3052851219018438, "mean_action_processing_ms": 0.05706289569398602}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1004000, "timers": {"sample_time_ms": 14483.996, "sample_throughput": 276.167, "learn_time_ms": 17040.2, "learn_throughput": 234.739, "update_time_ms": 3.579}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 216.33267736434937, "policy_loss": -0.029014445608481765, "vf_loss": 216.35574769973755, "vf_explained_var": -0.2908374071121216, "kl": 0.008249768754467368, "entropy": 0.13753763167187572, "entropy_coeff": 0.0}}, "num_steps_sampled": 1004000, "num_steps_trained": 1004000}, "done": false, "episodes_total": 100, "training_iteration": 251, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-01-49", "timestamp": 1618146109, "time_this_iter_s": 31.058733463287354, "time_total_s": 7462.803295135498, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efcfd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e17650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7462.803295135498, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 62.83777777777777, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1566.0, "episode_reward_min": 1566.0, "episode_reward_mean": 1566.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1566.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.710044206824003, "mean_raw_obs_processing_ms": 0.11849321198545622, "mean_inference_ms": 2.3052851219018438, "mean_action_processing_ms": 0.05706289569398602}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1008000, "timers": {"sample_time_ms": 14058.34, "sample_throughput": 284.529, "learn_time_ms": 17061.089, "learn_throughput": 234.452, "update_time_ms": 3.475}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 113.13481330871582, "policy_loss": -0.03323711268603802, "vf_loss": 113.1634464263916, "vf_explained_var": -0.12137892097234726, "kl": 0.006388566522218753, "entropy": 0.10288990871049464, "entropy_coeff": 0.0}}, "num_steps_sampled": 1008000, "num_steps_trained": 1008000}, "done": false, "episodes_total": 100, "training_iteration": 252, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-02-18", "timestamp": 1618146138, "time_this_iter_s": 29.316768884658813, "time_total_s": 7492.120064020157, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f105d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7492.120064020157, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 62.34761904761905, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1939.0, "episode_reward_min": -1939.0, "episode_reward_mean": -1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7082912689167279, "mean_raw_obs_processing_ms": 0.11884032232195038, "mean_inference_ms": 2.30542153010756, "mean_action_processing_ms": 0.057071016152105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1012000, "timers": {"sample_time_ms": 13499.427, "sample_throughput": 296.309, "learn_time_ms": 17126.377, "learn_throughput": 233.558, "update_time_ms": 3.47}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 23.58756822347641, "policy_loss": -0.03187416875152849, "vf_loss": 23.614571928977966, "vf_explained_var": 0.13053807616233826, "kl": 0.006757248564099427, "entropy": 0.12026414833962917, "entropy_coeff": 0.0}}, "num_steps_sampled": 1012000, "num_steps_trained": 1012000}, "done": false, "episodes_total": 101, "training_iteration": 253, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-02-47", "timestamp": 1618146167, "time_this_iter_s": 28.932119131088257, "time_total_s": 7521.052183151245, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e17690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7521.052183151245, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 62.5609756097561, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1939.0, "episode_reward_min": -1939.0, "episode_reward_mean": -1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7082912689167279, "mean_raw_obs_processing_ms": 0.11884032232195038, "mean_inference_ms": 2.30542153010756, "mean_action_processing_ms": 0.057071016152105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1016000, "timers": {"sample_time_ms": 13014.843, "sample_throughput": 307.341, "learn_time_ms": 17150.453, "learn_throughput": 233.23, "update_time_ms": 3.408}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 13.197335749864578, "policy_loss": -0.022241961996769533, "vf_loss": 13.215403705835342, "vf_explained_var": 0.22348690032958984, "kl": 0.0057904622372007, "entropy": 0.10197922750376165, "entropy_coeff": 0.0}}, "num_steps_sampled": 1016000, "num_steps_trained": 1016000}, "done": false, "episodes_total": 101, "training_iteration": 254, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-03-17", "timestamp": 1618146197, "time_this_iter_s": 30.2573344707489, "time_total_s": 7551.309517621994, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e12a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7551.309517621994, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 62.11860465116279, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1904.0, "episode_reward_min": -1904.0, "episode_reward_mean": -1904.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1904.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7073005574278838, "mean_raw_obs_processing_ms": 0.11909131524488507, "mean_inference_ms": 2.3060175154399665, "mean_action_processing_ms": 0.05708308864485352}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1020000, "timers": {"sample_time_ms": 12856.192, "sample_throughput": 311.134, "learn_time_ms": 17172.302, "learn_throughput": 232.933, "update_time_ms": 3.458}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 9.810327410697937, "policy_loss": -0.013184086186811328, "vf_loss": 9.819330111145973, "vf_explained_var": 0.5890336036682129, "kl": 0.005800900122267194, "entropy": 0.10920254304073751, "entropy_coeff": 0.0}}, "num_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 102, "training_iteration": 255, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-03-47", "timestamp": 1618146227, "time_this_iter_s": 30.12943196296692, "time_total_s": 7581.438949584961, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7581.438949584961, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 62.24883720930232, "ram_util_percent": 27.67441860465117}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1904.0, "episode_reward_min": -1904.0, "episode_reward_mean": -1904.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1904.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7073005574278838, "mean_raw_obs_processing_ms": 0.11909131524488507, "mean_inference_ms": 2.3060175154399665, "mean_action_processing_ms": 0.05708308864485352}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1024000, "timers": {"sample_time_ms": 12513.88, "sample_throughput": 319.645, "learn_time_ms": 17098.709, "learn_throughput": 233.936, "update_time_ms": 3.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 11.770174741744995, "policy_loss": -0.017511465412098914, "vf_loss": 11.782356768846512, "vf_explained_var": 0.5742095708847046, "kl": 0.007393449937808327, "entropy": 0.12129591754637659, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 102, "training_iteration": 256, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-04-16", "timestamp": 1618146256, "time_this_iter_s": 28.23065185546875, "time_total_s": 7609.66960144043, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fa50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7609.66960144043, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 62.16097560975609, "ram_util_percent": 27.69756097560976}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1904.0, "episode_reward_min": -1904.0, "episode_reward_mean": -1904.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1904.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7073005574278838, "mean_raw_obs_processing_ms": 0.11909131524488507, "mean_inference_ms": 2.3060175154399665, "mean_action_processing_ms": 0.05708308864485352}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1028000, "timers": {"sample_time_ms": 12306.824, "sample_throughput": 325.023, "learn_time_ms": 17135.422, "learn_throughput": 233.435, "update_time_ms": 3.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 9.699580729007721, "policy_loss": -0.0255527054250706, "vf_loss": 9.719407573342323, "vf_explained_var": 0.5139679908752441, "kl": 0.007943680480821058, "entropy": 0.1340405074879527, "entropy_coeff": 0.0}}, "num_steps_sampled": 1028000, "num_steps_trained": 1028000}, "done": false, "episodes_total": 102, "training_iteration": 257, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-04-46", "timestamp": 1618146286, "time_this_iter_s": 29.885989665985107, "time_total_s": 7639.555591106415, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b31c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7639.555591106415, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 62.40952380952382, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1933.0, "episode_reward_min": -1933.0, "episode_reward_mean": -1933.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1933.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7061274710752067, "mean_raw_obs_processing_ms": 0.11947108860670484, "mean_inference_ms": 2.306516488339704, "mean_action_processing_ms": 0.057092781569495196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1032000, "timers": {"sample_time_ms": 12477.634, "sample_throughput": 320.574, "learn_time_ms": 17199.805, "learn_throughput": 232.561, "update_time_ms": 3.743}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 6.80953224003315, "policy_loss": -0.02772226626984775, "vf_loss": 6.832044497132301, "vf_explained_var": 0.21529969573020935, "kl": 0.007228001006296836, "entropy": 0.11189655982889235, "entropy_coeff": 0.0}}, "num_steps_sampled": 1032000, "num_steps_trained": 1032000}, "done": false, "episodes_total": 103, "training_iteration": 258, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-05-17", "timestamp": 1618146317, "time_this_iter_s": 31.738402128219604, "time_total_s": 7671.293993234634, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7671.293993234634, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 62.43695652173914, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1933.0, "episode_reward_min": -1933.0, "episode_reward_mean": -1933.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1933.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7061274710752067, "mean_raw_obs_processing_ms": 0.11947108860670484, "mean_inference_ms": 2.306516488339704, "mean_action_processing_ms": 0.057092781569495196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1036000, "timers": {"sample_time_ms": 12756.712, "sample_throughput": 313.56, "learn_time_ms": 17137.606, "learn_throughput": 233.405, "update_time_ms": 3.727}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 7.739762112498283, "policy_loss": -0.027697049430571496, "vf_loss": 7.762810200452805, "vf_explained_var": 0.3108437657356262, "kl": 0.006449687120039016, "entropy": 0.11248426605015993, "entropy_coeff": 0.0}}, "num_steps_sampled": 1036000, "num_steps_trained": 1036000}, "done": false, "episodes_total": 103, "training_iteration": 259, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-05-49", "timestamp": 1618146349, "time_this_iter_s": 31.570078372955322, "time_total_s": 7702.86407160759, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7702.86407160759, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 61.63333333333333, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1934.0, "episode_reward_min": -1934.0, "episode_reward_mean": -1934.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1934.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7092239142150374, "mean_raw_obs_processing_ms": 0.1197209110292343, "mean_inference_ms": 2.3069064589952073, "mean_action_processing_ms": 0.057102540248767}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1040000, "timers": {"sample_time_ms": 13071.681, "sample_throughput": 306.005, "learn_time_ms": 17151.029, "learn_throughput": 233.222, "update_time_ms": 3.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 11.285363018512726, "policy_loss": -0.024345720012206584, "vf_loss": 11.304818987846375, "vf_explained_var": 0.41061675548553467, "kl": 0.006783629301935434, "entropy": 0.1291166429873556, "entropy_coeff": 0.0}}, "num_steps_sampled": 1040000, "num_steps_trained": 1040000}, "done": false, "episodes_total": 104, "training_iteration": 260, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-06-20", "timestamp": 1618146380, "time_this_iter_s": 31.213316202163696, "time_total_s": 7734.077387809753, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7734.077387809753, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 62.46818181818182, "ram_util_percent": 27.602272727272716}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1934.0, "episode_reward_min": -1934.0, "episode_reward_mean": -1934.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1934.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7092239142150374, "mean_raw_obs_processing_ms": 0.1197209110292343, "mean_inference_ms": 2.3069064589952073, "mean_action_processing_ms": 0.057102540248767}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1044000, "timers": {"sample_time_ms": 12893.109, "sample_throughput": 310.243, "learn_time_ms": 17208.763, "learn_throughput": 232.44, "update_time_ms": 3.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 14.208736300468445, "policy_loss": -0.03010683471802622, "vf_loss": 14.233415752649307, "vf_explained_var": 0.3933795690536499, "kl": 0.0075296373761375435, "entropy": 0.14587324298918247, "entropy_coeff": 0.0}}, "num_steps_sampled": 1044000, "num_steps_trained": 1044000}, "done": false, "episodes_total": 104, "training_iteration": 261, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-06-50", "timestamp": 1618146410, "time_this_iter_s": 29.856090307235718, "time_total_s": 7763.933478116989, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edae10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7763.933478116989, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 63.0720930232558, "ram_util_percent": 27.632558139534876}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1934.0, "episode_reward_min": -1934.0, "episode_reward_mean": -1934.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1934.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7092239142150374, "mean_raw_obs_processing_ms": 0.1197209110292343, "mean_inference_ms": 2.3069064589952073, "mean_action_processing_ms": 0.057102540248767}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1048000, "timers": {"sample_time_ms": 12989.434, "sample_throughput": 307.943, "learn_time_ms": 17170.669, "learn_throughput": 232.955, "update_time_ms": 3.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 10.313958406448364, "policy_loss": -0.02689053531503305, "vf_loss": 10.335433572530746, "vf_explained_var": 0.3900802433490753, "kl": 0.007512868513003923, "entropy": 0.13213736936450005, "entropy_coeff": 0.0}}, "num_steps_sampled": 1048000, "num_steps_trained": 1048000}, "done": false, "episodes_total": 104, "training_iteration": 262, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-07-20", "timestamp": 1618146440, "time_this_iter_s": 29.904271364212036, "time_total_s": 7793.837749481201, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e013d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7793.837749481201, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 62.204651162790704, "ram_util_percent": 27.672093023255822}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1850.0, "episode_reward_min": -1850.0, "episode_reward_mean": -1850.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1850.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7108460373515009, "mean_raw_obs_processing_ms": 0.1200569699120093, "mean_inference_ms": 2.3066239511826048, "mean_action_processing_ms": 0.057099960717277014}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1052000, "timers": {"sample_time_ms": 13378.293, "sample_throughput": 298.992, "learn_time_ms": 17109.337, "learn_throughput": 233.79, "update_time_ms": 3.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 8.465676292777061, "policy_loss": -0.03330398636171594, "vf_loss": 8.494325459003448, "vf_explained_var": 0.33865347504615784, "kl": 0.006457780778873712, "entropy": 0.11750532523728907, "entropy_coeff": 0.0}}, "num_steps_sampled": 1052000, "num_steps_trained": 1052000}, "done": false, "episodes_total": 105, "training_iteration": 263, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-07-52", "timestamp": 1618146472, "time_this_iter_s": 32.212424993515015, "time_total_s": 7826.050174474716, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edaed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7826.050174474716, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 62.08695652173913, "ram_util_percent": 27.700000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1850.0, "episode_reward_min": -1850.0, "episode_reward_mean": -1850.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1850.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7108460373515009, "mean_raw_obs_processing_ms": 0.1200569699120093, "mean_inference_ms": 2.3066239511826048, "mean_action_processing_ms": 0.057099960717277014}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1056000, "timers": {"sample_time_ms": 13379.308, "sample_throughput": 298.969, "learn_time_ms": 17068.249, "learn_throughput": 234.353, "update_time_ms": 4.161}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 14.369888573884964, "policy_loss": -0.03083111449086573, "vf_loss": 14.395541101694107, "vf_explained_var": 0.41684389114379883, "kl": 0.007184158072050195, "entropy": 0.1404865444637835, "entropy_coeff": 0.0}}, "num_steps_sampled": 1056000, "num_steps_trained": 1056000}, "done": false, "episodes_total": 105, "training_iteration": 264, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-08-22", "timestamp": 1618146502, "time_this_iter_s": 29.858246088027954, "time_total_s": 7855.908420562744, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d92250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7855.908420562744, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 62.61428571428572, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1864.0, "episode_reward_min": -1864.0, "episode_reward_mean": -1864.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1864.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7112757043328978, "mean_raw_obs_processing_ms": 0.12028031720480478, "mean_inference_ms": 2.3063902189817695, "mean_action_processing_ms": 0.05710413826813888}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1060000, "timers": {"sample_time_ms": 13440.332, "sample_throughput": 297.612, "learn_time_ms": 17044.352, "learn_throughput": 234.682, "update_time_ms": 4.077}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 12.850046753883362, "policy_loss": -0.027324264752678573, "vf_loss": 12.872012048959732, "vf_explained_var": 0.5530416965484619, "kl": 0.007434878571075387, "entropy": 0.1344076346140355, "entropy_coeff": 0.0}}, "num_steps_sampled": 1060000, "num_steps_trained": 1060000}, "done": false, "episodes_total": 106, "training_iteration": 265, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-08-53", "timestamp": 1618146533, "time_this_iter_s": 30.502795457839966, "time_total_s": 7886.411216020584, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7886.411216020584, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 61.98863636363637, "ram_util_percent": 27.602272727272716}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1864.0, "episode_reward_min": -1864.0, "episode_reward_mean": -1864.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1864.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7112757043328978, "mean_raw_obs_processing_ms": 0.12028031720480478, "mean_inference_ms": 2.3063902189817695, "mean_action_processing_ms": 0.05710413826813888}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1064000, "timers": {"sample_time_ms": 13809.294, "sample_throughput": 289.66, "learn_time_ms": 17141.364, "learn_throughput": 233.354, "update_time_ms": 4.035}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 12.775448083877563, "policy_loss": -0.018110131029970944, "vf_loss": 12.788856416940689, "vf_explained_var": 0.6087088584899902, "kl": 0.006522830430185422, "entropy": 0.1168240518309176, "entropy_coeff": 0.0}}, "num_steps_sampled": 1064000, "num_steps_trained": 1064000}, "done": false, "episodes_total": 106, "training_iteration": 266, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-09-26", "timestamp": 1618146566, "time_this_iter_s": 32.89258909225464, "time_total_s": 7919.303805112839, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e116d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e11bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7919.303805112839, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 63.02553191489361, "ram_util_percent": 27.599999999999987}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1864.0, "episode_reward_min": -1864.0, "episode_reward_mean": -1864.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1864.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7112757043328978, "mean_raw_obs_processing_ms": 0.12028031720480478, "mean_inference_ms": 2.3063902189817695, "mean_action_processing_ms": 0.05710413826813888}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1068000, "timers": {"sample_time_ms": 14030.099, "sample_throughput": 285.101, "learn_time_ms": 17138.326, "learn_throughput": 233.395, "update_time_ms": 3.86}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 9.255156248807907, "policy_loss": -0.031154201366007328, "vf_loss": 9.279641792178154, "vf_explained_var": 0.3375665247440338, "kl": 0.009251700772438198, "entropy": 0.16117190988734365, "entropy_coeff": 0.0}}, "num_steps_sampled": 1068000, "num_steps_trained": 1068000}, "done": false, "episodes_total": 106, "training_iteration": 267, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-09-58", "timestamp": 1618146598, "time_this_iter_s": 32.06038808822632, "time_total_s": 7951.364193201065, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eafb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7951.364193201065, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 62.02826086956521, "ram_util_percent": 27.602173913043465}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1826.0, "episode_reward_min": -1826.0, "episode_reward_mean": -1826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7139414360969322, "mean_raw_obs_processing_ms": 0.12065848951055372, "mean_inference_ms": 2.3070411171860243, "mean_action_processing_ms": 0.057122834006678884}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1072000, "timers": {"sample_time_ms": 13875.101, "sample_throughput": 288.286, "learn_time_ms": 17094.941, "learn_throughput": 233.987, "update_time_ms": 3.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 12.858870536088943, "policy_loss": -0.02884403889765963, "vf_loss": 12.88209554553032, "vf_explained_var": 0.7381902933120728, "kl": 0.007795714671374299, "entropy": 0.1204300430836156, "entropy_coeff": 0.0}}, "num_steps_sampled": 1072000, "num_steps_trained": 1072000}, "done": false, "episodes_total": 107, "training_iteration": 268, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-10-28", "timestamp": 1618146628, "time_this_iter_s": 29.75752854347229, "time_total_s": 7981.121721744537, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7981.121721744537, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 62.85000000000001, "ram_util_percent": 27.602380952380948}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1826.0, "episode_reward_min": -1826.0, "episode_reward_mean": -1826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7139414360969322, "mean_raw_obs_processing_ms": 0.12065848951055372, "mean_inference_ms": 2.3070411171860243, "mean_action_processing_ms": 0.057122834006678884}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1076000, "timers": {"sample_time_ms": 13725.075, "sample_throughput": 291.437, "learn_time_ms": 17177.216, "learn_throughput": 232.867, "update_time_ms": 4.347}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 15.017275929450989, "policy_loss": -0.032159779919311404, "vf_loss": 15.04288986325264, "vf_explained_var": 0.6004316806793213, "kl": 0.009081158947083168, "entropy": 0.17482881154865026, "entropy_coeff": 0.0}}, "num_steps_sampled": 1076000, "num_steps_trained": 1076000}, "done": false, "episodes_total": 107, "training_iteration": 269, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-10-59", "timestamp": 1618146659, "time_this_iter_s": 30.903513193130493, "time_total_s": 8012.025234937668, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47337d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8012.025234937668, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 62.179545454545455, "ram_util_percent": 27.606818181818177}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -574.0, "episode_reward_min": -574.0, "episode_reward_mean": -574.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7124499232169516, "mean_raw_obs_processing_ms": 0.12090302261952307, "mean_inference_ms": 2.3072681311360217, "mean_action_processing_ms": 0.05712872752100221}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1080000, "timers": {"sample_time_ms": 13383.971, "sample_throughput": 298.865, "learn_time_ms": 17183.969, "learn_throughput": 232.775, "update_time_ms": 4.314}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 3.4251151382923126, "policy_loss": -0.0075023215904366225, "vf_loss": 3.432574488222599, "vf_explained_var": -0.009809218347072601, "kl": 5.95816445922992e-05, "entropy": 0.003758491817279719, "entropy_coeff": 0.0}}, "num_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 108, "training_iteration": 270, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-11-27", "timestamp": 1618146687, "time_this_iter_s": 27.87408709526062, "time_total_s": 8039.8993220329285, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8039.8993220329285, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 62.75250000000001, "ram_util_percent": 27.6875}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -574.0, "episode_reward_min": -574.0, "episode_reward_mean": -574.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7124499232169516, "mean_raw_obs_processing_ms": 0.12090302261952307, "mean_inference_ms": 2.3072681311360217, "mean_action_processing_ms": 0.05712872752100221}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1084000, "timers": {"sample_time_ms": 13287.086, "sample_throughput": 301.044, "learn_time_ms": 17081.277, "learn_throughput": 234.175, "update_time_ms": 4.245}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.36040649414062503, "cur_lr": 5e-05, "total_loss": 0.6197601333260536, "policy_loss": 0.003029329818673432, "vf_loss": 0.6167307589203119, "vf_explained_var": -0.00044512003660202026, "kl": 1.2147814261453949e-07, "entropy": 0.004031282674986869, "entropy_coeff": 0.0}}, "num_steps_sampled": 1084000, "num_steps_trained": 1084000}, "done": false, "episodes_total": 108, "training_iteration": 271, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-11-54", "timestamp": 1618146714, "time_this_iter_s": 27.856571912765503, "time_total_s": 8067.755893945694, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8067.755893945694, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 62.86500000000001, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -574.0, "episode_reward_min": -574.0, "episode_reward_mean": -574.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7124499232169516, "mean_raw_obs_processing_ms": 0.12090302261952307, "mean_inference_ms": 2.3072681311360217, "mean_action_processing_ms": 0.05712872752100221}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1088000, "timers": {"sample_time_ms": 13385.723, "sample_throughput": 298.826, "learn_time_ms": 17097.333, "learn_throughput": 233.955, "update_time_ms": 4.189}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.18020324707031252, "cur_lr": 5e-05, "total_loss": 10.524979412555695, "policy_loss": -0.04310964437900111, "vf_loss": 10.565047770738602, "vf_explained_var": 0.5968039035797119, "kl": 0.0168765279231593, "entropy": 0.18329079868271947, "entropy_coeff": 0.0}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 108, "training_iteration": 272, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-12-26", "timestamp": 1618146746, "time_this_iter_s": 31.057045698165894, "time_total_s": 8098.81293964386, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d92650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8098.81293964386, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 62.16363636363636, "ram_util_percent": 27.693181818181817}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1043.0, "episode_reward_min": -1043.0, "episode_reward_mean": -1043.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1043.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7107102975882358, "mean_raw_obs_processing_ms": 0.12125168559175056, "mean_inference_ms": 2.307649929884735, "mean_action_processing_ms": 0.05713249156085609}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1092000, "timers": {"sample_time_ms": 13103.991, "sample_throughput": 305.251, "learn_time_ms": 17136.937, "learn_throughput": 233.414, "update_time_ms": 3.961}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.18020324707031252, "cur_lr": 5e-05, "total_loss": 9.655965819954872, "policy_loss": -0.043487954419106245, "vf_loss": 9.696062862873077, "vf_explained_var": 0.3312808871269226, "kl": 0.018816938856616616, "entropy": 0.22281440580263734, "entropy_coeff": 0.0}}, "num_steps_sampled": 1092000, "num_steps_trained": 1092000}, "done": false, "episodes_total": 109, "training_iteration": 273, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-12-55", "timestamp": 1618146775, "time_this_iter_s": 29.788627862930298, "time_total_s": 8128.60156750679, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472ffd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8128.60156750679, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 62.73488372093024, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1043.0, "episode_reward_min": -1043.0, "episode_reward_mean": -1043.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1043.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7107102975882358, "mean_raw_obs_processing_ms": 0.12125168559175056, "mean_inference_ms": 2.307649929884735, "mean_action_processing_ms": 0.05713249156085609}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1096000, "timers": {"sample_time_ms": 12957.529, "sample_throughput": 308.701, "learn_time_ms": 17134.314, "learn_throughput": 233.45, "update_time_ms": 3.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.18020324707031252, "cur_lr": 5e-05, "total_loss": 8.818964824080467, "policy_loss": -0.05097303865477443, "vf_loss": 8.864783987402916, "vf_explained_var": 0.6433706283569336, "kl": 0.02859977202024311, "entropy": 0.27399890031665564, "entropy_coeff": 0.0}}, "num_steps_sampled": 1096000, "num_steps_trained": 1096000}, "done": false, "episodes_total": 109, "training_iteration": 274, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-13-24", "timestamp": 1618146804, "time_this_iter_s": 28.3699049949646, "time_total_s": 8156.971472501755, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8156.971472501755, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 62.7975, "ram_util_percent": 27.629999999999995}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1248.0, "episode_reward_min": -1248.0, "episode_reward_mean": -1248.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1248.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7079560547779014, "mean_raw_obs_processing_ms": 0.12148901320330577, "mean_inference_ms": 2.3078473286599936, "mean_action_processing_ms": 0.05713752363982115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1100000, "timers": {"sample_time_ms": 12806.225, "sample_throughput": 312.348, "learn_time_ms": 17110.201, "learn_throughput": 233.779, "update_time_ms": 3.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 13.600034803152084, "policy_loss": -0.05092834169045091, "vf_loss": 13.646974802017212, "vf_explained_var": 0.5332551598548889, "kl": 0.01475581803242676, "entropy": 0.23207595013082027, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 110, "training_iteration": 275, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-13-53", "timestamp": 1618146833, "time_this_iter_s": 28.746779203414917, "time_total_s": 8185.71825170517, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8185.71825170517, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 62.473170731707306, "ram_util_percent": 27.599999999999998}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1248.0, "episode_reward_min": -1248.0, "episode_reward_mean": -1248.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1248.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7079560547779014, "mean_raw_obs_processing_ms": 0.12148901320330577, "mean_inference_ms": 2.3078473286599936, "mean_action_processing_ms": 0.05713752363982115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1104000, "timers": {"sample_time_ms": 12558.111, "sample_throughput": 318.519, "learn_time_ms": 17039.811, "learn_throughput": 234.744, "update_time_ms": 3.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 13.48431009054184, "policy_loss": -0.03703471636981703, "vf_loss": 13.517001241445541, "vf_explained_var": 0.4903537333011627, "kl": 0.01606995014299173, "entropy": 0.2010736046358943, "entropy_coeff": 0.0}}, "num_steps_sampled": 1104000, "num_steps_trained": 1104000}, "done": false, "episodes_total": 110, "training_iteration": 276, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-14-22", "timestamp": 1618146862, "time_this_iter_s": 29.704472541809082, "time_total_s": 8215.422724246979, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8215.422724246979, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 62.518604651162796, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1248.0, "episode_reward_min": -1248.0, "episode_reward_mean": -1248.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1248.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7079560547779014, "mean_raw_obs_processing_ms": 0.12148901320330577, "mean_inference_ms": 2.3078473286599936, "mean_action_processing_ms": 0.05713752363982115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1108000, "timers": {"sample_time_ms": 12379.326, "sample_throughput": 323.119, "learn_time_ms": 17000.996, "learn_throughput": 235.28, "update_time_ms": 4.354}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 9.590709388256073, "policy_loss": -0.052736558456672356, "vf_loss": 9.638078838586807, "vf_explained_var": 0.5290400981903076, "kl": 0.019855927472235635, "entropy": 0.28608730249106884, "entropy_coeff": 0.0}}, "num_steps_sampled": 1108000, "num_steps_trained": 1108000}, "done": false, "episodes_total": 110, "training_iteration": 277, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-14-52", "timestamp": 1618146892, "time_this_iter_s": 29.88621497154236, "time_total_s": 8245.308939218521, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8245.308939218521, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 62.088095238095235, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1104.0, "episode_reward_min": -1104.0, "episode_reward_mean": -1104.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1104.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7085857303399913, "mean_raw_obs_processing_ms": 0.12185080851596604, "mean_inference_ms": 2.3081350386528605, "mean_action_processing_ms": 0.0571404338173836}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1112000, "timers": {"sample_time_ms": 12550.98, "sample_throughput": 318.7, "learn_time_ms": 16956.996, "learn_throughput": 235.891, "update_time_ms": 4.32}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 10.31013235449791, "policy_loss": -0.04419420991325751, "vf_loss": 10.349722608923912, "vf_explained_var": 0.4520079493522644, "kl": 0.017032806179486215, "entropy": 0.251642778981477, "entropy_coeff": 0.0}}, "num_steps_sampled": 1112000, "num_steps_trained": 1112000}, "done": false, "episodes_total": 111, "training_iteration": 278, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-15-23", "timestamp": 1618146923, "time_this_iter_s": 31.031970739364624, "time_total_s": 8276.340909957886, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efcc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8276.340909957886, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 62.70222222222223, "ram_util_percent": 27.59999999999999}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1104.0, "episode_reward_min": -1104.0, "episode_reward_mean": -1104.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1104.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7085857303399913, "mean_raw_obs_processing_ms": 0.12185080851596604, "mean_inference_ms": 2.3081350386528605, "mean_action_processing_ms": 0.0571404338173836}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1116000, "timers": {"sample_time_ms": 12437.978, "sample_throughput": 321.596, "learn_time_ms": 16933.282, "learn_throughput": 236.221, "update_time_ms": 3.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 9.499778866767883, "policy_loss": -0.035062715760432184, "vf_loss": 9.530912593007088, "vf_explained_var": 0.5407328605651855, "kl": 0.014535074529703707, "entropy": 0.1881113536655903, "entropy_coeff": 0.0}}, "num_steps_sampled": 1116000, "num_steps_trained": 1116000}, "done": false, "episodes_total": 111, "training_iteration": 279, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-15-53", "timestamp": 1618146953, "time_this_iter_s": 29.525601148605347, "time_total_s": 8305.866511106491, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d92d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8305.866511106491, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 62.328571428571436, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -827.0, "episode_reward_min": -827.0, "episode_reward_mean": -827.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-827.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7068115980321354, "mean_raw_obs_processing_ms": 0.12208308214512047, "mean_inference_ms": 2.3081974750582868, "mean_action_processing_ms": 0.05714270479468889}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1120000, "timers": {"sample_time_ms": 12491.821, "sample_throughput": 320.21, "learn_time_ms": 16958.746, "learn_throughput": 235.866, "update_time_ms": 3.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 5.817256420850754, "policy_loss": -0.04099980992032215, "vf_loss": 5.853449046611786, "vf_explained_var": 0.5633844137191772, "kl": 0.017783847637474537, "entropy": 0.285151035990566, "entropy_coeff": 0.0}}, "num_steps_sampled": 1120000, "num_steps_trained": 1120000}, "done": false, "episodes_total": 112, "training_iteration": 280, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-16-22", "timestamp": 1618146982, "time_this_iter_s": 28.667258739471436, "time_total_s": 8334.533769845963, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8334.533769845963, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 62.712195121951225, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -827.0, "episode_reward_min": -827.0, "episode_reward_mean": -827.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-827.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7068115980321354, "mean_raw_obs_processing_ms": 0.12208308214512047, "mean_inference_ms": 2.3081974750582868, "mean_action_processing_ms": 0.05714270479468889}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1124000, "timers": {"sample_time_ms": 12504.99, "sample_throughput": 319.872, "learn_time_ms": 17001.322, "learn_throughput": 235.276, "update_time_ms": 3.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.27030487060546876, "cur_lr": 5e-05, "total_loss": 1.3276854660362005, "policy_loss": -0.04056767193833366, "vf_loss": 1.3623535633087158, "vf_explained_var": 0.69569993019104, "kl": 0.021825680712936446, "entropy": 0.38854990247637033, "entropy_coeff": 0.0}}, "num_steps_sampled": 1124000, "num_steps_trained": 1124000}, "done": false, "episodes_total": 112, "training_iteration": 281, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-16-50", "timestamp": 1618147010, "time_this_iter_s": 28.417442560195923, "time_total_s": 8362.951212406158, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8362.951212406158, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 63.26500000000001, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -827.0, "episode_reward_min": -827.0, "episode_reward_mean": -827.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-827.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7068115980321354, "mean_raw_obs_processing_ms": 0.12208308214512047, "mean_inference_ms": 2.3081974750582868, "mean_action_processing_ms": 0.05714270479468889}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1128000, "timers": {"sample_time_ms": 12457.293, "sample_throughput": 321.097, "learn_time_ms": 16981.191, "learn_throughput": 235.555, "update_time_ms": 3.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 7.573867648839951, "policy_loss": -0.04379256337415427, "vf_loss": 7.612091585993767, "vf_explained_var": 0.6760435700416565, "kl": 0.013734247462707572, "entropy": 0.29586962098255754, "entropy_coeff": 0.0}}, "num_steps_sampled": 1128000, "num_steps_trained": 1128000}, "done": false, "episodes_total": 112, "training_iteration": 282, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-17-20", "timestamp": 1618147040, "time_this_iter_s": 30.367834329605103, "time_total_s": 8393.319046735764, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b6b31e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8393.319046735764, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 62.60681818181819, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -535.0, "episode_reward_min": -535.0, "episode_reward_mean": -535.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7050645051796793, "mean_raw_obs_processing_ms": 0.12245295186663983, "mean_inference_ms": 2.30844123260202, "mean_action_processing_ms": 0.057151459613327495}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1132000, "timers": {"sample_time_ms": 12470.689, "sample_throughput": 320.752, "learn_time_ms": 16966.639, "learn_throughput": 235.757, "update_time_ms": 3.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 7.87138095498085, "policy_loss": -0.04984763101674616, "vf_loss": 7.914693549275398, "vf_explained_var": 0.551478922367096, "kl": 0.016117732040584087, "entropy": 0.34569545928388834, "entropy_coeff": 0.0}}, "num_steps_sampled": 1132000, "num_steps_trained": 1132000}, "done": false, "episodes_total": 113, "training_iteration": 283, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-17-50", "timestamp": 1618147070, "time_this_iter_s": 29.778397798538208, "time_total_s": 8423.097444534302, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b31090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8423.097444534302, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 62.642857142857146, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -535.0, "episode_reward_min": -535.0, "episode_reward_mean": -535.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7050645051796793, "mean_raw_obs_processing_ms": 0.12245295186663983, "mean_inference_ms": 2.30844123260202, "mean_action_processing_ms": 0.057151459613327495}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1136000, "timers": {"sample_time_ms": 12526.546, "sample_throughput": 319.322, "learn_time_ms": 17046.752, "learn_throughput": 234.649, "update_time_ms": 4.021}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 6.520199865102768, "policy_loss": -0.047081542550586164, "vf_loss": 6.560659825801849, "vf_explained_var": 0.5731110572814941, "kl": 0.0163310730131343, "entropy": 0.3251799074932933, "entropy_coeff": 0.0}}, "num_steps_sampled": 1136000, "num_steps_trained": 1136000}, "done": false, "episodes_total": 113, "training_iteration": 284, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-18-20", "timestamp": 1618147100, "time_this_iter_s": 29.73164677619934, "time_total_s": 8452.829091310501, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc0150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8452.829091310501, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 62.80232558139535, "ram_util_percent": 27.60232558139534}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -707.0, "episode_reward_min": -707.0, "episode_reward_mean": -707.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-707.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7036347353127996, "mean_raw_obs_processing_ms": 0.12268714474226677, "mean_inference_ms": 2.308648470792119, "mean_action_processing_ms": 0.05715610401043229}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1140000, "timers": {"sample_time_ms": 12610.808, "sample_throughput": 317.188, "learn_time_ms": 17057.535, "learn_throughput": 234.5, "update_time_ms": 3.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 5.9733335971832275, "policy_loss": -0.045872610702645034, "vf_loss": 6.013321042060852, "vf_explained_var": 0.481076180934906, "kl": 0.014515032758936286, "entropy": 0.3814657302573323, "entropy_coeff": 0.0}}, "num_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 114, "training_iteration": 285, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-18-50", "timestamp": 1618147130, "time_this_iter_s": 29.699986696243286, "time_total_s": 8482.529078006744, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc83d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8482.529078006744, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 62.52142857142857, "ram_util_percent": 27.599999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -707.0, "episode_reward_min": -707.0, "episode_reward_mean": -707.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-707.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7036347353127996, "mean_raw_obs_processing_ms": 0.12268714474226677, "mean_inference_ms": 2.308648470792119, "mean_action_processing_ms": 0.05715610401043229}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1144000, "timers": {"sample_time_ms": 12464.654, "sample_throughput": 320.907, "learn_time_ms": 17014.577, "learn_throughput": 235.093, "update_time_ms": 3.983}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 5.854752704501152, "policy_loss": -0.02438566117780283, "vf_loss": 5.875087291002274, "vf_explained_var": 0.34453123807907104, "kl": 0.009991198487114161, "entropy": 0.3007262432947755, "entropy_coeff": 0.0}}, "num_steps_sampled": 1144000, "num_steps_trained": 1144000}, "done": false, "episodes_total": 114, "training_iteration": 286, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-19-18", "timestamp": 1618147158, "time_this_iter_s": 27.815715074539185, "time_total_s": 8510.344793081284, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8510.344793081284, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 62.919999999999995, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -707.0, "episode_reward_min": -707.0, "episode_reward_mean": -707.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-707.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7036347353127996, "mean_raw_obs_processing_ms": 0.12268714474226677, "mean_inference_ms": 2.308648470792119, "mean_action_processing_ms": 0.05715610401043229}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1148000, "timers": {"sample_time_ms": 12280.903, "sample_throughput": 325.709, "learn_time_ms": 17105.508, "learn_throughput": 233.843, "update_time_ms": 3.39}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 5.944627612829208, "policy_loss": -0.027862785442266613, "vf_loss": 5.967805743217468, "vf_explained_var": 0.3026537299156189, "kl": 0.011553999676834792, "entropy": 0.16501407092437148, "entropy_coeff": 0.0}}, "num_steps_sampled": 1148000, "num_steps_trained": 1148000}, "done": false, "episodes_total": 114, "training_iteration": 287, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-19-47", "timestamp": 1618147187, "time_this_iter_s": 28.956023693084717, "time_total_s": 8539.300816774368, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d92d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d92250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8539.300816774368, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 63.3439024390244, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -235.0, "episode_reward_min": -235.0, "episode_reward_mean": -235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6988013976594024, "mean_raw_obs_processing_ms": 0.12306413961607278, "mean_inference_ms": 2.309557141739304, "mean_action_processing_ms": 0.057182733416191504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1152000, "timers": {"sample_time_ms": 12059.792, "sample_throughput": 331.681, "learn_time_ms": 17116.798, "learn_throughput": 233.689, "update_time_ms": 3.454}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 2.5918196961283684, "policy_loss": -0.05662173865130171, "vf_loss": 2.6398638486862183, "vf_explained_var": 0.5278785824775696, "kl": 0.02115542540559545, "entropy": 0.49254577700048685, "entropy_coeff": 0.0}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 115, "training_iteration": 288, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-20-16", "timestamp": 1618147216, "time_this_iter_s": 28.93655228614807, "time_total_s": 8568.237369060516, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db89d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8568.237369060516, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 63.064285714285724, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -235.0, "episode_reward_min": -235.0, "episode_reward_mean": -235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6988013976594024, "mean_raw_obs_processing_ms": 0.12306413961607278, "mean_inference_ms": 2.309557141739304, "mean_action_processing_ms": 0.057182733416191504}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1156000, "timers": {"sample_time_ms": 11968.99, "sample_throughput": 334.197, "learn_time_ms": 17156.744, "learn_throughput": 233.144, "update_time_ms": 3.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 1.7862726524472237, "policy_loss": -0.03453165659448132, "vf_loss": 1.8117827884852886, "vf_explained_var": 0.5715876221656799, "kl": 0.014833502165856771, "entropy": 0.25591453863307834, "entropy_coeff": 0.0}}, "num_steps_sampled": 1156000, "num_steps_trained": 1156000}, "done": false, "episodes_total": 115, "training_iteration": 289, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-20-45", "timestamp": 1618147245, "time_this_iter_s": 29.0213942527771, "time_total_s": 8597.258763313293, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d92410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8597.258763313293, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 63.24146341463414, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -109.0, "episode_reward_min": -109.0, "episode_reward_mean": -109.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6955277637664857, "mean_raw_obs_processing_ms": 0.1233441446684888, "mean_inference_ms": 2.310160682424144, "mean_action_processing_ms": 0.05720383094708324}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1160000, "timers": {"sample_time_ms": 11946.712, "sample_throughput": 334.82, "learn_time_ms": 17153.336, "learn_throughput": 233.191, "update_time_ms": 3.508}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.5991255198605359, "policy_loss": -0.04525808058679104, "vf_loss": 0.6362056504003704, "vf_explained_var": 0.7513090372085571, "kl": 0.013446461001876742, "entropy": 0.4578298218548298, "entropy_coeff": 0.0}}, "num_steps_sampled": 1160000, "num_steps_trained": 1160000}, "done": false, "episodes_total": 116, "training_iteration": 290, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-21-13", "timestamp": 1618147273, "time_this_iter_s": 28.40656352043152, "time_total_s": 8625.665326833725, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1afd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8625.665326833725, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 62.719512195121965, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -109.0, "episode_reward_min": -109.0, "episode_reward_mean": -109.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6955277637664857, "mean_raw_obs_processing_ms": 0.1233441446684888, "mean_inference_ms": 2.310160682424144, "mean_action_processing_ms": 0.05720383094708324}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1164000, "timers": {"sample_time_ms": 12032.975, "sample_throughput": 332.42, "learn_time_ms": 17158.533, "learn_throughput": 233.12, "update_time_ms": 3.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 1.5162970572710037, "policy_loss": -0.062311299610883, "vf_loss": 1.5693383812904358, "vf_explained_var": 0.6338205337524414, "kl": 0.015242026667692699, "entropy": 0.45664970949292183, "entropy_coeff": 0.0}}, "num_steps_sampled": 1164000, "num_steps_trained": 1164000}, "done": false, "episodes_total": 116, "training_iteration": 291, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-21-42", "timestamp": 1618147302, "time_this_iter_s": 29.327176332473755, "time_total_s": 8654.992503166199, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8654.992503166199, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 63.35714285714285, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -109.0, "episode_reward_min": -109.0, "episode_reward_mean": -109.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6955277637664857, "mean_raw_obs_processing_ms": 0.1233441446684888, "mean_inference_ms": 2.310160682424144, "mean_action_processing_ms": 0.05720383094708324}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1168000, "timers": {"sample_time_ms": 11889.111, "sample_throughput": 336.442, "learn_time_ms": 17176.858, "learn_throughput": 232.871, "update_time_ms": 3.786}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 2.3858547173440456, "policy_loss": -0.05619175569154322, "vf_loss": 2.4316904321312904, "vf_explained_var": 0.6576683521270752, "kl": 0.01702770052361302, "entropy": 0.3990618586540222, "entropy_coeff": 0.0}}, "num_steps_sampled": 1168000, "num_steps_trained": 1168000}, "done": false, "episodes_total": 116, "training_iteration": 292, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-22-12", "timestamp": 1618147332, "time_this_iter_s": 29.120450973510742, "time_total_s": 8684.11295413971, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8684.11295413971, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 62.31219512195123, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -302.0, "episode_reward_min": -302.0, "episode_reward_mean": -302.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6913139082505251, "mean_raw_obs_processing_ms": 0.12375649859222189, "mean_inference_ms": 2.3114052545624983, "mean_action_processing_ms": 0.057233019482828544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1172000, "timers": {"sample_time_ms": 11768.799, "sample_throughput": 339.882, "learn_time_ms": 17179.186, "learn_throughput": 232.84, "update_time_ms": 3.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 1.5899974517524242, "policy_loss": -0.060475427337223664, "vf_loss": 1.6397377364337444, "vf_explained_var": 0.5751177072525024, "kl": 0.01765108303516172, "entropy": 0.5497452728450298, "entropy_coeff": 0.0}}, "num_steps_sampled": 1172000, "num_steps_trained": 1172000}, "done": false, "episodes_total": 117, "training_iteration": 293, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-22-40", "timestamp": 1618147360, "time_this_iter_s": 28.601922273635864, "time_total_s": 8712.714876413345, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b47330d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f158d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8712.714876413345, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 62.6170731707317, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -302.0, "episode_reward_min": -302.0, "episode_reward_mean": -302.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6913139082505251, "mean_raw_obs_processing_ms": 0.12375649859222189, "mean_inference_ms": 2.3114052545624983, "mean_action_processing_ms": 0.057233019482828544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1176000, "timers": {"sample_time_ms": 11739.35, "sample_throughput": 340.734, "learn_time_ms": 17085.488, "learn_throughput": 234.117, "update_time_ms": 3.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 1.7623393051326275, "policy_loss": -0.05684497038600966, "vf_loss": 1.8104661889374256, "vf_explained_var": 0.5923709273338318, "kl": 0.014334549545310438, "entropy": 0.5111111355945468, "entropy_coeff": 0.0}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 117, "training_iteration": 294, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-23-09", "timestamp": 1618147389, "time_this_iter_s": 28.49539828300476, "time_total_s": 8741.21027469635, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8741.21027469635, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 62.84878048780487, "ram_util_percent": 27.69756097560976}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -209.0, "episode_reward_min": -209.0, "episode_reward_mean": -209.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.68842916034416, "mean_raw_obs_processing_ms": 0.12402932477872392, "mean_inference_ms": 2.311844956959597, "mean_action_processing_ms": 0.05724733277645821}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1180000, "timers": {"sample_time_ms": 11619.548, "sample_throughput": 344.247, "learn_time_ms": 17146.392, "learn_throughput": 233.285, "update_time_ms": 3.932}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.9496225845068693, "policy_loss": -0.04205757466843352, "vf_loss": 0.983754102140665, "vf_explained_var": 0.6012362241744995, "kl": 0.013032309914706275, "entropy": 0.4934792472049594, "entropy_coeff": 0.0}}, "num_steps_sampled": 1180000, "num_steps_trained": 1180000}, "done": false, "episodes_total": 118, "training_iteration": 295, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-23-38", "timestamp": 1618147418, "time_this_iter_s": 29.107413291931152, "time_total_s": 8770.317687988281, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8770.317687988281, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 62.98292682926829, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -209.0, "episode_reward_min": -209.0, "episode_reward_mean": -209.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.68842916034416, "mean_raw_obs_processing_ms": 0.12402932477872392, "mean_inference_ms": 2.311844956959597, "mean_action_processing_ms": 0.05724733277645821}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1184000, "timers": {"sample_time_ms": 11651.72, "sample_throughput": 343.297, "learn_time_ms": 17257.913, "learn_throughput": 231.778, "update_time_ms": 3.94}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 1.258527023717761, "policy_loss": -0.06067329703364521, "vf_loss": 1.3098439704626799, "vf_explained_var": 0.7376841306686401, "kl": 0.015383991383714601, "entropy": 0.5790467280894518, "entropy_coeff": 0.0}}, "num_steps_sampled": 1184000, "num_steps_trained": 1184000}, "done": false, "episodes_total": 118, "training_iteration": 296, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-24-07", "timestamp": 1618147447, "time_this_iter_s": 29.25578284263611, "time_total_s": 8799.573470830917, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f101d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8799.573470830917, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 63.08571428571428, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -209.0, "episode_reward_min": -209.0, "episode_reward_mean": -209.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.68842916034416, "mean_raw_obs_processing_ms": 0.12402932477872392, "mean_inference_ms": 2.311844956959597, "mean_action_processing_ms": 0.05724733277645821}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1188000, "timers": {"sample_time_ms": 11702.053, "sample_throughput": 341.82, "learn_time_ms": 17197.47, "learn_throughput": 232.592, "update_time_ms": 3.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 1.1004724185913801, "policy_loss": -0.062305870291311294, "vf_loss": 1.153726963326335, "vf_explained_var": 0.5707195401191711, "kl": 0.014882486342685297, "entropy": 0.5198458824306726, "entropy_coeff": 0.0}}, "num_steps_sampled": 1188000, "num_steps_trained": 1188000}, "done": false, "episodes_total": 118, "training_iteration": 297, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-24-36", "timestamp": 1618147476, "time_this_iter_s": 28.858237981796265, "time_total_s": 8828.431708812714, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d921d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8828.431708812714, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 63.31219512195123, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -213.0, "episode_reward_min": -213.0, "episode_reward_mean": -213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6842964371284216, "mean_raw_obs_processing_ms": 0.12443976435521277, "mean_inference_ms": 2.313038999084513, "mean_action_processing_ms": 0.05727630528942923}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1192000, "timers": {"sample_time_ms": 11714.116, "sample_throughput": 341.468, "learn_time_ms": 17170.529, "learn_throughput": 232.957, "update_time_ms": 3.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.6413601245731115, "policy_loss": -0.0578117732075043, "vf_loss": 0.6909372555091977, "vf_explained_var": 0.5080106258392334, "kl": 0.01353966980241239, "entropy": 0.5496200481429696, "entropy_coeff": 0.0}}, "num_steps_sampled": 1192000, "num_steps_trained": 1192000}, "done": false, "episodes_total": 119, "training_iteration": 298, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-25-05", "timestamp": 1618147505, "time_this_iter_s": 28.78157114982605, "time_total_s": 8857.21327996254, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8857.21327996254, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 62.8780487804878, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -213.0, "episode_reward_min": -213.0, "episode_reward_mean": -213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6842964371284216, "mean_raw_obs_processing_ms": 0.12443976435521277, "mean_inference_ms": 2.313038999084513, "mean_action_processing_ms": 0.05727630528942923}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1196000, "timers": {"sample_time_ms": 11711.252, "sample_throughput": 341.552, "learn_time_ms": 17149.85, "learn_throughput": 233.238, "update_time_ms": 3.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.4811211887281388, "policy_loss": -0.05572561948793009, "vf_loss": 0.5271903919056058, "vf_explained_var": 0.5376816391944885, "kl": 0.01587741047842428, "entropy": 0.6058497373014688, "entropy_coeff": 0.0}}, "num_steps_sampled": 1196000, "num_steps_trained": 1196000}, "done": false, "episodes_total": 119, "training_iteration": 299, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-25-34", "timestamp": 1618147534, "time_this_iter_s": 28.781967401504517, "time_total_s": 8885.995247364044, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8885.995247364044, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 63.25853658536585, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -138.0, "episode_reward_min": -138.0, "episode_reward_mean": -138.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6818509684224439, "mean_raw_obs_processing_ms": 0.1247121979632237, "mean_inference_ms": 2.31365896956343, "mean_action_processing_ms": 0.057290362061422115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1200000, "timers": {"sample_time_ms": 11795.787, "sample_throughput": 339.104, "learn_time_ms": 17149.511, "learn_throughput": 233.243, "update_time_ms": 3.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.9383793259039521, "policy_loss": -0.048494295129785314, "vf_loss": 0.9790010638535023, "vf_explained_var": 0.503641664981842, "kl": 0.012944323854753748, "entropy": 0.5469685178250074, "entropy_coeff": 0.0}}, "num_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 120, "training_iteration": 300, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-26-03", "timestamp": 1618147563, "time_this_iter_s": 29.24668312072754, "time_total_s": 8915.241930484772, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc08d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8915.241930484772, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 62.58571428571428, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -138.0, "episode_reward_min": -138.0, "episode_reward_mean": -138.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6818509684224439, "mean_raw_obs_processing_ms": 0.1247121979632237, "mean_inference_ms": 2.31365896956343, "mean_action_processing_ms": 0.057290362061422115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1204000, "timers": {"sample_time_ms": 11732.231, "sample_throughput": 340.941, "learn_time_ms": 17148.956, "learn_throughput": 233.25, "update_time_ms": 3.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.4304505097679794, "policy_loss": -0.05233166497782804, "vf_loss": 0.4747343622148037, "vf_explained_var": 0.5876404643058777, "kl": 0.013232501893071458, "entropy": 0.5533888917416334, "entropy_coeff": 0.0}}, "num_steps_sampled": 1204000, "num_steps_trained": 1204000}, "done": false, "episodes_total": 120, "training_iteration": 301, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-26-32", "timestamp": 1618147592, "time_this_iter_s": 28.68698287010193, "time_total_s": 8943.928913354874, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8943.928913354874, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 63.007317073170725, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -138.0, "episode_reward_min": -138.0, "episode_reward_mean": -138.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6818509684224439, "mean_raw_obs_processing_ms": 0.1247121979632237, "mean_inference_ms": 2.31365896956343, "mean_action_processing_ms": 0.057290362061422115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1208000, "timers": {"sample_time_ms": 11722.6, "sample_throughput": 341.221, "learn_time_ms": 17127.727, "learn_throughput": 233.539, "update_time_ms": 3.672}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.15711746976012364, "policy_loss": -0.03663564290036447, "vf_loss": 0.18610194232314825, "vf_explained_var": 0.49758172035217285, "kl": 0.012580315989907831, "entropy": 0.5322545748203993, "entropy_coeff": 0.0}}, "num_steps_sampled": 1208000, "num_steps_trained": 1208000}, "done": false, "episodes_total": 120, "training_iteration": 302, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-27-01", "timestamp": 1618147621, "time_this_iter_s": 28.80454993247986, "time_total_s": 8972.733463287354, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8972.733463287354, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 63.892682926829266, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -58.0, "episode_reward_min": -58.0, "episode_reward_mean": -58.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6776307331081085, "mean_raw_obs_processing_ms": 0.12510585042667685, "mean_inference_ms": 2.31438241063498, "mean_action_processing_ms": 0.057318714307850994}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1212000, "timers": {"sample_time_ms": 11708.752, "sample_throughput": 341.625, "learn_time_ms": 17099.66, "learn_throughput": 233.923, "update_time_ms": 3.517}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.03497811168199405, "policy_loss": -0.028175853833090514, "vf_loss": 0.05549413792323321, "vf_explained_var": 0.4215778708457947, "kl": 0.012594543397426605, "entropy": 0.5533324629068375, "entropy_coeff": 0.0}}, "num_steps_sampled": 1212000, "num_steps_trained": 1212000}, "done": false, "episodes_total": 121, "training_iteration": 303, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-27-29", "timestamp": 1618147649, "time_this_iter_s": 28.17743444442749, "time_total_s": 9000.910897731781, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9000.910897731781, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 62.917073170731705, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -58.0, "episode_reward_min": -58.0, "episode_reward_mean": -58.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6776307331081085, "mean_raw_obs_processing_ms": 0.12510585042667685, "mean_inference_ms": 2.31438241063498, "mean_action_processing_ms": 0.057318714307850994}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1216000, "timers": {"sample_time_ms": 11672.742, "sample_throughput": 342.679, "learn_time_ms": 17160.838, "learn_throughput": 233.089, "update_time_ms": 3.63}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.0685274152783677, "policy_loss": -0.030519217427354306, "vf_loss": 0.09227946144528687, "vf_explained_var": 0.22027674317359924, "kl": 0.011126814548333641, "entropy": 0.2995866322889924, "entropy_coeff": 0.0}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 121, "training_iteration": 304, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-27-58", "timestamp": 1618147678, "time_this_iter_s": 28.755088567733765, "time_total_s": 9029.665986299515, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9029.665986299515, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 63.056097560975616, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -19.0, "episode_reward_min": -19.0, "episode_reward_mean": -19.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6746887066619238, "mean_raw_obs_processing_ms": 0.1253608309242697, "mean_inference_ms": 2.3148309228645783, "mean_action_processing_ms": 0.05733074077571897}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1220000, "timers": {"sample_time_ms": 11684.211, "sample_throughput": 342.342, "learn_time_ms": 17107.0, "learn_throughput": 233.822, "update_time_ms": 3.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.09152305714087561, "policy_loss": -0.053824862552573904, "vf_loss": 0.13489970052614808, "vf_explained_var": 0.5441467761993408, "kl": 0.017179317714180797, "entropy": 0.42785139940679073, "entropy_coeff": 0.0}}, "num_steps_sampled": 1220000, "num_steps_trained": 1220000}, "done": false, "episodes_total": 122, "training_iteration": 305, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-28-26", "timestamp": 1618147706, "time_this_iter_s": 28.69593644142151, "time_total_s": 9058.361922740936, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d737d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9058.361922740936, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 62.37073170731707, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -19.0, "episode_reward_min": -19.0, "episode_reward_mean": -19.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6746887066619238, "mean_raw_obs_processing_ms": 0.1253608309242697, "mean_inference_ms": 2.3148309228645783, "mean_action_processing_ms": 0.05733074077571897}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1224000, "timers": {"sample_time_ms": 11724.253, "sample_throughput": 341.173, "learn_time_ms": 17060.288, "learn_throughput": 234.463, "update_time_ms": 3.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.14550935087027028, "policy_loss": -0.06418492645025253, "vf_loss": 0.19921373878605664, "vf_explained_var": 0.6938488483428955, "kl": 0.017232467915164307, "entropy": 0.5668958369642496, "entropy_coeff": 0.0}}, "num_steps_sampled": 1224000, "num_steps_trained": 1224000}, "done": false, "episodes_total": 122, "training_iteration": 306, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-28-56", "timestamp": 1618147736, "time_this_iter_s": 29.185386180877686, "time_total_s": 9087.547308921814, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b31390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9087.547308921814, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 63.62439024390245, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -19.0, "episode_reward_min": -19.0, "episode_reward_mean": -19.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6746887066619238, "mean_raw_obs_processing_ms": 0.1253608309242697, "mean_inference_ms": 2.3148309228645783, "mean_action_processing_ms": 0.05733074077571897}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1228000, "timers": {"sample_time_ms": 11734.942, "sample_throughput": 340.862, "learn_time_ms": 17059.177, "learn_throughput": 234.478, "update_time_ms": 3.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.17869431525468826, "policy_loss": -0.04729380729258992, "vf_loss": 0.2156940558925271, "vf_explained_var": 0.5817316174507141, "kl": 0.016925853706197813, "entropy": 0.5663076732307673, "entropy_coeff": 0.0}}, "num_steps_sampled": 1228000, "num_steps_trained": 1228000}, "done": false, "episodes_total": 122, "training_iteration": 307, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-29-25", "timestamp": 1618147765, "time_this_iter_s": 28.9495267868042, "time_total_s": 9116.496835708618, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edac90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9116.496835708618, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 63.11666666666667, "ram_util_percent": 27.62142857142857}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -56.0, "episode_reward_min": -56.0, "episode_reward_mean": -56.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6707342074940791, "mean_raw_obs_processing_ms": 0.12575492428216417, "mean_inference_ms": 2.3161233054884756, "mean_action_processing_ms": 0.0573565378261162}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1232000, "timers": {"sample_time_ms": 11695.812, "sample_throughput": 342.003, "learn_time_ms": 17086.229, "learn_throughput": 234.107, "update_time_ms": 3.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 0.0878919358656276, "policy_loss": -0.07104980986332521, "vf_loss": 0.14188750926405191, "vf_explained_var": 0.47679659724235535, "kl": 0.028041147510521114, "entropy": 0.6633464954793453, "entropy_coeff": 0.0}}, "num_steps_sampled": 1232000, "num_steps_trained": 1232000}, "done": false, "episodes_total": 123, "training_iteration": 308, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-29-53", "timestamp": 1618147793, "time_this_iter_s": 28.66895341873169, "time_total_s": 9145.16578912735, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1abd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1aad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9145.16578912735, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 62.734146341463415, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -56.0, "episode_reward_min": -56.0, "episode_reward_mean": -56.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6707342074940791, "mean_raw_obs_processing_ms": 0.12575492428216417, "mean_inference_ms": 2.3161233054884756, "mean_action_processing_ms": 0.0573565378261162}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1236000, "timers": {"sample_time_ms": 11717.434, "sample_throughput": 341.372, "learn_time_ms": 17077.155, "learn_throughput": 234.231, "update_time_ms": 3.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.1013044253049884, "policy_loss": -0.02795891196001321, "vf_loss": 0.12005816958844662, "vf_explained_var": 0.5236086845397949, "kl": 0.010090300405863672, "entropy": 0.6045783814042807, "entropy_coeff": 0.0}}, "num_steps_sampled": 1236000, "num_steps_trained": 1236000}, "done": false, "episodes_total": 123, "training_iteration": 309, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-30-22", "timestamp": 1618147822, "time_this_iter_s": 28.906217336654663, "time_total_s": 9174.072006464005, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9174.072006464005, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 63.40731707317074, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -25.0, "episode_reward_min": -25.0, "episode_reward_mean": -25.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6679258462913481, "mean_raw_obs_processing_ms": 0.12601929046199897, "mean_inference_ms": 2.3166815484980066, "mean_action_processing_ms": 0.05737204116471703}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1240000, "timers": {"sample_time_ms": 11628.318, "sample_throughput": 343.988, "learn_time_ms": 17032.209, "learn_throughput": 234.849, "update_time_ms": 3.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.18513238259765785, "policy_loss": -0.04232031246647239, "vf_loss": 0.21503329975530505, "vf_explained_var": 0.3461994230747223, "kl": 0.013613596791401505, "entropy": 0.5811748672276735, "entropy_coeff": 0.0}}, "num_steps_sampled": 1240000, "num_steps_trained": 1240000}, "done": false, "episodes_total": 124, "training_iteration": 310, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-30-50", "timestamp": 1618147850, "time_this_iter_s": 27.90630555152893, "time_total_s": 9201.978312015533, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9201.978312015533, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 63.34000000000001, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -25.0, "episode_reward_min": -25.0, "episode_reward_mean": -25.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6679258462913481, "mean_raw_obs_processing_ms": 0.12601929046199897, "mean_inference_ms": 2.3166815484980066, "mean_action_processing_ms": 0.05737204116471703}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1244000, "timers": {"sample_time_ms": 11613.186, "sample_throughput": 344.436, "learn_time_ms": 16994.547, "learn_throughput": 235.37, "update_time_ms": 3.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.04971980780828744, "policy_loss": -0.028822115855291486, "vf_loss": 0.07007735397201031, "vf_explained_var": 0.505200207233429, "kl": 0.009278489960706793, "entropy": 0.5255807721987367, "entropy_coeff": 0.0}}, "num_steps_sampled": 1244000, "num_steps_trained": 1244000}, "done": false, "episodes_total": 124, "training_iteration": 311, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-31-18", "timestamp": 1618147878, "time_this_iter_s": 28.16251015663147, "time_total_s": 9230.140822172165, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1ad50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc85d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9230.140822172165, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 62.8875, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -25.0, "episode_reward_min": -25.0, "episode_reward_mean": -25.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6679258462913481, "mean_raw_obs_processing_ms": 0.12601929046199897, "mean_inference_ms": 2.3166815484980066, "mean_action_processing_ms": 0.05737204116471703}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1248000, "timers": {"sample_time_ms": 11582.755, "sample_throughput": 345.341, "learn_time_ms": 17008.536, "learn_throughput": 235.176, "update_time_ms": 4.077}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.01118255517212674, "policy_loss": -0.0182704507606104, "vf_loss": 0.022542066464666277, "vf_explained_var": 0.22774192690849304, "kl": 0.007575467607239261, "entropy": 0.5785673335194588, "entropy_coeff": 0.0}}, "num_steps_sampled": 1248000, "num_steps_trained": 1248000}, "done": false, "episodes_total": 124, "training_iteration": 312, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-31-47", "timestamp": 1618147907, "time_this_iter_s": 28.648943662643433, "time_total_s": 9258.789765834808, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9258.789765834808, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 62.80487804878049, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -6.0, "episode_reward_min": -6.0, "episode_reward_mean": -6.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6637975040014319, "mean_raw_obs_processing_ms": 0.12638231872258002, "mean_inference_ms": 2.3172351696642175, "mean_action_processing_ms": 0.0573851360126986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1252000, "timers": {"sample_time_ms": 11588.025, "sample_throughput": 345.184, "learn_time_ms": 17078.471, "learn_throughput": 234.213, "update_time_ms": 4.072}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.035186253662686795, "policy_loss": -0.03700230803224258, "vf_loss": 0.06399920751573518, "vf_explained_var": 0.48405611515045166, "kl": 0.008976809011073783, "entropy": 0.5800652112811804, "entropy_coeff": 0.0}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 125, "training_iteration": 313, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-32-16", "timestamp": 1618147936, "time_this_iter_s": 28.93105912208557, "time_total_s": 9287.720824956894, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3efc650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9287.720824956894, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 63.082926829268295, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -6.0, "episode_reward_min": -6.0, "episode_reward_mean": -6.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6637975040014319, "mean_raw_obs_processing_ms": 0.12638231872258002, "mean_inference_ms": 2.3172351696642175, "mean_action_processing_ms": 0.0573851360126986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1256000, "timers": {"sample_time_ms": 11609.971, "sample_throughput": 344.531, "learn_time_ms": 17057.468, "learn_throughput": 234.501, "update_time_ms": 3.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.06073203298728913, "policy_loss": -0.038200840645004064, "vf_loss": 0.09055751340929419, "vf_explained_var": 0.4077264666557312, "kl": 0.009180702196317725, "entropy": 0.583869457244873, "entropy_coeff": 0.0}}, "num_steps_sampled": 1256000, "num_steps_trained": 1256000}, "done": false, "episodes_total": 125, "training_iteration": 314, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-32-45", "timestamp": 1618147965, "time_this_iter_s": 28.755966186523438, "time_total_s": 9316.476791143417, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d927d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9316.476791143417, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 63.32682926829268, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -12.0, "episode_reward_min": -12.0, "episode_reward_mean": -12.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6611523779471595, "mean_raw_obs_processing_ms": 0.12665328956361818, "mean_inference_ms": 2.317752674201308, "mean_action_processing_ms": 0.05740848121404224}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1260000, "timers": {"sample_time_ms": 11620.483, "sample_throughput": 344.22, "learn_time_ms": 17052.088, "learn_throughput": 234.575, "update_time_ms": 3.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.018632806197274476, "policy_loss": -0.02708857989637181, "vf_loss": 0.03779413644224405, "vf_explained_var": 0.16656216979026794, "kl": 0.008689507740200497, "entropy": 0.5447410624474287, "entropy_coeff": 0.0}}, "num_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 126, "training_iteration": 315, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-33-14", "timestamp": 1618147994, "time_this_iter_s": 28.741007089614868, "time_total_s": 9345.217798233032, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9345.217798233032, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 63.546341463414635, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -12.0, "episode_reward_min": -12.0, "episode_reward_mean": -12.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6611523779471595, "mean_raw_obs_processing_ms": 0.12665328956361818, "mean_inference_ms": 2.317752674201308, "mean_action_processing_ms": 0.05740848121404224}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1264000, "timers": {"sample_time_ms": 11587.319, "sample_throughput": 345.205, "learn_time_ms": 17074.437, "learn_throughput": 234.268, "update_time_ms": 3.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.08986732416087762, "policy_loss": -0.04251756373560056, "vf_loss": 0.12329614534974098, "vf_explained_var": 0.6836193799972534, "kl": 0.009962677431758493, "entropy": 0.5325717618688941, "entropy_coeff": 0.0}}, "num_steps_sampled": 1264000, "num_steps_trained": 1264000}, "done": false, "episodes_total": 126, "training_iteration": 316, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-33-43", "timestamp": 1618148023, "time_this_iter_s": 29.076152563095093, "time_total_s": 9374.293950796127, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d92f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d736d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9374.293950796127, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 62.95714285714286, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -12.0, "episode_reward_min": -12.0, "episode_reward_mean": -12.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6611523779471595, "mean_raw_obs_processing_ms": 0.12665328956361818, "mean_inference_ms": 2.317752674201308, "mean_action_processing_ms": 0.05740848121404224}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1268000, "timers": {"sample_time_ms": 11562.788, "sample_throughput": 345.937, "learn_time_ms": 17131.97, "learn_throughput": 233.482, "update_time_ms": 3.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.06696056632790715, "policy_loss": -0.01626667199889198, "vf_loss": 0.07541524106636643, "vf_explained_var": 0.29985326528549194, "kl": 0.008563170820707455, "entropy": 0.6052464209496975, "entropy_coeff": 0.0}}, "num_steps_sampled": 1268000, "num_steps_trained": 1268000}, "done": false, "episodes_total": 126, "training_iteration": 317, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-34-12", "timestamp": 1618148052, "time_this_iter_s": 29.28150725364685, "time_total_s": 9403.575458049774, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9403.575458049774, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 62.964285714285715, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6574509238392603, "mean_raw_obs_processing_ms": 0.127060800428731, "mean_inference_ms": 2.318727158441747, "mean_action_processing_ms": 0.05743646079902055}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1272000, "timers": {"sample_time_ms": 11593.439, "sample_throughput": 345.023, "learn_time_ms": 17145.577, "learn_throughput": 233.296, "update_time_ms": 3.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.06071024661650881, "policy_loss": -0.040572202240582556, "vf_loss": 0.09192766563501209, "vf_explained_var": 0.21769145131111145, "kl": 0.010254299122607335, "entropy": 0.532612893730402, "entropy_coeff": 0.0}}, "num_steps_sampled": 1272000, "num_steps_trained": 1272000}, "done": false, "episodes_total": 127, "training_iteration": 318, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-34-41", "timestamp": 1618148081, "time_this_iter_s": 29.10568881034851, "time_total_s": 9432.681146860123, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9432.681146860123, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 63.31219512195123, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6574509238392603, "mean_raw_obs_processing_ms": 0.127060800428731, "mean_inference_ms": 2.318727158441747, "mean_action_processing_ms": 0.05743646079902055}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1276000, "timers": {"sample_time_ms": 11570.126, "sample_throughput": 345.718, "learn_time_ms": 17197.801, "learn_throughput": 232.588, "update_time_ms": 3.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.02222170861205086, "policy_loss": -0.03160690233926289, "vf_loss": 0.04431838553864509, "vf_explained_var": 0.29612964391708374, "kl": 0.010424691179650836, "entropy": 0.5175583623349667, "entropy_coeff": 0.0}}, "num_steps_sampled": 1276000, "num_steps_trained": 1276000}, "done": false, "episodes_total": 127, "training_iteration": 319, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-35-10", "timestamp": 1618148110, "time_this_iter_s": 29.197062015533447, "time_total_s": 9461.878208875656, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9461.878208875656, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 63.04285714285714, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -4.0, "episode_reward_min": -4.0, "episode_reward_mean": -4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6550190459286785, "mean_raw_obs_processing_ms": 0.12732373456760324, "mean_inference_ms": 2.3194361553675784, "mean_action_processing_ms": 0.05745046474696806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1280000, "timers": {"sample_time_ms": 11646.218, "sample_throughput": 343.459, "learn_time_ms": 17232.523, "learn_throughput": 232.119, "update_time_ms": 3.783}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.055725379614159465, "policy_loss": -0.03204538847785443, "vf_loss": 0.07971714390441775, "vf_explained_var": 0.43506693840026855, "kl": 0.008828028992866166, "entropy": 0.5918445531278849, "entropy_coeff": 0.0}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 128, "training_iteration": 320, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-35-40", "timestamp": 1618148140, "time_this_iter_s": 29.017229795455933, "time_total_s": 9490.895438671112, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b3b190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9490.895438671112, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 63.599999999999994, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -4.0, "episode_reward_min": -4.0, "episode_reward_mean": -4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6550190459286785, "mean_raw_obs_processing_ms": 0.12732373456760324, "mean_inference_ms": 2.3194361553675784, "mean_action_processing_ms": 0.05745046474696806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1284000, "timers": {"sample_time_ms": 11696.426, "sample_throughput": 341.985, "learn_time_ms": 17260.998, "learn_throughput": 231.736, "update_time_ms": 3.783}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.009819080180022866, "policy_loss": -0.04011678072856739, "vf_loss": 0.03926495905034244, "vf_explained_var": 0.6924078464508057, "kl": 0.011696976056555286, "entropy": 0.5925764553248882, "entropy_coeff": 0.0}}, "num_steps_sampled": 1284000, "num_steps_trained": 1284000}, "done": false, "episodes_total": 128, "training_iteration": 321, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-36-09", "timestamp": 1618148169, "time_this_iter_s": 28.947704792022705, "time_total_s": 9519.843143463135, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafe50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9519.843143463135, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 63.64999999999999, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -4.0, "episode_reward_min": -4.0, "episode_reward_mean": -4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6550190459286785, "mean_raw_obs_processing_ms": 0.12732373456760324, "mean_inference_ms": 2.3194361553675784, "mean_action_processing_ms": 0.05745046474696806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1288000, "timers": {"sample_time_ms": 11716.48, "sample_throughput": 341.399, "learn_time_ms": 17325.796, "learn_throughput": 230.87, "update_time_ms": 3.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.006919499428477138, "policy_loss": -0.014719147176947445, "vf_loss": 0.015541396220214665, "vf_explained_var": 0.14627230167388916, "kl": 0.006683538907964248, "entropy": 0.4695611381903291, "entropy_coeff": 0.0}}, "num_steps_sampled": 1288000, "num_steps_trained": 1288000}, "done": false, "episodes_total": 128, "training_iteration": 322, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-36-38", "timestamp": 1618148198, "time_this_iter_s": 29.49166464805603, "time_total_s": 9549.33480811119, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d737d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9549.33480811119, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 63.657142857142865, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6511736041215086, "mean_raw_obs_processing_ms": 0.12771884895115093, "mean_inference_ms": 2.320768005152877, "mean_action_processing_ms": 0.057474030602539944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1292000, "timers": {"sample_time_ms": 11766.112, "sample_throughput": 339.959, "learn_time_ms": 17285.999, "learn_throughput": 231.401, "update_time_ms": 3.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.002742084034252912, "policy_loss": -0.01752853096695617, "vf_loss": 0.009511554657365195, "vf_explained_var": 0.03020571917295456, "kl": 0.0057821020964183845, "entropy": 0.5154005913063884, "entropy_coeff": 0.0}}, "num_steps_sampled": 1292000, "num_steps_trained": 1292000}, "done": false, "episodes_total": 129, "training_iteration": 323, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-37-07", "timestamp": 1618148227, "time_this_iter_s": 29.024580717086792, "time_total_s": 9578.359388828278, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e019d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9578.359388828278, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 63.27317073170731, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6511736041215086, "mean_raw_obs_processing_ms": 0.12771884895115093, "mean_inference_ms": 2.320768005152877, "mean_action_processing_ms": 0.057474030602539944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1296000, "timers": {"sample_time_ms": 11781.549, "sample_throughput": 339.514, "learn_time_ms": 17273.824, "learn_throughput": 231.564, "update_time_ms": 3.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.021489360311534256, "policy_loss": -0.024170582531951368, "vf_loss": 0.03818029665853828, "vf_explained_var": 0.39811983704566956, "kl": 0.008198858486139216, "entropy": 0.6023532785475254, "entropy_coeff": 0.0}}, "num_steps_sampled": 1296000, "num_steps_trained": 1296000}, "done": false, "episodes_total": 129, "training_iteration": 324, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-37-36", "timestamp": 1618148256, "time_this_iter_s": 28.792726278305054, "time_total_s": 9607.152115106583, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc07d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9607.152115106583, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 62.28292682926829, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1.0, "episode_reward_min": 1.0, "episode_reward_mean": 1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.648772225169413, "mean_raw_obs_processing_ms": 0.12797740793665482, "mean_inference_ms": 2.321230054645446, "mean_action_processing_ms": 0.05748238983546447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1300000, "timers": {"sample_time_ms": 11772.831, "sample_throughput": 339.765, "learn_time_ms": 17283.641, "learn_throughput": 231.433, "update_time_ms": 3.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.03896973101655021, "policy_loss": -0.03251024673227221, "vf_loss": 0.06476619117893279, "vf_explained_var": 0.4798906147480011, "kl": 0.007359353970969096, "entropy": 0.48638458736240864, "entropy_coeff": 0.0}}, "num_steps_sampled": 1300000, "num_steps_trained": 1300000}, "done": false, "episodes_total": 130, "training_iteration": 325, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-38-05", "timestamp": 1618148285, "time_this_iter_s": 28.748677015304565, "time_total_s": 9635.900792121887, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc02d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9635.900792121887, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 63.42682926829271, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1.0, "episode_reward_min": 1.0, "episode_reward_mean": 1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.648772225169413, "mean_raw_obs_processing_ms": 0.12797740793665482, "mean_inference_ms": 2.321230054645446, "mean_action_processing_ms": 0.05748238983546447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1304000, "timers": {"sample_time_ms": 11805.711, "sample_throughput": 338.819, "learn_time_ms": 17224.795, "learn_throughput": 232.223, "update_time_ms": 3.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.009459607012104243, "policy_loss": -0.03308279300108552, "vf_loss": 0.03451588685857132, "vf_explained_var": 0.5980743765830994, "kl": 0.008798310693237, "entropy": 0.5966113433241844, "entropy_coeff": 0.0}}, "num_steps_sampled": 1304000, "num_steps_trained": 1304000}, "done": false, "episodes_total": 130, "training_iteration": 326, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-38-34", "timestamp": 1618148314, "time_this_iter_s": 28.815584421157837, "time_total_s": 9664.716376543045, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc0c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9664.716376543045, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 63.52926829268292, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1.0, "episode_reward_min": 1.0, "episode_reward_mean": 1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.648772225169413, "mean_raw_obs_processing_ms": 0.12797740793665482, "mean_inference_ms": 2.321230054645446, "mean_action_processing_ms": 0.05748238983546447}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1308000, "timers": {"sample_time_ms": 11735.482, "sample_throughput": 340.847, "learn_time_ms": 17158.363, "learn_throughput": 233.122, "update_time_ms": 3.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.02434051438467577, "policy_loss": -0.046463759674225, "vf_loss": 0.013207295385655016, "vf_explained_var": 0.45404285192489624, "kl": 0.009773271682206541, "entropy": 0.6437688115984201, "entropy_coeff": 0.0}}, "num_steps_sampled": 1308000, "num_steps_trained": 1308000}, "done": false, "episodes_total": 130, "training_iteration": 327, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-39-02", "timestamp": 1618148342, "time_this_iter_s": 27.915997982025146, "time_total_s": 9692.63237452507, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaad90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec0110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9692.63237452507, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 63.152499999999996, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 3.0, "episode_reward_min": 3.0, "episode_reward_mean": 3.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6450598922122386, "mean_raw_obs_processing_ms": 0.12837226172186056, "mean_inference_ms": 2.321691349715846, "mean_action_processing_ms": 0.05749641955671832}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1312000, "timers": {"sample_time_ms": 11683.192, "sample_throughput": 342.372, "learn_time_ms": 17174.409, "learn_throughput": 232.905, "update_time_ms": 3.924}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.006195190828293562, "policy_loss": -0.03397573801339604, "vf_loss": 0.020614284730982035, "vf_explained_var": 0.312723308801651, "kl": 0.00785534002352506, "entropy": 0.62264608964324, "entropy_coeff": 0.0}}, "num_steps_sampled": 1312000, "num_steps_trained": 1312000}, "done": false, "episodes_total": 131, "training_iteration": 328, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-39-30", "timestamp": 1618148370, "time_this_iter_s": 28.74538779258728, "time_total_s": 9721.377762317657, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9721.377762317657, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 62.37317073170732, "ram_util_percent": 27.700000000000003}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 3.0, "episode_reward_min": 3.0, "episode_reward_mean": 3.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6450598922122386, "mean_raw_obs_processing_ms": 0.12837226172186056, "mean_inference_ms": 2.321691349715846, "mean_action_processing_ms": 0.05749641955671832}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1316000, "timers": {"sample_time_ms": 11664.382, "sample_throughput": 342.924, "learn_time_ms": 17228.893, "learn_throughput": 232.168, "update_time_ms": 4.028}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.01604568271432072, "policy_loss": -0.044557570887263864, "vf_loss": 0.050850875792093575, "vf_explained_var": 0.43633729219436646, "kl": 0.010690127091947943, "entropy": 0.6137242317199707, "entropy_coeff": 0.0}}, "num_steps_sampled": 1316000, "num_steps_trained": 1316000}, "done": false, "episodes_total": 131, "training_iteration": 329, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-40-00", "timestamp": 1618148400, "time_this_iter_s": 29.560850381851196, "time_total_s": 9750.938612699509, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b31390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9750.938612699509, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 63.01666666666667, "ram_util_percent": 27.76904761904762}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6425190483222921, "mean_raw_obs_processing_ms": 0.12864348498801687, "mean_inference_ms": 2.322126267046009, "mean_action_processing_ms": 0.05751226540335655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1320000, "timers": {"sample_time_ms": 11621.661, "sample_throughput": 344.185, "learn_time_ms": 17238.877, "learn_throughput": 232.034, "update_time_ms": 4.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.004794720560312271, "policy_loss": -0.03708448336692527, "vf_loss": 0.024028720275964588, "vf_explained_var": 0.44694817066192627, "kl": 0.009055390881258063, "entropy": 0.5134420553222299, "entropy_coeff": 0.0}}, "num_steps_sampled": 1320000, "num_steps_trained": 1320000}, "done": false, "episodes_total": 132, "training_iteration": 330, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-40-29", "timestamp": 1618148429, "time_this_iter_s": 28.68812370300293, "time_total_s": 9779.626736402512, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9779.626736402512, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 63.131707317073165, "ram_util_percent": 27.782926829268295}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6425190483222921, "mean_raw_obs_processing_ms": 0.12864348498801687, "mean_inference_ms": 2.322126267046009, "mean_action_processing_ms": 0.05751226540335655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1324000, "timers": {"sample_time_ms": 11587.358, "sample_throughput": 345.204, "learn_time_ms": 17204.97, "learn_throughput": 232.491, "update_time_ms": 3.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.007788435963448137, "policy_loss": -0.03043778489518445, "vf_loss": 0.014988489856477827, "vf_explained_var": 0.08006282150745392, "kl": 0.008397494704695418, "entropy": 0.543168431147933, "entropy_coeff": 0.0}}, "num_steps_sampled": 1324000, "num_steps_trained": 1324000}, "done": false, "episodes_total": 132, "training_iteration": 331, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-40-57", "timestamp": 1618148457, "time_this_iter_s": 28.266381978988647, "time_total_s": 9807.8931183815, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9807.8931183815, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 63.336585365853665, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6425190483222921, "mean_raw_obs_processing_ms": 0.12864348498801687, "mean_inference_ms": 2.322126267046009, "mean_action_processing_ms": 0.05751226540335655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1328000, "timers": {"sample_time_ms": 11541.177, "sample_throughput": 346.585, "learn_time_ms": 17154.218, "learn_throughput": 233.179, "update_time_ms": 3.791}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.018132635217625648, "policy_loss": -0.04961759314755909, "vf_loss": 0.05741237837355584, "vf_explained_var": 0.5106421709060669, "kl": 0.011331892863381654, "entropy": 0.5145242158323526, "entropy_coeff": 0.0}}, "num_steps_sampled": 1328000, "num_steps_trained": 1328000}, "done": false, "episodes_total": 132, "training_iteration": 332, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-41-26", "timestamp": 1618148486, "time_this_iter_s": 28.51974081993103, "time_total_s": 9836.412859201431, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db86d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9836.412859201431, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 63.748780487804886, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 4.0, "episode_reward_min": 4.0, "episode_reward_mean": 4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.638896592077455, "mean_raw_obs_processing_ms": 0.1290352893639559, "mean_inference_ms": 2.322572746868219, "mean_action_processing_ms": 0.05752899584217161}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1332000, "timers": {"sample_time_ms": 11513.488, "sample_throughput": 347.419, "learn_time_ms": 17198.47, "learn_throughput": 232.579, "update_time_ms": 3.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.06770236958982423, "policy_loss": -0.03191828733542934, "vf_loss": 0.09062782471301034, "vf_explained_var": 0.2888663411140442, "kl": 0.009857548371655867, "entropy": 0.5483031924813986, "entropy_coeff": 0.0}}, "num_steps_sampled": 1332000, "num_steps_trained": 1332000}, "done": false, "episodes_total": 133, "training_iteration": 333, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-41-55", "timestamp": 1618148515, "time_this_iter_s": 29.19175624847412, "time_total_s": 9865.604615449905, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f044d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9865.604615449905, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 63.82682926829268, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 4.0, "episode_reward_min": 4.0, "episode_reward_mean": 4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.638896592077455, "mean_raw_obs_processing_ms": 0.1290352893639559, "mean_inference_ms": 2.322572746868219, "mean_action_processing_ms": 0.05752899584217161}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1336000, "timers": {"sample_time_ms": 11547.858, "sample_throughput": 346.385, "learn_time_ms": 17253.269, "learn_throughput": 231.84, "update_time_ms": 3.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.05853127833688632, "policy_loss": -0.052581002411898226, "vf_loss": 0.09460955380927771, "vf_explained_var": 0.4891892671585083, "kl": 0.018089563847752288, "entropy": 0.6083809211850166, "entropy_coeff": 0.0}}, "num_steps_sampled": 1336000, "num_steps_trained": 1336000}, "done": false, "episodes_total": 133, "training_iteration": 334, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-42-24", "timestamp": 1618148544, "time_this_iter_s": 29.681308031082153, "time_total_s": 9895.285923480988, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9895.285923480988, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 63.2093023255814, "ram_util_percent": 27.7093023255814}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 9.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6365992946249392, "mean_raw_obs_processing_ms": 0.12930711341378529, "mean_inference_ms": 2.323221681314086, "mean_action_processing_ms": 0.05754763379519188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1340000, "timers": {"sample_time_ms": 11542.98, "sample_throughput": 346.531, "learn_time_ms": 17223.901, "learn_throughput": 232.235, "update_time_ms": 3.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.00666770723182708, "policy_loss": -0.03320644312771037, "vf_loss": 0.018668431061087176, "vf_explained_var": 0.2599210739135742, "kl": 0.008627082934253849, "entropy": 0.6500544510781765, "entropy_coeff": 0.0}}, "num_steps_sampled": 1340000, "num_steps_trained": 1340000}, "done": false, "episodes_total": 134, "training_iteration": 335, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-42-53", "timestamp": 1618148573, "time_this_iter_s": 28.405846118927002, "time_total_s": 9923.691769599915, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9923.691769599915, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 63.515, "ram_util_percent": 27.7}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 9.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6365992946249392, "mean_raw_obs_processing_ms": 0.12930711341378529, "mean_inference_ms": 2.323221681314086, "mean_action_processing_ms": 0.05754763379519188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1344000, "timers": {"sample_time_ms": 11469.923, "sample_throughput": 348.738, "learn_time_ms": 17272.23, "learn_throughput": 231.586, "update_time_ms": 3.675}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": -0.009869758563581854, "policy_loss": -0.02889998280443251, "vf_loss": 0.010157992961467244, "vf_explained_var": 0.24738119542598724, "kl": 0.00972534871834796, "entropy": 0.6287347879260778, "entropy_coeff": 0.0}}, "num_steps_sampled": 1344000, "num_steps_trained": 1344000}, "done": false, "episodes_total": 134, "training_iteration": 336, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-43-22", "timestamp": 1618148602, "time_this_iter_s": 28.57372784614563, "time_total_s": 9952.26549744606, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efcfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9952.26549744606, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 62.77073170731706, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 9.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6365992946249392, "mean_raw_obs_processing_ms": 0.12930711341378529, "mean_inference_ms": 2.323221681314086, "mean_action_processing_ms": 0.05754763379519188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1348000, "timers": {"sample_time_ms": 11516.775, "sample_throughput": 347.319, "learn_time_ms": 17296.906, "learn_throughput": 231.255, "update_time_ms": 3.715}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.003957208333304152, "policy_loss": -0.04491335537750274, "vf_loss": 0.04070846299873665, "vf_explained_var": 0.6202974319458008, "kl": 0.008946935035055503, "entropy": 0.6238247323781252, "entropy_coeff": 0.0}}, "num_steps_sampled": 1348000, "num_steps_trained": 1348000}, "done": false, "episodes_total": 134, "training_iteration": 337, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-43-50", "timestamp": 1618148630, "time_this_iter_s": 28.634909868240356, "time_total_s": 9980.9004073143, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edaf90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9980.9004073143, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 63.00975609756098, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 11.0, "episode_reward_min": 11.0, "episode_reward_mean": 11.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6330233440081142, "mean_raw_obs_processing_ms": 0.12971018615489305, "mean_inference_ms": 2.3237179049762564, "mean_action_processing_ms": 0.05756031030990672}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1352000, "timers": {"sample_time_ms": 11543.601, "sample_throughput": 346.512, "learn_time_ms": 17290.796, "learn_throughput": 231.337, "update_time_ms": 3.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.022165752190630883, "policy_loss": -0.03806233109207824, "vf_loss": 0.050944019574671984, "vf_explained_var": 0.5623975396156311, "kl": 0.010176780997426249, "entropy": 0.5836279839277267, "entropy_coeff": 0.0}}, "num_steps_sampled": 1352000, "num_steps_trained": 1352000}, "done": false, "episodes_total": 135, "training_iteration": 338, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-44-19", "timestamp": 1618148659, "time_this_iter_s": 28.95313000679016, "time_total_s": 10009.85353732109, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edae90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10009.85353732109, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 63.74146341463414, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 11.0, "episode_reward_min": 11.0, "episode_reward_mean": 11.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6330233440081142, "mean_raw_obs_processing_ms": 0.12971018615489305, "mean_inference_ms": 2.3237179049762564, "mean_action_processing_ms": 0.05756031030990672}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1356000, "timers": {"sample_time_ms": 11573.525, "sample_throughput": 345.616, "learn_time_ms": 17257.503, "learn_throughput": 231.783, "update_time_ms": 3.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.057540224166586995, "policy_loss": -0.03175930486759171, "vf_loss": 0.08028739667497575, "vf_explained_var": 0.42552870512008667, "kl": 0.009878700686385855, "entropy": 0.5179073922336102, "entropy_coeff": 0.0}}, "num_steps_sampled": 1356000, "num_steps_trained": 1356000}, "done": false, "episodes_total": 135, "training_iteration": 339, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-44-49", "timestamp": 1618148689, "time_this_iter_s": 29.52220344543457, "time_total_s": 10039.375740766525, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efc3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10039.375740766525, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 63.7547619047619, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 16.0, "episode_reward_min": 16.0, "episode_reward_mean": 16.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6306543104515536, "mean_raw_obs_processing_ms": 0.12997823600063688, "mean_inference_ms": 2.324577622205857, "mean_action_processing_ms": 0.057577801013904265}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1360000, "timers": {"sample_time_ms": 11609.814, "sample_throughput": 344.536, "learn_time_ms": 17250.344, "learn_throughput": 231.879, "update_time_ms": 3.739}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.08772695122752339, "policy_loss": -0.03589885780820623, "vf_loss": 0.1157063611317426, "vf_explained_var": 0.5724430680274963, "kl": 0.00868094849283807, "entropy": 0.48525194730609655, "entropy_coeff": 0.0}}, "num_steps_sampled": 1360000, "num_steps_trained": 1360000}, "done": false, "episodes_total": 136, "training_iteration": 340, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-45-18", "timestamp": 1618148718, "time_this_iter_s": 28.97831916809082, "time_total_s": 10068.354059934616, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db82d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10068.354059934616, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 63.66428571428572, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 16.0, "episode_reward_min": 16.0, "episode_reward_mean": 16.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6306543104515536, "mean_raw_obs_processing_ms": 0.12997823600063688, "mean_inference_ms": 2.324577622205857, "mean_action_processing_ms": 0.057577801013904265}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1364000, "timers": {"sample_time_ms": 11630.434, "sample_throughput": 343.925, "learn_time_ms": 17290.151, "learn_throughput": 231.346, "update_time_ms": 3.778}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.0935766805196181, "policy_loss": -0.03363259250181727, "vf_loss": 0.11904336675070226, "vf_explained_var": 0.3033391237258911, "kl": 0.00895110888814088, "entropy": 0.3162171132862568, "entropy_coeff": 0.0}}, "num_steps_sampled": 1364000, "num_steps_trained": 1364000}, "done": false, "episodes_total": 136, "training_iteration": 341, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-45-47", "timestamp": 1618148747, "time_this_iter_s": 28.87173366546631, "time_total_s": 10097.225793600082, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10097.225793600082, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 63.365853658536594, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 16.0, "episode_reward_min": 16.0, "episode_reward_mean": 16.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6306543104515536, "mean_raw_obs_processing_ms": 0.12997823600063688, "mean_inference_ms": 2.324577622205857, "mean_action_processing_ms": 0.057577801013904265}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1368000, "timers": {"sample_time_ms": 11688.071, "sample_throughput": 342.229, "learn_time_ms": 17345.495, "learn_throughput": 230.607, "update_time_ms": 3.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 0.008950743067543954, "policy_loss": -0.009826046123635024, "vf_loss": 0.016857052891282365, "vf_explained_var": 0.2675097584724426, "kl": 0.0021043308843218256, "entropy": 0.1606026915833354, "entropy_coeff": 0.0}}, "num_steps_sampled": 1368000, "num_steps_trained": 1368000}, "done": false, "episodes_total": 136, "training_iteration": 342, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-46-16", "timestamp": 1618148776, "time_this_iter_s": 29.65289545059204, "time_total_s": 10126.878689050674, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d643d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d64d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10126.878689050674, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 63.451162790697666, "ram_util_percent": 27.79767441860465}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 4.0, "episode_reward_min": 4.0, "episode_reward_mean": 4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6273402840583973, "mean_raw_obs_processing_ms": 0.13042517201149417, "mean_inference_ms": 2.325615438820993, "mean_action_processing_ms": 0.057597456697603876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1372000, "timers": {"sample_time_ms": 11721.234, "sample_throughput": 341.261, "learn_time_ms": 17372.9, "learn_throughput": 230.244, "update_time_ms": 4.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.0396443851350341, "policy_loss": -0.04585558094549924, "vf_loss": 0.07943788007833064, "vf_explained_var": 0.5864577889442444, "kl": 0.01328997829114087, "entropy": 0.3159941453486681, "entropy_coeff": 0.0}}, "num_steps_sampled": 1372000, "num_steps_trained": 1372000}, "done": false, "episodes_total": 137, "training_iteration": 343, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-46-46", "timestamp": 1618148806, "time_this_iter_s": 29.80354642868042, "time_total_s": 10156.682235479355, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10156.682235479355, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 64.27142857142856, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 4.0, "episode_reward_min": 4.0, "episode_reward_mean": 4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6273402840583973, "mean_raw_obs_processing_ms": 0.13042517201149417, "mean_inference_ms": 2.325615438820993, "mean_action_processing_ms": 0.057597456697603876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1376000, "timers": {"sample_time_ms": 11679.327, "sample_throughput": 342.485, "learn_time_ms": 17326.714, "learn_throughput": 230.857, "update_time_ms": 4.128}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.06620024639414623, "policy_loss": -0.037972198450006545, "vf_loss": 0.09702486894093454, "vf_explained_var": 0.42971110343933105, "kl": 0.01566971486317925, "entropy": 0.45384771283715963, "entropy_coeff": 0.0}}, "num_steps_sampled": 1376000, "num_steps_trained": 1376000}, "done": false, "episodes_total": 137, "training_iteration": 344, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-47-15", "timestamp": 1618148835, "time_this_iter_s": 28.80578637123108, "time_total_s": 10185.488021850586, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10185.488021850586, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 63.19268292682927, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 17.0, "episode_reward_min": 17.0, "episode_reward_mean": 17.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6251596623383273, "mean_raw_obs_processing_ms": 0.13069225875138138, "mean_inference_ms": 2.325953285805528, "mean_action_processing_ms": 0.0576090685474792}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1380000, "timers": {"sample_time_ms": 11682.242, "sample_throughput": 342.4, "learn_time_ms": 17327.891, "learn_throughput": 230.842, "update_time_ms": 4.361}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.013408402359345928, "policy_loss": -0.021587949711829424, "vf_loss": 0.030680644034873694, "vf_explained_var": 0.5958302021026611, "kl": 0.009461377456318587, "entropy": 0.3899536868557334, "entropy_coeff": 0.0}}, "num_steps_sampled": 1380000, "num_steps_trained": 1380000}, "done": false, "episodes_total": 138, "training_iteration": 345, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-47-44", "timestamp": 1618148864, "time_this_iter_s": 28.449671506881714, "time_total_s": 10213.937693357468, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10213.937693357468, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 62.79268292682926, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 17.0, "episode_reward_min": 17.0, "episode_reward_mean": 17.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6251596623383273, "mean_raw_obs_processing_ms": 0.13069225875138138, "mean_inference_ms": 2.325953285805528, "mean_action_processing_ms": 0.0576090685474792}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1384000, "timers": {"sample_time_ms": 11724.387, "sample_throughput": 341.169, "learn_time_ms": 17308.854, "learn_throughput": 231.096, "update_time_ms": 4.274}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.034136344271246344, "policy_loss": -0.04183112853206694, "vf_loss": 0.06831033830530941, "vf_explained_var": 0.6634529232978821, "kl": 0.016786829859483987, "entropy": 0.3488755030557513, "entropy_coeff": 0.0}}, "num_steps_sampled": 1384000, "num_steps_trained": 1384000}, "done": false, "episodes_total": 138, "training_iteration": 346, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-48-12", "timestamp": 1618148892, "time_this_iter_s": 28.803166151046753, "time_total_s": 10242.740859508514, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1aed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10242.740859508514, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 62.6780487804878, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 17.0, "episode_reward_min": 17.0, "episode_reward_mean": 17.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6251596623383273, "mean_raw_obs_processing_ms": 0.13069225875138138, "mean_inference_ms": 2.325953285805528, "mean_action_processing_ms": 0.0576090685474792}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1388000, "timers": {"sample_time_ms": 11730.056, "sample_throughput": 341.004, "learn_time_ms": 17323.033, "learn_throughput": 230.906, "update_time_ms": 4.15}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.1429042974486947, "policy_loss": -0.040796331013552845, "vf_loss": 0.17691618599928916, "vf_explained_var": 0.6484912633895874, "kl": 0.014873605134198442, "entropy": 0.4157188916578889, "entropy_coeff": 0.0}}, "num_steps_sampled": 1388000, "num_steps_trained": 1388000}, "done": false, "episodes_total": 138, "training_iteration": 347, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-48-41", "timestamp": 1618148921, "time_this_iter_s": 28.831793546676636, "time_total_s": 10271.572653055191, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10271.572653055191, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 63.41707317073172, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 35.0, "episode_reward_min": 35.0, "episode_reward_mean": 35.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6217773570542953, "mean_raw_obs_processing_ms": 0.13109988849862095, "mean_inference_ms": 2.3268589566572935, "mean_action_processing_ms": 0.05762949025569265}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1392000, "timers": {"sample_time_ms": 11749.213, "sample_throughput": 340.448, "learn_time_ms": 17312.61, "learn_throughput": 231.045, "update_time_ms": 4.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.09194194548763335, "policy_loss": -0.04407842978253029, "vf_loss": 0.12798117683269083, "vf_explained_var": 0.5851716995239258, "kl": 0.017624435131438076, "entropy": 0.4780432749539614, "entropy_coeff": 0.0}}, "num_steps_sampled": 1392000, "num_steps_trained": 1392000}, "done": false, "episodes_total": 139, "training_iteration": 348, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-49-10", "timestamp": 1618148950, "time_this_iter_s": 29.041517972946167, "time_total_s": 10300.614171028137, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaadd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10300.614171028137, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 63.76904761904763, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 35.0, "episode_reward_min": 35.0, "episode_reward_mean": 35.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6217773570542953, "mean_raw_obs_processing_ms": 0.13109988849862095, "mean_inference_ms": 2.3268589566572935, "mean_action_processing_ms": 0.05762949025569265}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1396000, "timers": {"sample_time_ms": 11728.63, "sample_throughput": 341.046, "learn_time_ms": 17305.203, "learn_throughput": 231.144, "update_time_ms": 4.087}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.052189025504048914, "policy_loss": -0.038941316364798695, "vf_loss": 0.0859238140983507, "vf_explained_var": 0.8069665431976318, "kl": 0.011414331704145297, "entropy": 0.4236014122143388, "entropy_coeff": 0.0}}, "num_steps_sampled": 1396000, "num_steps_trained": 1396000}, "done": false, "episodes_total": 139, "training_iteration": 349, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-49-40", "timestamp": 1618148980, "time_this_iter_s": 29.239731311798096, "time_total_s": 10329.853902339935, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1afd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10329.853902339935, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 63.675609756097565, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 20.0, "episode_reward_min": 20.0, "episode_reward_mean": 20.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.619488121897577, "mean_raw_obs_processing_ms": 0.1313576047839902, "mean_inference_ms": 2.3272847566707195, "mean_action_processing_ms": 0.057641613012305665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1400000, "timers": {"sample_time_ms": 11687.321, "sample_throughput": 342.251, "learn_time_ms": 17307.776, "learn_throughput": 231.11, "update_time_ms": 4.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.031468371307710186, "policy_loss": -0.030669993837364018, "vf_loss": 0.05688514420762658, "vf_explained_var": 0.6173223257064819, "kl": 0.011516697399201803, "entropy": 0.39282981120049953, "entropy_coeff": 0.0}}, "num_steps_sampled": 1400000, "num_steps_trained": 1400000}, "done": false, "episodes_total": 140, "training_iteration": 350, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-50-08", "timestamp": 1618149008, "time_this_iter_s": 28.591036796569824, "time_total_s": 10358.444939136505, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10358.444939136505, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 63.45609756097561, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 20.0, "episode_reward_min": 20.0, "episode_reward_mean": 20.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.619488121897577, "mean_raw_obs_processing_ms": 0.1313576047839902, "mean_inference_ms": 2.3272847566707195, "mean_action_processing_ms": 0.057641613012305665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1404000, "timers": {"sample_time_ms": 11689.216, "sample_throughput": 342.196, "learn_time_ms": 17345.017, "learn_throughput": 230.614, "update_time_ms": 4.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": -0.01693686355429236, "policy_loss": -0.026624034966516774, "vf_loss": 0.004212674844893627, "vf_explained_var": -0.12730160355567932, "kl": 0.012001806258922443, "entropy": 0.38342752680182457, "entropy_coeff": 0.0}}, "num_steps_sampled": 1404000, "num_steps_trained": 1404000}, "done": false, "episodes_total": 140, "training_iteration": 351, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-50-38", "timestamp": 1618149038, "time_this_iter_s": 29.263177394866943, "time_total_s": 10387.708116531372, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10387.708116531372, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 63.51428571428571, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 20.0, "episode_reward_min": 20.0, "episode_reward_mean": 20.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.619488121897577, "mean_raw_obs_processing_ms": 0.1313576047839902, "mean_inference_ms": 2.3272847566707195, "mean_action_processing_ms": 0.057641613012305665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1408000, "timers": {"sample_time_ms": 11628.379, "sample_throughput": 343.986, "learn_time_ms": 17327.343, "learn_throughput": 230.849, "update_time_ms": 3.972}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.0017504882998764515, "policy_loss": -0.04244182206457481, "vf_loss": 0.03739728429354727, "vf_explained_var": 0.33913880586624146, "kl": 0.01489681689417921, "entropy": 0.4351973179727793, "entropy_coeff": 0.0}}, "num_steps_sampled": 1408000, "num_steps_trained": 1408000}, "done": false, "episodes_total": 140, "training_iteration": 352, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-51-07", "timestamp": 1618149067, "time_this_iter_s": 28.863730430603027, "time_total_s": 10416.571846961975, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10416.571846961975, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 63.76585365853658, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1.0, "episode_reward_min": 1.0, "episode_reward_mean": 1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.616110885758516, "mean_raw_obs_processing_ms": 0.13176554413342462, "mean_inference_ms": 2.3279227556966644, "mean_action_processing_ms": 0.05765963126815715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1412000, "timers": {"sample_time_ms": 11600.14, "sample_throughput": 344.823, "learn_time_ms": 17193.812, "learn_throughput": 232.642, "update_time_ms": 4.458}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 0.005409723584307358, "policy_loss": -0.04193842757376842, "vf_loss": 0.041427938966080546, "vf_explained_var": 0.7171908617019653, "kl": 0.01297894530580379, "entropy": 0.4374746037647128, "entropy_coeff": 0.0}}, "num_steps_sampled": 1412000, "num_steps_trained": 1412000}, "done": false, "episodes_total": 141, "training_iteration": 353, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-51-35", "timestamp": 1618149095, "time_this_iter_s": 28.185636520385742, "time_total_s": 10444.75748348236, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f151d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10444.75748348236, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 62.27804878048781, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1.0, "episode_reward_min": 1.0, "episode_reward_mean": 1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.616110885758516, "mean_raw_obs_processing_ms": 0.13176554413342462, "mean_inference_ms": 2.3279227556966644, "mean_action_processing_ms": 0.05765963126815715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1416000, "timers": {"sample_time_ms": 11591.617, "sample_throughput": 345.077, "learn_time_ms": 17215.083, "learn_throughput": 232.354, "update_time_ms": 4.505}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": -0.020671080361353233, "policy_loss": -0.07635682012187317, "vf_loss": 0.008713215182069689, "vf_explained_var": 0.4170844256877899, "kl": 0.10297843022271991, "entropy": 0.4216763759031892, "entropy_coeff": 0.0}}, "num_steps_sampled": 1416000, "num_steps_trained": 1416000}, "done": false, "episodes_total": 141, "training_iteration": 354, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-52-04", "timestamp": 1618149124, "time_this_iter_s": 28.929306507110596, "time_total_s": 10473.686789989471, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d64050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d64790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10473.686789989471, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 63.76097560975608, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 32.0, "episode_reward_min": 32.0, "episode_reward_mean": 32.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6139502770306187, "mean_raw_obs_processing_ms": 0.1320379660486555, "mean_inference_ms": 2.328656160480229, "mean_action_processing_ms": 0.05767989546026709}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1420000, "timers": {"sample_time_ms": 11648.084, "sample_throughput": 343.404, "learn_time_ms": 17300.827, "learn_throughput": 231.203, "update_time_ms": 4.289}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 0.26458682119846344, "policy_loss": -0.03423391736578196, "vf_loss": 0.2926688464358449, "vf_explained_var": 0.5406674146652222, "kl": 0.008991244714707136, "entropy": 0.4257244197651744, "entropy_coeff": 0.0}}, "num_steps_sampled": 1420000, "num_steps_trained": 1420000}, "done": false, "episodes_total": 142, "training_iteration": 355, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-52-34", "timestamp": 1618149154, "time_this_iter_s": 29.870611429214478, "time_total_s": 10503.557401418686, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaac90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10503.557401418686, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 64.1547619047619, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 32.0, "episode_reward_min": 32.0, "episode_reward_mean": 32.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6139502770306187, "mean_raw_obs_processing_ms": 0.1320379660486555, "mean_inference_ms": 2.328656160480229, "mean_action_processing_ms": 0.05767989546026709}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1424000, "timers": {"sample_time_ms": 11665.035, "sample_throughput": 342.905, "learn_time_ms": 17299.181, "learn_throughput": 231.225, "update_time_ms": 4.27}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 0.19469225802458823, "policy_loss": -0.029570368060376495, "vf_loss": 0.21801335364580154, "vf_explained_var": 0.8090227842330933, "kl": 0.009133574814768508, "entropy": 0.41318288166075945, "entropy_coeff": 0.0}}, "num_steps_sampled": 1424000, "num_steps_trained": 1424000}, "done": false, "episodes_total": 142, "training_iteration": 356, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-53-03", "timestamp": 1618149183, "time_this_iter_s": 28.957948684692383, "time_total_s": 10532.515350103378, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10532.515350103378, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 63.80714285714286, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 32.0, "episode_reward_min": 32.0, "episode_reward_mean": 32.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6139502770306187, "mean_raw_obs_processing_ms": 0.1320379660486555, "mean_inference_ms": 2.328656160480229, "mean_action_processing_ms": 0.05767989546026709}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1428000, "timers": {"sample_time_ms": 11649.15, "sample_throughput": 343.373, "learn_time_ms": 17321.255, "learn_throughput": 230.93, "update_time_ms": 4.374}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 0.24242325662635267, "policy_loss": -0.030422789452131838, "vf_loss": 0.2671421584673226, "vf_explained_var": 0.5576936602592468, "kl": 0.008336465863976628, "entropy": 0.2849731966853142, "entropy_coeff": 0.0}}, "num_steps_sampled": 1428000, "num_steps_trained": 1428000}, "done": false, "episodes_total": 142, "training_iteration": 357, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-53-32", "timestamp": 1618149212, "time_this_iter_s": 28.89056420326233, "time_total_s": 10561.40591430664, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d644d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6ad50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10561.40591430664, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 63.72682926829269, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 35.0, "episode_reward_min": 35.0, "episode_reward_mean": 35.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6110420277171926, "mean_raw_obs_processing_ms": 0.13242732638745588, "mean_inference_ms": 2.3289929850633264, "mean_action_processing_ms": 0.057693797951749}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1432000, "timers": {"sample_time_ms": 11613.705, "sample_throughput": 344.421, "learn_time_ms": 17388.994, "learn_throughput": 230.031, "update_time_ms": 4.376}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 0.040978642529807985, "policy_loss": -0.0031013329280540347, "vf_loss": 0.0434975647367537, "vf_explained_var": -0.006159292533993721, "kl": 0.0008512226640959852, "entropy": 0.08425184851512313, "entropy_coeff": 0.0}}, "num_steps_sampled": 1432000, "num_steps_trained": 1432000}, "done": false, "episodes_total": 143, "training_iteration": 358, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-54-01", "timestamp": 1618149241, "time_this_iter_s": 29.35866951942444, "time_total_s": 10590.764583826065, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f044d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10590.764583826065, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 63.77619047619047, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 35.0, "episode_reward_min": 35.0, "episode_reward_mean": 35.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6110420277171926, "mean_raw_obs_processing_ms": 0.13242732638745588, "mean_inference_ms": 2.3289929850633264, "mean_action_processing_ms": 0.057693797951749}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1436000, "timers": {"sample_time_ms": 11657.86, "sample_throughput": 343.116, "learn_time_ms": 17316.337, "learn_throughput": 230.996, "update_time_ms": 4.367}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.34210460186004643, "cur_lr": 5e-05, "total_loss": 0.00874105718685314, "policy_loss": 0.0005401386879384518, "vf_loss": 0.00738973957777489, "vf_explained_var": -0.01539052464067936, "kl": 0.0023711406938673463, "entropy": 0.09246283071115613, "entropy_coeff": 0.0}}, "num_steps_sampled": 1436000, "num_steps_trained": 1436000}, "done": false, "episodes_total": 143, "training_iteration": 359, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-54-30", "timestamp": 1618149270, "time_this_iter_s": 28.958203077316284, "time_total_s": 10619.722786903381, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1a650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10619.722786903381, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 63.73658536585364, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 20.0, "episode_reward_min": 20.0, "episode_reward_mean": 20.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6090460985030587, "mean_raw_obs_processing_ms": 0.13267133691842042, "mean_inference_ms": 2.3293343794119847, "mean_action_processing_ms": 0.057701239152660275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1440000, "timers": {"sample_time_ms": 11628.825, "sample_throughput": 343.973, "learn_time_ms": 17296.814, "learn_throughput": 231.256, "update_time_ms": 4.345}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.17105230093002322, "cur_lr": 5e-05, "total_loss": 0.19142164278309792, "policy_loss": -0.036532026511849836, "vf_loss": 0.22304290859028697, "vf_explained_var": 0.6253001689910889, "kl": 0.028709102305583656, "entropy": 0.22756470972672105, "entropy_coeff": 0.0}}, "num_steps_sampled": 1440000, "num_steps_trained": 1440000}, "done": false, "episodes_total": 144, "training_iteration": 360, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-54-58", "timestamp": 1618149298, "time_this_iter_s": 28.11042308807373, "time_total_s": 10647.833209991455, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e011d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10647.833209991455, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 62.645, "ram_util_percent": 27.8}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 20.0, "episode_reward_min": 20.0, "episode_reward_mean": 20.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6090460985030587, "mean_raw_obs_processing_ms": 0.13267133691842042, "mean_inference_ms": 2.3293343794119847, "mean_action_processing_ms": 0.057701239152660275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1444000, "timers": {"sample_time_ms": 11618.117, "sample_throughput": 344.29, "learn_time_ms": 17251.647, "learn_throughput": 231.862, "update_time_ms": 4.386}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2565784513950348, "cur_lr": 5e-05, "total_loss": 0.8604165967553854, "policy_loss": -0.05401441431604326, "vf_loss": 0.9082702826708555, "vf_explained_var": 0.5344271659851074, "kl": 0.024011046101804823, "entropy": 0.44317403994500637, "entropy_coeff": 0.0}}, "num_steps_sampled": 1444000, "num_steps_trained": 1444000}, "done": false, "episodes_total": 144, "training_iteration": 361, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-55-27", "timestamp": 1618149327, "time_this_iter_s": 28.7047700881958, "time_total_s": 10676.53798007965, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10676.53798007965, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 62.92857142857143, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 20.0, "episode_reward_min": 20.0, "episode_reward_mean": 20.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6090460985030587, "mean_raw_obs_processing_ms": 0.13267133691842042, "mean_inference_ms": 2.3293343794119847, "mean_action_processing_ms": 0.057701239152660275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1448000, "timers": {"sample_time_ms": 11639.514, "sample_throughput": 343.657, "learn_time_ms": 17207.086, "learn_throughput": 232.462, "update_time_ms": 4.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3848676770925522, "cur_lr": 5e-05, "total_loss": 0.266145518515259, "policy_loss": -0.05214790580794215, "vf_loss": 0.3101258659735322, "vf_explained_var": 0.548736572265625, "kl": 0.021221733157290146, "entropy": 0.4458578061312437, "entropy_coeff": 0.0}}, "num_steps_sampled": 1448000, "num_steps_trained": 1448000}, "done": false, "episodes_total": 144, "training_iteration": 362, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-55-56", "timestamp": 1618149356, "time_this_iter_s": 28.63614273071289, "time_total_s": 10705.174122810364, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10705.174122810364, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 63.78536585365853, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 63.0, "episode_reward_min": 63.0, "episode_reward_mean": 63.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6058811237907901, "mean_raw_obs_processing_ms": 0.1330522916103922, "mean_inference_ms": 2.329983551860294, "mean_action_processing_ms": 0.057722349780144025}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1452000, "timers": {"sample_time_ms": 11641.501, "sample_throughput": 343.598, "learn_time_ms": 17289.919, "learn_throughput": 231.349, "update_time_ms": 3.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.4344187481328845, "policy_loss": -0.0408081344794482, "vf_loss": 0.4668424613773823, "vf_explained_var": 0.5203976631164551, "kl": 0.014523475139867514, "entropy": 0.4388108989223838, "entropy_coeff": 0.0}}, "num_steps_sampled": 1452000, "num_steps_trained": 1452000}, "done": false, "episodes_total": 145, "training_iteration": 363, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-56-25", "timestamp": 1618149385, "time_this_iter_s": 29.02702760696411, "time_total_s": 10734.201150417328, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ec8e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10734.201150417328, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 63.90975609756097, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 63.0, "episode_reward_min": 63.0, "episode_reward_mean": 63.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6058811237907901, "mean_raw_obs_processing_ms": 0.1330522916103922, "mean_inference_ms": 2.329983551860294, "mean_action_processing_ms": 0.057722349780144025}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1456000, "timers": {"sample_time_ms": 11688.303, "sample_throughput": 342.222, "learn_time_ms": 17255.951, "learn_throughput": 231.804, "update_time_ms": 3.601}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5773015156388284, "cur_lr": 5e-05, "total_loss": 0.7498649079352617, "policy_loss": -0.1045413869433105, "vf_loss": 0.7982618473470211, "vf_explained_var": 0.45963460206985474, "kl": 0.09725324693135917, "entropy": 0.3774062776938081, "entropy_coeff": 0.0}}, "num_steps_sampled": 1456000, "num_steps_trained": 1456000}, "done": false, "episodes_total": 145, "training_iteration": 364, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-56-54", "timestamp": 1618149414, "time_this_iter_s": 29.059032201766968, "time_total_s": 10763.260182619095, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10763.260182619095, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 64.1390243902439, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 141.0, "episode_reward_min": 141.0, "episode_reward_mean": 141.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6040160284586403, "mean_raw_obs_processing_ms": 0.13329921550988616, "mean_inference_ms": 2.3301308281981696, "mean_action_processing_ms": 0.05772930904050856}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1460000, "timers": {"sample_time_ms": 11583.222, "sample_throughput": 345.327, "learn_time_ms": 17238.046, "learn_throughput": 232.045, "update_time_ms": 3.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.7012256756424904, "policy_loss": -0.03642823704285547, "vf_loss": 0.7277965024113655, "vf_explained_var": 0.6661372780799866, "kl": 0.011383310134988278, "entropy": 0.39554861653596163, "entropy_coeff": 0.0}}, "num_steps_sampled": 1460000, "num_steps_trained": 1460000}, "done": false, "episodes_total": 146, "training_iteration": 365, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-57-22", "timestamp": 1618149442, "time_this_iter_s": 28.638477325439453, "time_total_s": 10791.898659944534, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc83d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10791.898659944534, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 63.78780487804878, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 141.0, "episode_reward_min": 141.0, "episode_reward_mean": 141.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6040160284586403, "mean_raw_obs_processing_ms": 0.13329921550988616, "mean_inference_ms": 2.3301308281981696, "mean_action_processing_ms": 0.05772930904050856}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1464000, "timers": {"sample_time_ms": 11546.078, "sample_throughput": 346.438, "learn_time_ms": 17218.137, "learn_throughput": 232.313, "update_time_ms": 3.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.17320309695787728, "policy_loss": -0.028477721323724836, "vf_loss": 0.18900096509605646, "vf_explained_var": 0.4967562258243561, "kl": 0.014642672409536317, "entropy": 0.3320063892751932, "entropy_coeff": 0.0}}, "num_steps_sampled": 1464000, "num_steps_trained": 1464000}, "done": false, "episodes_total": 146, "training_iteration": 366, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-57-51", "timestamp": 1618149471, "time_this_iter_s": 28.389044523239136, "time_total_s": 10820.287704467773, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10820.287704467773, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 62.17317073170732, "ram_util_percent": 27.89756097560976}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 141.0, "episode_reward_min": 141.0, "episode_reward_mean": 141.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6040160284586403, "mean_raw_obs_processing_ms": 0.13329921550988616, "mean_inference_ms": 2.3301308281981696, "mean_action_processing_ms": 0.05772930904050856}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1468000, "timers": {"sample_time_ms": 11516.689, "sample_throughput": 347.322, "learn_time_ms": 17230.108, "learn_throughput": 232.152, "update_time_ms": 3.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 0.4870133404619992, "policy_loss": -0.031703194486908615, "vf_loss": 0.510675166733563, "vf_explained_var": 0.5115364193916321, "kl": 0.009286156462621875, "entropy": 0.4594536488875747, "entropy_coeff": 0.0}}, "num_steps_sampled": 1468000, "num_steps_trained": 1468000}, "done": false, "episodes_total": 146, "training_iteration": 367, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-58-20", "timestamp": 1618149500, "time_this_iter_s": 28.714596033096313, "time_total_s": 10849.00230050087, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc89d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10849.00230050087, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 63.80487804878049, "ram_util_percent": 27.804878048780488}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 102.0, "episode_reward_min": 102.0, "episode_reward_mean": 102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6013935970502752, "mean_raw_obs_processing_ms": 0.13368633896093876, "mean_inference_ms": 2.3303548704643684, "mean_action_processing_ms": 0.057740159465602264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1472000, "timers": {"sample_time_ms": 11590.547, "sample_throughput": 345.109, "learn_time_ms": 17175.075, "learn_throughput": 232.896, "update_time_ms": 3.717}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8659522734582425, "cur_lr": 5e-05, "total_loss": 2.925219874829054, "policy_loss": -0.055614936689380556, "vf_loss": 2.9493807703256607, "vf_explained_var": 0.444641649723053, "kl": 0.03632305940845981, "entropy": 0.3390634097158909, "entropy_coeff": 0.0}}, "num_steps_sampled": 1472000, "num_steps_trained": 1472000}, "done": false, "episodes_total": 147, "training_iteration": 368, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-58-49", "timestamp": 1618149529, "time_this_iter_s": 29.550650358200073, "time_total_s": 10878.55295085907, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d730d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10878.55295085907, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 63.49285714285715, "ram_util_percent": 27.885714285714293}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 102.0, "episode_reward_min": 102.0, "episode_reward_mean": 102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6013935970502752, "mean_raw_obs_processing_ms": 0.13368633896093876, "mean_inference_ms": 2.3303548704643684, "mean_action_processing_ms": 0.057740159465602264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1476000, "timers": {"sample_time_ms": 11558.049, "sample_throughput": 346.079, "learn_time_ms": 17250.399, "learn_throughput": 231.879, "update_time_ms": 3.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 2.366439174860716, "policy_loss": -0.04631787381367758, "vf_loss": 2.4015964344143867, "vf_explained_var": 0.39575618505477905, "kl": 0.008592160724219866, "entropy": 0.3101385780610144, "entropy_coeff": 0.0}}, "num_steps_sampled": 1476000, "num_steps_trained": 1476000}, "done": false, "episodes_total": 147, "training_iteration": 369, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-59-19", "timestamp": 1618149559, "time_this_iter_s": 29.383355617523193, "time_total_s": 10907.936306476593, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db89d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10907.936306476593, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 63.66428571428572, "ram_util_percent": 27.842857142857135}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 208.0, "episode_reward_min": 208.0, "episode_reward_mean": 208.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.599539610074761, "mean_raw_obs_processing_ms": 0.13395625645191891, "mean_inference_ms": 2.330700127391418, "mean_action_processing_ms": 0.057750687047607566}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1480000, "timers": {"sample_time_ms": 11605.239, "sample_throughput": 344.672, "learn_time_ms": 17231.507, "learn_throughput": 232.133, "update_time_ms": 3.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.2375363074243069, "policy_loss": -0.03227934247115627, "vf_loss": 1.262978706508875, "vf_explained_var": 0.5426335334777832, "kl": 0.0052635263273259625, "entropy": 0.30288245994597673, "entropy_coeff": 0.0}}, "num_steps_sampled": 1480000, "num_steps_trained": 1480000}, "done": false, "episodes_total": 148, "training_iteration": 370, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_13-59-47", "timestamp": 1618149587, "time_this_iter_s": 28.392144203186035, "time_total_s": 10936.328450679779, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edad10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10936.328450679779, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 63.43414634146341, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 208.0, "episode_reward_min": 208.0, "episode_reward_mean": 208.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.599539610074761, "mean_raw_obs_processing_ms": 0.13395625645191891, "mean_inference_ms": 2.330700127391418, "mean_action_processing_ms": 0.057750687047607566}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1484000, "timers": {"sample_time_ms": 11619.33, "sample_throughput": 344.254, "learn_time_ms": 17275.879, "learn_throughput": 231.537, "update_time_ms": 3.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.47997079230844975, "policy_loss": -0.028100740164518356, "vf_loss": 0.49845362082123756, "vf_explained_var": 0.5764750242233276, "kl": 0.007404495561786462, "entropy": 0.3101642234250903, "entropy_coeff": 0.0}}, "num_steps_sampled": 1484000, "num_steps_trained": 1484000}, "done": false, "episodes_total": 148, "training_iteration": 371, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-00-16", "timestamp": 1618149616, "time_this_iter_s": 29.286714553833008, "time_total_s": 10965.615165233612, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f107d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10965.615165233612, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 63.98048780487805, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 208.0, "episode_reward_min": 208.0, "episode_reward_mean": 208.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.599539610074761, "mean_raw_obs_processing_ms": 0.13395625645191891, "mean_inference_ms": 2.330700127391418, "mean_action_processing_ms": 0.057750687047607566}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1488000, "timers": {"sample_time_ms": 11628.162, "sample_throughput": 343.992, "learn_time_ms": 17273.937, "learn_throughput": 231.563, "update_time_ms": 3.719}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.5668656509369612, "policy_loss": -0.043674020969774574, "vf_loss": 0.5955389607697725, "vf_explained_var": 0.504740834236145, "kl": 0.011548527225386351, "entropy": 0.3400082625448704, "entropy_coeff": 0.0}}, "num_steps_sampled": 1488000, "num_steps_trained": 1488000}, "done": false, "episodes_total": 148, "training_iteration": 372, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-00-45", "timestamp": 1618149645, "time_this_iter_s": 28.70250654220581, "time_total_s": 10994.317671775818, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6ad50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10994.317671775818, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 63.46341463414634, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 98.0, "episode_reward_min": 98.0, "episode_reward_mean": 98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5966423455097438, "mean_raw_obs_processing_ms": 0.13437030884440976, "mean_inference_ms": 2.3312714539230694, "mean_action_processing_ms": 0.05776628519680783}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1492000, "timers": {"sample_time_ms": 11620.882, "sample_throughput": 344.208, "learn_time_ms": 17257.233, "learn_throughput": 231.787, "update_time_ms": 3.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.634358737617731, "policy_loss": -0.03658916620770469, "vf_loss": 1.662428930401802, "vf_explained_var": 0.5847334861755371, "kl": 0.006558446024428122, "entropy": 0.30231438763439655, "entropy_coeff": 0.0}}, "num_steps_sampled": 1492000, "num_steps_trained": 1492000}, "done": false, "episodes_total": 149, "training_iteration": 373, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-01-14", "timestamp": 1618149674, "time_this_iter_s": 28.794320106506348, "time_total_s": 11023.111991882324, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edaf50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11023.111991882324, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 63.08571428571428, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 98.0, "episode_reward_min": 98.0, "episode_reward_mean": 98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5966423455097438, "mean_raw_obs_processing_ms": 0.13437030884440976, "mean_inference_ms": 2.3312714539230694, "mean_action_processing_ms": 0.05776628519680783}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1496000, "timers": {"sample_time_ms": 11564.147, "sample_throughput": 345.897, "learn_time_ms": 17248.744, "learn_throughput": 231.901, "update_time_ms": 3.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.8443953096866608, "policy_loss": -0.04298067092895508, "vf_loss": 0.875989924184978, "vf_explained_var": 0.5813906192779541, "kl": 0.008765727528952993, "entropy": 0.27838370064273477, "entropy_coeff": 0.0}}, "num_steps_sampled": 1496000, "num_steps_trained": 1496000}, "done": false, "episodes_total": 149, "training_iteration": 374, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-01-42", "timestamp": 1618149702, "time_this_iter_s": 28.403326511383057, "time_total_s": 11051.515318393707, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc02d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11051.515318393707, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 63.30250000000001, "ram_util_percent": 27.8}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 254.0, "episode_reward_min": 254.0, "episode_reward_mean": 254.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [254.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5950194899729686, "mean_raw_obs_processing_ms": 0.13463570917398238, "mean_inference_ms": 2.3314353018206893, "mean_action_processing_ms": 0.05777510304032234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1500000, "timers": {"sample_time_ms": 11651.13, "sample_throughput": 343.314, "learn_time_ms": 17231.086, "learn_throughput": 232.139, "update_time_ms": 3.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 2.375148981809616, "policy_loss": -0.035342957417014986, "vf_loss": 2.400840640068054, "vf_explained_var": 0.6686074733734131, "kl": 0.007430156198097393, "entropy": 0.2766324863769114, "entropy_coeff": 0.0}}, "num_steps_sampled": 1500000, "num_steps_trained": 1500000}, "done": false, "episodes_total": 150, "training_iteration": 375, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-02-12", "timestamp": 1618149732, "time_this_iter_s": 29.329824924468994, "time_total_s": 11080.845143318176, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11080.845143318176, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 63.48809523809525, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 254.0, "episode_reward_min": 254.0, "episode_reward_mean": 254.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [254.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5950194899729686, "mean_raw_obs_processing_ms": 0.13463570917398238, "mean_inference_ms": 2.3314353018206893, "mean_action_processing_ms": 0.05777510304032234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1504000, "timers": {"sample_time_ms": 11708.22, "sample_throughput": 341.64, "learn_time_ms": 17254.298, "learn_throughput": 231.826, "update_time_ms": 3.592}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.686983659863472, "policy_loss": -0.03373019408900291, "vf_loss": 1.7111267074942589, "vf_explained_var": 0.57424396276474, "kl": 0.007380805705906823, "entropy": 0.2884511388838291, "entropy_coeff": 0.0}}, "num_steps_sampled": 1504000, "num_steps_trained": 1504000}, "done": false, "episodes_total": 150, "training_iteration": 376, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-02-41", "timestamp": 1618149761, "time_this_iter_s": 29.185088396072388, "time_total_s": 11110.030231714249, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11110.030231714249, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 63.63809523809523, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 254.0, "episode_reward_min": 254.0, "episode_reward_mean": 254.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [254.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5950194899729686, "mean_raw_obs_processing_ms": 0.13463570917398238, "mean_inference_ms": 2.3314353018206893, "mean_action_processing_ms": 0.05777510304032234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1508000, "timers": {"sample_time_ms": 11791.622, "sample_throughput": 339.224, "learn_time_ms": 17234.243, "learn_throughput": 232.096, "update_time_ms": 3.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.9499308783560991, "policy_loss": -0.014482170692645013, "vf_loss": 0.9556165803223848, "vf_explained_var": 0.5276618003845215, "kl": 0.006772094595362432, "entropy": 0.10478360252454877, "entropy_coeff": 0.0}}, "num_steps_sampled": 1508000, "num_steps_trained": 1508000}, "done": false, "episodes_total": 150, "training_iteration": 377, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-03-10", "timestamp": 1618149790, "time_this_iter_s": 29.350472450256348, "time_total_s": 11139.380704164505, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11139.380704164505, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 63.690476190476204, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 203.0, "episode_reward_min": 203.0, "episode_reward_mean": 203.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5929620428276018, "mean_raw_obs_processing_ms": 0.13504705851222823, "mean_inference_ms": 2.332068456322419, "mean_action_processing_ms": 0.057797682439673724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1512000, "timers": {"sample_time_ms": 11789.09, "sample_throughput": 339.297, "learn_time_ms": 17210.59, "learn_throughput": 232.415, "update_time_ms": 3.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 2.3604557625949383, "policy_loss": -0.027716051845345646, "vf_loss": 2.38023279979825, "vf_explained_var": 0.5138055682182312, "kl": 0.006111980619607493, "entropy": 0.29855174757540226, "entropy_coeff": 0.0}}, "num_steps_sampled": 1512000, "num_steps_trained": 1512000}, "done": false, "episodes_total": 151, "training_iteration": 378, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-03-40", "timestamp": 1618149820, "time_this_iter_s": 29.290537118911743, "time_total_s": 11168.671241283417, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edad90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11168.671241283417, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 63.44878048780488, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 203.0, "episode_reward_min": 203.0, "episode_reward_mean": 203.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5929620428276018, "mean_raw_obs_processing_ms": 0.13504705851222823, "mean_inference_ms": 2.332068456322419, "mean_action_processing_ms": 0.057797682439673724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1516000, "timers": {"sample_time_ms": 11803.476, "sample_throughput": 338.883, "learn_time_ms": 17163.775, "learn_throughput": 233.049, "update_time_ms": 3.459}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.7937564514577389, "policy_loss": -0.036834733764408156, "vf_loss": 1.821090918034315, "vf_explained_var": 0.5615638494491577, "kl": 0.007313924157642759, "entropy": 0.30623527709394693, "entropy_coeff": 0.0}}, "num_steps_sampled": 1516000, "num_steps_trained": 1516000}, "done": false, "episodes_total": 151, "training_iteration": 379, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-04-09", "timestamp": 1618149849, "time_this_iter_s": 29.060808658599854, "time_total_s": 11197.732049942017, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11197.732049942017, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 63.67619047619048, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 301.0, "episode_reward_min": 301.0, "episode_reward_mean": 301.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5915455890137852, "mean_raw_obs_processing_ms": 0.13530723836552297, "mean_inference_ms": 2.332322272114278, "mean_action_processing_ms": 0.05781066818056659}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1520000, "timers": {"sample_time_ms": 11831.29, "sample_throughput": 338.087, "learn_time_ms": 17202.618, "learn_throughput": 232.523, "update_time_ms": 3.52}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 2.9597360119223595, "policy_loss": -0.035367197007872164, "vf_loss": 2.987499926239252, "vf_explained_var": 0.6415987014770508, "kl": 0.005853463801031467, "entropy": 0.28611672576516867, "entropy_coeff": 0.0}}, "num_steps_sampled": 1520000, "num_steps_trained": 1520000}, "done": false, "episodes_total": 152, "training_iteration": 380, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-04-38", "timestamp": 1618149878, "time_this_iter_s": 29.055216073989868, "time_total_s": 11226.787266016006, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b474ad50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11226.787266016006, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 63.68536585365853, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 301.0, "episode_reward_min": 301.0, "episode_reward_mean": 301.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5915455890137852, "mean_raw_obs_processing_ms": 0.13530723836552297, "mean_inference_ms": 2.332322272114278, "mean_action_processing_ms": 0.05781066818056659}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1524000, "timers": {"sample_time_ms": 11873.49, "sample_throughput": 336.885, "learn_time_ms": 17202.792, "learn_throughput": 232.52, "update_time_ms": 3.507}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.6034786514937878, "policy_loss": -0.02327611349755898, "vf_loss": 1.6201541721820831, "vf_explained_var": 0.627729058265686, "kl": 0.005081555216747802, "entropy": 0.2627060078084469, "entropy_coeff": 0.0}}, "num_steps_sampled": 1524000, "num_steps_trained": 1524000}, "done": false, "episodes_total": 152, "training_iteration": 381, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-05-08", "timestamp": 1618149908, "time_this_iter_s": 29.707783699035645, "time_total_s": 11256.495049715042, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11256.495049715042, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 63.99302325581395, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 301.0, "episode_reward_min": 301.0, "episode_reward_mean": 301.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5915455890137852, "mean_raw_obs_processing_ms": 0.13530723836552297, "mean_inference_ms": 2.332322272114278, "mean_action_processing_ms": 0.05781066818056659}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1528000, "timers": {"sample_time_ms": 11908.41, "sample_throughput": 335.897, "learn_time_ms": 17257.093, "learn_throughput": 231.789, "update_time_ms": 3.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 3.128570917993784, "policy_loss": -0.027699099329765886, "vf_loss": 3.148572914302349, "vf_explained_var": 0.493276447057724, "kl": 0.005925743113039061, "entropy": 0.32909371703863144, "entropy_coeff": 0.0}}, "num_steps_sampled": 1528000, "num_steps_trained": 1528000}, "done": false, "episodes_total": 152, "training_iteration": 382, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-05-37", "timestamp": 1618149937, "time_this_iter_s": 29.59808874130249, "time_total_s": 11286.093138456345, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b474abd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11286.093138456345, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 63.69285714285714, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 229.0, "episode_reward_min": 229.0, "episode_reward_mean": 229.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5894922547941541, "mean_raw_obs_processing_ms": 0.13571069209259753, "mean_inference_ms": 2.333135344204189, "mean_action_processing_ms": 0.05783091504012974}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1532000, "timers": {"sample_time_ms": 11982.917, "sample_throughput": 333.809, "learn_time_ms": 17246.521, "learn_throughput": 231.931, "update_time_ms": 3.41}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.6883445754647255, "policy_loss": -0.03750408039195463, "vf_loss": 1.718025341629982, "vf_explained_var": 0.5413222312927246, "kl": 0.006022890956955962, "entropy": 0.2248738519847393, "entropy_coeff": 0.0}}, "num_steps_sampled": 1532000, "num_steps_trained": 1532000}, "done": false, "episodes_total": 153, "training_iteration": 383, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-06-07", "timestamp": 1618149967, "time_this_iter_s": 29.42797088623047, "time_total_s": 11315.521109342575, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11315.521109342575, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 63.25952380952381, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 229.0, "episode_reward_min": 229.0, "episode_reward_mean": 229.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5894922547941541, "mean_raw_obs_processing_ms": 0.13571069209259753, "mean_inference_ms": 2.333135344204189, "mean_action_processing_ms": 0.05783091504012974}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1536000, "timers": {"sample_time_ms": 11991.97, "sample_throughput": 333.557, "learn_time_ms": 17228.984, "learn_throughput": 232.167, "update_time_ms": 3.478}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 1.1943808160722256, "policy_loss": -0.02831482538022101, "vf_loss": 1.2134609688073397, "vf_explained_var": 0.5724989771842957, "kl": 0.007109425532689784, "entropy": 0.20788236614316702, "entropy_coeff": 0.0}}, "num_steps_sampled": 1536000, "num_steps_trained": 1536000}, "done": false, "episodes_total": 153, "training_iteration": 384, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-06-35", "timestamp": 1618149995, "time_this_iter_s": 28.321892499923706, "time_total_s": 11343.843001842499, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11343.843001842499, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 62.66097560975609, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 146.0, "episode_reward_min": 146.0, "episode_reward_mean": 146.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5877015465267375, "mean_raw_obs_processing_ms": 0.13599514072514776, "mean_inference_ms": 2.3336536080724755, "mean_action_processing_ms": 0.05784056456043948}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1540000, "timers": {"sample_time_ms": 12040.37, "sample_throughput": 332.216, "learn_time_ms": 17203.689, "learn_throughput": 232.508, "update_time_ms": 3.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.4367590360343456, "policy_loss": -0.025030741817317903, "vf_loss": 0.45346533320844173, "vf_explained_var": 0.6424227356910706, "kl": 0.006408705477952026, "entropy": 0.26581188617274165, "entropy_coeff": 0.0}}, "num_steps_sampled": 1540000, "num_steps_trained": 1540000}, "done": false, "episodes_total": 154, "training_iteration": 385, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-07-05", "timestamp": 1618150025, "time_this_iter_s": 29.574639320373535, "time_total_s": 11373.417641162872, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edab10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11373.417641162872, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 63.821428571428584, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 146.0, "episode_reward_min": 146.0, "episode_reward_mean": 146.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5877015465267375, "mean_raw_obs_processing_ms": 0.13599514072514776, "mean_inference_ms": 2.3336536080724755, "mean_action_processing_ms": 0.05784056456043948}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1544000, "timers": {"sample_time_ms": 12026.78, "sample_throughput": 332.591, "learn_time_ms": 17233.201, "learn_throughput": 232.11, "update_time_ms": 3.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.8790710400789976, "policy_loss": -0.026911442633718252, "vf_loss": 0.8993716202676296, "vf_explained_var": 0.7875895500183105, "kl": 0.00508948510105256, "entropy": 0.2830518218688667, "entropy_coeff": 0.0}}, "num_steps_sampled": 1544000, "num_steps_trained": 1544000}, "done": false, "episodes_total": 154, "training_iteration": 386, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-07-34", "timestamp": 1618150054, "time_this_iter_s": 29.3491690158844, "time_total_s": 11402.766810178757, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d736d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11402.766810178757, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 63.85714285714285, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 146.0, "episode_reward_min": 146.0, "episode_reward_mean": 146.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5877015465267375, "mean_raw_obs_processing_ms": 0.13599514072514776, "mean_inference_ms": 2.3336536080724755, "mean_action_processing_ms": 0.05784056456043948}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1548000, "timers": {"sample_time_ms": 12024.404, "sample_throughput": 332.657, "learn_time_ms": 17267.963, "learn_throughput": 231.643, "update_time_ms": 3.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.7756407056003809, "policy_loss": -0.01775878033367917, "vf_loss": 0.7868043156340718, "vf_explained_var": 0.5386099219322205, "kl": 0.005077402907772921, "entropy": 0.3390251426026225, "entropy_coeff": 0.0}}, "num_steps_sampled": 1548000, "num_steps_trained": 1548000}, "done": false, "episodes_total": 154, "training_iteration": 387, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-08-04", "timestamp": 1618150084, "time_this_iter_s": 29.676109313964844, "time_total_s": 11432.442919492722, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d9e790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d9ee90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11432.442919492722, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 64.00000000000001, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 93.0, "episode_reward_min": 93.0, "episode_reward_mean": 93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5849584134440119, "mean_raw_obs_processing_ms": 0.136393020897521, "mean_inference_ms": 2.334697362161407, "mean_action_processing_ms": 0.05786324181875823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1552000, "timers": {"sample_time_ms": 11986.796, "sample_throughput": 333.701, "learn_time_ms": 17311.042, "learn_throughput": 231.066, "update_time_ms": 3.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.08471454557729885, "policy_loss": -0.020281262375647202, "vf_loss": 0.09790161543060094, "vf_explained_var": 0.38639312982559204, "kl": 0.005461571410705801, "entropy": 0.4044683054089546, "entropy_coeff": 0.0}}, "num_steps_sampled": 1552000, "num_steps_trained": 1552000}, "done": false, "episodes_total": 155, "training_iteration": 388, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-08-33", "timestamp": 1618150113, "time_this_iter_s": 29.340062379837036, "time_total_s": 11461.782981872559, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaaed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11461.782981872559, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 63.849999999999994, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 93.0, "episode_reward_min": 93.0, "episode_reward_mean": 93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5849584134440119, "mean_raw_obs_processing_ms": 0.136393020897521, "mean_inference_ms": 2.334697362161407, "mean_action_processing_ms": 0.05786324181875823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1556000, "timers": {"sample_time_ms": 12006.404, "sample_throughput": 333.156, "learn_time_ms": 17322.968, "learn_throughput": 230.907, "update_time_ms": 3.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.09204592526657507, "policy_loss": -0.028780435444787145, "vf_loss": 0.10941998870112002, "vf_explained_var": 0.5841858386993408, "kl": 0.008781371092482004, "entropy": 0.21632111025974154, "entropy_coeff": 0.0}}, "num_steps_sampled": 1556000, "num_steps_trained": 1556000}, "done": false, "episodes_total": 155, "training_iteration": 389, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-09-03", "timestamp": 1618150143, "time_this_iter_s": 29.38022494316101, "time_total_s": 11491.16320681572, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d733d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11491.16320681572, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 63.88333333333334, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 46.0, "episode_reward_min": 46.0, "episode_reward_mean": 46.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5831125336195824, "mean_raw_obs_processing_ms": 0.1366571693570626, "mean_inference_ms": 2.3352343209763897, "mean_action_processing_ms": 0.05787401768775722}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1560000, "timers": {"sample_time_ms": 11958.654, "sample_throughput": 334.486, "learn_time_ms": 17354.489, "learn_throughput": 230.488, "update_time_ms": 3.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.44890500884503126, "policy_loss": -0.0232173825497739, "vf_loss": 0.46459836373105645, "vf_explained_var": 0.5358327627182007, "kl": 0.005792481613752898, "entropy": 0.2814658572897315, "entropy_coeff": 0.0}}, "num_steps_sampled": 1560000, "num_steps_trained": 1560000}, "done": false, "episodes_total": 156, "training_iteration": 390, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-09-32", "timestamp": 1618150172, "time_this_iter_s": 28.89611840248108, "time_total_s": 11520.0593252182, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1acd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11520.0593252182, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 63.66097560975611, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 46.0, "episode_reward_min": 46.0, "episode_reward_mean": 46.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5831125336195824, "mean_raw_obs_processing_ms": 0.1366571693570626, "mean_inference_ms": 2.3352343209763897, "mean_action_processing_ms": 0.05787401768775722}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1564000, "timers": {"sample_time_ms": 11883.997, "sample_throughput": 336.587, "learn_time_ms": 17341.282, "learn_throughput": 230.663, "update_time_ms": 4.011}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.2058651519473642, "policy_loss": -0.03483993269037455, "vf_loss": 0.23043482517823577, "vf_explained_var": 0.47926750779151917, "kl": 0.007906715138233267, "entropy": 0.32990970835089684, "entropy_coeff": 0.0}}, "num_steps_sampled": 1564000, "num_steps_trained": 1564000}, "done": false, "episodes_total": 156, "training_iteration": 391, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-10-00", "timestamp": 1618150200, "time_this_iter_s": 28.8348286151886, "time_total_s": 11548.89415383339, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11548.89415383339, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 63.40238095238095, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 46.0, "episode_reward_min": 46.0, "episode_reward_mean": 46.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5831125336195824, "mean_raw_obs_processing_ms": 0.1366571693570626, "mean_inference_ms": 2.3352343209763897, "mean_action_processing_ms": 0.05787401768775722}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1568000, "timers": {"sample_time_ms": 11811.806, "sample_throughput": 338.644, "learn_time_ms": 17278.006, "learn_throughput": 231.508, "update_time_ms": 4.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.11627030390081927, "policy_loss": -0.04482069765799679, "vf_loss": 0.144224212737754, "vf_explained_var": 0.7640764713287354, "kl": 0.012985158515220974, "entropy": 0.27004119800403714, "entropy_coeff": 0.0}}, "num_steps_sampled": 1568000, "num_steps_trained": 1568000}, "done": false, "episodes_total": 156, "training_iteration": 392, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-10-29", "timestamp": 1618150229, "time_this_iter_s": 28.24808669090271, "time_total_s": 11577.142240524292, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11577.142240524292, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 63.02, "ram_util_percent": 27.8}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 44.0, "episode_reward_min": 44.0, "episode_reward_mean": 44.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5802702960121686, "mean_raw_obs_processing_ms": 0.13703956786221105, "mean_inference_ms": 2.335260578118999, "mean_action_processing_ms": 0.05788192527979829}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1572000, "timers": {"sample_time_ms": 11696.46, "sample_throughput": 341.984, "learn_time_ms": 17311.332, "learn_throughput": 231.063, "update_time_ms": 4.662}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5e-05, "total_loss": 0.19558734045131132, "policy_loss": -0.015536235645413399, "vf_loss": 0.20684828306548297, "vf_explained_var": 0.4668516516685486, "kl": 0.003291398723376915, "entropy": 0.24749108124524355, "entropy_coeff": 0.0}}, "num_steps_sampled": 1572000, "num_steps_trained": 1572000}, "done": false, "episodes_total": 157, "training_iteration": 393, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-10-57", "timestamp": 1618150257, "time_this_iter_s": 28.60616183280945, "time_total_s": 11605.748402357101, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d80690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11605.748402357101, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 62.95853658536585, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 44.0, "episode_reward_min": 44.0, "episode_reward_mean": 44.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5802702960121686, "mean_raw_obs_processing_ms": 0.13703956786221105, "mean_inference_ms": 2.335260578118999, "mean_action_processing_ms": 0.05788192527979829}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1576000, "timers": {"sample_time_ms": 11714.413, "sample_throughput": 341.46, "learn_time_ms": 17349.15, "learn_throughput": 230.559, "update_time_ms": 4.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6494642050936819, "cur_lr": 5e-05, "total_loss": 3.3838663399219513, "policy_loss": -0.04204939235933125, "vf_loss": 3.4132343903183937, "vf_explained_var": 0.6848344802856445, "kl": 0.019525904092006385, "entropy": 0.24148725252598524, "entropy_coeff": 0.0}}, "num_steps_sampled": 1576000, "num_steps_trained": 1576000}, "done": false, "episodes_total": 157, "training_iteration": 394, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-11-26", "timestamp": 1618150286, "time_this_iter_s": 28.879846811294556, "time_total_s": 11634.628249168396, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6ac10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11634.628249168396, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 63.46829268292682, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 518.0, "episode_reward_min": 518.0, "episode_reward_mean": 518.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57846429313963, "mean_raw_obs_processing_ms": 0.13730589756442393, "mean_inference_ms": 2.335587208759517, "mean_action_processing_ms": 0.05789159554243831}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1580000, "timers": {"sample_time_ms": 11619.688, "sample_throughput": 344.243, "learn_time_ms": 17324.352, "learn_throughput": 230.889, "update_time_ms": 4.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6494642050936819, "cur_lr": 5e-05, "total_loss": 6.8722570687532425, "policy_loss": -0.04957153246505186, "vf_loss": 6.908369198441505, "vf_explained_var": 0.44623613357543945, "kl": 0.020723706838907674, "entropy": 0.21969058318063617, "entropy_coeff": 0.0}}, "num_steps_sampled": 1580000, "num_steps_trained": 1580000}, "done": false, "episodes_total": 158, "training_iteration": 395, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-11-55", "timestamp": 1618150315, "time_this_iter_s": 28.370439291000366, "time_total_s": 11662.998688459396, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472fb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11662.998688459396, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 63.541463414634144, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 518.0, "episode_reward_min": 518.0, "episode_reward_mean": 518.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57846429313963, "mean_raw_obs_processing_ms": 0.13730589756442393, "mean_inference_ms": 2.335587208759517, "mean_action_processing_ms": 0.05789159554243831}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1584000, "timers": {"sample_time_ms": 11622.687, "sample_throughput": 344.154, "learn_time_ms": 17318.077, "learn_throughput": 230.973, "update_time_ms": 4.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": 2.9747836589813232, "policy_loss": -0.034348966903053224, "vf_loss": 3.0025778114795685, "vf_explained_var": 0.4742409586906433, "kl": 0.006728459338773973, "entropy": 0.2938171732239425, "entropy_coeff": 0.0}}, "num_steps_sampled": 1584000, "num_steps_trained": 1584000}, "done": false, "episodes_total": 158, "training_iteration": 396, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-12-24", "timestamp": 1618150344, "time_this_iter_s": 29.31901788711548, "time_total_s": 11692.317706346512, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d9e1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d9ef50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11692.317706346512, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 63.69756097560977, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 518.0, "episode_reward_min": 518.0, "episode_reward_mean": 518.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.57846429313963, "mean_raw_obs_processing_ms": 0.13730589756442393, "mean_inference_ms": 2.335587208759517, "mean_action_processing_ms": 0.05789159554243831}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1588000, "timers": {"sample_time_ms": 11697.075, "sample_throughput": 341.966, "learn_time_ms": 17253.349, "learn_throughput": 231.839, "update_time_ms": 4.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": 5.1545325964689255, "policy_loss": -0.03342837360105477, "vf_loss": 5.178939908742905, "vf_explained_var": 0.5830461978912354, "kl": 0.009259967468096875, "entropy": 0.2522617792710662, "entropy_coeff": 0.0}}, "num_steps_sampled": 1588000, "num_steps_trained": 1588000}, "done": false, "episodes_total": 158, "training_iteration": 397, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-12-54", "timestamp": 1618150374, "time_this_iter_s": 29.76735782623291, "time_total_s": 11722.085064172745, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11722.085064172745, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 63.67906976744186, "ram_util_percent": 27.823255813953494}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 315.0, "episode_reward_min": 315.0, "episode_reward_mean": 315.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5765677805371398, "mean_raw_obs_processing_ms": 0.13771108742302912, "mean_inference_ms": 2.336446353423792, "mean_action_processing_ms": 0.05791228816411275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1592000, "timers": {"sample_time_ms": 11713.926, "sample_throughput": 341.474, "learn_time_ms": 17222.306, "learn_throughput": 232.257, "update_time_ms": 4.563}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": 1.660301312804222, "policy_loss": -0.02180566021706909, "vf_loss": 1.6749700270593166, "vf_explained_var": 0.4970915615558624, "kl": 0.00732600106857717, "entropy": 0.21511599933728576, "entropy_coeff": 0.0}}, "num_steps_sampled": 1592000, "num_steps_trained": 1592000}, "done": false, "episodes_total": 159, "training_iteration": 398, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-13-23", "timestamp": 1618150403, "time_this_iter_s": 29.19694495201111, "time_total_s": 11751.282009124756, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11751.282009124756, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 63.540476190476184, "ram_util_percent": 27.880952380952376}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 315.0, "episode_reward_min": 315.0, "episode_reward_mean": 315.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5765677805371398, "mean_raw_obs_processing_ms": 0.13771108742302912, "mean_inference_ms": 2.336446353423792, "mean_action_processing_ms": 0.05791228816411275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1596000, "timers": {"sample_time_ms": 11686.205, "sample_throughput": 342.284, "learn_time_ms": 17196.166, "learn_throughput": 232.61, "update_time_ms": 4.503}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9741963076405228, "cur_lr": 5e-05, "total_loss": 1.9499066919088364, "policy_loss": -0.027477138210088015, "vf_loss": 1.9725291170179844, "vf_explained_var": 0.7654229402542114, "kl": 0.004983284474292304, "entropy": 0.19988190988078713, "entropy_coeff": 0.0}}, "num_steps_sampled": 1596000, "num_steps_trained": 1596000}, "done": false, "episodes_total": 159, "training_iteration": 399, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-13-52", "timestamp": 1618150432, "time_this_iter_s": 28.834484338760376, "time_total_s": 11780.116493463516, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11780.116493463516, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 63.712195121951225, "ram_util_percent": 27.89756097560976}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 191.0, "episode_reward_min": 191.0, "episode_reward_mean": 191.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5750965246364991, "mean_raw_obs_processing_ms": 0.13795544510676336, "mean_inference_ms": 2.3363520940585536, "mean_action_processing_ms": 0.057914300425323556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1600000, "timers": {"sample_time_ms": 11658.214, "sample_throughput": 343.106, "learn_time_ms": 17244.332, "learn_throughput": 231.96, "update_time_ms": 5.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 2.742158707231283, "policy_loss": -0.03087894056807272, "vf_loss": 2.767870672047138, "vf_explained_var": 0.5023350119590759, "kl": 0.010607705320580862, "entropy": 0.20916444808244705, "entropy_coeff": 0.0}}, "num_steps_sampled": 1600000, "num_steps_trained": 1600000}, "done": false, "episodes_total": 160, "training_iteration": 400, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-14-21", "timestamp": 1618150461, "time_this_iter_s": 29.10276508331299, "time_total_s": 11809.21925854683, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3efc3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11809.21925854683, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 63.18780487804877, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 191.0, "episode_reward_min": 191.0, "episode_reward_mean": 191.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5750965246364991, "mean_raw_obs_processing_ms": 0.13795544510676336, "mean_inference_ms": 2.3363520940585536, "mean_action_processing_ms": 0.057914300425323556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1604000, "timers": {"sample_time_ms": 11706.732, "sample_throughput": 341.684, "learn_time_ms": 17104.253, "learn_throughput": 233.86, "update_time_ms": 4.974}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 2.3185914121568203, "policy_loss": -0.041452835488598794, "vf_loss": 2.3523769602179527, "vf_explained_var": 0.7371207475662231, "kl": 0.01574068405898288, "entropy": 0.26531004859134555, "entropy_coeff": 0.0}}, "num_steps_sampled": 1604000, "num_steps_trained": 1604000}, "done": false, "episodes_total": 160, "training_iteration": 401, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-14-49", "timestamp": 1618150489, "time_this_iter_s": 27.914738178253174, "time_total_s": 11837.133996725082, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11837.133996725082, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 63.427499999999995, "ram_util_percent": 27.889999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 191.0, "episode_reward_min": 191.0, "episode_reward_mean": 191.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5750965246364991, "mean_raw_obs_processing_ms": 0.13795544510676336, "mean_inference_ms": 2.3363520940585536, "mean_action_processing_ms": 0.057914300425323556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1608000, "timers": {"sample_time_ms": 11752.573, "sample_throughput": 340.351, "learn_time_ms": 17121.056, "learn_throughput": 233.63, "update_time_ms": 4.268}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 2.8065285719931126, "policy_loss": -0.03024734408245422, "vf_loss": 2.8308888413012028, "vf_explained_var": 0.721876323223114, "kl": 0.012085990878404118, "entropy": 0.2764667524024844, "entropy_coeff": 0.0}}, "num_steps_sampled": 1608000, "num_steps_trained": 1608000}, "done": false, "episodes_total": 160, "training_iteration": 402, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-15-18", "timestamp": 1618150518, "time_this_iter_s": 28.870242595672607, "time_total_s": 11866.004239320755, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e34bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11866.004239320755, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 63.81190476190475, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 336.0, "episode_reward_min": 336.0, "episode_reward_mean": 336.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5726487805377356, "mean_raw_obs_processing_ms": 0.13832722730931768, "mean_inference_ms": 2.336927263555786, "mean_action_processing_ms": 0.05793201938389835}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1612000, "timers": {"sample_time_ms": 11793.901, "sample_throughput": 339.158, "learn_time_ms": 17100.953, "learn_throughput": 233.905, "update_time_ms": 4.303}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 4.265200085937977, "policy_loss": -0.035617131856270134, "vf_loss": 4.292826525866985, "vf_explained_var": 0.630565881729126, "kl": 0.016404671012423933, "entropy": 0.20086222141981125, "entropy_coeff": 0.0}}, "num_steps_sampled": 1612000, "num_steps_trained": 1612000}, "done": false, "episodes_total": 161, "training_iteration": 403, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-15-47", "timestamp": 1618150547, "time_this_iter_s": 28.818768739700317, "time_total_s": 11894.823008060455, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d80050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11894.823008060455, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 64.29512195121953, "ram_util_percent": 27.804878048780488}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 336.0, "episode_reward_min": 336.0, "episode_reward_mean": 336.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5726487805377356, "mean_raw_obs_processing_ms": 0.13832722730931768, "mean_inference_ms": 2.336927263555786, "mean_action_processing_ms": 0.05793201938389835}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1616000, "timers": {"sample_time_ms": 11792.503, "sample_throughput": 339.199, "learn_time_ms": 17056.797, "learn_throughput": 234.511, "update_time_ms": 4.099}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 5.669677644968033, "policy_loss": -0.039616488065803424, "vf_loss": 5.702410265803337, "vf_explained_var": 0.4717766046524048, "kl": 0.014132410142337903, "entropy": 0.19416187889873981, "entropy_coeff": 0.0}}, "num_steps_sampled": 1616000, "num_steps_trained": 1616000}, "done": false, "episodes_total": 161, "training_iteration": 404, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-16-15", "timestamp": 1618150575, "time_this_iter_s": 28.424529552459717, "time_total_s": 11923.247537612915, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11923.247537612915, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 63.2075, "ram_util_percent": 27.9}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 881.0, "episode_reward_min": 881.0, "episode_reward_mean": 881.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [881.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5710082058579831, "mean_raw_obs_processing_ms": 0.13858744799680364, "mean_inference_ms": 2.3372184673938095, "mean_action_processing_ms": 0.05794476328985891}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1620000, "timers": {"sample_time_ms": 11805.583, "sample_throughput": 338.823, "learn_time_ms": 17094.489, "learn_throughput": 233.994, "update_time_ms": 4.091}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 6.118497923016548, "policy_loss": -0.040650525013916194, "vf_loss": 6.149957790970802, "vf_explained_var": 0.4708460569381714, "kl": 0.01886814142926596, "entropy": 0.19159383326768875, "entropy_coeff": 0.0}}, "num_steps_sampled": 1620000, "num_steps_trained": 1620000}, "done": false, "episodes_total": 162, "training_iteration": 405, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-16-44", "timestamp": 1618150604, "time_this_iter_s": 28.87852668762207, "time_total_s": 11952.126064300537, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1aa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaae50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11952.126064300537, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 64.06666666666666, "ram_util_percent": 27.897619047619052}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 881.0, "episode_reward_min": 881.0, "episode_reward_mean": 881.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [881.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5710082058579831, "mean_raw_obs_processing_ms": 0.13858744799680364, "mean_inference_ms": 2.3372184673938095, "mean_action_processing_ms": 0.05794476328985891}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1624000, "timers": {"sample_time_ms": 11795.349, "sample_throughput": 339.117, "learn_time_ms": 17133.503, "learn_throughput": 233.461, "update_time_ms": 4.122}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 5.636690989136696, "policy_loss": -0.050314364256337285, "vf_loss": 5.669871658086777, "vf_explained_var": 0.5891588926315308, "kl": 0.035174823191482574, "entropy": 0.2097541857510805, "entropy_coeff": 0.0}}, "num_steps_sampled": 1624000, "num_steps_trained": 1624000}, "done": false, "episodes_total": 162, "training_iteration": 406, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-17-14", "timestamp": 1618150634, "time_this_iter_s": 29.60420560836792, "time_total_s": 11981.730269908905, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d80850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d80a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11981.730269908905, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 63.55952380952381, "ram_util_percent": 27.802380952380947}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 881.0, "episode_reward_min": 881.0, "episode_reward_mean": 881.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [881.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5710082058579831, "mean_raw_obs_processing_ms": 0.13858744799680364, "mean_inference_ms": 2.3372184673938095, "mean_action_processing_ms": 0.05794476328985891}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1628000, "timers": {"sample_time_ms": 11734.344, "sample_throughput": 340.88, "learn_time_ms": 17086.52, "learn_throughput": 234.103, "update_time_ms": 4.14}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7306472307303921, "cur_lr": 5e-05, "total_loss": 6.592888817191124, "policy_loss": -0.0461372216232121, "vf_loss": 6.6191035360097885, "vf_explained_var": 0.29726141691207886, "kl": 0.02726687944959849, "entropy": 0.18861029716208577, "entropy_coeff": 0.0}}, "num_steps_sampled": 1628000, "num_steps_trained": 1628000}, "done": false, "episodes_total": 162, "training_iteration": 407, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-17-43", "timestamp": 1618150663, "time_this_iter_s": 28.68713140487671, "time_total_s": 12010.417401313782, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12010.417401313782, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 62.699999999999996, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 669.0, "episode_reward_min": 669.0, "episode_reward_mean": 669.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [669.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5690016736928745, "mean_raw_obs_processing_ms": 0.13896213211127553, "mean_inference_ms": 2.3376847753979697, "mean_action_processing_ms": 0.05795686310870058}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1632000, "timers": {"sample_time_ms": 11708.462, "sample_throughput": 341.633, "learn_time_ms": 17085.861, "learn_throughput": 234.112, "update_time_ms": 4.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 5.891404032707214, "policy_loss": -0.03647801128681749, "vf_loss": 5.917934477329254, "vf_explained_var": 0.43056294322013855, "kl": 0.00907650068984367, "entropy": 0.17390275071375072, "entropy_coeff": 0.0}}, "num_steps_sampled": 1632000, "num_steps_trained": 1632000}, "done": false, "episodes_total": 163, "training_iteration": 408, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-18-12", "timestamp": 1618150692, "time_this_iter_s": 28.937384843826294, "time_total_s": 12039.354786157608, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d9e510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12039.354786157608, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 63.390243902439025, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 669.0, "episode_reward_min": 669.0, "episode_reward_mean": 669.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [669.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5690016736928745, "mean_raw_obs_processing_ms": 0.13896213211127553, "mean_inference_ms": 2.3376847753979697, "mean_action_processing_ms": 0.05795686310870058}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1636000, "timers": {"sample_time_ms": 11703.92, "sample_throughput": 341.766, "learn_time_ms": 17096.701, "learn_throughput": 233.963, "update_time_ms": 4.323}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 5.187167681753635, "policy_loss": -0.03615090134553611, "vf_loss": 5.205733440816402, "vf_explained_var": 0.5025888085365295, "kl": 0.016045236930949613, "entropy": 0.1889445218257606, "entropy_coeff": 0.0}}, "num_steps_sampled": 1636000, "num_steps_trained": 1636000}, "done": false, "episodes_total": 163, "training_iteration": 409, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-18-40", "timestamp": 1618150720, "time_this_iter_s": 28.90028667449951, "time_total_s": 12068.255072832108, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3ec8bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12068.255072832108, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 63.70975609756098, "ram_util_percent": 27.887804878048776}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 769.0, "episode_reward_min": 769.0, "episode_reward_mean": 769.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [769.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5673675155186304, "mean_raw_obs_processing_ms": 0.1391985236375907, "mean_inference_ms": 2.337999071249314, "mean_action_processing_ms": 0.057965600036215766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1640000, "timers": {"sample_time_ms": 11739.306, "sample_throughput": 340.736, "learn_time_ms": 17053.475, "learn_throughput": 234.556, "update_time_ms": 3.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 4.17453096061945, "policy_loss": -0.022831745445728302, "vf_loss": 4.188815452158451, "vf_explained_var": 0.5934486389160156, "kl": 0.007798792401445098, "entropy": 0.16096337512135506, "entropy_coeff": 0.0}}, "num_steps_sampled": 1640000, "num_steps_trained": 1640000}, "done": false, "episodes_total": 164, "training_iteration": 410, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-19-10", "timestamp": 1618150750, "time_this_iter_s": 29.02582025527954, "time_total_s": 12097.280893087387, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edabd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12097.280893087387, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 63.895238095238106, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 769.0, "episode_reward_min": 769.0, "episode_reward_mean": 769.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [769.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5673675155186304, "mean_raw_obs_processing_ms": 0.1391985236375907, "mean_inference_ms": 2.337999071249314, "mean_action_processing_ms": 0.057965600036215766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1644000, "timers": {"sample_time_ms": 11698.445, "sample_throughput": 341.926, "learn_time_ms": 17154.864, "learn_throughput": 233.17, "update_time_ms": 3.915}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 3.847275048494339, "policy_loss": -0.033861876116134226, "vf_loss": 3.8722582533955574, "vf_explained_var": 0.6788378953933716, "kl": 0.008101162049570121, "entropy": 0.17550358502194285, "entropy_coeff": 0.0}}, "num_steps_sampled": 1644000, "num_steps_trained": 1644000}, "done": false, "episodes_total": 164, "training_iteration": 411, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-19-38", "timestamp": 1618150778, "time_this_iter_s": 28.52389430999756, "time_total_s": 12125.804787397385, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d806d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12125.804787397385, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 63.93414634146343, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 769.0, "episode_reward_min": 769.0, "episode_reward_mean": 769.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [769.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5673675155186304, "mean_raw_obs_processing_ms": 0.1391985236375907, "mean_inference_ms": 2.337999071249314, "mean_action_processing_ms": 0.057965600036215766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1648000, "timers": {"sample_time_ms": 11691.688, "sample_throughput": 342.123, "learn_time_ms": 17180.392, "learn_throughput": 232.824, "update_time_ms": 3.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 5.777288571000099, "policy_loss": -0.03286633174866438, "vf_loss": 5.801850147545338, "vf_explained_var": 0.44920581579208374, "kl": 0.007577537777251564, "entropy": 0.15594831365160644, "entropy_coeff": 0.0}}, "num_steps_sampled": 1648000, "num_steps_trained": 1648000}, "done": false, "episodes_total": 164, "training_iteration": 412, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-20-07", "timestamp": 1618150807, "time_this_iter_s": 29.057827711105347, "time_total_s": 12154.86261510849, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12154.86261510849, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 63.92195121951219, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 808.0, "episode_reward_min": 808.0, "episode_reward_mean": 808.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [808.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5647976642467349, "mean_raw_obs_processing_ms": 0.1395749349542582, "mean_inference_ms": 2.3383653579821635, "mean_action_processing_ms": 0.05797516315880198}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1652000, "timers": {"sample_time_ms": 11671.472, "sample_throughput": 342.716, "learn_time_ms": 17173.081, "learn_throughput": 232.923, "update_time_ms": 3.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 5.266925469040871, "policy_loss": -0.01940591336460784, "vf_loss": 5.280589796602726, "vf_explained_var": 0.7703689336776733, "kl": 0.005238836703938432, "entropy": 0.16932329488918185, "entropy_coeff": 0.0}}, "num_steps_sampled": 1652000, "num_steps_trained": 1652000}, "done": false, "episodes_total": 165, "training_iteration": 413, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-20-36", "timestamp": 1618150836, "time_this_iter_s": 28.547845125198364, "time_total_s": 12183.410460233688, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12183.410460233688, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 62.49268292682926, "ram_util_percent": 27.804878048780488}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 808.0, "episode_reward_min": 808.0, "episode_reward_mean": 808.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [808.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5647976642467349, "mean_raw_obs_processing_ms": 0.1395749349542582, "mean_inference_ms": 2.3383653579821635, "mean_action_processing_ms": 0.05797516315880198}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1656000, "timers": {"sample_time_ms": 11648.006, "sample_throughput": 343.406, "learn_time_ms": 17237.017, "learn_throughput": 232.059, "update_time_ms": 4.084}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 5.832379534840584, "policy_loss": -0.03493409315706231, "vf_loss": 5.859893977642059, "vf_explained_var": 0.6579143404960632, "kl": 0.006769879255443811, "entropy": 0.16740246932022274, "entropy_coeff": 0.0}}, "num_steps_sampled": 1656000, "num_steps_trained": 1656000}, "done": false, "episodes_total": 165, "training_iteration": 414, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-21-05", "timestamp": 1618150865, "time_this_iter_s": 28.829559803009033, "time_total_s": 12212.240020036697, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12212.240020036697, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 63.96585365853658, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 578.0, "episode_reward_min": 578.0, "episode_reward_mean": 578.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [578.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5631588878316225, "mean_raw_obs_processing_ms": 0.13983512994596112, "mean_inference_ms": 2.338723365611805, "mean_action_processing_ms": 0.057985457999356046}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1660000, "timers": {"sample_time_ms": 11674.244, "sample_throughput": 342.635, "learn_time_ms": 17330.548, "learn_throughput": 230.806, "update_time_ms": 4.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 5.086684539914131, "policy_loss": -0.014909704972524196, "vf_loss": 5.098817765712738, "vf_explained_var": 0.6139004230499268, "kl": 0.0025334502370242262, "entropy": 0.04549640230834484, "entropy_coeff": 0.0}}, "num_steps_sampled": 1660000, "num_steps_trained": 1660000}, "done": false, "episodes_total": 166, "training_iteration": 415, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-21-35", "timestamp": 1618150895, "time_this_iter_s": 30.072794437408447, "time_total_s": 12242.312814474106, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edabd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3ca5e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12242.312814474106, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 63.781395348837215, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 578.0, "episode_reward_min": 578.0, "episode_reward_mean": 578.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [578.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5631588878316225, "mean_raw_obs_processing_ms": 0.13983512994596112, "mean_inference_ms": 2.338723365611805, "mean_action_processing_ms": 0.057985457999356046}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1664000, "timers": {"sample_time_ms": 11746.407, "sample_throughput": 340.53, "learn_time_ms": 17297.822, "learn_throughput": 231.243, "update_time_ms": 4.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 4.582807555794716, "policy_loss": -0.03526511590462178, "vf_loss": 4.6118860468268394, "vf_explained_var": 0.6854673027992249, "kl": 0.01128977321786806, "entropy": 0.18653906229883432, "entropy_coeff": 0.0}}, "num_steps_sampled": 1664000, "num_steps_trained": 1664000}, "done": false, "episodes_total": 166, "training_iteration": 416, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-22-05", "timestamp": 1618150925, "time_this_iter_s": 29.994359731674194, "time_total_s": 12272.30717420578, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d80150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1aad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12272.30717420578, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 63.583720930232566, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 578.0, "episode_reward_min": 578.0, "episode_reward_mean": 578.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [578.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5631588878316225, "mean_raw_obs_processing_ms": 0.13983512994596112, "mean_inference_ms": 2.338723365611805, "mean_action_processing_ms": 0.057985457999356046}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1668000, "timers": {"sample_time_ms": 11706.803, "sample_throughput": 341.682, "learn_time_ms": 17425.638, "learn_throughput": 229.547, "update_time_ms": 4.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 0.9879748933017254, "policy_loss": -0.026377184520242736, "vf_loss": 1.0078691747039557, "vf_explained_var": 0.3962806463241577, "kl": 0.011830468371044844, "entropy": 0.2673072014003992, "entropy_coeff": 0.0}}, "num_steps_sampled": 1668000, "num_steps_trained": 1668000}, "done": false, "episodes_total": 166, "training_iteration": 417, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-22-34", "timestamp": 1618150954, "time_this_iter_s": 29.58035135269165, "time_total_s": 12301.887525558472, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f158d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f154d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12301.887525558472, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 64.0547619047619, "ram_util_percent": 27.80714285714286}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 373.0, "episode_reward_min": 373.0, "episode_reward_mean": 373.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5612192484858877, "mean_raw_obs_processing_ms": 0.14021520935388082, "mean_inference_ms": 2.3394365729458344, "mean_action_processing_ms": 0.05799763207519736}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1672000, "timers": {"sample_time_ms": 11718.656, "sample_throughput": 341.336, "learn_time_ms": 17454.126, "learn_throughput": 229.172, "update_time_ms": 3.979}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 4.8582824021577835, "policy_loss": -0.04473473544931039, "vf_loss": 4.884299218654633, "vf_explained_var": 0.7374768853187561, "kl": 0.03415773925371468, "entropy": 0.22205129731446505, "entropy_coeff": 0.0}}, "num_steps_sampled": 1672000, "num_steps_trained": 1672000}, "done": false, "episodes_total": 167, "training_iteration": 418, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-23-04", "timestamp": 1618150984, "time_this_iter_s": 29.336894273757935, "time_total_s": 12331.22441983223, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d9e590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d9e390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12331.22441983223, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 63.93809523809523, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 373.0, "episode_reward_min": 373.0, "episode_reward_mean": 373.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5612192484858877, "mean_raw_obs_processing_ms": 0.14021520935388082, "mean_inference_ms": 2.3394365729458344, "mean_action_processing_ms": 0.05799763207519736}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1676000, "timers": {"sample_time_ms": 11731.801, "sample_throughput": 340.954, "learn_time_ms": 17417.678, "learn_throughput": 229.652, "update_time_ms": 3.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 7.269790560007095, "policy_loss": -0.041233749710954726, "vf_loss": 7.303898483514786, "vf_explained_var": 0.6230673789978027, "kl": 0.008668934926390648, "entropy": 0.16684541013091803, "entropy_coeff": 0.0}}, "num_steps_sampled": 1676000, "num_steps_trained": 1676000}, "done": false, "episodes_total": 167, "training_iteration": 419, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-23-33", "timestamp": 1618151013, "time_this_iter_s": 28.668856143951416, "time_total_s": 12359.893275976181, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12359.893275976181, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 63.53658536585366, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 669.0, "episode_reward_min": 669.0, "episode_reward_mean": 669.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [669.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5606277137365991, "mean_raw_obs_processing_ms": 0.14045295217173737, "mean_inference_ms": 2.3394680703764466, "mean_action_processing_ms": 0.05800084240760615}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1680000, "timers": {"sample_time_ms": 11837.749, "sample_throughput": 337.902, "learn_time_ms": 17378.2, "learn_throughput": 230.173, "update_time_ms": 3.559}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 8.169945895671844, "policy_loss": -0.032203592389123514, "vf_loss": 8.194446712732315, "vf_explained_var": 0.4763375520706177, "kl": 0.009371061911224388, "entropy": 0.17499979631975293, "entropy_coeff": 0.0}}, "num_steps_sampled": 1680000, "num_steps_trained": 1680000}, "done": false, "episodes_total": 168, "training_iteration": 420, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-24-02", "timestamp": 1618151042, "time_this_iter_s": 29.684399604797363, "time_total_s": 12389.577675580978, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12389.577675580978, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 63.407142857142865, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 669.0, "episode_reward_min": 669.0, "episode_reward_mean": 669.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [669.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5606277137365991, "mean_raw_obs_processing_ms": 0.14045295217173737, "mean_inference_ms": 2.3394680703764466, "mean_action_processing_ms": 0.05800084240760615}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1684000, "timers": {"sample_time_ms": 11945.002, "sample_throughput": 334.868, "learn_time_ms": 17511.791, "learn_throughput": 228.418, "update_time_ms": 3.504}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 6.479935750365257, "policy_loss": -0.02356427611084655, "vf_loss": 6.493952393531799, "vf_explained_var": 0.5242046117782593, "kl": 0.01161537365987897, "entropy": 0.17321672476828098, "entropy_coeff": 0.0}}, "num_steps_sampled": 1684000, "num_steps_trained": 1684000}, "done": false, "episodes_total": 168, "training_iteration": 421, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-24-33", "timestamp": 1618151073, "time_this_iter_s": 30.930530786514282, "time_total_s": 12420.508206367493, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12420.508206367493, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 64.11555555555555, "ram_util_percent": 27.799999999999994}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 669.0, "episode_reward_min": 669.0, "episode_reward_mean": 669.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [669.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5606277137365991, "mean_raw_obs_processing_ms": 0.14045295217173737, "mean_inference_ms": 2.3394680703764466, "mean_action_processing_ms": 0.05800084240760615}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1688000, "timers": {"sample_time_ms": 12017.82, "sample_throughput": 332.839, "learn_time_ms": 17495.699, "learn_throughput": 228.628, "update_time_ms": 3.558}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 8.41883784532547, "policy_loss": -0.03941420780029148, "vf_loss": 8.443305999040604, "vf_explained_var": 0.43907999992370605, "kl": 0.018182949686888605, "entropy": 0.16046613035723567, "entropy_coeff": 0.0}}, "num_steps_sampled": 1688000, "num_steps_trained": 1688000}, "done": false, "episodes_total": 168, "training_iteration": 422, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-25-03", "timestamp": 1618151103, "time_this_iter_s": 29.6204514503479, "time_total_s": 12450.12865781784, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc02d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d9e350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12450.12865781784, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 63.38571428571429, "ram_util_percent": 27.80952380952381}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 703.0, "episode_reward_min": 703.0, "episode_reward_mean": 703.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [703.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.56005987700258, "mean_raw_obs_processing_ms": 0.14081725884972002, "mean_inference_ms": 2.3396876259389545, "mean_action_processing_ms": 0.058005799315224295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1692000, "timers": {"sample_time_ms": 12137.357, "sample_throughput": 329.561, "learn_time_ms": 17550.173, "learn_throughput": 227.918, "update_time_ms": 3.453}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 6.517625883221626, "policy_loss": -0.013240765838418156, "vf_loss": 6.525271832942963, "vf_explained_var": 0.5806993246078491, "kl": 0.0068065124360146, "entropy": 0.13847901136614382, "entropy_coeff": 0.0}}, "num_steps_sampled": 1692000, "num_steps_trained": 1692000}, "done": false, "episodes_total": 169, "training_iteration": 423, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-25-33", "timestamp": 1618151133, "time_this_iter_s": 30.28548812866211, "time_total_s": 12480.414145946503, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6ac10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12480.414145946503, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 64.11627906976744, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 703.0, "episode_reward_min": 703.0, "episode_reward_mean": 703.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [703.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.56005987700258, "mean_raw_obs_processing_ms": 0.14081725884972002, "mean_inference_ms": 2.3396876259389545, "mean_action_processing_ms": 0.058005799315224295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1696000, "timers": {"sample_time_ms": 12217.195, "sample_throughput": 327.407, "learn_time_ms": 17507.57, "learn_throughput": 228.473, "update_time_ms": 3.388}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 7.810333967208862, "policy_loss": -0.013430433988105506, "vf_loss": 7.817528426647186, "vf_explained_var": 0.5369378328323364, "kl": 0.007586449704831466, "entropy": 0.14130440377630293, "entropy_coeff": 0.0}}, "num_steps_sampled": 1696000, "num_steps_trained": 1696000}, "done": false, "episodes_total": 169, "training_iteration": 424, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-26-03", "timestamp": 1618151163, "time_this_iter_s": 29.20286774635315, "time_total_s": 12509.617013692856, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e01510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12509.617013692856, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 63.597619047619055, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 431.0, "episode_reward_min": 431.0, "episode_reward_mean": 431.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [431.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5586264726625823, "mean_raw_obs_processing_ms": 0.1410737193744231, "mean_inference_ms": 2.3402245099947, "mean_action_processing_ms": 0.058013921579469885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1700000, "timers": {"sample_time_ms": 12196.058, "sample_throughput": 327.975, "learn_time_ms": 17376.03, "learn_throughput": 230.202, "update_time_ms": 3.422}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 5.38596560806036, "policy_loss": -0.026101969182491302, "vf_loss": 5.407125607132912, "vf_explained_var": 0.7134761810302734, "kl": 0.006012260913848877, "entropy": 0.10977683565579355, "entropy_coeff": 0.0}}, "num_steps_sampled": 1700000, "num_steps_trained": 1700000}, "done": false, "episodes_total": 170, "training_iteration": 425, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-26-31", "timestamp": 1618151191, "time_this_iter_s": 28.54514241218567, "time_total_s": 12538.162156105042, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12538.162156105042, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 63.59512195121951, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 431.0, "episode_reward_min": 431.0, "episode_reward_mean": 431.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [431.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5586264726625823, "mean_raw_obs_processing_ms": 0.1410737193744231, "mean_inference_ms": 2.3402245099947, "mean_action_processing_ms": 0.058013921579469885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1704000, "timers": {"sample_time_ms": 12164.26, "sample_throughput": 328.832, "learn_time_ms": 17343.88, "learn_throughput": 230.629, "update_time_ms": 3.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 5.05304379761219, "policy_loss": -0.02715140744112432, "vf_loss": 5.0757759511470795, "vf_explained_var": 0.5607905983924866, "kl": 0.005376425568101695, "entropy": 0.0803232635371387, "entropy_coeff": 0.0}}, "num_steps_sampled": 1704000, "num_steps_trained": 1704000}, "done": false, "episodes_total": 170, "training_iteration": 426, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-27-00", "timestamp": 1618151220, "time_this_iter_s": 29.360264539718628, "time_total_s": 12567.52242064476, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b47339d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12567.52242064476, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 64.50731707317073, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 431.0, "episode_reward_min": 431.0, "episode_reward_mean": 431.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [431.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5586264726625823, "mean_raw_obs_processing_ms": 0.1410737193744231, "mean_inference_ms": 2.3402245099947, "mean_action_processing_ms": 0.058013921579469885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1708000, "timers": {"sample_time_ms": 12140.308, "sample_throughput": 329.481, "learn_time_ms": 17332.463, "learn_throughput": 230.781, "update_time_ms": 3.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 6.457881778478622, "policy_loss": -0.03629594435915351, "vf_loss": 6.481012478470802, "vf_explained_var": 0.4173179864883423, "kl": 0.01601648829819169, "entropy": 0.1280651178676635, "entropy_coeff": 0.0}}, "num_steps_sampled": 1708000, "num_steps_trained": 1708000}, "done": false, "episodes_total": 170, "training_iteration": 427, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-27-30", "timestamp": 1618151250, "time_this_iter_s": 29.221441507339478, "time_total_s": 12596.7438621521, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaf650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12596.7438621521, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 64.04523809523809, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 847.0, "episode_reward_min": 847.0, "episode_reward_mean": 847.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [847.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5564454645055703, "mean_raw_obs_processing_ms": 0.1416446570619312, "mean_inference_ms": 2.3408678871293573, "mean_action_processing_ms": 0.05802532565707143}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1712000, "timers": {"sample_time_ms": 12167.744, "sample_throughput": 328.738, "learn_time_ms": 17310.821, "learn_throughput": 231.069, "update_time_ms": 3.591}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 6.471624210476875, "policy_loss": -0.08216135500697419, "vf_loss": 6.504080444574356, "vf_explained_var": 0.6562104225158691, "kl": 0.06047015101648867, "entropy": 0.21541168494150043, "entropy_coeff": 0.0}}, "num_steps_sampled": 1712000, "num_steps_trained": 1712000}, "done": false, "episodes_total": 171, "training_iteration": 428, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-27-59", "timestamp": 1618151279, "time_this_iter_s": 29.39967370033264, "time_total_s": 12626.143535852432, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12626.143535852432, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 64.07142857142858, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 847.0, "episode_reward_min": 847.0, "episode_reward_mean": 847.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [847.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5564454645055703, "mean_raw_obs_processing_ms": 0.1416446570619312, "mean_inference_ms": 2.3408678871293573, "mean_action_processing_ms": 0.05802532565707143}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1716000, "timers": {"sample_time_ms": 12336.837, "sample_throughput": 324.232, "learn_time_ms": 17347.076, "learn_throughput": 230.586, "update_time_ms": 3.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2329672018575366, "cur_lr": 5e-05, "total_loss": 7.437819346785545, "policy_loss": -0.03312141908099875, "vf_loss": 7.461568117141724, "vf_explained_var": 0.5741245746612549, "kl": 0.007601812176289968, "entropy": 0.13913180259987712, "entropy_coeff": 0.0}}, "num_steps_sampled": 1716000, "num_steps_trained": 1716000}, "done": false, "episodes_total": 171, "training_iteration": 429, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-28-30", "timestamp": 1618151310, "time_this_iter_s": 30.718754529953003, "time_total_s": 12656.862290382385, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12656.862290382385, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 63.60681818181819, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 976.0, "episode_reward_min": 976.0, "episode_reward_mean": 976.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [976.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5562525415015416, "mean_raw_obs_processing_ms": 0.14190613111819592, "mean_inference_ms": 2.3413238617952428, "mean_action_processing_ms": 0.05803671695137661}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1720000, "timers": {"sample_time_ms": 12312.629, "sample_throughput": 324.87, "learn_time_ms": 17357.354, "learn_throughput": 230.45, "update_time_ms": 3.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2329672018575366, "cur_lr": 5e-05, "total_loss": 7.851922437548637, "policy_loss": -0.025071619456866756, "vf_loss": 7.868999511003494, "vf_explained_var": 0.5867748260498047, "kl": 0.006483962162747048, "entropy": 0.1716788960620761, "entropy_coeff": 0.0}}, "num_steps_sampled": 1720000, "num_steps_trained": 1720000}, "done": false, "episodes_total": 172, "training_iteration": 430, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-29-00", "timestamp": 1618151340, "time_this_iter_s": 29.5456862449646, "time_total_s": 12686.40797662735, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaaf10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12686.40797662735, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 63.48571428571429, "ram_util_percent": 27.802380952380947}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 976.0, "episode_reward_min": 976.0, "episode_reward_mean": 976.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [976.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5562525415015416, "mean_raw_obs_processing_ms": 0.14190613111819592, "mean_inference_ms": 2.3413238617952428, "mean_action_processing_ms": 0.05803671695137661}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1724000, "timers": {"sample_time_ms": 12344.243, "sample_throughput": 324.038, "learn_time_ms": 17222.902, "learn_throughput": 232.249, "update_time_ms": 3.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2329672018575366, "cur_lr": 5e-05, "total_loss": 5.663730412721634, "policy_loss": -0.02828952734125778, "vf_loss": 5.680974178016186, "vf_explained_var": 0.6887239217758179, "kl": 0.008958649887063075, "entropy": 0.10355657897889614, "entropy_coeff": 0.0}}, "num_steps_sampled": 1724000, "num_steps_trained": 1724000}, "done": false, "episodes_total": 172, "training_iteration": 431, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-29-29", "timestamp": 1618151369, "time_this_iter_s": 29.89973783493042, "time_total_s": 12716.30771446228, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc89d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaad90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12716.30771446228, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 63.77906976744185, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 976.0, "episode_reward_min": 976.0, "episode_reward_mean": 976.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [976.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5562525415015416, "mean_raw_obs_processing_ms": 0.14190613111819592, "mean_inference_ms": 2.3413238617952428, "mean_action_processing_ms": 0.05803671695137661}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1728000, "timers": {"sample_time_ms": 12364.242, "sample_throughput": 323.514, "learn_time_ms": 17209.827, "learn_throughput": 232.425, "update_time_ms": 3.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2329672018575366, "cur_lr": 5e-05, "total_loss": 5.267546221613884, "policy_loss": -0.009298117860453203, "vf_loss": 5.272198975086212, "vf_explained_var": 0.5473037958145142, "kl": 0.003767612754018046, "entropy": 0.11846283217892051, "entropy_coeff": 0.0}}, "num_steps_sampled": 1728000, "num_steps_trained": 1728000}, "done": false, "episodes_total": 172, "training_iteration": 432, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-29-59", "timestamp": 1618151399, "time_this_iter_s": 29.68931484222412, "time_total_s": 12745.997029304504, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12745.997029304504, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 63.671428571428564, "ram_util_percent": 27.826190476190472}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 419.0, "episode_reward_min": 419.0, "episode_reward_mean": 419.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [419.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5550204204460807, "mean_raw_obs_processing_ms": 0.14228629118961766, "mean_inference_ms": 2.3418717833751637, "mean_action_processing_ms": 0.05805067632239852}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1732000, "timers": {"sample_time_ms": 12257.99, "sample_throughput": 326.318, "learn_time_ms": 17105.491, "learn_throughput": 233.843, "update_time_ms": 3.946}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6164836009287683, "cur_lr": 5e-05, "total_loss": 4.893259085714817, "policy_loss": -0.02693048765650019, "vf_loss": 4.913978561758995, "vf_explained_var": 0.5882843136787415, "kl": 0.010074943129438907, "entropy": 0.1402639711741358, "entropy_coeff": 0.0}}, "num_steps_sampled": 1732000, "num_steps_trained": 1732000}, "done": false, "episodes_total": 173, "training_iteration": 433, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-30-27", "timestamp": 1618151427, "time_this_iter_s": 28.17906618118286, "time_total_s": 12774.176095485687, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12774.176095485687, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 62.489999999999995, "ram_util_percent": 27.85}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 419.0, "episode_reward_min": 419.0, "episode_reward_mean": 419.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [419.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5550204204460807, "mean_raw_obs_processing_ms": 0.14228629118961766, "mean_inference_ms": 2.3418717833751637, "mean_action_processing_ms": 0.05805067632239852}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1736000, "timers": {"sample_time_ms": 12388.497, "sample_throughput": 322.88, "learn_time_ms": 17113.04, "learn_throughput": 233.74, "update_time_ms": 4.019}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6164836009287683, "cur_lr": 5e-05, "total_loss": 5.504786044359207, "policy_loss": -0.032159502152353525, "vf_loss": 5.528660386800766, "vf_explained_var": 0.7739951610565186, "kl": 0.013439278423902579, "entropy": 0.17277387669309974, "entropy_coeff": 0.0}}, "num_steps_sampled": 1736000, "num_steps_trained": 1736000}, "done": false, "episodes_total": 173, "training_iteration": 434, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-30-58", "timestamp": 1618151458, "time_this_iter_s": 30.582093954086304, "time_total_s": 12804.758189439774, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12804.758189439774, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 64.29545454545455, "ram_util_percent": 27.86363636363636}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 697.0, "episode_reward_min": 697.0, "episode_reward_mean": 697.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [697.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5548294671481432, "mean_raw_obs_processing_ms": 0.14253434150625116, "mean_inference_ms": 2.342331873212471, "mean_action_processing_ms": 0.0580586725931438}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1740000, "timers": {"sample_time_ms": 12457.427, "sample_throughput": 321.094, "learn_time_ms": 17192.892, "learn_throughput": 232.654, "update_time_ms": 4.003}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6164836009287683, "cur_lr": 5e-05, "total_loss": 6.323133781552315, "policy_loss": -0.046157445351127535, "vf_loss": 6.353553488850594, "vf_explained_var": 0.5431220531463623, "kl": 0.02552828739862889, "entropy": 0.1298810071311891, "entropy_coeff": 0.0}}, "num_steps_sampled": 1740000, "num_steps_trained": 1740000}, "done": false, "episodes_total": 174, "training_iteration": 435, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-31-28", "timestamp": 1618151488, "time_this_iter_s": 30.03405237197876, "time_total_s": 12834.792241811752, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12834.792241811752, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 64.04883720930233, "ram_util_percent": 27.804651162790694}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 697.0, "episode_reward_min": 697.0, "episode_reward_mean": 697.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [697.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5548294671481432, "mean_raw_obs_processing_ms": 0.14253434150625116, "mean_inference_ms": 2.342331873212471, "mean_action_processing_ms": 0.0580586725931438}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1744000, "timers": {"sample_time_ms": 12519.951, "sample_throughput": 319.49, "learn_time_ms": 17183.11, "learn_throughput": 232.787, "update_time_ms": 3.974}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 7.050820022821426, "policy_loss": -0.02665418037213385, "vf_loss": 7.069277673959732, "vf_explained_var": 0.5437438488006592, "kl": 0.008863796378136612, "entropy": 0.14587953803129494, "entropy_coeff": 0.0}}, "num_steps_sampled": 1744000, "num_steps_trained": 1744000}, "done": false, "episodes_total": 174, "training_iteration": 436, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-31-58", "timestamp": 1618151518, "time_this_iter_s": 29.883456230163574, "time_total_s": 12864.675698041916, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f2aa92b0fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12864.675698041916, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 63.465116279069775, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 697.0, "episode_reward_min": 697.0, "episode_reward_mean": 697.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [697.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5548294671481432, "mean_raw_obs_processing_ms": 0.14253434150625116, "mean_inference_ms": 2.342331873212471, "mean_action_processing_ms": 0.0580586725931438}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1748000, "timers": {"sample_time_ms": 12599.345, "sample_throughput": 317.477, "learn_time_ms": 17100.022, "learn_throughput": 233.918, "update_time_ms": 4.161}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 6.952408492565155, "policy_loss": -0.028492367215221748, "vf_loss": 6.972156718373299, "vf_explained_var": 0.6864466071128845, "kl": 0.009455984793021344, "entropy": 0.13843524712137878, "entropy_coeff": 0.0}}, "num_steps_sampled": 1748000, "num_steps_trained": 1748000}, "done": false, "episodes_total": 174, "training_iteration": 437, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-32-27", "timestamp": 1618151547, "time_this_iter_s": 29.18759512901306, "time_total_s": 12893.863293170929, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12893.863293170929, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 62.67560975609756, "ram_util_percent": 27.89756097560976}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 786.0, "episode_reward_min": 786.0, "episode_reward_mean": 786.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [786.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5540268492267243, "mean_raw_obs_processing_ms": 0.14289451879139745, "mean_inference_ms": 2.3424927879241406, "mean_action_processing_ms": 0.05807029621725271}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1752000, "timers": {"sample_time_ms": 12573.353, "sample_throughput": 318.133, "learn_time_ms": 17048.196, "learn_throughput": 234.629, "update_time_ms": 4.13}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 7.1707087606191635, "policy_loss": -0.03062636754475534, "vf_loss": 7.189736306667328, "vf_explained_var": 0.534525454044342, "kl": 0.012543071716208942, "entropy": 0.14075188105925918, "entropy_coeff": 0.0}}, "num_steps_sampled": 1752000, "num_steps_trained": 1752000}, "done": false, "episodes_total": 175, "training_iteration": 438, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-32-56", "timestamp": 1618151576, "time_this_iter_s": 28.61754035949707, "time_total_s": 12922.480833530426, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d736d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12922.480833530426, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 63.070731707317066, "ram_util_percent": 27.890243902439025}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 786.0, "episode_reward_min": 786.0, "episode_reward_mean": 786.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [786.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5540268492267243, "mean_raw_obs_processing_ms": 0.14289451879139745, "mean_inference_ms": 2.3424927879241406, "mean_action_processing_ms": 0.05807029621725271}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1756000, "timers": {"sample_time_ms": 12570.216, "sample_throughput": 318.213, "learn_time_ms": 17031.277, "learn_throughput": 234.862, "update_time_ms": 4.203}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 6.078306347131729, "policy_loss": -0.019207661069231108, "vf_loss": 6.0923580676317215, "vf_explained_var": 0.752824604511261, "kl": 0.005575658658926841, "entropy": 0.09769008331932127, "entropy_coeff": 0.0}}, "num_steps_sampled": 1756000, "num_steps_trained": 1756000}, "done": false, "episodes_total": 175, "training_iteration": 439, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-33-26", "timestamp": 1618151606, "time_this_iter_s": 30.5253586769104, "time_total_s": 12953.006192207336, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b6b3b0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12953.006192207336, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 63.7909090909091, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 676.0, "episode_reward_min": 676.0, "episode_reward_mean": 676.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [676.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5534437963486356, "mean_raw_obs_processing_ms": 0.14314668606618347, "mean_inference_ms": 2.342722695511692, "mean_action_processing_ms": 0.05807801422790406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1760000, "timers": {"sample_time_ms": 12465.564, "sample_throughput": 320.884, "learn_time_ms": 16984.308, "learn_throughput": 235.512, "update_time_ms": 4.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 4.8698758110404015, "policy_loss": -0.024067735706921667, "vf_loss": 4.887385830283165, "vf_explained_var": 0.7685894966125488, "kl": 0.0070915273754508235, "entropy": 0.11203881865367293, "entropy_coeff": 0.0}}, "num_steps_sampled": 1760000, "num_steps_trained": 1760000}, "done": false, "episodes_total": 176, "training_iteration": 440, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-33-55", "timestamp": 1618151635, "time_this_iter_s": 28.029231548309326, "time_total_s": 12981.035423755646, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12981.035423755646, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 63.64, "ram_util_percent": 27.9}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 676.0, "episode_reward_min": 676.0, "episode_reward_mean": 676.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [676.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5534437963486356, "mean_raw_obs_processing_ms": 0.14314668606618347, "mean_inference_ms": 2.342722695511692, "mean_action_processing_ms": 0.05807801422790406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1764000, "timers": {"sample_time_ms": 12350.73, "sample_throughput": 323.867, "learn_time_ms": 16966.424, "learn_throughput": 235.76, "update_time_ms": 4.129}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 2.484721578657627, "policy_loss": -0.019597970240283757, "vf_loss": 2.4991656579077244, "vf_explained_var": 0.78580242395401, "kl": 0.005573437090788502, "entropy": 0.10839903797022998, "entropy_coeff": 0.0}}, "num_steps_sampled": 1764000, "num_steps_trained": 1764000}, "done": false, "episodes_total": 176, "training_iteration": 441, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-34-23", "timestamp": 1618151663, "time_this_iter_s": 28.571299076080322, "time_total_s": 13009.606722831726, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13009.606722831726, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 63.7609756097561, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 676.0, "episode_reward_min": 676.0, "episode_reward_mean": 676.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [676.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5534437963486356, "mean_raw_obs_processing_ms": 0.14314668606618347, "mean_inference_ms": 2.342722695511692, "mean_action_processing_ms": 0.05807801422790406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1768000, "timers": {"sample_time_ms": 12248.954, "sample_throughput": 326.558, "learn_time_ms": 16984.027, "learn_throughput": 235.515, "update_time_ms": 4.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 0.16424855566583574, "policy_loss": -0.0029112022020854056, "vf_loss": 0.16505361557938159, "vf_explained_var": -0.0010791700333356857, "kl": 0.002277586906529905, "entropy": 0.08168750524055213, "entropy_coeff": 0.0}}, "num_steps_sampled": 1768000, "num_steps_trained": 1768000}, "done": false, "episodes_total": 176, "training_iteration": 442, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-34-52", "timestamp": 1618151692, "time_this_iter_s": 28.849483966827393, "time_total_s": 13038.456206798553, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc01d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13038.456206798553, "timesteps_since_restore": 0, "iterations_since_restore": 442, "perf": {"cpu_util_percent": 63.98292682926829, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 243.0, "episode_reward_min": 243.0, "episode_reward_mean": 243.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [243.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5523354641655435, "mean_raw_obs_processing_ms": 0.14352287799744504, "mean_inference_ms": 2.3428992684442123, "mean_action_processing_ms": 0.058087556728542857}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1772000, "timers": {"sample_time_ms": 12419.514, "sample_throughput": 322.074, "learn_time_ms": 17004.866, "learn_throughput": 235.227, "update_time_ms": 3.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 6.490056931972504, "policy_loss": -0.03365166072035208, "vf_loss": 6.5179143846035, "vf_explained_var": 0.6690196990966797, "kl": 0.012531715576187707, "entropy": 0.1407248021569103, "entropy_coeff": 0.0}}, "num_steps_sampled": 1772000, "num_steps_trained": 1772000}, "done": false, "episodes_total": 177, "training_iteration": 443, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-35-22", "timestamp": 1618151722, "time_this_iter_s": 30.097801208496094, "time_total_s": 13068.55400800705, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc0c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13068.55400800705, "timesteps_since_restore": 0, "iterations_since_restore": 443, "perf": {"cpu_util_percent": 62.70232558139534, "ram_util_percent": 27.799999999999997}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 243.0, "episode_reward_min": 243.0, "episode_reward_mean": 243.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [243.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5523354641655435, "mean_raw_obs_processing_ms": 0.14352287799744504, "mean_inference_ms": 2.3428992684442123, "mean_action_processing_ms": 0.058087556728542857}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1776000, "timers": {"sample_time_ms": 12447.016, "sample_throughput": 321.362, "learn_time_ms": 17035.619, "learn_throughput": 234.802, "update_time_ms": 3.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 6.0192679315805435, "policy_loss": -0.024459178850520402, "vf_loss": 6.03854413330555, "vf_explained_var": 0.5289020538330078, "kl": 0.011209976830286905, "entropy": 0.12935605668462813, "entropy_coeff": 0.0}}, "num_steps_sampled": 1776000, "num_steps_trained": 1776000}, "done": false, "episodes_total": 177, "training_iteration": 444, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-35-53", "timestamp": 1618151753, "time_this_iter_s": 31.16382908821106, "time_total_s": 13099.71783709526, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3db8c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13099.71783709526, "timesteps_since_restore": 0, "iterations_since_restore": 444, "perf": {"cpu_util_percent": 63.26818181818183, "ram_util_percent": 27.897727272727284}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 988.0, "episode_reward_min": 988.0, "episode_reward_mean": 988.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [988.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5537224687243626, "mean_raw_obs_processing_ms": 0.14376725520932626, "mean_inference_ms": 2.3431733876156655, "mean_action_processing_ms": 0.058094513996792316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1780000, "timers": {"sample_time_ms": 12665.964, "sample_throughput": 315.807, "learn_time_ms": 17003.225, "learn_throughput": 235.249, "update_time_ms": 3.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 8.321758270263672, "policy_loss": -0.030560589133528993, "vf_loss": 8.346667021512985, "vf_explained_var": 0.5581115484237671, "kl": 0.012223660087329336, "entropy": 0.11058893240988255, "entropy_coeff": 0.0}}, "num_steps_sampled": 1780000, "num_steps_trained": 1780000}, "done": false, "episodes_total": 178, "training_iteration": 445, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-36-25", "timestamp": 1618151785, "time_this_iter_s": 31.903411626815796, "time_total_s": 13131.621248722076, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d48ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3edab90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13131.621248722076, "timesteps_since_restore": 0, "iterations_since_restore": 445, "perf": {"cpu_util_percent": 64.19347826086957, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 988.0, "episode_reward_min": 988.0, "episode_reward_mean": 988.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [988.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5537224687243626, "mean_raw_obs_processing_ms": 0.14376725520932626, "mean_inference_ms": 2.3431733876156655, "mean_action_processing_ms": 0.058094513996792316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1784000, "timers": {"sample_time_ms": 12778.325, "sample_throughput": 313.03, "learn_time_ms": 16993.725, "learn_throughput": 235.381, "update_time_ms": 3.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 7.20874996483326, "policy_loss": -0.022865429637022316, "vf_loss": 7.2224380671978, "vf_explained_var": 0.6249777674674988, "kl": 0.019848994037602097, "entropy": 0.1097855914849788, "entropy_coeff": 0.0}}, "num_steps_sampled": 1784000, "num_steps_trained": 1784000}, "done": false, "episodes_total": 178, "training_iteration": 446, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-36-56", "timestamp": 1618151816, "time_this_iter_s": 30.91540265083313, "time_total_s": 13162.53665137291, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eda690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f2aaa8391d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13162.53665137291, "timesteps_since_restore": 0, "iterations_since_restore": 446, "perf": {"cpu_util_percent": 63.38181818181818, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 988.0, "episode_reward_min": 988.0, "episode_reward_mean": 988.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [988.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5537224687243626, "mean_raw_obs_processing_ms": 0.14376725520932626, "mean_inference_ms": 2.3431733876156655, "mean_action_processing_ms": 0.058094513996792316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1788000, "timers": {"sample_time_ms": 12786.377, "sample_throughput": 312.833, "learn_time_ms": 16997.198, "learn_throughput": 235.333, "update_time_ms": 3.602}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 8.101988509297371, "policy_loss": -0.05311187723418698, "vf_loss": 8.138482391834259, "vf_explained_var": 0.6542208790779114, "kl": 0.035941369365900755, "entropy": 0.17690073372796178, "entropy_coeff": 0.0}}, "num_steps_sampled": 1788000, "num_steps_trained": 1788000}, "done": false, "episodes_total": 178, "training_iteration": 447, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-37-26", "timestamp": 1618151846, "time_this_iter_s": 29.29452681541443, "time_total_s": 13191.831178188324, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13191.831178188324, "timesteps_since_restore": 0, "iterations_since_restore": 447, "perf": {"cpu_util_percent": 63.9952380952381, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 778.0, "episode_reward_min": 778.0, "episode_reward_mean": 778.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [778.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5540406223899021, "mean_raw_obs_processing_ms": 0.1441025573747056, "mean_inference_ms": 2.342985875878612, "mean_action_processing_ms": 0.05809105910739175}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1792000, "timers": {"sample_time_ms": 12797.275, "sample_throughput": 312.567, "learn_time_ms": 17080.737, "learn_throughput": 234.182, "update_time_ms": 3.583}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 7.418876186013222, "policy_loss": -0.04888015307369642, "vf_loss": 7.441481858491898, "vf_explained_var": 0.638874351978302, "kl": 0.03788435575552285, "entropy": 0.16280649323016405, "entropy_coeff": 0.0}}, "num_steps_sampled": 1792000, "num_steps_trained": 1792000}, "done": false, "episodes_total": 179, "training_iteration": 448, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-37-55", "timestamp": 1618151875, "time_this_iter_s": 29.563246726989746, "time_total_s": 13221.394424915314, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b4733450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13221.394424915314, "timesteps_since_restore": 0, "iterations_since_restore": 448, "perf": {"cpu_util_percent": 63.91428571428572, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 778.0, "episode_reward_min": 778.0, "episode_reward_mean": 778.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [778.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5540406223899021, "mean_raw_obs_processing_ms": 0.1441025573747056, "mean_inference_ms": 2.342985875878612, "mean_action_processing_ms": 0.05809105910739175}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1796000, "timers": {"sample_time_ms": 13013.468, "sample_throughput": 307.374, "learn_time_ms": 17119.806, "learn_throughput": 233.648, "update_time_ms": 3.508}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 8.533505320549011, "policy_loss": -0.022406257572583854, "vf_loss": 8.549501612782478, "vf_explained_var": 0.3382282257080078, "kl": 0.006161591038107872, "entropy": 0.09536048292648047, "entropy_coeff": 0.0}}, "num_steps_sampled": 1796000, "num_steps_trained": 1796000}, "done": false, "episodes_total": 179, "training_iteration": 449, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-38-28", "timestamp": 1618151908, "time_this_iter_s": 33.07424712181091, "time_total_s": 13254.468672037125, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaac90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13254.468672037125, "timesteps_since_restore": 0, "iterations_since_restore": 449, "perf": {"cpu_util_percent": 62.34680851063829, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 991.0, "episode_reward_min": 991.0, "episode_reward_mean": 991.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [991.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.556390263283265, "mean_raw_obs_processing_ms": 0.1443326467441191, "mean_inference_ms": 2.3430756047604637, "mean_action_processing_ms": 0.058093345210134956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1800000, "timers": {"sample_time_ms": 13295.455, "sample_throughput": 300.855, "learn_time_ms": 17205.672, "learn_throughput": 232.481, "update_time_ms": 3.533}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 8.544519454240799, "policy_loss": -0.015667732513975352, "vf_loss": 8.550846889615059, "vf_explained_var": 0.5487730503082275, "kl": 0.008978302430477925, "entropy": 0.10656912950798869, "entropy_coeff": 0.0}}, "num_steps_sampled": 1800000, "num_steps_trained": 1800000}, "done": false, "episodes_total": 180, "training_iteration": 450, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-39-00", "timestamp": 1618151940, "time_this_iter_s": 31.708335161209106, "time_total_s": 13286.177007198334, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eafb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13286.177007198334, "timesteps_since_restore": 0, "iterations_since_restore": 450, "perf": {"cpu_util_percent": 64.22826086956523, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 991.0, "episode_reward_min": 991.0, "episode_reward_mean": 991.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [991.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.556390263283265, "mean_raw_obs_processing_ms": 0.1443326467441191, "mean_inference_ms": 2.3430756047604637, "mean_action_processing_ms": 0.058093345210134956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1804000, "timers": {"sample_time_ms": 13407.198, "sample_throughput": 298.347, "learn_time_ms": 17263.739, "learn_throughput": 231.7, "update_time_ms": 3.573}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 8.723642364144325, "policy_loss": -0.023137794516514987, "vf_loss": 8.738999381661415, "vf_explained_var": 0.5602807998657227, "kl": 0.007479316300305072, "entropy": 0.12123103113844991, "entropy_coeff": 0.0}}, "num_steps_sampled": 1804000, "num_steps_trained": 1804000}, "done": false, "episodes_total": 180, "training_iteration": 451, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-39-30", "timestamp": 1618151970, "time_this_iter_s": 30.270245790481567, "time_total_s": 13316.447252988815, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13316.447252988815, "timesteps_since_restore": 0, "iterations_since_restore": 451, "perf": {"cpu_util_percent": 63.45813953488373, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 991.0, "episode_reward_min": 991.0, "episode_reward_mean": 991.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [991.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.556390263283265, "mean_raw_obs_processing_ms": 0.1443326467441191, "mean_inference_ms": 2.3430756047604637, "mean_action_processing_ms": 0.058093345210134956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1808000, "timers": {"sample_time_ms": 13487.225, "sample_throughput": 296.577, "learn_time_ms": 17220.76, "learn_throughput": 232.278, "update_time_ms": 3.86}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 7.174990028142929, "policy_loss": -0.0178425838239491, "vf_loss": 7.1822216510772705, "vf_explained_var": 0.5612618923187256, "kl": 0.010199759606621228, "entropy": 0.1310462076216936, "entropy_coeff": 0.0}}, "num_steps_sampled": 1808000, "num_steps_trained": 1808000}, "done": false, "episodes_total": 180, "training_iteration": 452, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-40-00", "timestamp": 1618152000, "time_this_iter_s": 29.223564624786377, "time_total_s": 13345.670817613602, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edac10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaa910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13345.670817613602, "timesteps_since_restore": 0, "iterations_since_restore": 452, "perf": {"cpu_util_percent": 63.34634146341463, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 700.0, "episode_reward_min": 700.0, "episode_reward_mean": 700.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5554371489762397, "mean_raw_obs_processing_ms": 0.1447157788774075, "mean_inference_ms": 2.3435143160752285, "mean_action_processing_ms": 0.05810479169002956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1812000, "timers": {"sample_time_ms": 13375.799, "sample_throughput": 299.048, "learn_time_ms": 17269.836, "learn_throughput": 231.618, "update_time_ms": 4.026}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 6.460551932454109, "policy_loss": -0.02819325088057667, "vf_loss": 6.47668169438839, "vf_explained_var": 0.5610759854316711, "kl": 0.011595952499192208, "entropy": 0.11809466453269124, "entropy_coeff": 0.0}}, "num_steps_sampled": 1812000, "num_steps_trained": 1812000}, "done": false, "episodes_total": 181, "training_iteration": 453, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-40-29", "timestamp": 1618152029, "time_this_iter_s": 29.47001838684082, "time_total_s": 13375.140836000443, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f040d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d73590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13375.140836000443, "timesteps_since_restore": 0, "iterations_since_restore": 453, "perf": {"cpu_util_percent": 64.0953488372093, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 700.0, "episode_reward_min": 700.0, "episode_reward_mean": 700.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5554371489762397, "mean_raw_obs_processing_ms": 0.1447157788774075, "mean_inference_ms": 2.3435143160752285, "mean_action_processing_ms": 0.05810479169002956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1816000, "timers": {"sample_time_ms": 13288.442, "sample_throughput": 301.013, "learn_time_ms": 17215.011, "learn_throughput": 232.355, "update_time_ms": 4.277}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 7.913166970014572, "policy_loss": -0.013023644220083952, "vf_loss": 7.922675460577011, "vf_explained_var": 0.5476446151733398, "kl": 0.003378987450560089, "entropy": 0.07199182105250657, "entropy_coeff": 0.0}}, "num_steps_sampled": 1816000, "num_steps_trained": 1816000}, "done": false, "episodes_total": 181, "training_iteration": 454, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-40-59", "timestamp": 1618152059, "time_this_iter_s": 29.747981309890747, "time_total_s": 13404.888817310333, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc07d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f19c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13404.888817310333, "timesteps_since_restore": 0, "iterations_since_restore": 454, "perf": {"cpu_util_percent": 63.104761904761894, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 801.0, "episode_reward_min": 801.0, "episode_reward_mean": 801.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [801.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5553917535737513, "mean_raw_obs_processing_ms": 0.14496011786319368, "mean_inference_ms": 2.3439145874072786, "mean_action_processing_ms": 0.058124050754775246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1820000, "timers": {"sample_time_ms": 13152.198, "sample_throughput": 304.132, "learn_time_ms": 17158.769, "learn_throughput": 233.117, "update_time_ms": 4.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 6.374926269054413, "policy_loss": -0.06862398830708116, "vf_loss": 6.4111254289746284, "vf_explained_var": 0.7598231434822083, "kl": 0.062336563831195235, "entropy": 0.1726673454977572, "entropy_coeff": 0.0}}, "num_steps_sampled": 1820000, "num_steps_trained": 1820000}, "done": false, "episodes_total": 182, "training_iteration": 455, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-41-29", "timestamp": 1618152089, "time_this_iter_s": 29.98149609565735, "time_total_s": 13434.87031340599, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13434.87031340599, "timesteps_since_restore": 0, "iterations_since_restore": 455, "perf": {"cpu_util_percent": 63.472093023255816, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 801.0, "episode_reward_min": 801.0, "episode_reward_mean": 801.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [801.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5553917535737513, "mean_raw_obs_processing_ms": 0.14496011786319368, "mean_inference_ms": 2.3439145874072786, "mean_action_processing_ms": 0.058124050754775246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1824000, "timers": {"sample_time_ms": 13256.335, "sample_throughput": 301.743, "learn_time_ms": 17257.854, "learn_throughput": 231.779, "update_time_ms": 4.597}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 6.377809435129166, "policy_loss": -0.022422456444473937, "vf_loss": 6.3952633291482925, "vf_explained_var": 0.2528850734233856, "kl": 0.006367965332174208, "entropy": 0.08678002585656941, "entropy_coeff": 0.0}}, "num_steps_sampled": 1824000, "num_steps_trained": 1824000}, "done": false, "episodes_total": 182, "training_iteration": 456, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-42-02", "timestamp": 1618152122, "time_this_iter_s": 32.94782114028931, "time_total_s": 13467.81813454628, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472fb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13467.81813454628, "timesteps_since_restore": 0, "iterations_since_restore": 456, "perf": {"cpu_util_percent": 64.26382978723403, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 801.0, "episode_reward_min": 801.0, "episode_reward_mean": 801.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [801.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5553917535737513, "mean_raw_obs_processing_ms": 0.14496011786319368, "mean_inference_ms": 2.3439145874072786, "mean_action_processing_ms": 0.058124050754775246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1828000, "timers": {"sample_time_ms": 13254.693, "sample_throughput": 301.78, "learn_time_ms": 17281.813, "learn_throughput": 231.457, "update_time_ms": 4.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 7.5352625250816345, "policy_loss": 0.0021241341601125896, "vf_loss": 7.532451555132866, "vf_explained_var": -0.0018442682921886444, "kl": 0.0008802290098515186, "entropy": 0.09081575646996498, "entropy_coeff": 0.0}}, "num_steps_sampled": 1828000, "num_steps_trained": 1828000}, "done": false, "episodes_total": 182, "training_iteration": 457, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-42-32", "timestamp": 1618152152, "time_this_iter_s": 29.524434804916382, "time_total_s": 13497.342569351196, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3cda510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13497.342569351196, "timesteps_since_restore": 0, "iterations_since_restore": 457, "perf": {"cpu_util_percent": 63.957142857142856, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 523.0, "episode_reward_min": 523.0, "episode_reward_mean": 523.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [523.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5548545578644406, "mean_raw_obs_processing_ms": 0.145355688736175, "mean_inference_ms": 2.344990871149823, "mean_action_processing_ms": 0.058152394535653316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1832000, "timers": {"sample_time_ms": 13251.859, "sample_throughput": 301.844, "learn_time_ms": 17223.977, "learn_throughput": 232.234, "update_time_ms": 4.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3901185287127362, "cur_lr": 5e-05, "total_loss": 1.4939652681350708, "policy_loss": 0.0035694753751158714, "vf_loss": 1.489282414317131, "vf_explained_var": -0.0012470614165067673, "kl": 0.0028539811924994662, "entropy": 0.07978878286667168, "entropy_coeff": 0.0}}, "num_steps_sampled": 1832000, "num_steps_trained": 1832000}, "done": false, "episodes_total": 183, "training_iteration": 458, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-43-01", "timestamp": 1618152181, "time_this_iter_s": 28.953483819961548, "time_total_s": 13526.296053171158, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13526.296053171158, "timesteps_since_restore": 0, "iterations_since_restore": 458, "perf": {"cpu_util_percent": 63.714285714285715, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 523.0, "episode_reward_min": 523.0, "episode_reward_mean": 523.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [523.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5548545578644406, "mean_raw_obs_processing_ms": 0.145355688736175, "mean_inference_ms": 2.344990871149823, "mean_action_processing_ms": 0.058152394535653316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1836000, "timers": {"sample_time_ms": 12841.481, "sample_throughput": 311.491, "learn_time_ms": 17260.68, "learn_throughput": 231.741, "update_time_ms": 4.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1950592643563681, "cur_lr": 5e-05, "total_loss": 0.31153149669989944, "policy_loss": -0.005169545154785737, "vf_loss": 0.3161680535413325, "vf_explained_var": -0.002796849235892296, "kl": 0.0027324630199245803, "entropy": 0.09893519780598581, "entropy_coeff": 0.0}}, "num_steps_sampled": 1836000, "num_steps_trained": 1836000}, "done": false, "episodes_total": 183, "training_iteration": 459, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-43-30", "timestamp": 1618152210, "time_this_iter_s": 29.337910413742065, "time_total_s": 13555.6339635849, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f150d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13555.6339635849, "timesteps_since_restore": 0, "iterations_since_restore": 459, "perf": {"cpu_util_percent": 63.882926829268285, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 130.0, "episode_reward_min": 130.0, "episode_reward_mean": 130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5542960971741135, "mean_raw_obs_processing_ms": 0.14560244527835967, "mean_inference_ms": 2.345041478092664, "mean_action_processing_ms": 0.05815691171421079}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1840000, "timers": {"sample_time_ms": 12726.445, "sample_throughput": 314.306, "learn_time_ms": 17274.656, "learn_throughput": 231.553, "update_time_ms": 4.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09752963217818406, "cur_lr": 5e-05, "total_loss": 3.366120934486389, "policy_loss": -0.026942245371174067, "vf_loss": 3.3853211626410484, "vf_explained_var": 0.8306401968002319, "kl": 0.07938136724987999, "entropy": 0.19616998126730323, "entropy_coeff": 0.0}}, "num_steps_sampled": 1840000, "num_steps_trained": 1840000}, "done": false, "episodes_total": 184, "training_iteration": 460, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-44-01", "timestamp": 1618152241, "time_this_iter_s": 30.69335103034973, "time_total_s": 13586.32731461525, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3cdacd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d48bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13586.32731461525, "timesteps_since_restore": 0, "iterations_since_restore": 460, "perf": {"cpu_util_percent": 64.50909090909092, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 130.0, "episode_reward_min": 130.0, "episode_reward_mean": 130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5542960971741135, "mean_raw_obs_processing_ms": 0.14560244527835967, "mean_inference_ms": 2.345041478092664, "mean_action_processing_ms": 0.05815691171421079}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1844000, "timers": {"sample_time_ms": 12812.03, "sample_throughput": 312.207, "learn_time_ms": 17314.163, "learn_throughput": 231.025, "update_time_ms": 4.529}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.14629444826727608, "cur_lr": 5e-05, "total_loss": 8.18771106004715, "policy_loss": -0.03810341001371853, "vf_loss": 8.222504705190659, "vf_explained_var": 0.4572669565677643, "kl": 0.022624985576840118, "entropy": 0.10143342101946473, "entropy_coeff": 0.0}}, "num_steps_sampled": 1844000, "num_steps_trained": 1844000}, "done": false, "episodes_total": 184, "training_iteration": 461, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-44-32", "timestamp": 1618152272, "time_this_iter_s": 31.520894765853882, "time_total_s": 13617.848209381104, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc0190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13617.848209381104, "timesteps_since_restore": 0, "iterations_since_restore": 461, "perf": {"cpu_util_percent": 63.39333333333332, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 130.0, "episode_reward_min": 130.0, "episode_reward_mean": 130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5542960971741135, "mean_raw_obs_processing_ms": 0.14560244527835967, "mean_inference_ms": 2.345041478092664, "mean_action_processing_ms": 0.05815691171421079}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1848000, "timers": {"sample_time_ms": 12845.943, "sample_throughput": 311.382, "learn_time_ms": 17460.173, "learn_throughput": 229.093, "update_time_ms": 4.3}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2194416724009141, "cur_lr": 5e-05, "total_loss": 7.531016439199448, "policy_loss": -0.04244237838429399, "vf_loss": 7.56397345662117, "vf_explained_var": 0.6855385303497314, "kl": 0.04322523245355114, "entropy": 0.15989262191578746, "entropy_coeff": 0.0}}, "num_steps_sampled": 1848000, "num_steps_trained": 1848000}, "done": false, "episodes_total": 184, "training_iteration": 462, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-45-03", "timestamp": 1618152303, "time_this_iter_s": 31.021281480789185, "time_total_s": 13648.869490861893, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3cb8910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3cb8dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13648.869490861893, "timesteps_since_restore": 0, "iterations_since_restore": 462, "perf": {"cpu_util_percent": 63.839999999999996, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 968.0, "episode_reward_min": 968.0, "episode_reward_mean": 968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5537384792811517, "mean_raw_obs_processing_ms": 0.14596867197829438, "mean_inference_ms": 2.3455593284740726, "mean_action_processing_ms": 0.05816970801231941}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1852000, "timers": {"sample_time_ms": 12811.591, "sample_throughput": 312.217, "learn_time_ms": 17442.272, "learn_throughput": 229.328, "update_time_ms": 4.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3291625086013712, "cur_lr": 5e-05, "total_loss": 8.271710015833378, "policy_loss": -0.027452044014353305, "vf_loss": 8.294765934348106, "vf_explained_var": 0.6388154029846191, "kl": 0.013355606148252264, "entropy": 0.11976081132888794, "entropy_coeff": 0.0}}, "num_steps_sampled": 1852000, "num_steps_trained": 1852000}, "done": false, "episodes_total": 185, "training_iteration": 463, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-45-32", "timestamp": 1618152332, "time_this_iter_s": 28.945666074752808, "time_total_s": 13677.815156936646, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3cb8850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13677.815156936646, "timesteps_since_restore": 0, "iterations_since_restore": 463, "perf": {"cpu_util_percent": 64.17073170731707, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 968.0, "episode_reward_min": 968.0, "episode_reward_mean": 968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5537384792811517, "mean_raw_obs_processing_ms": 0.14596867197829438, "mean_inference_ms": 2.3455593284740726, "mean_action_processing_ms": 0.05816970801231941}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1856000, "timers": {"sample_time_ms": 12710.67, "sample_throughput": 314.696, "learn_time_ms": 17515.633, "learn_throughput": 228.367, "update_time_ms": 3.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3291625086013712, "cur_lr": 5e-05, "total_loss": 5.922779694199562, "policy_loss": -0.025321986991912127, "vf_loss": 5.941059812903404, "vf_explained_var": 0.6643227934837341, "kl": 0.021393146336777136, "entropy": 0.143910605693236, "entropy_coeff": 0.0}}, "num_steps_sampled": 1856000, "num_steps_trained": 1856000}, "done": false, "episodes_total": 185, "training_iteration": 464, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-46-02", "timestamp": 1618152362, "time_this_iter_s": 29.465789318084717, "time_total_s": 13707.28094625473, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f15f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f04c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13707.28094625473, "timesteps_since_restore": 0, "iterations_since_restore": 464, "perf": {"cpu_util_percent": 63.81904761904762, "ram_util_percent": 27.86904761904762}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 382.0, "episode_reward_min": 382.0, "episode_reward_mean": 382.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5525355492225175, "mean_raw_obs_processing_ms": 0.14620590553078416, "mean_inference_ms": 2.3458114946982507, "mean_action_processing_ms": 0.058174173549917586}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1860000, "timers": {"sample_time_ms": 12568.571, "sample_throughput": 318.254, "learn_time_ms": 17525.253, "learn_throughput": 228.242, "update_time_ms": 3.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 4.861512765288353, "policy_loss": -0.03195844386937097, "vf_loss": 4.887800291180611, "vf_explained_var": 0.7274413108825684, "kl": 0.011485594004625455, "entropy": 0.1623073562514037, "entropy_coeff": 0.0}}, "num_steps_sampled": 1860000, "num_steps_trained": 1860000}, "done": false, "episodes_total": 186, "training_iteration": 465, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-46-30", "timestamp": 1618152390, "time_this_iter_s": 28.652695417404175, "time_total_s": 13735.933641672134, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3cb8590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaabd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13735.933641672134, "timesteps_since_restore": 0, "iterations_since_restore": 465, "perf": {"cpu_util_percent": 63.55853658536586, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 382.0, "episode_reward_min": 382.0, "episode_reward_mean": 382.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5525355492225175, "mean_raw_obs_processing_ms": 0.14620590553078416, "mean_inference_ms": 2.3458114946982507, "mean_action_processing_ms": 0.058174173549917586}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1864000, "timers": {"sample_time_ms": 12361.555, "sample_throughput": 323.584, "learn_time_ms": 17474.374, "learn_throughput": 228.907, "update_time_ms": 3.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 7.434435456991196, "policy_loss": -0.005873769288882613, "vf_loss": 7.436674669384956, "vf_explained_var": 0.5886024236679077, "kl": 0.0073613027852843516, "entropy": 0.07304394501261413, "entropy_coeff": 0.0}}, "num_steps_sampled": 1864000, "num_steps_trained": 1864000}, "done": false, "episodes_total": 186, "training_iteration": 466, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-47-01", "timestamp": 1618152421, "time_this_iter_s": 30.368409156799316, "time_total_s": 13766.302050828934, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13766.302050828934, "timesteps_since_restore": 0, "iterations_since_restore": 466, "perf": {"cpu_util_percent": 64.23720930232558, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 382.0, "episode_reward_min": 382.0, "episode_reward_mean": 382.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5525355492225175, "mean_raw_obs_processing_ms": 0.14620590553078416, "mean_inference_ms": 2.3458114946982507, "mean_action_processing_ms": 0.058174173549917586}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1868000, "timers": {"sample_time_ms": 12268.123, "sample_throughput": 326.048, "learn_time_ms": 17484.155, "learn_throughput": 228.779, "update_time_ms": 3.487}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 8.485834047198296, "policy_loss": -0.03233006288064644, "vf_loss": 8.509616404771805, "vf_explained_var": 0.5634794235229492, "kl": 0.017311768286162987, "entropy": 0.12559323152527213, "entropy_coeff": 0.0}}, "num_steps_sampled": 1868000, "num_steps_trained": 1868000}, "done": false, "episodes_total": 186, "training_iteration": 467, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-47-30", "timestamp": 1618152450, "time_this_iter_s": 28.686232089996338, "time_total_s": 13794.98828291893, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13794.98828291893, "timesteps_since_restore": 0, "iterations_since_restore": 467, "perf": {"cpu_util_percent": 62.93414634146342, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 754.0, "episode_reward_min": 754.0, "episode_reward_mean": 754.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [754.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5519701114920411, "mean_raw_obs_processing_ms": 0.14656969793359054, "mean_inference_ms": 2.3460588933967883, "mean_action_processing_ms": 0.0581787210729333}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1872000, "timers": {"sample_time_ms": 12401.418, "sample_throughput": 322.544, "learn_time_ms": 17457.919, "learn_throughput": 229.122, "update_time_ms": 3.489}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 9.53799818456173, "policy_loss": -0.03299046138999984, "vf_loss": 9.561068817973137, "vf_explained_var": 0.5711089968681335, "kl": 0.020091062353458256, "entropy": 0.10862994031049311, "entropy_coeff": 0.0}}, "num_steps_sampled": 1872000, "num_steps_trained": 1872000}, "done": false, "episodes_total": 187, "training_iteration": 468, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-48-00", "timestamp": 1618152480, "time_this_iter_s": 30.030446529388428, "time_total_s": 13825.018729448318, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f19710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13825.018729448318, "timesteps_since_restore": 0, "iterations_since_restore": 468, "perf": {"cpu_util_percent": 63.51395348837209, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 754.0, "episode_reward_min": 754.0, "episode_reward_mean": 754.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [754.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5519701114920411, "mean_raw_obs_processing_ms": 0.14656969793359054, "mean_inference_ms": 2.3460588933967883, "mean_action_processing_ms": 0.0581787210729333}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1876000, "timers": {"sample_time_ms": 12476.596, "sample_throughput": 320.6, "learn_time_ms": 17378.715, "learn_throughput": 230.167, "update_time_ms": 4.196}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7406156443530851, "cur_lr": 5e-05, "total_loss": 8.851285919547081, "policy_loss": -0.024056945752818137, "vf_loss": 8.868520334362984, "vf_explained_var": 0.6816350221633911, "kl": 0.009211864598910324, "entropy": 0.10998048377223313, "entropy_coeff": 0.0}}, "num_steps_sampled": 1876000, "num_steps_trained": 1876000}, "done": false, "episodes_total": 187, "training_iteration": 469, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-48-29", "timestamp": 1618152509, "time_this_iter_s": 29.301408529281616, "time_total_s": 13854.3201379776, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eaf190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13854.3201379776, "timesteps_since_restore": 0, "iterations_since_restore": 469, "perf": {"cpu_util_percent": 63.10476190476191, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 892.0, "episode_reward_min": 892.0, "episode_reward_mean": 892.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.551555078157761, "mean_raw_obs_processing_ms": 0.14680031249813097, "mean_inference_ms": 2.346333997904231, "mean_action_processing_ms": 0.05818620982948103}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1880000, "timers": {"sample_time_ms": 12467.11, "sample_throughput": 320.844, "learn_time_ms": 17349.358, "learn_throughput": 230.556, "update_time_ms": 4.257}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7406156443530851, "cur_lr": 5e-05, "total_loss": 5.657632827758789, "policy_loss": -0.011938769894186407, "vf_loss": 5.666509248316288, "vf_explained_var": 0.7809507846832275, "kl": 0.0041348151353304274, "entropy": 0.05280408763792366, "entropy_coeff": 0.0}}, "num_steps_sampled": 1880000, "num_steps_trained": 1880000}, "done": false, "episodes_total": 188, "training_iteration": 470, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-48-59", "timestamp": 1618152539, "time_this_iter_s": 30.309439659118652, "time_total_s": 13884.629577636719, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaad90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13884.629577636719, "timesteps_since_restore": 0, "iterations_since_restore": 470, "perf": {"cpu_util_percent": 63.83023255813953, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 892.0, "episode_reward_min": 892.0, "episode_reward_mean": 892.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.551555078157761, "mean_raw_obs_processing_ms": 0.14680031249813097, "mean_inference_ms": 2.346333997904231, "mean_action_processing_ms": 0.05818620982948103}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1884000, "timers": {"sample_time_ms": 12534.251, "sample_throughput": 319.126, "learn_time_ms": 17304.265, "learn_throughput": 231.157, "update_time_ms": 4.298}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37030782217654257, "cur_lr": 5e-05, "total_loss": 4.443456009030342, "policy_loss": -0.01937177323270589, "vf_loss": 4.45834019780159, "vf_explained_var": 0.26100730895996094, "kl": 0.012118730010115542, "entropy": 0.0735495681874454, "entropy_coeff": 0.0}}, "num_steps_sampled": 1884000, "num_steps_trained": 1884000}, "done": false, "episodes_total": 188, "training_iteration": 471, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-49-31", "timestamp": 1618152571, "time_this_iter_s": 31.742315769195557, "time_total_s": 13916.371893405914, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b4733a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13916.371893405914, "timesteps_since_restore": 0, "iterations_since_restore": 471, "perf": {"cpu_util_percent": 63.90652173913043, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 892.0, "episode_reward_min": 892.0, "episode_reward_mean": 892.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.551555078157761, "mean_raw_obs_processing_ms": 0.14680031249813097, "mean_inference_ms": 2.346333997904231, "mean_action_processing_ms": 0.05818620982948103}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1888000, "timers": {"sample_time_ms": 12567.999, "sample_throughput": 318.269, "learn_time_ms": 17167.367, "learn_throughput": 233.0, "update_time_ms": 4.26}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37030782217654257, "cur_lr": 5e-05, "total_loss": 5.594786316156387, "policy_loss": -0.03207825968274847, "vf_loss": 5.6192146092653275, "vf_explained_var": 0.532128095626831, "kl": 0.02065843893797137, "entropy": 0.10790571756660938, "entropy_coeff": 0.0}}, "num_steps_sampled": 1888000, "num_steps_trained": 1888000}, "done": false, "episodes_total": 188, "training_iteration": 472, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-50-01", "timestamp": 1618152601, "time_this_iter_s": 29.988077640533447, "time_total_s": 13946.359971046448, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f10790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13946.359971046448, "timesteps_since_restore": 0, "iterations_since_restore": 472, "perf": {"cpu_util_percent": 63.964285714285715, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1329.0, "episode_reward_min": 1329.0, "episode_reward_mean": 1329.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1329.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5539993026743617, "mean_raw_obs_processing_ms": 0.14717500049812177, "mean_inference_ms": 2.3467264767826927, "mean_action_processing_ms": 0.05820275586452195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1892000, "timers": {"sample_time_ms": 13014.368, "sample_throughput": 307.353, "learn_time_ms": 17129.949, "learn_throughput": 233.509, "update_time_ms": 4.467}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 7.839717328548431, "policy_loss": -0.024537504272302613, "vf_loss": 7.860191449522972, "vf_explained_var": 0.3068580627441406, "kl": 0.007315712820854969, "entropy": 0.07292233733460307, "entropy_coeff": 0.0}}, "num_steps_sampled": 1892000, "num_steps_trained": 1892000}, "done": false, "episodes_total": 189, "training_iteration": 473, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-50-34", "timestamp": 1618152634, "time_this_iter_s": 33.03865361213684, "time_total_s": 13979.398624658585, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eafa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13979.398624658585, "timesteps_since_restore": 0, "iterations_since_restore": 473, "perf": {"cpu_util_percent": 62.66875000000001, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1329.0, "episode_reward_min": 1329.0, "episode_reward_mean": 1329.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1329.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5539993026743617, "mean_raw_obs_processing_ms": 0.14717500049812177, "mean_inference_ms": 2.3467264767826927, "mean_action_processing_ms": 0.05820275586452195}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1896000, "timers": {"sample_time_ms": 13218.638, "sample_throughput": 302.603, "learn_time_ms": 17140.677, "learn_throughput": 233.363, "update_time_ms": 4.445}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 7.498955011367798, "policy_loss": -0.046908504446037114, "vf_loss": 7.529408693313599, "vf_explained_var": 0.6217766404151917, "kl": 0.02962373275659047, "entropy": 0.11622561980038881, "entropy_coeff": 0.0}}, "num_steps_sampled": 1896000, "num_steps_trained": 1896000}, "done": false, "episodes_total": 189, "training_iteration": 474, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-51-06", "timestamp": 1618152666, "time_this_iter_s": 31.619951725006104, "time_total_s": 14011.01857638359, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f04dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14011.01857638359, "timesteps_since_restore": 0, "iterations_since_restore": 474, "perf": {"cpu_util_percent": 64.52, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1164.0, "episode_reward_min": 1164.0, "episode_reward_mean": 1164.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1164.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5556694396362112, "mean_raw_obs_processing_ms": 0.1474207292949081, "mean_inference_ms": 2.3469129620518903, "mean_action_processing_ms": 0.05820846844422039}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1900000, "timers": {"sample_time_ms": 13549.071, "sample_throughput": 295.223, "learn_time_ms": 17188.067, "learn_throughput": 232.72, "update_time_ms": 4.566}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 7.367923527956009, "policy_loss": -0.02589338691905141, "vf_loss": 7.387565225362778, "vf_explained_var": 0.4617522358894348, "kl": 0.007503162829380017, "entropy": 0.09122850722633302, "entropy_coeff": 0.0}}, "num_steps_sampled": 1900000, "num_steps_trained": 1900000}, "done": false, "episodes_total": 190, "training_iteration": 475, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-51-38", "timestamp": 1618152698, "time_this_iter_s": 32.430601596832275, "time_total_s": 14043.449177980423, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b472f550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14043.449177980423, "timesteps_since_restore": 0, "iterations_since_restore": 475, "perf": {"cpu_util_percent": 63.03913043478262, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1164.0, "episode_reward_min": 1164.0, "episode_reward_mean": 1164.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1164.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5556694396362112, "mean_raw_obs_processing_ms": 0.1474207292949081, "mean_inference_ms": 2.3469129620518903, "mean_action_processing_ms": 0.05820846844422039}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1904000, "timers": {"sample_time_ms": 13655.925, "sample_throughput": 292.913, "learn_time_ms": 17149.462, "learn_throughput": 233.243, "update_time_ms": 4.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 6.382177472114563, "policy_loss": -0.02886814545490779, "vf_loss": 6.405169114470482, "vf_explained_var": 0.4246702194213867, "kl": 0.007053123423247598, "entropy": 0.0721070347353816, "entropy_coeff": 0.0}}, "num_steps_sampled": 1904000, "num_steps_trained": 1904000}, "done": false, "episodes_total": 190, "training_iteration": 476, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-52-09", "timestamp": 1618152729, "time_this_iter_s": 31.053170680999756, "time_total_s": 14074.502348661423, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc83d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14074.502348661423, "timesteps_since_restore": 0, "iterations_since_restore": 476, "perf": {"cpu_util_percent": 63.156818181818196, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1164.0, "episode_reward_min": 1164.0, "episode_reward_mean": 1164.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1164.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5556694396362112, "mean_raw_obs_processing_ms": 0.1474207292949081, "mean_inference_ms": 2.3469129620518903, "mean_action_processing_ms": 0.05820846844422039}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1908000, "timers": {"sample_time_ms": 13850.845, "sample_throughput": 288.791, "learn_time_ms": 17075.67, "learn_throughput": 234.251, "update_time_ms": 5.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 8.64188115298748, "policy_loss": -0.020759647130034864, "vf_loss": 8.655462875962257, "vf_explained_var": 0.5935883522033691, "kl": 0.008614934951765463, "entropy": 0.10322789964266121, "entropy_coeff": 0.0}}, "num_steps_sampled": 1908000, "num_steps_trained": 1908000}, "done": false, "episodes_total": 190, "training_iteration": 477, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-52-39", "timestamp": 1618152759, "time_this_iter_s": 29.896557569503784, "time_total_s": 14104.398906230927, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e6a210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14104.398906230927, "timesteps_since_restore": 0, "iterations_since_restore": 477, "perf": {"cpu_util_percent": 63.40697674418606, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1277.0, "episode_reward_min": 1277.0, "episode_reward_mean": 1277.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1277.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5574354712616665, "mean_raw_obs_processing_ms": 0.1477973678237859, "mean_inference_ms": 2.3471147706677136, "mean_action_processing_ms": 0.058219835948783126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1912000, "timers": {"sample_time_ms": 13995.826, "sample_throughput": 285.799, "learn_time_ms": 17110.452, "learn_throughput": 233.775, "update_time_ms": 5.018}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 7.842865750193596, "policy_loss": -0.025555438012816012, "vf_loss": 7.859504982829094, "vf_explained_var": 0.5007060170173645, "kl": 0.010701323197281454, "entropy": 0.0950230157468468, "entropy_coeff": 0.0}}, "num_steps_sampled": 1912000, "num_steps_trained": 1912000}, "done": false, "episodes_total": 191, "training_iteration": 478, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-53-11", "timestamp": 1618152791, "time_this_iter_s": 31.82731342315674, "time_total_s": 14136.226219654083, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d48e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3eda250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14136.226219654083, "timesteps_since_restore": 0, "iterations_since_restore": 478, "perf": {"cpu_util_percent": 63.60434782608694, "ram_util_percent": 27.902173913043487}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1277.0, "episode_reward_min": 1277.0, "episode_reward_mean": 1277.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1277.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5574354712616665, "mean_raw_obs_processing_ms": 0.1477973678237859, "mean_inference_ms": 2.3471147706677136, "mean_action_processing_ms": 0.058219835948783126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1916000, "timers": {"sample_time_ms": 14106.325, "sample_throughput": 283.561, "learn_time_ms": 17145.351, "learn_throughput": 233.299, "update_time_ms": 4.29}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 8.400773733854294, "policy_loss": -0.029716129414737225, "vf_loss": 8.423508539795876, "vf_explained_var": 0.4427056908607483, "kl": 0.008378891056054272, "entropy": 0.09479158115573227, "entropy_coeff": 0.0}}, "num_steps_sampled": 1916000, "num_steps_trained": 1916000}, "done": false, "episodes_total": 191, "training_iteration": 479, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-53-42", "timestamp": 1618152822, "time_this_iter_s": 30.747004508972168, "time_total_s": 14166.973224163055, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14166.973224163055, "timesteps_since_restore": 0, "iterations_since_restore": 479, "perf": {"cpu_util_percent": 63.806818181818194, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 921.0, "episode_reward_min": 921.0, "episode_reward_mean": 921.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [921.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5569978832927284, "mean_raw_obs_processing_ms": 0.14803374410935677, "mean_inference_ms": 2.3475039585002704, "mean_action_processing_ms": 0.05822667091832077}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1920000, "timers": {"sample_time_ms": 14020.87, "sample_throughput": 285.289, "learn_time_ms": 17111.181, "learn_throughput": 233.765, "update_time_ms": 4.27}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 7.356203496456146, "policy_loss": -0.02544551732717082, "vf_loss": 7.362985283136368, "vf_explained_var": 0.5146347880363464, "kl": 0.022400236746761948, "entropy": 0.14686192711815238, "entropy_coeff": 0.0}}, "num_steps_sampled": 1920000, "num_steps_trained": 1920000}, "done": false, "episodes_total": 192, "training_iteration": 480, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-54-11", "timestamp": 1618152851, "time_this_iter_s": 29.109919786453247, "time_total_s": 14196.083143949509, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e1ab10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3f15210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14196.083143949509, "timesteps_since_restore": 0, "iterations_since_restore": 480, "perf": {"cpu_util_percent": 63.792682926829265, "ram_util_percent": 27.900000000000002}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 921.0, "episode_reward_min": 921.0, "episode_reward_mean": 921.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [921.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5569978832927284, "mean_raw_obs_processing_ms": 0.14803374410935677, "mean_inference_ms": 2.3475039585002704, "mean_action_processing_ms": 0.05822667091832077}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1924000, "timers": {"sample_time_ms": 14001.823, "sample_throughput": 285.677, "learn_time_ms": 17199.407, "learn_throughput": 232.566, "update_time_ms": 4.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 8.187212273478508, "policy_loss": -0.021828707627719268, "vf_loss": 8.197308123111725, "vf_explained_var": 0.5354214906692505, "kl": 0.009387832586071454, "entropy": 0.0965848839841783, "entropy_coeff": 0.0}}, "num_steps_sampled": 1924000, "num_steps_trained": 1924000}, "done": false, "episodes_total": 192, "training_iteration": 481, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-54-44", "timestamp": 1618152884, "time_this_iter_s": 32.436164140701294, "time_total_s": 14228.51930809021, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edac10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e1a110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14228.51930809021, "timesteps_since_restore": 0, "iterations_since_restore": 481, "perf": {"cpu_util_percent": 63.04255319148936, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 921.0, "episode_reward_min": 921.0, "episode_reward_mean": 921.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [921.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5569978832927284, "mean_raw_obs_processing_ms": 0.14803374410935677, "mean_inference_ms": 2.3475039585002704, "mean_action_processing_ms": 0.05822667091832077}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1928000, "timers": {"sample_time_ms": 13960.745, "sample_throughput": 286.518, "learn_time_ms": 17263.02, "learn_throughput": 231.709, "update_time_ms": 4.475}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 8.235879495739937, "policy_loss": -0.019601744948886335, "vf_loss": 8.249082297086716, "vf_explained_var": 0.44269222021102905, "kl": 0.005120007765071932, "entropy": 0.08118492143694311, "entropy_coeff": 0.0}}, "num_steps_sampled": 1928000, "num_steps_trained": 1928000}, "done": false, "episodes_total": 192, "training_iteration": 482, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-55-14", "timestamp": 1618152914, "time_this_iter_s": 30.213390588760376, "time_total_s": 14258.73269867897, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3db8fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14258.73269867897, "timesteps_since_restore": 0, "iterations_since_restore": 482, "perf": {"cpu_util_percent": 64.13023255813954, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1155.0, "episode_reward_min": 1155.0, "episode_reward_mean": 1155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5570032206330935, "mean_raw_obs_processing_ms": 0.1484019395427861, "mean_inference_ms": 2.347846121449848, "mean_action_processing_ms": 0.0582363686624479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1932000, "timers": {"sample_time_ms": 13561.612, "sample_throughput": 294.95, "learn_time_ms": 17363.789, "learn_throughput": 230.364, "update_time_ms": 4.296}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 9.356316074728966, "policy_loss": -0.01739604485919699, "vf_loss": 9.368545711040497, "vf_explained_var": 0.46281111240386963, "kl": 0.004133788221224677, "entropy": 0.08739888481795788, "entropy_coeff": 0.0}}, "num_steps_sampled": 1932000, "num_steps_trained": 1932000}, "done": false, "episodes_total": 193, "training_iteration": 483, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-55-44", "timestamp": 1618152944, "time_this_iter_s": 30.057634115219116, "time_total_s": 14288.79033279419, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d35890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d4ddd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14288.79033279419, "timesteps_since_restore": 0, "iterations_since_restore": 483, "perf": {"cpu_util_percent": 64.07441860465116, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1155.0, "episode_reward_min": 1155.0, "episode_reward_mean": 1155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5570032206330935, "mean_raw_obs_processing_ms": 0.1484019395427861, "mean_inference_ms": 2.347846121449848, "mean_action_processing_ms": 0.0582363686624479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1936000, "timers": {"sample_time_ms": 13579.092, "sample_throughput": 294.571, "learn_time_ms": 17334.287, "learn_throughput": 230.757, "update_time_ms": 4.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 8.403666600584984, "policy_loss": -0.024711332051083446, "vf_loss": 8.421291276812553, "vf_explained_var": 0.5475383996963501, "kl": 0.011340310462401249, "entropy": 0.10263598407618701, "entropy_coeff": 0.0}}, "num_steps_sampled": 1936000, "num_steps_trained": 1936000}, "done": false, "episodes_total": 193, "training_iteration": 484, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-56-16", "timestamp": 1618152976, "time_this_iter_s": 31.501077890396118, "time_total_s": 14320.291410684586, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3c27050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3cda310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14320.291410684586, "timesteps_since_restore": 0, "iterations_since_restore": 484, "perf": {"cpu_util_percent": 64.17333333333335, "ram_util_percent": 27.924444444444443}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1065.0, "episode_reward_min": 1065.0, "episode_reward_mean": 1065.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1065.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5582555095567756, "mean_raw_obs_processing_ms": 0.14865403636211963, "mean_inference_ms": 2.348150159175174, "mean_action_processing_ms": 0.05824388679861194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1940000, "timers": {"sample_time_ms": 13517.724, "sample_throughput": 295.908, "learn_time_ms": 17403.398, "learn_throughput": 229.84, "update_time_ms": 4.433}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 9.319293707609177, "policy_loss": -0.054799047589767724, "vf_loss": 9.35627293586731, "vf_explained_var": 0.504697322845459, "kl": 0.028516572783701122, "entropy": 0.12733097351156175, "entropy_coeff": 0.0}}, "num_steps_sampled": 1940000, "num_steps_trained": 1940000}, "done": false, "episodes_total": 194, "training_iteration": 485, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-56-48", "timestamp": 1618153008, "time_this_iter_s": 32.507288217544556, "time_total_s": 14352.79869890213, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14352.79869890213, "timesteps_since_restore": 0, "iterations_since_restore": 485, "perf": {"cpu_util_percent": 63.97608695652174, "ram_util_percent": 27.921739130434794}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1065.0, "episode_reward_min": 1065.0, "episode_reward_mean": 1065.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1065.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5582555095567756, "mean_raw_obs_processing_ms": 0.14865403636211963, "mean_inference_ms": 2.348150159175174, "mean_action_processing_ms": 0.05824388679861194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1944000, "timers": {"sample_time_ms": 13362.54, "sample_throughput": 299.344, "learn_time_ms": 17379.722, "learn_throughput": 230.153, "update_time_ms": 4.231}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 8.59946945309639, "policy_loss": -0.020774908654857427, "vf_loss": 8.611990004777908, "vf_explained_var": 0.5296337604522705, "kl": 0.008806186684523709, "entropy": 0.0957820441108197, "entropy_coeff": 0.0}}, "num_steps_sampled": 1944000, "num_steps_trained": 1944000}, "done": false, "episodes_total": 194, "training_iteration": 486, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-57-18", "timestamp": 1618153038, "time_this_iter_s": 29.261358737945557, "time_total_s": 14382.060057640076, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d351d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b474a050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14382.060057640076, "timesteps_since_restore": 0, "iterations_since_restore": 486, "perf": {"cpu_util_percent": 63.769047619047605, "ram_util_percent": 27.902380952380955}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1065.0, "episode_reward_min": 1065.0, "episode_reward_mean": 1065.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1065.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5582555095567756, "mean_raw_obs_processing_ms": 0.14865403636211963, "mean_inference_ms": 2.348150159175174, "mean_action_processing_ms": 0.05824388679861194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1948000, "timers": {"sample_time_ms": 13354.631, "sample_throughput": 299.522, "learn_time_ms": 17461.821, "learn_throughput": 229.071, "update_time_ms": 4.094}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 6.836110219359398, "policy_loss": -0.02154949662508443, "vf_loss": 6.84955558180809, "vf_explained_var": 0.5445947647094727, "kl": 0.008645887690363452, "entropy": 0.09198897867463529, "entropy_coeff": 0.0}}, "num_steps_sampled": 1948000, "num_steps_trained": 1948000}, "done": false, "episodes_total": 194, "training_iteration": 487, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-57-48", "timestamp": 1618153068, "time_this_iter_s": 30.63933539390564, "time_total_s": 14412.699393033981, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaffd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b472f590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14412.699393033981, "timesteps_since_restore": 0, "iterations_since_restore": 487, "perf": {"cpu_util_percent": 63.45227272727272, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1091.0, "episode_reward_min": 1091.0, "episode_reward_mean": 1091.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1091.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.55914286631356, "mean_raw_obs_processing_ms": 0.14902014028393704, "mean_inference_ms": 2.348399170121693, "mean_action_processing_ms": 0.058249779128969496}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1952000, "timers": {"sample_time_ms": 13368.848, "sample_throughput": 299.203, "learn_time_ms": 17419.148, "learn_throughput": 229.632, "update_time_ms": 4.129}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 6.5012644082307816, "policy_loss": -0.026595786795951426, "vf_loss": 6.5108417719602585, "vf_explained_var": 0.6040812730789185, "kl": 0.018156086021917872, "entropy": 0.10603972803801298, "entropy_coeff": 0.0}}, "num_steps_sampled": 1952000, "num_steps_trained": 1952000}, "done": false, "episodes_total": 195, "training_iteration": 488, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-58-20", "timestamp": 1618153100, "time_this_iter_s": 31.53828525543213, "time_total_s": 14444.237678289413, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc8710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc0ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14444.237678289413, "timesteps_since_restore": 0, "iterations_since_restore": 488, "perf": {"cpu_util_percent": 62.851111111111116, "ram_util_percent": 27.964444444444446}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1091.0, "episode_reward_min": 1091.0, "episode_reward_mean": 1091.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1091.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.55914286631356, "mean_raw_obs_processing_ms": 0.14902014028393704, "mean_inference_ms": 2.348399170121693, "mean_action_processing_ms": 0.058249779128969496}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1956000, "timers": {"sample_time_ms": 13399.473, "sample_throughput": 298.519, "learn_time_ms": 17346.207, "learn_throughput": 230.598, "update_time_ms": 4.322}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 7.063439637422562, "policy_loss": -0.022358523216098547, "vf_loss": 7.0778190940618515, "vf_explained_var": 0.45722249150276184, "kl": 0.00851243174111005, "entropy": 0.07855438359547406, "entropy_coeff": 0.0}}, "num_steps_sampled": 1956000, "num_steps_trained": 1956000}, "done": false, "episodes_total": 195, "training_iteration": 489, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-58-50", "timestamp": 1618153130, "time_this_iter_s": 30.32916021347046, "time_total_s": 14474.566838502884, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e01d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3cda250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14474.566838502884, "timesteps_since_restore": 0, "iterations_since_restore": 489, "perf": {"cpu_util_percent": 63.35116279069767, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1335.0, "episode_reward_min": 1335.0, "episode_reward_mean": 1335.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1335.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5596847948385533, "mean_raw_obs_processing_ms": 0.14928135322899513, "mean_inference_ms": 2.3487812737417837, "mean_action_processing_ms": 0.05826019591689441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1960000, "timers": {"sample_time_ms": 13569.907, "sample_throughput": 294.77, "learn_time_ms": 17374.946, "learn_throughput": 230.217, "update_time_ms": 4.259}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 5.987246170639992, "policy_loss": -0.02057103830156848, "vf_loss": 6.002302899956703, "vf_explained_var": 0.3169369697570801, "kl": 0.005882958903384861, "entropy": 0.07503155141603202, "entropy_coeff": 0.0}}, "num_steps_sampled": 1960000, "num_steps_trained": 1960000}, "done": false, "episodes_total": 196, "training_iteration": 490, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-59-21", "timestamp": 1618153161, "time_this_iter_s": 31.100122690200806, "time_total_s": 14505.666961193085, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3e34450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e013d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14505.666961193085, "timesteps_since_restore": 0, "iterations_since_restore": 490, "perf": {"cpu_util_percent": 64.13181818181819, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1335.0, "episode_reward_min": 1335.0, "episode_reward_mean": 1335.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1335.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5596847948385533, "mean_raw_obs_processing_ms": 0.14928135322899513, "mean_inference_ms": 2.3487812737417837, "mean_action_processing_ms": 0.05826019591689441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1964000, "timers": {"sample_time_ms": 13440.807, "sample_throughput": 297.601, "learn_time_ms": 17298.185, "learn_throughput": 231.238, "update_time_ms": 4.115}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 6.699349969625473, "policy_loss": -0.0413411995396018, "vf_loss": 6.7148816883563995, "vf_explained_var": 0.4932403564453125, "kl": 0.027534763736184686, "entropy": 0.12428810587152839, "entropy_coeff": 0.0}}, "num_steps_sampled": 1964000, "num_steps_trained": 1964000}, "done": false, "episodes_total": 196, "training_iteration": 491, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_14-59-52", "timestamp": 1618153192, "time_this_iter_s": 30.374473094940186, "time_total_s": 14536.041434288025, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3dc05d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14536.041434288025, "timesteps_since_restore": 0, "iterations_since_restore": 491, "perf": {"cpu_util_percent": 63.41818181818181, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1335.0, "episode_reward_min": 1335.0, "episode_reward_mean": 1335.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1335.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5596847948385533, "mean_raw_obs_processing_ms": 0.14928135322899513, "mean_inference_ms": 2.3487812737417837, "mean_action_processing_ms": 0.05826019591689441}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1968000, "timers": {"sample_time_ms": 13497.77, "sample_throughput": 296.345, "learn_time_ms": 17233.225, "learn_throughput": 232.11, "update_time_ms": 4.14}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4060125123265599, "cur_lr": 5e-05, "total_loss": 8.43142557144165, "policy_loss": -0.025197846931405365, "vf_loss": 8.44817616045475, "vf_explained_var": 0.5550140738487244, "kl": 0.006007928917824756, "entropy": 0.09261398355010897, "entropy_coeff": 0.0}}, "num_steps_sampled": 1968000, "num_steps_trained": 1968000}, "done": false, "episodes_total": 196, "training_iteration": 492, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-00-22", "timestamp": 1618153222, "time_this_iter_s": 30.137876987457275, "time_total_s": 14566.179311275482, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3f10d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d35f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14566.179311275482, "timesteps_since_restore": 0, "iterations_since_restore": 492, "perf": {"cpu_util_percent": 63.81395348837209, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1276.0, "episode_reward_min": 1276.0, "episode_reward_mean": 1276.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1276.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5604442555481736, "mean_raw_obs_processing_ms": 0.149660470311406, "mean_inference_ms": 2.3491983054313104, "mean_action_processing_ms": 0.05827002515630843}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1972000, "timers": {"sample_time_ms": 13743.73, "sample_throughput": 291.042, "learn_time_ms": 17176.145, "learn_throughput": 232.881, "update_time_ms": 4.05}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4060125123265599, "cur_lr": 5e-05, "total_loss": 5.381236433982849, "policy_loss": -0.010645809641573578, "vf_loss": 5.386842861771584, "vf_explained_var": 0.32584142684936523, "kl": 0.0035842072502418887, "entropy": 0.06854096963070333, "entropy_coeff": 0.0}}, "num_steps_sampled": 1972000, "num_steps_trained": 1972000}, "done": false, "episodes_total": 197, "training_iteration": 493, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-00-54", "timestamp": 1618153254, "time_this_iter_s": 31.940894842147827, "time_total_s": 14598.12020611763, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3e6a590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14598.12020611763, "timesteps_since_restore": 0, "iterations_since_restore": 493, "perf": {"cpu_util_percent": 62.888888888888886, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1276.0, "episode_reward_min": 1276.0, "episode_reward_mean": 1276.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1276.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5604442555481736, "mean_raw_obs_processing_ms": 0.149660470311406, "mean_inference_ms": 2.3491983054313104, "mean_action_processing_ms": 0.05827002515630843}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1976000, "timers": {"sample_time_ms": 13539.263, "sample_throughput": 295.437, "learn_time_ms": 17194.602, "learn_throughput": 232.631, "update_time_ms": 3.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 5.7059585973620415, "policy_loss": -0.026692997955251485, "vf_loss": 5.725961111485958, "vf_explained_var": 0.47883349657058716, "kl": 0.009516934333078098, "entropy": 0.09938757761847228, "entropy_coeff": 0.0}}, "num_steps_sampled": 1976000, "num_steps_trained": 1976000}, "done": false, "episodes_total": 197, "training_iteration": 494, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-01-24", "timestamp": 1618153284, "time_this_iter_s": 29.638862371444702, "time_total_s": 14627.759068489075, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3edab10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d34750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14627.759068489075, "timesteps_since_restore": 0, "iterations_since_restore": 494, "perf": {"cpu_util_percent": 63.427906976744175, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1235.0, "episode_reward_min": 1235.0, "episode_reward_mean": 1235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5603308705129995, "mean_raw_obs_processing_ms": 0.1499059687056681, "mean_inference_ms": 2.349453870898092, "mean_action_processing_ms": 0.058275868383717316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1980000, "timers": {"sample_time_ms": 13473.382, "sample_throughput": 296.882, "learn_time_ms": 17112.699, "learn_throughput": 233.745, "update_time_ms": 3.825}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 7.795613676309586, "policy_loss": -0.04628565287566744, "vf_loss": 7.820171169936657, "vf_explained_var": 0.6466283798217773, "kl": 0.030907580337952822, "entropy": 0.14656850625760853, "entropy_coeff": 0.0}}, "num_steps_sampled": 1980000, "num_steps_trained": 1980000}, "done": false, "episodes_total": 198, "training_iteration": 495, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-01-55", "timestamp": 1618153315, "time_this_iter_s": 31.026251316070557, "time_total_s": 14658.785319805145, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d73810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3cdaf50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14658.785319805145, "timesteps_since_restore": 0, "iterations_since_restore": 495, "perf": {"cpu_util_percent": 63.28409090909092, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1235.0, "episode_reward_min": 1235.0, "episode_reward_mean": 1235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5603308705129995, "mean_raw_obs_processing_ms": 0.1499059687056681, "mean_inference_ms": 2.349453870898092, "mean_action_processing_ms": 0.058275868383717316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1984000, "timers": {"sample_time_ms": 13699.008, "sample_throughput": 291.992, "learn_time_ms": 17204.934, "learn_throughput": 232.491, "update_time_ms": 3.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0545093842449198, "cur_lr": 5e-05, "total_loss": 7.333531901240349, "policy_loss": -0.03127853086334653, "vf_loss": 7.359090611338615, "vf_explained_var": 0.509742021560669, "kl": 0.005424131792096887, "entropy": 0.08232383814174682, "entropy_coeff": 0.0}}, "num_steps_sampled": 1984000, "num_steps_trained": 1984000}, "done": false, "episodes_total": 198, "training_iteration": 496, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-02-27", "timestamp": 1618153347, "time_this_iter_s": 32.43772792816162, "time_total_s": 14691.223047733307, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3c27dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3c27390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14691.223047733307, "timesteps_since_restore": 0, "iterations_since_restore": 496, "perf": {"cpu_util_percent": 64.58695652173913, "ram_util_percent": 27.900000000000013}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1235.0, "episode_reward_min": 1235.0, "episode_reward_mean": 1235.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1235.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5603308705129995, "mean_raw_obs_processing_ms": 0.1499059687056681, "mean_inference_ms": 2.349453870898092, "mean_action_processing_ms": 0.058275868383717316}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1988000, "timers": {"sample_time_ms": 13556.361, "sample_throughput": 295.064, "learn_time_ms": 17214.708, "learn_throughput": 232.359, "update_time_ms": 3.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0545093842449198, "cur_lr": 5e-05, "total_loss": 6.829382479190826, "policy_loss": -0.009593560767825693, "vf_loss": 6.837521001696587, "vf_explained_var": 0.4253358244895935, "kl": 0.00137982043906959, "entropy": 0.022158115258207545, "entropy_coeff": 0.0}}, "num_steps_sampled": 1988000, "num_steps_trained": 1988000}, "done": false, "episodes_total": 198, "training_iteration": 497, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-02-56", "timestamp": 1618153376, "time_this_iter_s": 29.305317163467407, "time_total_s": 14720.528364896774, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3eaa510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3cdab10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14720.528364896774, "timesteps_since_restore": 0, "iterations_since_restore": 497, "perf": {"cpu_util_percent": 64.0142857142857, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 617.0, "episode_reward_min": 617.0, "episode_reward_mean": 617.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [617.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5600132436079927, "mean_raw_obs_processing_ms": 0.15028049389017673, "mean_inference_ms": 2.3499151952703907, "mean_action_processing_ms": 0.05828426335926528}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1992000, "timers": {"sample_time_ms": 13289.389, "sample_throughput": 300.992, "learn_time_ms": 17332.601, "learn_throughput": 230.779, "update_time_ms": 3.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 3.773113202303648, "policy_loss": -0.00848692684667185, "vf_loss": 3.780395247042179, "vf_explained_var": 0.863956093788147, "kl": 0.0022852006932225777, "entropy": 0.009986577846575528, "entropy_coeff": 0.0}}, "num_steps_sampled": 1992000, "num_steps_trained": 1992000}, "done": false, "episodes_total": 199, "training_iteration": 498, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-03-26", "timestamp": 1618153406, "time_this_iter_s": 30.04685688018799, "time_total_s": 14750.575221776962, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3c27f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3dc8510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14750.575221776962, "timesteps_since_restore": 0, "iterations_since_restore": 498, "perf": {"cpu_util_percent": 63.44651162790697, "ram_util_percent": 27.900000000000006}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 617.0, "episode_reward_min": 617.0, "episode_reward_mean": 617.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [617.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5600132436079927, "mean_raw_obs_processing_ms": 0.15028049389017673, "mean_inference_ms": 2.3499151952703907, "mean_action_processing_ms": 0.05828426335926528}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1996000, "timers": {"sample_time_ms": 13217.717, "sample_throughput": 302.624, "learn_time_ms": 17498.827, "learn_throughput": 228.587, "update_time_ms": 3.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.26362734606122995, "cur_lr": 5e-05, "total_loss": 13.377690315246582, "policy_loss": -0.029225163045339286, "vf_loss": 13.402403175830841, "vf_explained_var": 0.477222740650177, "kl": 0.01711673743557185, "entropy": 0.08945277845486999, "entropy_coeff": 0.0}}, "num_steps_sampled": 1996000, "num_steps_trained": 1996000}, "done": false, "episodes_total": 199, "training_iteration": 499, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-03-58", "timestamp": 1618153438, "time_this_iter_s": 31.273517847061157, "time_total_s": 14781.848739624023, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d34f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3d34fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14781.848739624023, "timesteps_since_restore": 0, "iterations_since_restore": 499, "perf": {"cpu_util_percent": 63.642222222222216, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
{"episode_reward_max": 1136.0, "episode_reward_min": 1136.0, "episode_reward_mean": 1136.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1136.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5603198529300928, "mean_raw_obs_processing_ms": 0.1505212544999242, "mean_inference_ms": 2.350028401645002, "mean_action_processing_ms": 0.058286454740630364}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 2000000, "timers": {"sample_time_ms": 13189.539, "sample_throughput": 303.271, "learn_time_ms": 17516.835, "learn_throughput": 228.352, "update_time_ms": 3.591}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.26362734606122995, "cur_lr": 5e-05, "total_loss": 8.172725394368172, "policy_loss": -0.02236454200465232, "vf_loss": 8.192228332161903, "vf_explained_var": 0.4858551621437073, "kl": 0.01085469129611738, "entropy": 0.07859207061119378, "entropy_coeff": 0.0}}, "num_steps_sampled": 2000000, "num_steps_trained": 2000000}, "done": true, "episodes_total": 200, "training_iteration": 500, "experiment_id": "143c9cb5e33d4388b1f11996b18bdbfe", "date": "2021-04-11_15-04-29", "timestamp": 1618153469, "time_this_iter_s": 31.001890182495117, "time_total_s": 14812.850629806519, "pid": 703, "hostname": "285e2a0aa751", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 1, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f29b3d48cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f29b3c27310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 1, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14812.850629806519, "timesteps_since_restore": 0, "iterations_since_restore": 500, "perf": {"cpu_util_percent": 63.756818181818176, "ram_util_percent": 27.90000000000001}, "trial_id": "9a92d_00000"}
