{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 4000, "timers": {"sample_time_ms": 11839.019, "sample_throughput": 337.866, "learn_time_ms": 11522.176, "learn_throughput": 347.157, "update_time_ms": 3.108}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.4608094245195389, "policy_loss": -0.043908312742132694, "vf_loss": 1.5020350106060505, "vf_explained_var": 0.14762845635414124, "kl": 0.013413660548394546, "entropy": 1.0849049277603626, "entropy_coeff": 0.0}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_10-58-01", "timestamp": 1618138681, "time_this_iter_s": 23.369654655456543, "time_total_s": 23.369654655456543, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7232a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.369654655456543, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.858823529411765, "ram_util_percent": 27.023529411764706}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 8000, "timers": {"sample_time_ms": 10762.763, "sample_throughput": 371.652, "learn_time_ms": 11481.432, "learn_throughput": 348.389, "update_time_ms": 2.998}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.1028840709477663, "policy_loss": -0.051168186648283154, "vf_loss": 1.1509516146034002, "vf_explained_var": 0.27261871099472046, "kl": 0.015503266564337537, "entropy": 1.0652060061693192, "entropy_coeff": 0.0}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_10-58-22", "timestamp": 1618138702, "time_this_iter_s": 21.13536810874939, "time_total_s": 44.50502276420593, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f99d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7232e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.50502276420593, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.36999999999999, "ram_util_percent": 27.05}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 60.0, "episode_reward_min": 60.0, "episode_reward_mean": 60.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6456220758903941, "mean_raw_obs_processing_ms": 0.07616171349327659, "mean_inference_ms": 1.689664424136225, "mean_action_processing_ms": 0.0519503971783581}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12000, "timers": {"sample_time_ms": 9927.47, "sample_throughput": 402.922, "learn_time_ms": 11504.904, "learn_throughput": 347.678, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.2478396333754063, "policy_loss": -0.054023212287575006, "vf_loss": 1.2980172336101532, "vf_explained_var": 0.4717782139778137, "kl": 0.019228024233598262, "entropy": 1.0354138650000095, "entropy_coeff": 0.0}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_10-58-42", "timestamp": 1618138722, "time_this_iter_s": 19.818300008773804, "time_total_s": 64.32332277297974, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b72329d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 64.32332277297974, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 57.074999999999996, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 60.0, "episode_reward_min": 60.0, "episode_reward_mean": 60.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6456220758903941, "mean_raw_obs_processing_ms": 0.07616171349327659, "mean_inference_ms": 1.689664424136225, "mean_action_processing_ms": 0.0519503971783581}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timers": {"sample_time_ms": 9724.65, "sample_throughput": 411.326, "learn_time_ms": 11488.751, "learn_throughput": 348.167, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 2.300493437796831, "policy_loss": -0.0531731829396449, "vf_loss": 2.349727477878332, "vf_explained_var": 0.3402549624443054, "kl": 0.01969594438560307, "entropy": 0.981165049597621, "entropy_coeff": 0.0}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 1, "training_iteration": 4, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_10-59-02", "timestamp": 1618138742, "time_this_iter_s": 20.56639790534973, "time_total_s": 84.88972067832947, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 84.88972067832947, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.496666666666655, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5801064235843079, "mean_raw_obs_processing_ms": 0.07583696742897231, "mean_inference_ms": 1.6586713913434579, "mean_action_processing_ms": 0.050528741682727876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 20000, "timers": {"sample_time_ms": 9531.37, "sample_throughput": 419.667, "learn_time_ms": 11466.121, "learn_throughput": 348.854, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 3.1814699918031693, "policy_loss": -0.05431341158691794, "vf_loss": 3.2319665029644966, "vf_explained_var": 0.4472118616104126, "kl": 0.019084637984633446, "entropy": 0.9090386442840099, "entropy_coeff": 0.0}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 2, "training_iteration": 5, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_10-59-22", "timestamp": 1618138762, "time_this_iter_s": 20.143783569335938, "time_total_s": 105.0335042476654, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723b250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 105.0335042476654, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.635714285714286, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5801064235843079, "mean_raw_obs_processing_ms": 0.07583696742897231, "mean_inference_ms": 1.6586713913434579, "mean_action_processing_ms": 0.050528741682727876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timers": {"sample_time_ms": 9431.193, "sample_throughput": 424.124, "learn_time_ms": 11475.575, "learn_throughput": 348.566, "update_time_ms": 2.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 3.9270788356661797, "policy_loss": -0.05116051418008283, "vf_loss": 3.9746128767728806, "vf_explained_var": 0.28464746475219727, "kl": 0.0181322650751099, "entropy": 0.871813589707017, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 2, "training_iteration": 6, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_10-59-43", "timestamp": 1618138783, "time_this_iter_s": 20.463037490844727, "time_total_s": 125.49654173851013, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a07610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a07f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 125.49654173851013, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.24333333333334, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5801064235843079, "mean_raw_obs_processing_ms": 0.07583696742897231, "mean_inference_ms": 1.6586713913434579, "mean_action_processing_ms": 0.050528741682727876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28000, "timers": {"sample_time_ms": 9327.884, "sample_throughput": 428.822, "learn_time_ms": 11489.919, "learn_throughput": 348.131, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 2.4775268845260143, "policy_loss": -0.05433428898686543, "vf_loss": 2.528435815125704, "vf_explained_var": 0.6180633306503296, "kl": 0.01712670663255267, "entropy": 0.8568815533071756, "entropy_coeff": 0.0}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 2, "training_iteration": 7, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-00-03", "timestamp": 1618138803, "time_this_iter_s": 20.291524648666382, "time_total_s": 145.7880663871765, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a0d850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a0df50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 145.7880663871765, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 57.49655172413794, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 606.0, "episode_reward_min": 606.0, "episode_reward_mean": 606.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [606.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4946675763562755, "mean_raw_obs_processing_ms": 0.07617509736481623, "mean_inference_ms": 1.6477058009875423, "mean_action_processing_ms": 0.05004508119609772}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timers": {"sample_time_ms": 9144.003, "sample_throughput": 437.445, "learn_time_ms": 11491.846, "learn_throughput": 348.073, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.691152065992355, "policy_loss": -0.05063961539417505, "vf_loss": 5.738550320267677, "vf_explained_var": 0.40978723764419556, "kl": 0.01620672777062282, "entropy": 0.7824255749583244, "entropy_coeff": 0.0}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 3, "training_iteration": 8, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-00-23", "timestamp": 1618138823, "time_this_iter_s": 19.369620084762573, "time_total_s": 165.1576864719391, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b9628490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 165.1576864719391, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.05925925925926, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 606.0, "episode_reward_min": 606.0, "episode_reward_mean": 606.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [606.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4946675763562755, "mean_raw_obs_processing_ms": 0.07617509736481623, "mean_inference_ms": 1.6477058009875423, "mean_action_processing_ms": 0.05004508119609772}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 36000, "timers": {"sample_time_ms": 9044.792, "sample_throughput": 442.243, "learn_time_ms": 11487.443, "learn_throughput": 348.206, "update_time_ms": 2.775}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.6997373551130295, "policy_loss": -0.04184927904861979, "vf_loss": 5.738016650080681, "vf_explained_var": 0.4810335338115692, "kl": 0.017850010190159082, "entropy": 0.7415107041597366, "entropy_coeff": 0.0}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 3, "training_iteration": 9, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-00-42", "timestamp": 1618138842, "time_this_iter_s": 19.71187710762024, "time_total_s": 184.86956357955933, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a0d450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723b3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 184.86956357955933, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.732142857142854, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 846.0, "episode_reward_min": 846.0, "episode_reward_mean": 846.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [846.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48900006404564006, "mean_raw_obs_processing_ms": 0.07617678339131305, "mean_inference_ms": 1.6395299572523963, "mean_action_processing_ms": 0.049738057753237565}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 40000, "timers": {"sample_time_ms": 9086.767, "sample_throughput": 440.201, "learn_time_ms": 11477.225, "learn_throughput": 348.516, "update_time_ms": 2.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.215489849448204, "policy_loss": -0.054218109347857535, "vf_loss": 6.266192451119423, "vf_explained_var": 0.40063488483428955, "kl": 0.017576986167114228, "entropy": 0.6402270309627056, "entropy_coeff": 0.0}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 4, "training_iteration": 10, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-01-03", "timestamp": 1618138863, "time_this_iter_s": 20.85966205596924, "time_total_s": 205.72922563552856, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 205.72922563552856, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.940000000000005, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 846.0, "episode_reward_min": 846.0, "episode_reward_mean": 846.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [846.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48900006404564006, "mean_raw_obs_processing_ms": 0.07617678339131305, "mean_inference_ms": 1.6395299572523963, "mean_action_processing_ms": 0.049738057753237565}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44000, "timers": {"sample_time_ms": 9006.778, "sample_throughput": 444.11, "learn_time_ms": 11472.044, "learn_throughput": 348.674, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.793027326464653, "policy_loss": -0.04539086122531444, "vf_loss": 5.835601359605789, "vf_explained_var": 0.1392759382724762, "kl": 0.014084467315115035, "entropy": 0.5907111940905452, "entropy_coeff": 0.0}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 4, "training_iteration": 11, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-01-26", "timestamp": 1618138886, "time_this_iter_s": 22.51768398284912, "time_total_s": 228.24690961837769, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a14e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 228.24690961837769, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 57.193749999999994, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 846.0, "episode_reward_min": 846.0, "episode_reward_mean": 846.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [846.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48900006404564006, "mean_raw_obs_processing_ms": 0.07617678339131305, "mean_inference_ms": 1.6395299572523963, "mean_action_processing_ms": 0.049738057753237565}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timers": {"sample_time_ms": 8886.79, "sample_throughput": 450.106, "learn_time_ms": 11466.923, "learn_throughput": 348.829, "update_time_ms": 2.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.348502069711685, "policy_loss": -0.04014261130942032, "vf_loss": 6.385705754160881, "vf_explained_var": 0.3136705756187439, "kl": 0.014694798010168597, "entropy": 0.595413139089942, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 4, "training_iteration": 12, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-01-46", "timestamp": 1618138906, "time_this_iter_s": 19.88432550430298, "time_total_s": 248.13123512268066, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a14f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a169d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 248.13123512268066, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.41724137931035, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1202.0, "episode_reward_min": 1202.0, "episode_reward_mean": 1202.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1202.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5176995378767412, "mean_raw_obs_processing_ms": 0.07652123637690994, "mean_inference_ms": 1.6405329892540026, "mean_action_processing_ms": 0.04971453539282241}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52000, "timers": {"sample_time_ms": 8990.23, "sample_throughput": 444.927, "learn_time_ms": 11452.479, "learn_throughput": 349.269, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 4.989076338708401, "policy_loss": -0.03644733809051104, "vf_loss": 5.02240090072155, "vf_explained_var": 0.3278721570968628, "kl": 0.015613981668138877, "entropy": 0.5700529366731644, "entropy_coeff": 0.0}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 5, "training_iteration": 13, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-02-06", "timestamp": 1618138926, "time_this_iter_s": 20.70651626586914, "time_total_s": 268.8377513885498, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a0d7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 268.8377513885498, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 57.59310344827587, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1202.0, "episode_reward_min": 1202.0, "episode_reward_mean": 1202.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1202.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5176995378767412, "mean_raw_obs_processing_ms": 0.07652123637690994, "mean_inference_ms": 1.6405329892540026, "mean_action_processing_ms": 0.04971453539282241}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 56000, "timers": {"sample_time_ms": 8847.515, "sample_throughput": 452.104, "learn_time_ms": 11454.56, "learn_throughput": 349.206, "update_time_ms": 3.494}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.1531940549612045, "policy_loss": -0.040389461209997535, "vf_loss": 6.190559059381485, "vf_explained_var": 0.49142980575561523, "kl": 0.01512217553681694, "entropy": 0.6173765622079372, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 5, "training_iteration": 14, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-02-25", "timestamp": 1618138945, "time_this_iter_s": 19.16359806060791, "time_total_s": 288.0013494491577, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a16950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a0df50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 288.0013494491577, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 56.921428571428564, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 963.0, "episode_reward_min": 963.0, "episode_reward_mean": 963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48538672185155146, "mean_raw_obs_processing_ms": 0.07670196012124163, "mean_inference_ms": 1.6363182536117378, "mean_action_processing_ms": 0.04959580493019818}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 60000, "timers": {"sample_time_ms": 8824.822, "sample_throughput": 453.267, "learn_time_ms": 11461.616, "learn_throughput": 348.991, "update_time_ms": 3.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.729657754302025, "policy_loss": -0.051730853389017284, "vf_loss": 6.778823256492615, "vf_explained_var": 0.4332956075668335, "kl": 0.012826073740143329, "entropy": 0.5521382465958595, "entropy_coeff": 0.0}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 6, "training_iteration": 15, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-02-46", "timestamp": 1618138966, "time_this_iter_s": 19.98632001876831, "time_total_s": 307.987669467926, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a161d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 307.987669467926, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 57.417857142857144, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 963.0, "episode_reward_min": 963.0, "episode_reward_mean": 963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48538672185155146, "mean_raw_obs_processing_ms": 0.07670196012124163, "mean_inference_ms": 1.6363182536117378, "mean_action_processing_ms": 0.04959580493019818}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 64000, "timers": {"sample_time_ms": 8894.001, "sample_throughput": 449.741, "learn_time_ms": 11457.707, "learn_throughput": 349.11, "update_time_ms": 3.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.526083782315254, "policy_loss": -0.041210604074876755, "vf_loss": 5.564537733793259, "vf_explained_var": 0.3634769022464752, "kl": 0.013782773312414065, "entropy": 0.49148104526102543, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 6, "training_iteration": 16, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-03-07", "timestamp": 1618138987, "time_this_iter_s": 21.116121530532837, "time_total_s": 329.10379099845886, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a14510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a14790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 329.10379099845886, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.06333333333335, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 963.0, "episode_reward_min": 963.0, "episode_reward_mean": 963.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [963.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48538672185155146, "mean_raw_obs_processing_ms": 0.07670196012124163, "mean_inference_ms": 1.6363182536117378, "mean_action_processing_ms": 0.04959580493019818}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 68000, "timers": {"sample_time_ms": 8893.906, "sample_throughput": 449.746, "learn_time_ms": 11441.0, "learn_throughput": 349.62, "update_time_ms": 3.541}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.320967644453049, "policy_loss": -0.042204186553135514, "vf_loss": 7.360327646136284, "vf_explained_var": 0.36588752269744873, "kl": 0.014221189863746986, "entropy": 0.5228426428511739, "entropy_coeff": 0.0}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 6, "training_iteration": 17, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-03-27", "timestamp": 1618139007, "time_this_iter_s": 20.123663663864136, "time_total_s": 349.227454662323, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a143d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 349.227454662323, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 57.46206896551725, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1297.0, "episode_reward_min": 1297.0, "episode_reward_mean": 1297.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1297.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5049175561211993, "mean_raw_obs_processing_ms": 0.07688350653383802, "mean_inference_ms": 1.6320658280444449, "mean_action_processing_ms": 0.04941896174302063}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timers": {"sample_time_ms": 9103.368, "sample_throughput": 439.398, "learn_time_ms": 11436.171, "learn_throughput": 349.767, "update_time_ms": 3.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.198857247829437, "policy_loss": -0.0466746311285533, "vf_loss": 5.242564678192139, "vf_explained_var": 0.3406825065612793, "kl": 0.014836053509498015, "entropy": 0.47784400824457407, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 7, "training_iteration": 18, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-03-48", "timestamp": 1618139028, "time_this_iter_s": 21.41817283630371, "time_total_s": 370.6456274986267, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fe90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 370.6456274986267, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.9225806451613, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1297.0, "episode_reward_min": 1297.0, "episode_reward_mean": 1297.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1297.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5049175561211993, "mean_raw_obs_processing_ms": 0.07688350653383802, "mean_inference_ms": 1.6320658280444449, "mean_action_processing_ms": 0.04941896174302063}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76000, "timers": {"sample_time_ms": 9283.468, "sample_throughput": 430.873, "learn_time_ms": 11440.868, "learn_throughput": 349.624, "update_time_ms": 3.578}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.273877799510956, "policy_loss": -0.04306337528396398, "vf_loss": 6.314169704914093, "vf_explained_var": 0.43419867753982544, "kl": 0.013857244164682925, "entropy": 0.4808381861075759, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 7, "training_iteration": 19, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-04-10", "timestamp": 1618139050, "time_this_iter_s": 21.56158447265625, "time_total_s": 392.20721197128296, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699cb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 392.20721197128296, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 57.30322580645161, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1394.0, "episode_reward_min": 1394.0, "episode_reward_mean": 1394.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1394.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5410928860066648, "mean_raw_obs_processing_ms": 0.07701678266584992, "mean_inference_ms": 1.6304563831397008, "mean_action_processing_ms": 0.04931187382641543}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 80000, "timers": {"sample_time_ms": 9432.689, "sample_throughput": 424.057, "learn_time_ms": 11440.822, "learn_throughput": 349.625, "update_time_ms": 3.584}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.169224292039871, "policy_loss": -0.04041759279789403, "vf_loss": 6.2070499658584595, "vf_explained_var": 0.34410959482192993, "kl": 0.012959855113876984, "entropy": 0.4064915245398879, "entropy_coeff": 0.0}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 8, "training_iteration": 20, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-04-32", "timestamp": 1618139072, "time_this_iter_s": 22.35212516784668, "time_total_s": 414.55933713912964, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b72282d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 414.55933713912964, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.090625, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1394.0, "episode_reward_min": 1394.0, "episode_reward_mean": 1394.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1394.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5410928860066648, "mean_raw_obs_processing_ms": 0.07701678266584992, "mean_inference_ms": 1.6304563831397008, "mean_action_processing_ms": 0.04931187382641543}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84000, "timers": {"sample_time_ms": 9311.411, "sample_throughput": 429.58, "learn_time_ms": 11440.835, "learn_throughput": 349.625, "update_time_ms": 3.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.6344607919454575, "policy_loss": -0.038341944746207446, "vf_loss": 5.670141741633415, "vf_explained_var": 0.3331894278526306, "kl": 0.013304932654136792, "entropy": 0.44613551441580057, "entropy_coeff": 0.0}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 8, "training_iteration": 21, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-04-54", "timestamp": 1618139094, "time_this_iter_s": 21.304789543151855, "time_total_s": 435.8641266822815, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a07b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 435.8641266822815, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.18666666666666, "ram_util_percent": 27.013333333333332}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1394.0, "episode_reward_min": 1394.0, "episode_reward_mean": 1394.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1394.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5410928860066648, "mean_raw_obs_processing_ms": 0.07701678266584992, "mean_inference_ms": 1.6304563831397008, "mean_action_processing_ms": 0.04931187382641543}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 88000, "timers": {"sample_time_ms": 9304.397, "sample_throughput": 429.904, "learn_time_ms": 11446.25, "learn_throughput": 349.459, "update_time_ms": 3.426}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.168655782938004, "policy_loss": -0.04370638812542893, "vf_loss": 8.209612876176834, "vf_explained_var": 0.4807034730911255, "kl": 0.013746459182584658, "entropy": 0.45562698505818844, "entropy_coeff": 0.0}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 8, "training_iteration": 22, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-05-13", "timestamp": 1618139113, "time_this_iter_s": 19.86811089515686, "time_total_s": 455.73223757743835, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699c090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 455.73223757743835, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 57.5, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1346.0, "episode_reward_min": 1346.0, "episode_reward_mean": 1346.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1346.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5443533058185992, "mean_raw_obs_processing_ms": 0.07736858982784388, "mean_inference_ms": 1.6306421668400894, "mean_action_processing_ms": 0.049304998957192515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 92000, "timers": {"sample_time_ms": 9364.029, "sample_throughput": 427.167, "learn_time_ms": 11456.513, "learn_throughput": 349.146, "update_time_ms": 3.394}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.835956186056137, "policy_loss": -0.042985763459000736, "vf_loss": 5.876070439815521, "vf_explained_var": 0.21045532822608948, "kl": 0.014356975065311417, "entropy": 0.37786174286156893, "entropy_coeff": 0.0}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 9, "training_iteration": 23, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-05-35", "timestamp": 1618139135, "time_this_iter_s": 21.406429529190063, "time_total_s": 477.1386671066284, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a07190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a16590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 477.1386671066284, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 57.18387096774193, "ram_util_percent": 27.003225806451614}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1346.0, "episode_reward_min": 1346.0, "episode_reward_mean": 1346.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1346.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5443533058185992, "mean_raw_obs_processing_ms": 0.07736858982784388, "mean_inference_ms": 1.6306421668400894, "mean_action_processing_ms": 0.049304998957192515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timers": {"sample_time_ms": 9421.338, "sample_throughput": 424.568, "learn_time_ms": 11459.096, "learn_throughput": 349.068, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.652484238147736, "policy_loss": -0.03162722405977547, "vf_loss": 7.681572154164314, "vf_explained_var": 0.4507204294204712, "kl": 0.012696281861281022, "entropy": 0.4314675275236368, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 9, "training_iteration": 24, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-05-55", "timestamp": 1618139155, "time_this_iter_s": 19.759960174560547, "time_total_s": 496.89862728118896, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699ca90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 496.89862728118896, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 57.767857142857146, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1315.0, "episode_reward_min": 1315.0, "episode_reward_mean": 1315.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1315.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5202855795958338, "mean_raw_obs_processing_ms": 0.07768772638811698, "mean_inference_ms": 1.6308069918148782, "mean_action_processing_ms": 0.04934502609243317}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 100000, "timers": {"sample_time_ms": 9361.617, "sample_throughput": 427.277, "learn_time_ms": 11468.387, "learn_throughput": 348.785, "update_time_ms": 2.801}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.750191554427147, "policy_loss": -0.04370749869849533, "vf_loss": 8.791194573044777, "vf_explained_var": 0.45773810148239136, "kl": 0.013522857305360958, "entropy": 0.44528941437602043, "entropy_coeff": 0.0}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 10, "training_iteration": 25, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-06-14", "timestamp": 1618139174, "time_this_iter_s": 19.483295917510986, "time_total_s": 516.3819231987, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a14810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 516.3819231987, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 57.31428571428571, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1315.0, "episode_reward_min": 1315.0, "episode_reward_mean": 1315.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1315.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5202855795958338, "mean_raw_obs_processing_ms": 0.07768772638811698, "mean_inference_ms": 1.6308069918148782, "mean_action_processing_ms": 0.04934502609243317}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 104000, "timers": {"sample_time_ms": 9186.278, "sample_throughput": 435.432, "learn_time_ms": 11474.056, "learn_throughput": 348.613, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.621791139245033, "policy_loss": -0.03524906310485676, "vf_loss": 7.654037684202194, "vf_explained_var": 0.6748135089874268, "kl": 0.015012437186669558, "entropy": 0.4851331524550915, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 10, "training_iteration": 26, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-06-34", "timestamp": 1618139194, "time_this_iter_s": 19.41957950592041, "time_total_s": 535.8015027046204, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 535.8015027046204, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 57.19642857142858, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1315.0, "episode_reward_min": 1315.0, "episode_reward_mean": 1315.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1315.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5202855795958338, "mean_raw_obs_processing_ms": 0.07768772638811698, "mean_inference_ms": 1.6308069918148782, "mean_action_processing_ms": 0.04934502609243317}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 108000, "timers": {"sample_time_ms": 9105.345, "sample_throughput": 439.302, "learn_time_ms": 11481.134, "learn_throughput": 348.398, "update_time_ms": 2.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.18296992778778, "policy_loss": -0.04282326711108908, "vf_loss": 8.2230916172266, "vf_explained_var": 0.5493318438529968, "kl": 0.013507915893569589, "entropy": 0.474246246740222, "entropy_coeff": 0.0}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 10, "training_iteration": 27, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-06-53", "timestamp": 1618139213, "time_this_iter_s": 19.38772225379944, "time_total_s": 555.1892249584198, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699c4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 555.1892249584198, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 57.85185185185184, "ram_util_percent": 27.0}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1063.0, "episode_reward_min": 1063.0, "episode_reward_mean": 1063.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1063.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5092031641669182, "mean_raw_obs_processing_ms": 0.07783719370864775, "mean_inference_ms": 1.62762093174248, "mean_action_processing_ms": 0.04918318499575862}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 112000, "timers": {"sample_time_ms": 9127.268, "sample_throughput": 438.247, "learn_time_ms": 11511.344, "learn_throughput": 347.483, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.714774489402771, "policy_loss": -0.04572295187972486, "vf_loss": 8.75636138021946, "vf_explained_var": 0.4185026288032532, "kl": 0.020680447487393394, "entropy": 0.3648273404687643, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 11, "training_iteration": 28, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-07-15", "timestamp": 1618139235, "time_this_iter_s": 21.937991619110107, "time_total_s": 577.1272165775299, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 577.1272165775299, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.751612903225805, "ram_util_percent": 27.04193548387097}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1063.0, "episode_reward_min": 1063.0, "episode_reward_mean": 1063.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1063.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5092031641669182, "mean_raw_obs_processing_ms": 0.07783719370864775, "mean_inference_ms": 1.62762093174248, "mean_action_processing_ms": 0.04918318499575862}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 116000, "timers": {"sample_time_ms": 9200.931, "sample_throughput": 434.739, "learn_time_ms": 11510.956, "learn_throughput": 347.495, "update_time_ms": 2.833}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 5.954844519495964, "policy_loss": -0.034838561434298754, "vf_loss": 5.986449837684631, "vf_explained_var": 0.2977455258369446, "kl": 0.01077764219371602, "entropy": 0.33175974804908037, "entropy_coeff": 0.0}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 11, "training_iteration": 29, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-07-37", "timestamp": 1618139257, "time_this_iter_s": 22.294084310531616, "time_total_s": 599.4213008880615, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 599.4213008880615, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.21875, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1727.0, "episode_reward_min": 1727.0, "episode_reward_mean": 1727.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1727.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5380119490908184, "mean_raw_obs_processing_ms": 0.07798931377949171, "mean_inference_ms": 1.6259204316048426, "mean_action_processing_ms": 0.04909483011833361}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timers": {"sample_time_ms": 9177.052, "sample_throughput": 435.87, "learn_time_ms": 11524.431, "learn_throughput": 347.089, "update_time_ms": 2.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.566794604063034, "policy_loss": -0.03851055266568437, "vf_loss": 6.601745292544365, "vf_explained_var": 0.31486421823501587, "kl": 0.011866437445860356, "entropy": 0.318274955265224, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 12, "training_iteration": 30, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-08-00", "timestamp": 1618139280, "time_this_iter_s": 22.244895696640015, "time_total_s": 621.6661965847015, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a14410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a142d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 621.6661965847015, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.134375000000006, "ram_util_percent": 27.096875}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1727.0, "episode_reward_min": 1727.0, "episode_reward_mean": 1727.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1727.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5380119490908184, "mean_raw_obs_processing_ms": 0.07798931377949171, "mean_inference_ms": 1.6259204316048426, "mean_action_processing_ms": 0.04909483011833361}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124000, "timers": {"sample_time_ms": 9218.088, "sample_throughput": 433.929, "learn_time_ms": 11525.328, "learn_throughput": 347.062, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.751464679837227, "policy_loss": -0.042210599582176656, "vf_loss": 6.7885672599077225, "vf_explained_var": 0.33862242102622986, "kl": 0.017026806715875864, "entropy": 0.3268176754936576, "entropy_coeff": 0.0}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 12, "training_iteration": 31, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-08-21", "timestamp": 1618139301, "time_this_iter_s": 21.72950792312622, "time_total_s": 643.3957045078278, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a07e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 643.3957045078278, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 57.21290322580645, "ram_util_percent": 27.045161290322586}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1727.0, "episode_reward_min": 1727.0, "episode_reward_mean": 1727.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1727.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5380119490908184, "mean_raw_obs_processing_ms": 0.07798931377949171, "mean_inference_ms": 1.6259204316048426, "mean_action_processing_ms": 0.04909483011833361}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 128000, "timers": {"sample_time_ms": 9415.793, "sample_throughput": 424.818, "learn_time_ms": 11531.307, "learn_throughput": 346.882, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.186001643538475, "policy_loss": -0.044609817676246166, "vf_loss": 8.227109894156456, "vf_explained_var": 0.373542845249176, "kl": 0.011671897213091142, "entropy": 0.3420977797359228, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 12, "training_iteration": 32, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-08-43", "timestamp": 1618139323, "time_this_iter_s": 21.907596588134766, "time_total_s": 665.3033010959625, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 665.3033010959625, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 57.42258064516128, "ram_util_percent": 27.080645161290327}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1611.0, "episode_reward_min": 1611.0, "episode_reward_mean": 1611.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1611.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5585664369889445, "mean_raw_obs_processing_ms": 0.07808470453098226, "mean_inference_ms": 1.6219500737629475, "mean_action_processing_ms": 0.048914316637021255}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 132000, "timers": {"sample_time_ms": 9351.442, "sample_throughput": 427.742, "learn_time_ms": 11530.738, "learn_throughput": 346.899, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.305805936455727, "policy_loss": -0.03374401599285193, "vf_loss": 10.336255058646202, "vf_explained_var": 0.5004115700721741, "kl": 0.010983151936670765, "entropy": 0.3527673752978444, "entropy_coeff": 0.0}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 13, "training_iteration": 33, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-09-04", "timestamp": 1618139344, "time_this_iter_s": 20.756345510482788, "time_total_s": 686.0596466064453, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 686.0596466064453, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.03, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1611.0, "episode_reward_min": 1611.0, "episode_reward_mean": 1611.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1611.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5585664369889445, "mean_raw_obs_processing_ms": 0.07808470453098226, "mean_inference_ms": 1.6219500737629475, "mean_action_processing_ms": 0.048914316637021255}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 136000, "timers": {"sample_time_ms": 9446.279, "sample_throughput": 423.447, "learn_time_ms": 11525.879, "learn_throughput": 347.045, "update_time_ms": 2.92}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.296225488185883, "policy_loss": -0.05125696535105817, "vf_loss": 10.342587485909462, "vf_explained_var": 0.49194788932800293, "kl": 0.01631715211260598, "entropy": 0.3593585882335901, "entropy_coeff": 0.0}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 13, "training_iteration": 34, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-09-25", "timestamp": 1618139365, "time_this_iter_s": 20.658863067626953, "time_total_s": 706.7185096740723, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 706.7185096740723, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.80666666666666, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1332.0, "episode_reward_min": 1332.0, "episode_reward_mean": 1332.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1332.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5583350967898884, "mean_raw_obs_processing_ms": 0.0781528135765304, "mean_inference_ms": 1.6197068290321626, "mean_action_processing_ms": 0.04881539047345515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 140000, "timers": {"sample_time_ms": 9555.898, "sample_throughput": 418.59, "learn_time_ms": 11514.196, "learn_throughput": 347.397, "update_time_ms": 2.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.099576100707054, "policy_loss": -0.03374001116026193, "vf_loss": 10.129941418766975, "vf_explained_var": 0.596860945224762, "kl": 0.01124850832275115, "entropy": 0.4076880654320121, "entropy_coeff": 0.0}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 14, "training_iteration": 35, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-09-45", "timestamp": 1618139385, "time_this_iter_s": 20.463102340698242, "time_total_s": 727.1816120147705, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bf90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 727.1816120147705, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 57.15172413793102, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1332.0, "episode_reward_min": 1332.0, "episode_reward_mean": 1332.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1332.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5583350967898884, "mean_raw_obs_processing_ms": 0.0781528135765304, "mean_inference_ms": 1.6197068290321626, "mean_action_processing_ms": 0.04881539047345515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timers": {"sample_time_ms": 9616.65, "sample_throughput": 415.945, "learn_time_ms": 11504.478, "learn_throughput": 347.691, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 11.559631317853928, "policy_loss": -0.037777055928017944, "vf_loss": 11.594176888465881, "vf_explained_var": 0.5703458786010742, "kl": 0.010772522568004206, "entropy": 0.35048482846468687, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 14, "training_iteration": 36, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-10-05", "timestamp": 1618139405, "time_this_iter_s": 19.927109003067017, "time_total_s": 747.1087210178375, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 747.1087210178375, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.31071428571429, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1332.0, "episode_reward_min": 1332.0, "episode_reward_mean": 1332.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1332.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5583350967898884, "mean_raw_obs_processing_ms": 0.0781528135765304, "mean_inference_ms": 1.6197068290321626, "mean_action_processing_ms": 0.04881539047345515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 148000, "timers": {"sample_time_ms": 9697.27, "sample_throughput": 412.487, "learn_time_ms": 11499.338, "learn_throughput": 347.846, "update_time_ms": 3.011}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 11.848042279481888, "policy_loss": -0.041455693251919, "vf_loss": 11.886488795280457, "vf_explained_var": 0.5742500424385071, "kl": 0.010030730161815882, "entropy": 0.3732866393402219, "entropy_coeff": 0.0}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 14, "training_iteration": 37, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-10-25", "timestamp": 1618139425, "time_this_iter_s": 20.141380786895752, "time_total_s": 767.2501018047333, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699c0d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 767.2501018047333, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.47586206896552, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1333.0, "episode_reward_min": 1333.0, "episode_reward_mean": 1333.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1333.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5585695696338537, "mean_raw_obs_processing_ms": 0.07851198424927563, "mean_inference_ms": 1.6200438440530311, "mean_action_processing_ms": 0.04882326443005033}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 152000, "timers": {"sample_time_ms": 9762.61, "sample_throughput": 409.726, "learn_time_ms": 11469.387, "learn_throughput": 348.754, "update_time_ms": 3.021}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.853460401296616, "policy_loss": -0.04376625354052521, "vf_loss": 7.893673747777939, "vf_explained_var": 0.23320448398590088, "kl": 0.011842580483062193, "entropy": 0.28556957747787237, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 15, "training_iteration": 38, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-10-48", "timestamp": 1618139448, "time_this_iter_s": 22.294102668762207, "time_total_s": 789.5442044734955, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 789.5442044734955, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.150000000000006, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1333.0, "episode_reward_min": 1333.0, "episode_reward_mean": 1333.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1333.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5585695696338537, "mean_raw_obs_processing_ms": 0.07851198424927563, "mean_inference_ms": 1.6200438440530311, "mean_action_processing_ms": 0.04882326443005033}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timers": {"sample_time_ms": 9810.523, "sample_throughput": 407.725, "learn_time_ms": 11461.954, "learn_throughput": 348.981, "update_time_ms": 3.005}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.837439373135567, "policy_loss": -0.04275431443238631, "vf_loss": 6.875329077243805, "vf_explained_var": 0.22874632477760315, "kl": 0.01621515880106017, "entropy": 0.2857882478274405, "entropy_coeff": 0.0}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 15, "training_iteration": 39, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-11-10", "timestamp": 1618139470, "time_this_iter_s": 22.698281049728394, "time_total_s": 812.2424855232239, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f72ab7624d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697be90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 812.2424855232239, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.925, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1720.0, "episode_reward_min": 1720.0, "episode_reward_mean": 1720.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1720.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5855795381984124, "mean_raw_obs_processing_ms": 0.07870353891466843, "mean_inference_ms": 1.619525333074357, "mean_action_processing_ms": 0.04878271131288828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 160000, "timers": {"sample_time_ms": 9897.095, "sample_throughput": 404.159, "learn_time_ms": 11449.988, "learn_throughput": 349.345, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 6.071495071053505, "policy_loss": -0.03860799560789019, "vf_loss": 6.1070476323366165, "vf_explained_var": 0.35358476638793945, "kl": 0.010184826503973454, "entropy": 0.25764953764155507, "entropy_coeff": 0.0}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 16, "training_iteration": 40, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-11-33", "timestamp": 1618139493, "time_this_iter_s": 22.99339461326599, "time_total_s": 835.2358801364899, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 835.2358801364899, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.581818181818186, "ram_util_percent": 27.081818181818182}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1720.0, "episode_reward_min": 1720.0, "episode_reward_mean": 1720.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1720.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5855795381984124, "mean_raw_obs_processing_ms": 0.07870353891466843, "mean_inference_ms": 1.619525333074357, "mean_action_processing_ms": 0.04878271131288828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 164000, "timers": {"sample_time_ms": 10012.106, "sample_throughput": 399.516, "learn_time_ms": 11446.395, "learn_throughput": 349.455, "update_time_ms": 2.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 7.350398436188698, "policy_loss": -0.04151003423612565, "vf_loss": 7.388676807284355, "vf_explained_var": 0.329060822725296, "kl": 0.010772384033771232, "entropy": 0.2651266139000654, "entropy_coeff": 0.0}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 16, "training_iteration": 41, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-11-56", "timestamp": 1618139516, "time_this_iter_s": 22.840583086013794, "time_total_s": 858.0764632225037, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a14d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723b0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 858.0764632225037, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 56.82121212121212, "ram_util_percent": 27.093939393939394}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1720.0, "episode_reward_min": 1720.0, "episode_reward_mean": 1720.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1720.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5855795381984124, "mean_raw_obs_processing_ms": 0.07870353891466843, "mean_inference_ms": 1.619525333074357, "mean_action_processing_ms": 0.04878271131288828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timers": {"sample_time_ms": 9993.538, "sample_throughput": 400.259, "learn_time_ms": 11443.8, "learn_throughput": 349.534, "update_time_ms": 2.944}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 8.245408117771149, "policy_loss": -0.06308124301722273, "vf_loss": 8.298494696617126, "vf_explained_var": 0.5300775766372681, "kl": 0.033315660315565765, "entropy": 0.2589396587572992, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 16, "training_iteration": 42, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-12-18", "timestamp": 1618139538, "time_this_iter_s": 21.69520115852356, "time_total_s": 879.7716643810272, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 879.7716643810272, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 57.64838709677419, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1692.0, "episode_reward_min": 1692.0, "episode_reward_mean": 1692.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1692.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6071322165296739, "mean_raw_obs_processing_ms": 0.07897215633443455, "mean_inference_ms": 1.6183843903817101, "mean_action_processing_ms": 0.048705556661706846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 172000, "timers": {"sample_time_ms": 10083.611, "sample_throughput": 396.683, "learn_time_ms": 11434.773, "learn_throughput": 349.81, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.225062787532806, "policy_loss": -0.03705785603960976, "vf_loss": 13.25778380036354, "vf_explained_var": 0.270779013633728, "kl": 0.009637639959692024, "entropy": 0.24147997330874205, "entropy_coeff": 0.0}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 17, "training_iteration": 43, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-12-40", "timestamp": 1618139560, "time_this_iter_s": 21.567566394805908, "time_total_s": 901.3392307758331, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a14590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 901.3392307758331, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.1483870967742, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1692.0, "episode_reward_min": 1692.0, "episode_reward_mean": 1692.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1692.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6071322165296739, "mean_raw_obs_processing_ms": 0.07897215633443455, "mean_inference_ms": 1.6183843903817101, "mean_action_processing_ms": 0.048705556661706846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 176000, "timers": {"sample_time_ms": 10194.186, "sample_throughput": 392.381, "learn_time_ms": 11440.825, "learn_throughput": 349.625, "update_time_ms": 2.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.621915265917778, "policy_loss": -0.034364831750281155, "vf_loss": 6.652735739946365, "vf_explained_var": 0.25490373373031616, "kl": 0.007876196876168251, "entropy": 0.23140118829905987, "entropy_coeff": 0.0}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 17, "training_iteration": 44, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-13-01", "timestamp": 1618139581, "time_this_iter_s": 21.822835206985474, "time_total_s": 923.1620659828186, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 923.1620659828186, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 56.9774193548387, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1799.0, "episode_reward_min": 1799.0, "episode_reward_mean": 1799.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1799.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6052722749499163, "mean_raw_obs_processing_ms": 0.07913157423088509, "mean_inference_ms": 1.6171863927160957, "mean_action_processing_ms": 0.048658023825560726}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 180000, "timers": {"sample_time_ms": 10102.494, "sample_throughput": 395.942, "learn_time_ms": 11443.236, "learn_throughput": 349.551, "update_time_ms": 2.918}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.9075726717710495, "policy_loss": -0.028934481844771653, "vf_loss": 6.932889208197594, "vf_explained_var": 0.39799392223358154, "kl": 0.008040108674322255, "entropy": 0.2688197889365256, "entropy_coeff": 0.0}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 18, "training_iteration": 45, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-13-21", "timestamp": 1618139601, "time_this_iter_s": 19.57059597969055, "time_total_s": 942.7326619625092, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a079d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 942.7326619625092, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.885714285714286, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1799.0, "episode_reward_min": 1799.0, "episode_reward_mean": 1799.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1799.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6052722749499163, "mean_raw_obs_processing_ms": 0.07913157423088509, "mean_inference_ms": 1.6171863927160957, "mean_action_processing_ms": 0.048658023825560726}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 184000, "timers": {"sample_time_ms": 10288.742, "sample_throughput": 388.774, "learn_time_ms": 11457.469, "learn_throughput": 349.117, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.329477444291115, "policy_loss": -0.035803455335553735, "vf_loss": 8.360461860895157, "vf_explained_var": 0.33633285760879517, "kl": 0.010708871588576585, "entropy": 0.25142546044662595, "entropy_coeff": 0.0}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 18, "training_iteration": 46, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-13-43", "timestamp": 1618139623, "time_this_iter_s": 21.932154655456543, "time_total_s": 964.6648166179657, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a07310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 964.6648166179657, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.351612903225806, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1799.0, "episode_reward_min": 1799.0, "episode_reward_mean": 1799.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1799.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6052722749499163, "mean_raw_obs_processing_ms": 0.07913157423088509, "mean_inference_ms": 1.6171863927160957, "mean_action_processing_ms": 0.048658023825560726}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 188000, "timers": {"sample_time_ms": 10322.219, "sample_throughput": 387.514, "learn_time_ms": 11459.205, "learn_throughput": 349.064, "update_time_ms": 2.959}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.43485489487648, "policy_loss": -0.038499195827171206, "vf_loss": 8.467237919569016, "vf_explained_var": 0.5918798446655273, "kl": 0.013591562281362712, "entropy": 0.27282678382471204, "entropy_coeff": 0.0}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 18, "training_iteration": 47, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-14-04", "timestamp": 1618139644, "time_this_iter_s": 20.495779275894165, "time_total_s": 985.1605958938599, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6933d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8df90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 985.1605958938599, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 57.372413793103455, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1611.0, "episode_reward_min": 1611.0, "episode_reward_mean": 1611.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1611.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6000798308386966, "mean_raw_obs_processing_ms": 0.07947248427599832, "mean_inference_ms": 1.618004706497475, "mean_action_processing_ms": 0.048678083754229794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timers": {"sample_time_ms": 10065.655, "sample_throughput": 397.391, "learn_time_ms": 11459.167, "learn_throughput": 349.066, "update_time_ms": 2.94}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.078301399946213, "policy_loss": -0.04625085287261754, "vf_loss": 13.115673571825027, "vf_explained_var": 0.49322497844696045, "kl": 0.019730409650946967, "entropy": 0.2874588998965919, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 19, "training_iteration": 48, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-14-23", "timestamp": 1618139663, "time_this_iter_s": 19.727770566940308, "time_total_s": 1004.8883664608002, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1004.8883664608002, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 57.48571428571428, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1611.0, "episode_reward_min": 1611.0, "episode_reward_mean": 1611.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1611.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6000798308386966, "mean_raw_obs_processing_ms": 0.07947248427599832, "mean_inference_ms": 1.618004706497475, "mean_action_processing_ms": 0.048678083754229794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 196000, "timers": {"sample_time_ms": 9869.315, "sample_throughput": 405.297, "learn_time_ms": 11473.758, "learn_throughput": 348.622, "update_time_ms": 2.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.159177631139755, "policy_loss": -0.03389665886061266, "vf_loss": 11.188655376434326, "vf_explained_var": 0.4562124013900757, "kl": 0.00981967753614299, "entropy": 0.2798188207671046, "entropy_coeff": 0.0}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 19, "training_iteration": 49, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-14-44", "timestamp": 1618139684, "time_this_iter_s": 20.880849599838257, "time_total_s": 1025.7692160606384, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a07e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1025.7692160606384, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.04666666666667, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1320.0, "episode_reward_min": 1320.0, "episode_reward_mean": 1320.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1320.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5933688285717355, "mean_raw_obs_processing_ms": 0.07961696512966715, "mean_inference_ms": 1.6167845114639479, "mean_action_processing_ms": 0.04862105735362131}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 200000, "timers": {"sample_time_ms": 9514.15, "sample_throughput": 420.426, "learn_time_ms": 11482.554, "learn_throughput": 348.355, "update_time_ms": 2.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.021082431077957, "policy_loss": -0.03210567415226251, "vf_loss": 13.04822850227356, "vf_explained_var": 0.5627136826515198, "kl": 0.01102143237949349, "entropy": 0.3255943013355136, "entropy_coeff": 0.0}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 20, "training_iteration": 50, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-15-04", "timestamp": 1618139704, "time_this_iter_s": 19.528116464614868, "time_total_s": 1045.2973325252533, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1045.2973325252533, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 56.69642857142856, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1320.0, "episode_reward_min": 1320.0, "episode_reward_mean": 1320.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1320.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5933688285717355, "mean_raw_obs_processing_ms": 0.07961696512966715, "mean_inference_ms": 1.6167845114639479, "mean_action_processing_ms": 0.04862105735362131}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 204000, "timers": {"sample_time_ms": 9536.381, "sample_throughput": 419.446, "learn_time_ms": 11478.011, "learn_throughput": 348.492, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.002754509449005, "policy_loss": -0.032045537140220404, "vf_loss": 8.03102396428585, "vf_explained_var": 0.22436527907848358, "kl": 0.00839127074868884, "entropy": 0.20497443852946162, "entropy_coeff": 0.0}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 20, "training_iteration": 51, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-15-27", "timestamp": 1618139727, "time_this_iter_s": 23.017529249191284, "time_total_s": 1068.3148617744446, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a07510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab762b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1068.3148617744446, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 57.384848484848476, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1320.0, "episode_reward_min": 1320.0, "episode_reward_mean": 1320.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1320.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5933688285717355, "mean_raw_obs_processing_ms": 0.07961696512966715, "mean_inference_ms": 1.6167845114639479, "mean_action_processing_ms": 0.04862105735362131}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 208000, "timers": {"sample_time_ms": 9563.011, "sample_throughput": 418.278, "learn_time_ms": 11476.551, "learn_throughput": 348.537, "update_time_ms": 2.961}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.355825141072273, "policy_loss": -0.036651619884651154, "vf_loss": 9.386883467435837, "vf_explained_var": 0.29864880442619324, "kl": 0.012429778755176812, "entropy": 0.22848071809858084, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 20, "training_iteration": 52, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-15-49", "timestamp": 1618139749, "time_this_iter_s": 21.947073459625244, "time_total_s": 1090.2619352340698, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b96300d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1090.2619352340698, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.16774193548387, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1975.0, "episode_reward_min": 1975.0, "episode_reward_mean": 1975.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1975.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6109719393365237, "mean_raw_obs_processing_ms": 0.0799338972039214, "mean_inference_ms": 1.616949958644184, "mean_action_processing_ms": 0.0486127026840726}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 212000, "timers": {"sample_time_ms": 9550.638, "sample_throughput": 418.82, "learn_time_ms": 11489.483, "learn_throughput": 348.144, "update_time_ms": 2.978}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.408596247434616, "policy_loss": -0.03240701663889922, "vf_loss": 8.43712803721428, "vf_explained_var": 0.4147101044654846, "kl": 0.008611789598944597, "entropy": 0.2182826423086226, "entropy_coeff": 0.0}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 21, "training_iteration": 53, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-16-10", "timestamp": 1618139770, "time_this_iter_s": 21.57590079307556, "time_total_s": 1111.8378360271454, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6933110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1111.8378360271454, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 57.196774193548386, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1975.0, "episode_reward_min": 1975.0, "episode_reward_mean": 1975.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1975.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6109719393365237, "mean_raw_obs_processing_ms": 0.0799338972039214, "mean_inference_ms": 1.616949958644184, "mean_action_processing_ms": 0.0486127026840726}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timers": {"sample_time_ms": 9382.77, "sample_throughput": 426.313, "learn_time_ms": 11478.05, "learn_throughput": 348.491, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.161290735006332, "policy_loss": -0.03759377548703924, "vf_loss": 10.19221144914627, "vf_explained_var": 0.33276206254959106, "kl": 0.014828745508566499, "entropy": 0.2242978224530816, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 21, "training_iteration": 54, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-16-30", "timestamp": 1618139790, "time_this_iter_s": 20.032495498657227, "time_total_s": 1131.8703315258026, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b6050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a07290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1131.8703315258026, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.53793103448276, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1746.0, "episode_reward_min": 1746.0, "episode_reward_mean": 1746.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1746.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.608110202877027, "mean_raw_obs_processing_ms": 0.08009742503496711, "mean_inference_ms": 1.6170759444799183, "mean_action_processing_ms": 0.048593264476902306}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 220000, "timers": {"sample_time_ms": 9548.94, "sample_throughput": 418.895, "learn_time_ms": 11476.167, "learn_throughput": 348.548, "update_time_ms": 2.908}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.809163555502892, "policy_loss": -0.038720539305359125, "vf_loss": 9.843885138630867, "vf_explained_var": 0.3993968963623047, "kl": 0.008886317649739794, "entropy": 0.24555013282224536, "entropy_coeff": 0.0}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 22, "training_iteration": 55, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-16-52", "timestamp": 1618139812, "time_this_iter_s": 21.210388660430908, "time_total_s": 1153.0807201862335, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699c790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1153.0807201862335, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 57.29666666666667, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1746.0, "episode_reward_min": 1746.0, "episode_reward_mean": 1746.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1746.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.608110202877027, "mean_raw_obs_processing_ms": 0.08009742503496711, "mean_inference_ms": 1.6170759444799183, "mean_action_processing_ms": 0.048593264476902306}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 224000, "timers": {"sample_time_ms": 9540.222, "sample_throughput": 419.277, "learn_time_ms": 11486.494, "learn_throughput": 348.235, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.7820451855659485, "policy_loss": -0.03805943694896996, "vf_loss": 7.8157519698143005, "vf_explained_var": 0.26230403780937195, "kl": 0.00967229726666119, "entropy": 0.1967810937203467, "entropy_coeff": 0.0}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 22, "training_iteration": 56, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-17-14", "timestamp": 1618139834, "time_this_iter_s": 21.947677850723267, "time_total_s": 1175.0283980369568, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1175.0283980369568, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.887096774193544, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1746.0, "episode_reward_min": 1746.0, "episode_reward_mean": 1746.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1746.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.608110202877027, "mean_raw_obs_processing_ms": 0.08009742503496711, "mean_inference_ms": 1.6170759444799183, "mean_action_processing_ms": 0.048593264476902306}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228000, "timers": {"sample_time_ms": 9530.15, "sample_throughput": 419.721, "learn_time_ms": 11502.696, "learn_throughput": 347.745, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.717016965150833, "policy_loss": -0.0335684169549495, "vf_loss": 10.745063781738281, "vf_explained_var": 0.48210904002189636, "kl": 0.012270353618077934, "entropy": 0.2856340268626809, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 22, "training_iteration": 57, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-17-34", "timestamp": 1618139854, "time_this_iter_s": 20.5533287525177, "time_total_s": 1195.5817267894745, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b6790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b6990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1195.5817267894745, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 57.22666666666667, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1704.0, "episode_reward_min": 1704.0, "episode_reward_mean": 1704.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1704.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6213169745409576, "mean_raw_obs_processing_ms": 0.08033456581667504, "mean_inference_ms": 1.6150294327279517, "mean_action_processing_ms": 0.0485203260913}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 232000, "timers": {"sample_time_ms": 9892.987, "sample_throughput": 404.327, "learn_time_ms": 11498.892, "learn_throughput": 347.86, "update_time_ms": 2.849}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.71955418586731, "policy_loss": -0.033885711105540395, "vf_loss": 6.750345170497894, "vf_explained_var": 0.39243170619010925, "kl": 0.0068772581580560654, "entropy": 0.17297052359208465, "entropy_coeff": 0.0}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 23, "training_iteration": 58, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-17-58", "timestamp": 1618139878, "time_this_iter_s": 23.315622091293335, "time_total_s": 1218.8973488807678, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1218.8973488807678, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 56.724242424242426, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1704.0, "episode_reward_min": 1704.0, "episode_reward_mean": 1704.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1704.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6213169745409576, "mean_raw_obs_processing_ms": 0.08033456581667504, "mean_inference_ms": 1.6150294327279517, "mean_action_processing_ms": 0.0485203260913}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 236000, "timers": {"sample_time_ms": 9992.242, "sample_throughput": 400.311, "learn_time_ms": 11486.71, "learn_throughput": 348.229, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.066863059997559, "policy_loss": -0.0334621814545244, "vf_loss": 13.09551590681076, "vf_explained_var": 0.5047219395637512, "kl": 0.010687244808650576, "entropy": 0.2059891694225371, "entropy_coeff": 0.0}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 23, "training_iteration": 59, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-18-19", "timestamp": 1618139899, "time_this_iter_s": 21.75167441368103, "time_total_s": 1240.6490232944489, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7ad5dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1240.6490232944489, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 57.400000000000006, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1942.0, "episode_reward_min": 1942.0, "episode_reward_mean": 1942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6250027791145877, "mean_raw_obs_processing_ms": 0.08053300998615631, "mean_inference_ms": 1.61488119731082, "mean_action_processing_ms": 0.04851074966904384}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timers": {"sample_time_ms": 10154.12, "sample_throughput": 393.929, "learn_time_ms": 11484.841, "learn_throughput": 348.285, "update_time_ms": 2.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.806801050901413, "policy_loss": -0.025669974100310355, "vf_loss": 10.828830242156982, "vf_explained_var": 0.4083556532859802, "kl": 0.00809037865838036, "entropy": 0.20096852723509073, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 24, "training_iteration": 60, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-18-40", "timestamp": 1618139920, "time_this_iter_s": 21.132041215896606, "time_total_s": 1261.7810645103455, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f92d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1261.7810645103455, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 57.16, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1942.0, "episode_reward_min": 1942.0, "episode_reward_mean": 1942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6250027791145877, "mean_raw_obs_processing_ms": 0.08053300998615631, "mean_inference_ms": 1.61488119731082, "mean_action_processing_ms": 0.04851074966904384}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 244000, "timers": {"sample_time_ms": 10257.103, "sample_throughput": 389.974, "learn_time_ms": 11494.582, "learn_throughput": 347.99, "update_time_ms": 2.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.647822588682175, "policy_loss": -0.027799499919638038, "vf_loss": 7.671574875712395, "vf_explained_var": 0.2461060881614685, "kl": 0.00899371576088015, "entropy": 0.17096312390640378, "entropy_coeff": 0.0}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 24, "training_iteration": 61, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-19-05", "timestamp": 1618139945, "time_this_iter_s": 24.147379159927368, "time_total_s": 1285.9284436702728, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f96d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1285.9284436702728, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 57.214285714285715, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1942.0, "episode_reward_min": 1942.0, "episode_reward_mean": 1942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6250027791145877, "mean_raw_obs_processing_ms": 0.08053300998615631, "mean_inference_ms": 1.61488119731082, "mean_action_processing_ms": 0.04851074966904384}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 248000, "timers": {"sample_time_ms": 10324.056, "sample_throughput": 387.445, "learn_time_ms": 11482.775, "learn_throughput": 348.348, "update_time_ms": 2.781}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.12933437526226, "policy_loss": -0.035927918273955584, "vf_loss": 7.160584211349487, "vf_explained_var": 0.3342457413673401, "kl": 0.010395869961939752, "entropy": 0.18274321127682924, "entropy_coeff": 0.0}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 24, "training_iteration": 62, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-19-27", "timestamp": 1618139967, "time_this_iter_s": 22.496166467666626, "time_total_s": 1308.4246101379395, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6944550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6944050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1308.4246101379395, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 57.234375, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2112.0, "episode_reward_min": 2112.0, "episode_reward_mean": 2112.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2112.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6508160926798593, "mean_raw_obs_processing_ms": 0.08084894352011529, "mean_inference_ms": 1.6145636666664571, "mean_action_processing_ms": 0.04849754116513341}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 252000, "timers": {"sample_time_ms": 10456.594, "sample_throughput": 382.534, "learn_time_ms": 11461.098, "learn_throughput": 349.007, "update_time_ms": 2.774}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 4.823978126049042, "policy_loss": -0.03259091355721466, "vf_loss": 4.85354445874691, "vf_explained_var": 0.2828952670097351, "kl": 0.006721199955791235, "entropy": 0.15816455730237067, "entropy_coeff": 0.0}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 25, "training_iteration": 63, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-19-50", "timestamp": 1618139990, "time_this_iter_s": 22.681185960769653, "time_total_s": 1331.105796098709, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1331.105796098709, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 57.056250000000006, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2112.0, "episode_reward_min": 2112.0, "episode_reward_mean": 2112.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2112.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6508160926798593, "mean_raw_obs_processing_ms": 0.08084894352011529, "mean_inference_ms": 1.6145636666664571, "mean_action_processing_ms": 0.04849754116513341}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 256000, "timers": {"sample_time_ms": 10472.916, "sample_throughput": 381.938, "learn_time_ms": 11470.201, "learn_throughput": 348.73, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.60856556892395, "policy_loss": -0.02987199352355674, "vf_loss": 8.634670287370682, "vf_explained_var": 0.30995169281959534, "kl": 0.0083713991480181, "entropy": 0.19736115401610732, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 25, "training_iteration": 64, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-20-10", "timestamp": 1618140010, "time_this_iter_s": 20.287020683288574, "time_total_s": 1351.3928167819977, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1351.3928167819977, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 57.5, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1853.0, "episode_reward_min": 1853.0, "episode_reward_mean": 1853.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1853.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6461216862102903, "mean_raw_obs_processing_ms": 0.08102512649021502, "mean_inference_ms": 1.6141206703619002, "mean_action_processing_ms": 0.048518737002214395}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 260000, "timers": {"sample_time_ms": 10415.883, "sample_throughput": 384.029, "learn_time_ms": 11472.055, "learn_throughput": 348.673, "update_time_ms": 2.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.544171333312988, "policy_loss": -0.03405233920784667, "vf_loss": 11.572377145290375, "vf_explained_var": 0.4169391989707947, "kl": 0.012992190997465514, "entropy": 0.22909768810495734, "entropy_coeff": 0.0}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 26, "training_iteration": 65, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-20-31", "timestamp": 1618140031, "time_this_iter_s": 20.65863347053528, "time_total_s": 1372.051450252533, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699c0d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1372.051450252533, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 57.49333333333333, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1853.0, "episode_reward_min": 1853.0, "episode_reward_mean": 1853.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1853.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6461216862102903, "mean_raw_obs_processing_ms": 0.08102512649021502, "mean_inference_ms": 1.6141206703619002, "mean_action_processing_ms": 0.048518737002214395}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 264000, "timers": {"sample_time_ms": 10341.476, "sample_throughput": 386.792, "learn_time_ms": 11448.85, "learn_throughput": 349.38, "update_time_ms": 2.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.977966755628586, "policy_loss": -0.03750516404397786, "vf_loss": 13.011844217777252, "vf_explained_var": 0.5329295992851257, "kl": 0.008061513872235082, "entropy": 0.20771329943090677, "entropy_coeff": 0.0}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 26, "training_iteration": 66, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-20-52", "timestamp": 1618140052, "time_this_iter_s": 20.974788427352905, "time_total_s": 1393.0262386798859, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1393.0262386798859, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.55, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1853.0, "episode_reward_min": 1853.0, "episode_reward_mean": 1853.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1853.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6461216862102903, "mean_raw_obs_processing_ms": 0.08102512649021502, "mean_inference_ms": 1.6141206703619002, "mean_action_processing_ms": 0.048518737002214395}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 268000, "timers": {"sample_time_ms": 10232.583, "sample_throughput": 390.908, "learn_time_ms": 11428.517, "learn_throughput": 350.002, "update_time_ms": 2.778}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 16.490039736032486, "policy_loss": -0.04145352705381811, "vf_loss": 16.52676683664322, "vf_explained_var": 0.5100128054618835, "kl": 0.010503775687539019, "entropy": 0.33605648297816515, "entropy_coeff": 0.0}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 26, "training_iteration": 67, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-21-11", "timestamp": 1618140071, "time_this_iter_s": 19.260605812072754, "time_total_s": 1412.2868444919586, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1412.2868444919586, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 56.80000000000001, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1403.0, "episode_reward_min": 1403.0, "episode_reward_mean": 1403.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1403.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.63556101152468, "mean_raw_obs_processing_ms": 0.08131680587862855, "mean_inference_ms": 1.614011288869026, "mean_action_processing_ms": 0.048487487635837455}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 272000, "timers": {"sample_time_ms": 9912.653, "sample_throughput": 403.525, "learn_time_ms": 11431.515, "learn_throughput": 349.91, "update_time_ms": 2.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 14.348169773817062, "policy_loss": -0.030360667209606618, "vf_loss": 14.374515444040298, "vf_explained_var": 0.5933514833450317, "kl": 0.008922185908886604, "entropy": 0.27578712720423937, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 27, "training_iteration": 68, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-21-31", "timestamp": 1618140091, "time_this_iter_s": 20.14633822441101, "time_total_s": 1432.4331827163696, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b6910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1432.4331827163696, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.59655172413794, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1403.0, "episode_reward_min": 1403.0, "episode_reward_mean": 1403.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1403.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.63556101152468, "mean_raw_obs_processing_ms": 0.08131680587862855, "mean_inference_ms": 1.614011288869026, "mean_action_processing_ms": 0.048487487635837455}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 276000, "timers": {"sample_time_ms": 9747.942, "sample_throughput": 410.343, "learn_time_ms": 11436.328, "learn_throughput": 349.763, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.271646335721016, "policy_loss": -0.03268463851418346, "vf_loss": 10.300923302769661, "vf_explained_var": 0.45979273319244385, "kl": 0.007573010239866562, "entropy": 0.22845450788736343, "entropy_coeff": 0.0}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 27, "training_iteration": 69, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-21-52", "timestamp": 1618140112, "time_this_iter_s": 20.150994777679443, "time_total_s": 1452.584177494049, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699c5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1452.584177494049, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.62758620689655, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1474.0, "episode_reward_min": 1474.0, "episode_reward_mean": 1474.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1474.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6261718448953341, "mean_raw_obs_processing_ms": 0.08152296123157025, "mean_inference_ms": 1.6140997784264113, "mean_action_processing_ms": 0.048478754644194225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 280000, "timers": {"sample_time_ms": 9579.807, "sample_throughput": 417.545, "learn_time_ms": 11440.443, "learn_throughput": 349.637, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.76972496509552, "policy_loss": -0.04142884106840938, "vf_loss": 10.806601762771606, "vf_explained_var": 0.5557892322540283, "kl": 0.010115456127095968, "entropy": 0.28141784435138106, "entropy_coeff": 0.0}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 28, "training_iteration": 70, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-22-11", "timestamp": 1618140131, "time_this_iter_s": 19.492554903030396, "time_total_s": 1472.0767323970795, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699ccd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1472.0767323970795, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 57.72857142857142, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1474.0, "episode_reward_min": 1474.0, "episode_reward_mean": 1474.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1474.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6261718448953341, "mean_raw_obs_processing_ms": 0.08152296123157025, "mean_inference_ms": 1.6140997784264113, "mean_action_processing_ms": 0.048478754644194225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 284000, "timers": {"sample_time_ms": 9107.956, "sample_throughput": 439.176, "learn_time_ms": 11440.09, "learn_throughput": 349.648, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.078930586576462, "policy_loss": -0.03521955222822726, "vf_loss": 12.109940856695175, "vf_explained_var": 0.6336488723754883, "kl": 0.009353711458970793, "entropy": 0.3457268998026848, "entropy_coeff": 0.0}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 28, "training_iteration": 71, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-22-31", "timestamp": 1618140151, "time_this_iter_s": 19.42286443710327, "time_total_s": 1491.4995968341827, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1491.4995968341827, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 57.33333333333334, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1474.0, "episode_reward_min": 1474.0, "episode_reward_mean": 1474.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1474.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6261718448953341, "mean_raw_obs_processing_ms": 0.08152296123157025, "mean_inference_ms": 1.6140997784264113, "mean_action_processing_ms": 0.048478754644194225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 288000, "timers": {"sample_time_ms": 9137.047, "sample_throughput": 437.778, "learn_time_ms": 11500.784, "learn_throughput": 347.802, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 14.588214308023453, "policy_loss": -0.03687633911613375, "vf_loss": 14.620505571365356, "vf_explained_var": 0.6019675731658936, "kl": 0.010189552820520476, "entropy": 0.2164432741701603, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 28, "training_iteration": 72, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-22-54", "timestamp": 1618140174, "time_this_iter_s": 23.39927887916565, "time_total_s": 1514.8988757133484, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1514.8988757133484, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 57.88235294117647, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1442.0, "episode_reward_min": 1442.0, "episode_reward_mean": 1442.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1442.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6328560927217618, "mean_raw_obs_processing_ms": 0.08198991957539759, "mean_inference_ms": 1.6164243492564814, "mean_action_processing_ms": 0.04854812636310059}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 292000, "timers": {"sample_time_ms": 9210.923, "sample_throughput": 434.267, "learn_time_ms": 11533.67, "learn_throughput": 346.811, "update_time_ms": 2.821}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.657322764396667, "policy_loss": -0.02099406236084178, "vf_loss": 13.674421399831772, "vf_explained_var": 0.48303598165512085, "kl": 0.008656146179419011, "entropy": 0.175632088445127, "entropy_coeff": 0.0}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 29, "training_iteration": 73, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-23-18", "timestamp": 1618140198, "time_this_iter_s": 23.75044083595276, "time_total_s": 1538.6493165493011, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697ba50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1538.6493165493011, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.38823529411765, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1442.0, "episode_reward_min": 1442.0, "episode_reward_mean": 1442.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1442.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6328560927217618, "mean_raw_obs_processing_ms": 0.08198991957539759, "mean_inference_ms": 1.6164243492564814, "mean_action_processing_ms": 0.04854812636310059}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 296000, "timers": {"sample_time_ms": 9401.009, "sample_throughput": 425.486, "learn_time_ms": 11551.599, "learn_throughput": 346.272, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.300277635455132, "policy_loss": -0.02701082796556875, "vf_loss": 9.323802709579468, "vf_explained_var": 0.3416256308555603, "kl": 0.007746075760223903, "entropy": 0.16771732736378908, "entropy_coeff": 0.0}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 29, "training_iteration": 74, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-23-40", "timestamp": 1618140220, "time_this_iter_s": 22.364322662353516, "time_total_s": 1561.0136392116547, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8d910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6944690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1561.0136392116547, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.64999999999999, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2047.0, "episode_reward_min": 2047.0, "episode_reward_mean": 2047.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2047.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.640861832325183, "mean_raw_obs_processing_ms": 0.08235248771399767, "mean_inference_ms": 1.6194959587586897, "mean_action_processing_ms": 0.04864137807152541}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 300000, "timers": {"sample_time_ms": 9674.631, "sample_throughput": 413.452, "learn_time_ms": 11566.106, "learn_throughput": 345.838, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.688184753060341, "policy_loss": -0.032394626119639724, "vf_loss": 6.717099547386169, "vf_explained_var": 0.3313700556755066, "kl": 0.007733085789368488, "entropy": 0.16376601718366146, "entropy_coeff": 0.0}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 30, "training_iteration": 75, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-24-04", "timestamp": 1618140244, "time_this_iter_s": 23.540498733520508, "time_total_s": 1584.5541379451752, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6944a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8dd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1584.5541379451752, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 57.96060606060607, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2047.0, "episode_reward_min": 2047.0, "episode_reward_mean": 2047.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2047.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.640861832325183, "mean_raw_obs_processing_ms": 0.08235248771399767, "mean_inference_ms": 1.6194959587586897, "mean_action_processing_ms": 0.04864137807152541}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 304000, "timers": {"sample_time_ms": 10073.2, "sample_throughput": 397.093, "learn_time_ms": 11594.831, "learn_throughput": 344.981, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.261354461312294, "policy_loss": -0.025826882105320692, "vf_loss": 6.283802360296249, "vf_explained_var": 0.16919368505477905, "kl": 0.00750891346251592, "entropy": 0.1349291258957237, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 30, "training_iteration": 76, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-24-29", "timestamp": 1618140269, "time_this_iter_s": 25.246944189071655, "time_total_s": 1609.8010821342468, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699cf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6944710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1609.8010821342468, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.20277777777778, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2047.0, "episode_reward_min": 2047.0, "episode_reward_mean": 2047.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2047.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.640861832325183, "mean_raw_obs_processing_ms": 0.08235248771399767, "mean_inference_ms": 1.6194959587586897, "mean_action_processing_ms": 0.04864137807152541}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 308000, "timers": {"sample_time_ms": 10297.253, "sample_throughput": 388.453, "learn_time_ms": 11610.403, "learn_throughput": 344.519, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.675300657749176, "policy_loss": -0.0426921799662523, "vf_loss": 9.710006296634674, "vf_explained_var": 0.40272092819213867, "kl": 0.0177478688856354, "entropy": 0.16725480323657393, "entropy_coeff": 0.0}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 30, "training_iteration": 77, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-24-51", "timestamp": 1618140291, "time_this_iter_s": 21.657416582107544, "time_total_s": 1631.4584987163544, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d5050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699c250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1631.4584987163544, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.43225806451613, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2239.0, "episode_reward_min": 2239.0, "episode_reward_mean": 2239.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2239.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6605388793419081, "mean_raw_obs_processing_ms": 0.0827964312958389, "mean_inference_ms": 1.6205795107719803, "mean_action_processing_ms": 0.048689943689241184}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 312000, "timers": {"sample_time_ms": 10624.101, "sample_throughput": 376.502, "learn_time_ms": 11611.953, "learn_throughput": 344.473, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 5.6087237149477005, "policy_loss": -0.026930750464089215, "vf_loss": 5.632175505161285, "vf_explained_var": 0.2516421675682068, "kl": 0.007730967598035932, "entropy": 0.15076892380602658, "entropy_coeff": 0.0}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 31, "training_iteration": 78, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-25-14", "timestamp": 1618140314, "time_this_iter_s": 23.434186458587646, "time_total_s": 1654.892685174942, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bb10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1654.892685174942, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.482352941176465, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2239.0, "episode_reward_min": 2239.0, "episode_reward_mean": 2239.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2239.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6605388793419081, "mean_raw_obs_processing_ms": 0.0827964312958389, "mean_inference_ms": 1.6205795107719803, "mean_action_processing_ms": 0.048689943689241184}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 316000, "timers": {"sample_time_ms": 10949.624, "sample_throughput": 365.309, "learn_time_ms": 11613.081, "learn_throughput": 344.439, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.302173897624016, "policy_loss": -0.028729200654197484, "vf_loss": 7.327242940664291, "vf_explained_var": 0.26717737317085266, "kl": 0.008133661540341564, "entropy": 0.15738694043830037, "entropy_coeff": 0.0}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 31, "training_iteration": 79, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-25-38", "timestamp": 1618140338, "time_this_iter_s": 23.419182300567627, "time_total_s": 1678.3118674755096, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1678.3118674755096, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 57.372727272727275, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2003.0, "episode_reward_min": 2003.0, "episode_reward_mean": 2003.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2003.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6732388036189921, "mean_raw_obs_processing_ms": 0.08302582782837617, "mean_inference_ms": 1.6206494476672553, "mean_action_processing_ms": 0.04870005081384038}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 320000, "timers": {"sample_time_ms": 11322.594, "sample_throughput": 353.276, "learn_time_ms": 11609.79, "learn_throughput": 344.537, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.895028293132782, "policy_loss": -0.03110029554227367, "vf_loss": 8.920610204339027, "vf_explained_var": 0.44745934009552, "kl": 0.012263084587175399, "entropy": 0.16770142270252109, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 32, "training_iteration": 80, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-26-01", "timestamp": 1618140361, "time_this_iter_s": 23.184058666229248, "time_total_s": 1701.495926141739, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d59d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1701.495926141739, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 57.56060606060606, "ram_util_percent": 27.1}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2003.0, "episode_reward_min": 2003.0, "episode_reward_mean": 2003.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2003.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6732388036189921, "mean_raw_obs_processing_ms": 0.08302582782837617, "mean_inference_ms": 1.6206494476672553, "mean_action_processing_ms": 0.04870005081384038}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 324000, "timers": {"sample_time_ms": 11489.302, "sample_throughput": 348.15, "learn_time_ms": 11609.264, "learn_throughput": 344.552, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.717538103461266, "policy_loss": -0.02936339093139395, "vf_loss": 9.743238300085068, "vf_explained_var": 0.4748746156692505, "kl": 0.008140182428178377, "entropy": 0.18195277941413224, "entropy_coeff": 0.0}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 32, "training_iteration": 81, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-26-22", "timestamp": 1618140382, "time_this_iter_s": 21.084084272384644, "time_total_s": 1722.5800104141235, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1722.5800104141235, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.229032258064514, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2003.0, "episode_reward_min": 2003.0, "episode_reward_mean": 2003.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2003.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6732388036189921, "mean_raw_obs_processing_ms": 0.08302582782837617, "mean_inference_ms": 1.6206494476672553, "mean_action_processing_ms": 0.04870005081384038}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 328000, "timers": {"sample_time_ms": 11370.803, "sample_throughput": 351.778, "learn_time_ms": 11563.429, "learn_throughput": 345.918, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.660089448094368, "policy_loss": -0.03332293371204287, "vf_loss": 7.69056624174118, "vf_explained_var": 0.4318487346172333, "kl": 0.0063248793594539165, "entropy": 0.14567568246275187, "entropy_coeff": 0.0}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 32, "training_iteration": 82, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-26-44", "timestamp": 1618140404, "time_this_iter_s": 21.751148462295532, "time_total_s": 1744.331158876419, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d2dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1744.331158876419, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 57.32580645161289, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1971.0, "episode_reward_min": 1971.0, "episode_reward_mean": 1971.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1971.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6738835160471396, "mean_raw_obs_processing_ms": 0.0832527996635217, "mean_inference_ms": 1.6196684138015762, "mean_action_processing_ms": 0.04864987404061995}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 332000, "timers": {"sample_time_ms": 11103.962, "sample_throughput": 360.232, "learn_time_ms": 11548.327, "learn_throughput": 346.371, "update_time_ms": 2.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.054649770259857, "policy_loss": -0.03613796510035172, "vf_loss": 10.08647707104683, "vf_explained_var": 0.3600732386112213, "kl": 0.009579358054907061, "entropy": 0.163334020646289, "entropy_coeff": 0.0}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 33, "training_iteration": 83, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-27-05", "timestamp": 1618140425, "time_this_iter_s": 20.929835557937622, "time_total_s": 1765.2609944343567, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f72ab529c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1765.2609944343567, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 57.627586206896545, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1971.0, "episode_reward_min": 1971.0, "episode_reward_mean": 1971.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1971.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6738835160471396, "mean_raw_obs_processing_ms": 0.0832527996635217, "mean_inference_ms": 1.6196684138015762, "mean_action_processing_ms": 0.04864987404061995}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 336000, "timers": {"sample_time_ms": 10868.231, "sample_throughput": 368.045, "learn_time_ms": 11535.909, "learn_throughput": 346.743, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.040582835674286, "policy_loss": -0.029031198529992253, "vf_loss": 12.066065818071365, "vf_explained_var": 0.4557027220726013, "kl": 0.007885293423896655, "entropy": 0.19722281815484166, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 33, "training_iteration": 84, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-27-25", "timestamp": 1618140445, "time_this_iter_s": 19.88445258140564, "time_total_s": 1785.1454470157623, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1785.1454470157623, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 57.603448275862064, "ram_util_percent": 27.10000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1720.0, "episode_reward_min": 1720.0, "episode_reward_mean": 1720.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1720.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6637389989999193, "mean_raw_obs_processing_ms": 0.08344998288533477, "mean_inference_ms": 1.6202081276070157, "mean_action_processing_ms": 0.04863953239147434}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 340000, "timers": {"sample_time_ms": 10473.144, "sample_throughput": 381.929, "learn_time_ms": 11523.688, "learn_throughput": 347.111, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.813590750098228, "policy_loss": -0.025447686653933488, "vf_loss": 10.835802584886551, "vf_explained_var": 0.42689305543899536, "kl": 0.007190447562607005, "entropy": 0.19289536867290735, "entropy_coeff": 0.0}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 34, "training_iteration": 85, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-27-44", "timestamp": 1618140464, "time_this_iter_s": 19.46739149093628, "time_total_s": 1804.6128385066986, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1804.6128385066986, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.7, "ram_util_percent": 27.100000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1720.0, "episode_reward_min": 1720.0, "episode_reward_mean": 1720.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1720.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6637389989999193, "mean_raw_obs_processing_ms": 0.08344998288533477, "mean_inference_ms": 1.6202081276070157, "mean_action_processing_ms": 0.04863953239147434}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 344000, "timers": {"sample_time_ms": 10014.386, "sample_throughput": 399.425, "learn_time_ms": 11493.716, "learn_throughput": 348.016, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.932247191667557, "policy_loss": -0.03175576182547957, "vf_loss": 13.960175096988678, "vf_explained_var": 0.44892454147338867, "kl": 0.00850627436011564, "entropy": 0.17183699924498796, "entropy_coeff": 0.0}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 34, "training_iteration": 86, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-28-04", "timestamp": 1618140484, "time_this_iter_s": 20.360220193862915, "time_total_s": 1824.9730587005615, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7232c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1824.9730587005615, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 57.62413793103449, "ram_util_percent": 27.11379310344828}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1720.0, "episode_reward_min": 1720.0, "episode_reward_mean": 1720.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1720.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6637389989999193, "mean_raw_obs_processing_ms": 0.08344998288533477, "mean_inference_ms": 1.6202081276070157, "mean_action_processing_ms": 0.04863953239147434}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 348000, "timers": {"sample_time_ms": 9841.509, "sample_throughput": 406.442, "learn_time_ms": 11496.528, "learn_throughput": 347.931, "update_time_ms": 2.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.157279655337334, "policy_loss": -0.03353226440958679, "vf_loss": 9.187277868390083, "vf_explained_var": 0.40104150772094727, "kl": 0.007853747199987993, "entropy": 0.15200729435309768, "entropy_coeff": 0.0}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 34, "training_iteration": 87, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-28-24", "timestamp": 1618140504, "time_this_iter_s": 19.956409215927124, "time_total_s": 1844.9294679164886, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8df10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1844.9294679164886, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.824999999999996, "ram_util_percent": 27.171428571428578}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1821.0, "episode_reward_min": 1821.0, "episode_reward_mean": 1821.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1821.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6532859388536848, "mean_raw_obs_processing_ms": 0.08370196949927274, "mean_inference_ms": 1.6193286255296446, "mean_action_processing_ms": 0.048625759136124054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 352000, "timers": {"sample_time_ms": 9448.125, "sample_throughput": 423.364, "learn_time_ms": 11493.195, "learn_throughput": 348.032, "update_time_ms": 2.755}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.304927825927734, "policy_loss": -0.034069594606989995, "vf_loss": 11.335013717412949, "vf_explained_var": 0.5342452526092529, "kl": 0.008852735831169412, "entropy": 0.18055034521967173, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 35, "training_iteration": 88, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-28-44", "timestamp": 1618140524, "time_this_iter_s": 19.463210344314575, "time_total_s": 1864.3926782608032, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1864.3926782608032, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 56.875, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1821.0, "episode_reward_min": 1821.0, "episode_reward_mean": 1821.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1821.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6532859388536848, "mean_raw_obs_processing_ms": 0.08370196949927274, "mean_inference_ms": 1.6193286255296446, "mean_action_processing_ms": 0.048625759136124054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 356000, "timers": {"sample_time_ms": 9053.136, "sample_throughput": 441.836, "learn_time_ms": 11492.909, "learn_throughput": 348.041, "update_time_ms": 2.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 13.176076918840408, "policy_loss": -0.025586295349057764, "vf_loss": 13.19812723994255, "vf_explained_var": 0.5055584907531738, "kl": 0.007857422526285518, "entropy": 0.18630892829969525, "entropy_coeff": 0.0}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 35, "training_iteration": 89, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-29-03", "timestamp": 1618140543, "time_this_iter_s": 19.46555209159851, "time_total_s": 1883.8582303524017, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bd50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1883.8582303524017, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 57.58571428571428, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1712.0, "episode_reward_min": 1712.0, "episode_reward_mean": 1712.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1712.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6491045742949431, "mean_raw_obs_processing_ms": 0.08384409502637179, "mean_inference_ms": 1.6183090768388682, "mean_action_processing_ms": 0.0485825652744718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 360000, "timers": {"sample_time_ms": 8841.11, "sample_throughput": 452.432, "learn_time_ms": 11490.586, "learn_throughput": 348.111, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.671052023768425, "policy_loss": -0.025452055560890585, "vf_loss": 9.693276435136795, "vf_explained_var": 0.443734347820282, "kl": 0.007172772049671039, "entropy": 0.14791422663256526, "entropy_coeff": 0.0}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 36, "training_iteration": 90, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-29-24", "timestamp": 1618140564, "time_this_iter_s": 21.043986320495605, "time_total_s": 1904.9022166728973, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b72280d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac73f190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1904.9022166728973, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 57.31000000000001, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1712.0, "episode_reward_min": 1712.0, "episode_reward_mean": 1712.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1712.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6491045742949431, "mean_raw_obs_processing_ms": 0.08384409502637179, "mean_inference_ms": 1.6183090768388682, "mean_action_processing_ms": 0.0485825652744718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 364000, "timers": {"sample_time_ms": 8993.083, "sample_throughput": 444.786, "learn_time_ms": 11483.737, "learn_throughput": 348.319, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.32298581302166, "policy_loss": -0.02336780386394821, "vf_loss": 9.342795088887215, "vf_explained_var": 0.4008410573005676, "kl": 0.0079078747658059, "entropy": 0.14472620701417327, "entropy_coeff": 0.0}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 36, "training_iteration": 91, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-29-47", "timestamp": 1618140587, "time_this_iter_s": 22.53676414489746, "time_total_s": 1927.4389808177948, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cda10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab224e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1927.4389808177948, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 57.253125, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1712.0, "episode_reward_min": 1712.0, "episode_reward_mean": 1712.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1712.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6491045742949431, "mean_raw_obs_processing_ms": 0.08384409502637179, "mean_inference_ms": 1.6183090768388682, "mean_action_processing_ms": 0.0485825652744718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 368000, "timers": {"sample_time_ms": 9098.532, "sample_throughput": 439.631, "learn_time_ms": 11479.774, "learn_throughput": 348.439, "update_time_ms": 2.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.3363775461912155, "policy_loss": -0.022942026364034973, "vf_loss": 6.3559247851371765, "vf_explained_var": 0.33051401376724243, "kl": 0.007543961575720459, "entropy": 0.13193986169062555, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 36, "training_iteration": 92, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-30-10", "timestamp": 1618140610, "time_this_iter_s": 22.76644730567932, "time_total_s": 1950.2054281234741, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1950.2054281234741, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 57.08787878787879, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2118.0, "episode_reward_min": 2118.0, "episode_reward_mean": 2118.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2118.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6602325021478279, "mean_raw_obs_processing_ms": 0.08411143044700599, "mean_inference_ms": 1.6172164870221253, "mean_action_processing_ms": 0.04854322466475901}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 372000, "timers": {"sample_time_ms": 9197.724, "sample_throughput": 434.89, "learn_time_ms": 11482.26, "learn_throughput": 348.363, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.253705754876137, "policy_loss": -0.0480667149531655, "vf_loss": 8.29282794892788, "vf_explained_var": 0.40353259444236755, "kl": 0.019876898411894217, "entropy": 0.1699989610351622, "entropy_coeff": 0.0}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 37, "training_iteration": 93, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-30-32", "timestamp": 1618140632, "time_this_iter_s": 21.945799589157104, "time_total_s": 1972.1512277126312, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fc50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1972.1512277126312, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 57.6483870967742, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2118.0, "episode_reward_min": 2118.0, "episode_reward_mean": 2118.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2118.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6602325021478279, "mean_raw_obs_processing_ms": 0.08411143044700599, "mean_inference_ms": 1.6172164870221253, "mean_action_processing_ms": 0.04854322466475901}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 376000, "timers": {"sample_time_ms": 9397.44, "sample_throughput": 425.648, "learn_time_ms": 11476.008, "learn_throughput": 348.553, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.212031573057175, "policy_loss": -0.028533935779705644, "vf_loss": 7.236437097191811, "vf_explained_var": 0.23381935060024261, "kl": 0.009174405946396291, "entropy": 0.14602252352051437, "entropy_coeff": 0.0}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 37, "training_iteration": 94, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-30-54", "timestamp": 1618140654, "time_this_iter_s": 21.817372798919678, "time_total_s": 1993.968600511551, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d3c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723b3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1993.968600511551, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 57.11612903225806, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2064.0, "episode_reward_min": 2064.0, "episode_reward_mean": 2064.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2064.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.670546756620819, "mean_raw_obs_processing_ms": 0.08424501773607425, "mean_inference_ms": 1.6160790893109291, "mean_action_processing_ms": 0.0485015483716674}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 380000, "timers": {"sample_time_ms": 9857.985, "sample_throughput": 405.762, "learn_time_ms": 11474.258, "learn_throughput": 348.606, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 4.5228846445679665, "policy_loss": -0.02203676468343474, "vf_loss": 4.541673809289932, "vf_explained_var": 0.2254912257194519, "kl": 0.007216870741103776, "entropy": 0.12312074657529593, "entropy_coeff": 0.0}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 38, "training_iteration": 95, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-31-18", "timestamp": 1618140678, "time_this_iter_s": 24.054975271224976, "time_total_s": 2018.0235757827759, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2018.0235757827759, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 56.92058823529412, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2064.0, "episode_reward_min": 2064.0, "episode_reward_mean": 2064.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2064.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.670546756620819, "mean_raw_obs_processing_ms": 0.08424501773607425, "mean_inference_ms": 1.6160790893109291, "mean_action_processing_ms": 0.0485015483716674}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 384000, "timers": {"sample_time_ms": 9998.998, "sample_throughput": 400.04, "learn_time_ms": 11475.048, "learn_throughput": 348.582, "update_time_ms": 2.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.24316294491291, "policy_loss": -0.045495074591599405, "vf_loss": 11.281976744532585, "vf_explained_var": 0.341531902551651, "kl": 0.014847474070847966, "entropy": 0.1390038151293993, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 38, "training_iteration": 96, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-31-39", "timestamp": 1618140699, "time_this_iter_s": 21.778135061264038, "time_total_s": 2039.80171084404, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d5810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2039.80171084404, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 57.131249999999994, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2064.0, "episode_reward_min": 2064.0, "episode_reward_mean": 2064.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2064.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.670546756620819, "mean_raw_obs_processing_ms": 0.08424501773607425, "mean_inference_ms": 1.6160790893109291, "mean_action_processing_ms": 0.0485015483716674}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 388000, "timers": {"sample_time_ms": 10021.382, "sample_throughput": 399.147, "learn_time_ms": 11460.403, "learn_throughput": 349.028, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.20172905921936, "policy_loss": -0.03002695960458368, "vf_loss": 11.228428840637207, "vf_explained_var": 0.40417638421058655, "kl": 0.007393785061140079, "entropy": 0.14797531231306493, "entropy_coeff": 0.0}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 38, "training_iteration": 97, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-32-00", "timestamp": 1618140720, "time_this_iter_s": 20.036561489105225, "time_total_s": 2059.838272333145, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2059.838272333145, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.846428571428575, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1998.0, "episode_reward_min": 1998.0, "episode_reward_mean": 1998.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1998.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6733893336084573, "mean_raw_obs_processing_ms": 0.08445274573169848, "mean_inference_ms": 1.6144106246202938, "mean_action_processing_ms": 0.048431785047279484}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 392000, "timers": {"sample_time_ms": 10303.595, "sample_throughput": 388.214, "learn_time_ms": 11466.737, "learn_throughput": 348.835, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.808375254273415, "policy_loss": -0.0372847038670443, "vf_loss": 6.841793671250343, "vf_explained_var": 0.33281973004341125, "kl": 0.008591737729148008, "entropy": 0.1301899158861488, "entropy_coeff": 0.0}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 39, "training_iteration": 98, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-32-22", "timestamp": 1618140742, "time_this_iter_s": 22.348981857299805, "time_total_s": 2082.187254190445, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2082.187254190445, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.575, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1998.0, "episode_reward_min": 1998.0, "episode_reward_mean": 1998.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1998.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6733893336084573, "mean_raw_obs_processing_ms": 0.08445274573169848, "mean_inference_ms": 1.6144106246202938, "mean_action_processing_ms": 0.048431785047279484}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 396000, "timers": {"sample_time_ms": 10725.917, "sample_throughput": 372.928, "learn_time_ms": 11462.41, "learn_throughput": 348.967, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.66572231054306, "policy_loss": -0.02488241926766932, "vf_loss": 7.687848404049873, "vf_explained_var": 0.30512353777885437, "kl": 0.006124882027506828, "entropy": 0.11676344298757613, "entropy_coeff": 0.0}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 39, "training_iteration": 99, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-32-46", "timestamp": 1618140766, "time_this_iter_s": 23.64402413368225, "time_total_s": 2105.831278324127, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b04d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2105.831278324127, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 57.544117647058826, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2107.0, "episode_reward_min": 2107.0, "episode_reward_mean": 2107.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2107.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6775483978724746, "mean_raw_obs_processing_ms": 0.08462860586756461, "mean_inference_ms": 1.6137873430760454, "mean_action_processing_ms": 0.04840417860636714}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 400000, "timers": {"sample_time_ms": 10647.388, "sample_throughput": 375.679, "learn_time_ms": 11469.845, "learn_throughput": 348.741, "update_time_ms": 2.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.210351929068565, "policy_loss": -0.03545928071253002, "vf_loss": 9.242499515414238, "vf_explained_var": 0.3265376389026642, "kl": 0.0073592919507063925, "entropy": 0.140433338470757, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 40, "training_iteration": 100, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-33-06", "timestamp": 1618140786, "time_this_iter_s": 20.32984733581543, "time_total_s": 2126.1611256599426, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8dcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2126.1611256599426, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 57.517241379310356, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2107.0, "episode_reward_min": 2107.0, "episode_reward_mean": 2107.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2107.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6775483978724746, "mean_raw_obs_processing_ms": 0.08462860586756461, "mean_inference_ms": 1.6137873430760454, "mean_action_processing_ms": 0.04840417860636714}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 404000, "timers": {"sample_time_ms": 10488.778, "sample_throughput": 381.36, "learn_time_ms": 11487.246, "learn_throughput": 348.212, "update_time_ms": 2.897}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.638188540935516, "policy_loss": -0.020046754594659433, "vf_loss": 7.6552465707063675, "vf_explained_var": 0.3437437415122986, "kl": 0.00664165379566839, "entropy": 0.1257778035942465, "entropy_coeff": 0.0}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 40, "training_iteration": 101, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-33-27", "timestamp": 1618140807, "time_this_iter_s": 21.123098611831665, "time_total_s": 2147.2842242717743, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f4e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2147.2842242717743, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 56.83666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2107.0, "episode_reward_min": 2107.0, "episode_reward_mean": 2107.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2107.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6775483978724746, "mean_raw_obs_processing_ms": 0.08462860586756461, "mean_inference_ms": 1.6137873430760454, "mean_action_processing_ms": 0.04840417860636714}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 408000, "timers": {"sample_time_ms": 10542.178, "sample_throughput": 379.428, "learn_time_ms": 11491.596, "learn_throughput": 348.08, "update_time_ms": 2.832}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 7.6673809587955475, "policy_loss": -0.023397478100378066, "vf_loss": 7.687110811471939, "vf_explained_var": 0.27343839406967163, "kl": 0.008150520570779918, "entropy": 0.12622660072520375, "entropy_coeff": 0.0}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 40, "training_iteration": 102, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-33-50", "timestamp": 1618140830, "time_this_iter_s": 23.346081972122192, "time_total_s": 2170.6303062438965, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab529c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2170.6303062438965, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 57.83333333333334, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2165.0, "episode_reward_min": 2165.0, "episode_reward_mean": 2165.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2165.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6855247140514906, "mean_raw_obs_processing_ms": 0.0849201053203093, "mean_inference_ms": 1.6131420696775685, "mean_action_processing_ms": 0.04837960125245223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 412000, "timers": {"sample_time_ms": 10608.348, "sample_throughput": 377.062, "learn_time_ms": 11491.62, "learn_throughput": 348.08, "update_time_ms": 2.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 4.896461255848408, "policy_loss": -0.027980623504845425, "vf_loss": 4.920785114169121, "vf_explained_var": 0.23325490951538086, "kl": 0.008126124404952861, "entropy": 0.12523090024478734, "entropy_coeff": 0.0}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 41, "training_iteration": 103, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-34-13", "timestamp": 1618140853, "time_this_iter_s": 22.61088275909424, "time_total_s": 2193.2411890029907, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2193.2411890029907, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 57.130303030303025, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2165.0, "episode_reward_min": 2165.0, "episode_reward_mean": 2165.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2165.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6855247140514906, "mean_raw_obs_processing_ms": 0.0849201053203093, "mean_inference_ms": 1.6131420696775685, "mean_action_processing_ms": 0.04837960125245223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 416000, "timers": {"sample_time_ms": 10672.471, "sample_throughput": 374.796, "learn_time_ms": 11487.283, "learn_throughput": 348.211, "update_time_ms": 2.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 4.861922092735767, "policy_loss": -0.02236326993443072, "vf_loss": 4.880804754793644, "vf_explained_var": 0.23240694403648376, "kl": 0.007734678685665131, "entropy": 0.12237432808615267, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 41, "training_iteration": 104, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-34-36", "timestamp": 1618140876, "time_this_iter_s": 22.41590714454651, "time_total_s": 2215.6570961475372, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d2190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2215.6570961475372, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 57.4375, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2194.0, "episode_reward_min": 2194.0, "episode_reward_mean": 2194.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2194.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6880957926551867, "mean_raw_obs_processing_ms": 0.08512110424962042, "mean_inference_ms": 1.612994269877208, "mean_action_processing_ms": 0.048373548250330675}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 420000, "timers": {"sample_time_ms": 10383.946, "sample_throughput": 385.21, "learn_time_ms": 11486.294, "learn_throughput": 348.241, "update_time_ms": 2.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.680480599403381, "policy_loss": -0.023034057332552038, "vf_loss": 6.7003510892391205, "vf_explained_var": 0.36079227924346924, "kl": 0.0070303870452335104, "entropy": 0.12614694819785655, "entropy_coeff": 0.0}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 42, "training_iteration": 105, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-34-57", "timestamp": 1618140897, "time_this_iter_s": 21.159998416900635, "time_total_s": 2236.817094564438, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a95d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2236.817094564438, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 57.61666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2194.0, "episode_reward_min": 2194.0, "episode_reward_mean": 2194.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2194.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6880957926551867, "mean_raw_obs_processing_ms": 0.08512110424962042, "mean_inference_ms": 1.612994269877208, "mean_action_processing_ms": 0.048373548250330675}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 424000, "timers": {"sample_time_ms": 10421.304, "sample_throughput": 383.829, "learn_time_ms": 11493.864, "learn_throughput": 348.012, "update_time_ms": 2.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.522436425089836, "policy_loss": -0.036541256005875766, "vf_loss": 8.551908060908318, "vf_explained_var": 0.3931131958961487, "kl": 0.015710301740909927, "entropy": 0.14745740895159543, "entropy_coeff": 0.0}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 42, "training_iteration": 106, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-35-19", "timestamp": 1618140919, "time_this_iter_s": 22.226372241973877, "time_total_s": 2259.0434668064117, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d3550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68f3390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2259.0434668064117, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 57.825, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2194.0, "episode_reward_min": 2194.0, "episode_reward_mean": 2194.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2194.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6880957926551867, "mean_raw_obs_processing_ms": 0.08512110424962042, "mean_inference_ms": 1.612994269877208, "mean_action_processing_ms": 0.048373548250330675}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 428000, "timers": {"sample_time_ms": 10544.018, "sample_throughput": 379.362, "learn_time_ms": 11505.287, "learn_throughput": 347.666, "update_time_ms": 2.713}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.720695734024048, "policy_loss": -0.03411031063296832, "vf_loss": 8.751148328185081, "vf_explained_var": 0.32508060336112976, "kl": 0.00812848854548065, "entropy": 0.13362540863454342, "entropy_coeff": 0.0}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 42, "training_iteration": 107, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-35-40", "timestamp": 1618140940, "time_this_iter_s": 21.37753987312317, "time_total_s": 2280.421006679535, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69485d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69487d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2280.421006679535, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.00666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2139.0, "episode_reward_min": 2139.0, "episode_reward_mean": 2139.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2139.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7000250876402274, "mean_raw_obs_processing_ms": 0.08531905829130088, "mean_inference_ms": 1.6112107138349272, "mean_action_processing_ms": 0.04830547250650737}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 432000, "timers": {"sample_time_ms": 10794.409, "sample_throughput": 370.562, "learn_time_ms": 11510.242, "learn_throughput": 347.517, "update_time_ms": 2.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 6.379881680011749, "policy_loss": -0.025271296442952007, "vf_loss": 6.402522251009941, "vf_explained_var": 0.23947426676750183, "kl": 0.005846183816174744, "entropy": 0.11420855997130275, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 43, "training_iteration": 108, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-36-05", "timestamp": 1618140965, "time_this_iter_s": 24.901914834976196, "time_total_s": 2305.322921514511, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68f3dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68f3550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2305.322921514511, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 57.36944444444445, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2139.0, "episode_reward_min": 2139.0, "episode_reward_mean": 2139.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2139.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7000250876402274, "mean_raw_obs_processing_ms": 0.08531905829130088, "mean_inference_ms": 1.6112107138349272, "mean_action_processing_ms": 0.04830547250650737}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 436000, "timers": {"sample_time_ms": 10633.667, "sample_throughput": 376.164, "learn_time_ms": 11513.002, "learn_throughput": 347.433, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.986055582761765, "policy_loss": -0.026149644516408443, "vf_loss": 10.009083777666092, "vf_explained_var": 0.3469359576702118, "kl": 0.006936615536687896, "entropy": 0.13187859766185284, "entropy_coeff": 0.0}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 43, "training_iteration": 109, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-36-27", "timestamp": 1618140987, "time_this_iter_s": 22.070592403411865, "time_total_s": 2327.393513917923, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2327.393513917923, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 57.70967741935484, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1816.0, "episode_reward_min": 1816.0, "episode_reward_mean": 1816.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1816.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6982945107007789, "mean_raw_obs_processing_ms": 0.08553668110650034, "mean_inference_ms": 1.6116001841474128, "mean_action_processing_ms": 0.04831019551773163}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 440000, "timers": {"sample_time_ms": 10617.568, "sample_throughput": 376.734, "learn_time_ms": 11511.518, "learn_throughput": 347.478, "update_time_ms": 2.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 17.728314131498337, "policy_loss": -0.10528834781143814, "vf_loss": 17.79773387312889, "vf_explained_var": 0.5662554502487183, "kl": 0.07970856875181198, "entropy": 0.2580074234865606, "entropy_coeff": 0.0}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 44, "training_iteration": 110, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-36-48", "timestamp": 1618141008, "time_this_iter_s": 20.15661120414734, "time_total_s": 2347.5501251220703, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fe10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2347.5501251220703, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 57.91034482758621, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1816.0, "episode_reward_min": 1816.0, "episode_reward_mean": 1816.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1816.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6982945107007789, "mean_raw_obs_processing_ms": 0.08553668110650034, "mean_inference_ms": 1.6116001841474128, "mean_action_processing_ms": 0.04831019551773163}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 444000, "timers": {"sample_time_ms": 10507.154, "sample_throughput": 380.693, "learn_time_ms": 11505.908, "learn_throughput": 347.647, "update_time_ms": 2.96}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 14.524844497442245, "policy_loss": -0.02463381944107823, "vf_loss": 14.544119596481323, "vf_explained_var": 0.5950464010238647, "kl": 0.007938816168461926, "entropy": 0.20257717790082097, "entropy_coeff": 0.0}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 44, "training_iteration": 111, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-37-08", "timestamp": 1618141028, "time_this_iter_s": 19.963672161102295, "time_total_s": 2367.5137972831726, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2367.5137972831726, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 57.8448275862069, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1816.0, "episode_reward_min": 1816.0, "episode_reward_mean": 1816.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1816.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6982945107007789, "mean_raw_obs_processing_ms": 0.08553668110650034, "mean_inference_ms": 1.6116001841474128, "mean_action_processing_ms": 0.04831019551773163}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 448000, "timers": {"sample_time_ms": 10454.699, "sample_throughput": 382.603, "learn_time_ms": 11531.126, "learn_throughput": 346.887, "update_time_ms": 2.96}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.367052093148232, "policy_loss": -0.02269646932836622, "vf_loss": 10.38582830131054, "vf_explained_var": 0.4922472834587097, "kl": 0.005807676549011376, "entropy": 0.12842218903824687, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 44, "training_iteration": 112, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-37-31", "timestamp": 1618141051, "time_this_iter_s": 23.072347164154053, "time_total_s": 2390.5861444473267, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fd10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2390.5861444473267, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 58.24848484848484, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1856.0, "episode_reward_min": 1856.0, "episode_reward_mean": 1856.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1856.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7024492377276718, "mean_raw_obs_processing_ms": 0.08585869837784026, "mean_inference_ms": 1.6117555709049562, "mean_action_processing_ms": 0.048293535921546796}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 452000, "timers": {"sample_time_ms": 10536.416, "sample_throughput": 379.636, "learn_time_ms": 11548.488, "learn_throughput": 346.366, "update_time_ms": 3.002}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 13.642415046691895, "policy_loss": -0.02842214607517235, "vf_loss": 13.665930300951004, "vf_explained_var": 0.39508846402168274, "kl": 0.007269556270330213, "entropy": 0.12459244020283222, "entropy_coeff": 0.0}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 45, "training_iteration": 113, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-37-54", "timestamp": 1618141074, "time_this_iter_s": 23.605221271514893, "time_total_s": 2414.1913657188416, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8db50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2414.1913657188416, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 57.67878787878788, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1856.0, "episode_reward_min": 1856.0, "episode_reward_mean": 1856.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1856.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7024492377276718, "mean_raw_obs_processing_ms": 0.08585869837784026, "mean_inference_ms": 1.6117555709049562, "mean_action_processing_ms": 0.048293535921546796}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 456000, "timers": {"sample_time_ms": 10758.832, "sample_throughput": 371.788, "learn_time_ms": 11570.927, "learn_throughput": 345.694, "update_time_ms": 3.044}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 4.775664076209068, "policy_loss": -0.02763087977655232, "vf_loss": 4.799847774207592, "vf_explained_var": 0.32694995403289795, "kl": 0.005106818960484816, "entropy": 0.11034770286642015, "entropy_coeff": 0.0}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 45, "training_iteration": 114, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-38-19", "timestamp": 1618141099, "time_this_iter_s": 24.866340398788452, "time_total_s": 2439.05770611763, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d56d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2439.05770611763, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 57.11388888888889, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2175.0, "episode_reward_min": 2175.0, "episode_reward_mean": 2175.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2175.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7147405962118161, "mean_raw_obs_processing_ms": 0.08606062870210192, "mean_inference_ms": 1.61132377210817, "mean_action_processing_ms": 0.04827921831207769}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 460000, "timers": {"sample_time_ms": 10993.824, "sample_throughput": 363.841, "learn_time_ms": 11610.906, "learn_throughput": 344.504, "update_time_ms": 3.105}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.749856606125832, "policy_loss": -0.026193855272140354, "vf_loss": 7.771425470709801, "vf_explained_var": 0.33472058176994324, "kl": 0.006852112041087821, "entropy": 0.1277596578001976, "entropy_coeff": 0.0}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 46, "training_iteration": 115, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-38-43", "timestamp": 1618141123, "time_this_iter_s": 23.909303426742554, "time_total_s": 2462.9670095443726, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f72acbb74d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7232d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2462.9670095443726, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 57.89705882352941, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2175.0, "episode_reward_min": 2175.0, "episode_reward_mean": 2175.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2175.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7147405962118161, "mean_raw_obs_processing_ms": 0.08606062870210192, "mean_inference_ms": 1.61132377210817, "mean_action_processing_ms": 0.04827921831207769}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 464000, "timers": {"sample_time_ms": 10911.794, "sample_throughput": 366.576, "learn_time_ms": 11620.53, "learn_throughput": 344.218, "update_time_ms": 3.138}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.623832434415817, "policy_loss": -0.025426747626625, "vf_loss": 6.645241856575012, "vf_explained_var": 0.3169006109237671, "kl": 0.005951498773356434, "entropy": 0.11976546351797879, "entropy_coeff": 0.0}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 46, "training_iteration": 116, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-39-05", "timestamp": 1618141145, "time_this_iter_s": 21.500863075256348, "time_total_s": 2484.467872619629, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab503e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2484.467872619629, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 57.81290322580645, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2175.0, "episode_reward_min": 2175.0, "episode_reward_mean": 2175.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2175.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7147405962118161, "mean_raw_obs_processing_ms": 0.08606062870210192, "mean_inference_ms": 1.61132377210817, "mean_action_processing_ms": 0.04827921831207769}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 468000, "timers": {"sample_time_ms": 11136.758, "sample_throughput": 359.171, "learn_time_ms": 11638.529, "learn_throughput": 343.686, "update_time_ms": 3.181}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 5.329691678285599, "policy_loss": -0.02679928476572968, "vf_loss": 5.352281555533409, "vf_explained_var": 0.31070032715797424, "kl": 0.0062360629890463315, "entropy": 0.1276224465109408, "entropy_coeff": 0.0}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 46, "training_iteration": 117, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-39-28", "timestamp": 1618141168, "time_this_iter_s": 23.80894112586975, "time_total_s": 2508.2768137454987, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2508.2768137454987, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 57.39705882352941, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2220.0, "episode_reward_min": 2220.0, "episode_reward_mean": 2220.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2220.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7206355795190021, "mean_raw_obs_processing_ms": 0.08652453608926684, "mean_inference_ms": 1.6120891199314775, "mean_action_processing_ms": 0.04832315612546113}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 472000, "timers": {"sample_time_ms": 10920.766, "sample_throughput": 366.275, "learn_time_ms": 11657.142, "learn_throughput": 343.137, "update_time_ms": 3.166}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 5.987437024712563, "policy_loss": -0.02753284462960437, "vf_loss": 6.008974477648735, "vf_explained_var": 0.3249339461326599, "kl": 0.008882028399966657, "entropy": 0.12799408403225243, "entropy_coeff": 0.0}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 47, "training_iteration": 118, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-39-51", "timestamp": 1618141191, "time_this_iter_s": 22.930418014526367, "time_total_s": 2531.207231760025, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bd10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2531.207231760025, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 58.268750000000004, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2220.0, "episode_reward_min": 2220.0, "episode_reward_mean": 2220.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2220.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7206355795190021, "mean_raw_obs_processing_ms": 0.08652453608926684, "mean_inference_ms": 1.6120891199314775, "mean_action_processing_ms": 0.04832315612546113}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 476000, "timers": {"sample_time_ms": 10782.634, "sample_throughput": 370.967, "learn_time_ms": 11685.396, "learn_throughput": 342.308, "update_time_ms": 2.935}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 9.14888510107994, "policy_loss": -0.0335476707550697, "vf_loss": 9.178176179528236, "vf_explained_var": 0.34556084871292114, "kl": 0.00630602575984085, "entropy": 0.1397353725042194, "entropy_coeff": 0.0}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 47, "training_iteration": 119, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-40-12", "timestamp": 1618141212, "time_this_iter_s": 20.96884298324585, "time_total_s": 2552.176074743271, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2552.176074743271, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.73, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1997.0, "episode_reward_min": 1997.0, "episode_reward_mean": 1997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7144610222842676, "mean_raw_obs_processing_ms": 0.08685092812816537, "mean_inference_ms": 1.6126869906487586, "mean_action_processing_ms": 0.04836195913714237}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 480000, "timers": {"sample_time_ms": 10738.333, "sample_throughput": 372.497, "learn_time_ms": 11713.99, "learn_throughput": 341.472, "update_time_ms": 2.946}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.422021239995956, "policy_loss": -0.03380085283424705, "vf_loss": 10.452055841684341, "vf_explained_var": 0.43806082010269165, "kl": 0.00557968087377958, "entropy": 0.14864266756922007, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 48, "training_iteration": 120, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-40-32", "timestamp": 1618141232, "time_this_iter_s": 20.000006198883057, "time_total_s": 2572.176080942154, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2572.176080942154, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 58.26206896551724, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1997.0, "episode_reward_min": 1997.0, "episode_reward_mean": 1997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7144610222842676, "mean_raw_obs_processing_ms": 0.08685092812816537, "mean_inference_ms": 1.6126869906487586, "mean_action_processing_ms": 0.04836195913714237}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 484000, "timers": {"sample_time_ms": 11024.646, "sample_throughput": 362.823, "learn_time_ms": 11761.384, "learn_throughput": 340.096, "update_time_ms": 2.924}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.799639329314232, "policy_loss": -0.02940769918495789, "vf_loss": 8.823915183544159, "vf_explained_var": 0.6330311894416809, "kl": 0.007602967736602295, "entropy": 0.15115382242947817, "entropy_coeff": 0.0}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 48, "training_iteration": 121, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-40-56", "timestamp": 1618141256, "time_this_iter_s": 23.29948925971985, "time_total_s": 2595.475570201874, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2595.475570201874, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 57.918181818181814, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1997.0, "episode_reward_min": 1997.0, "episode_reward_mean": 1997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7144610222842676, "mean_raw_obs_processing_ms": 0.08685092812816537, "mean_inference_ms": 1.6126869906487586, "mean_action_processing_ms": 0.04836195913714237}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 488000, "timers": {"sample_time_ms": 10856.99, "sample_throughput": 368.426, "learn_time_ms": 11756.179, "learn_throughput": 340.247, "update_time_ms": 2.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 14.374588042497635, "policy_loss": -0.02692141418810934, "vf_loss": 14.397295355796814, "vf_explained_var": 0.584100067615509, "kl": 0.006243406307476107, "entropy": 0.1566244310233742, "entropy_coeff": 0.0}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 48, "training_iteration": 122, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-41-17", "timestamp": 1618141277, "time_this_iter_s": 21.342716693878174, "time_total_s": 2616.818286895752, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68f3a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2616.818286895752, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 57.84516129032257, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1994.0, "episode_reward_min": 1994.0, "episode_reward_mean": 1994.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1994.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7176063715639761, "mean_raw_obs_processing_ms": 0.08711635562827003, "mean_inference_ms": 1.6116993219111448, "mean_action_processing_ms": 0.048318909598464986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 492000, "timers": {"sample_time_ms": 10669.088, "sample_throughput": 374.915, "learn_time_ms": 11741.635, "learn_throughput": 340.668, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.921517848968506, "policy_loss": -0.032326010055840015, "vf_loss": 12.949657768011093, "vf_explained_var": 0.6192935109138489, "kl": 0.006202016920724418, "entropy": 0.16258442169055343, "entropy_coeff": 0.0}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 49, "training_iteration": 123, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-41-39", "timestamp": 1618141299, "time_this_iter_s": 21.576887369155884, "time_total_s": 2638.395174264908, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2638.395174264908, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 57.59677419354839, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1994.0, "episode_reward_min": 1994.0, "episode_reward_mean": 1994.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1994.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7176063715639761, "mean_raw_obs_processing_ms": 0.08711635562827003, "mean_inference_ms": 1.6116993219111448, "mean_action_processing_ms": 0.048318909598464986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 496000, "timers": {"sample_time_ms": 10399.909, "sample_throughput": 384.619, "learn_time_ms": 11756.708, "learn_throughput": 340.231, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.1411954164505, "policy_loss": -0.03662873530993238, "vf_loss": 11.173493653535843, "vf_explained_var": 0.4173658788204193, "kl": 0.006415778792870697, "entropy": 0.1460699699819088, "entropy_coeff": 0.0}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 49, "training_iteration": 124, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-42-01", "timestamp": 1618141321, "time_this_iter_s": 22.327284812927246, "time_total_s": 2660.722459077835, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d5150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695ba10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2660.722459077835, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1983.0, "episode_reward_min": 1983.0, "episode_reward_mean": 1983.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1983.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7212571448460924, "mean_raw_obs_processing_ms": 0.08736134985920947, "mean_inference_ms": 1.6115149849969161, "mean_action_processing_ms": 0.0483169028016192}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 500000, "timers": {"sample_time_ms": 10313.844, "sample_throughput": 387.828, "learn_time_ms": 11717.848, "learn_throughput": 341.36, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.547003954648972, "policy_loss": -0.033220090495888144, "vf_loss": 7.575436174869537, "vf_explained_var": 0.3983456790447235, "kl": 0.007093040883773938, "entropy": 0.13488037372007966, "entropy_coeff": 0.0}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 50, "training_iteration": 125, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-42-24", "timestamp": 1618141344, "time_this_iter_s": 22.66385054588318, "time_total_s": 2683.3863096237183, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695be50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2683.3863096237183, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 57.306060606060605, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1983.0, "episode_reward_min": 1983.0, "episode_reward_mean": 1983.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1983.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7212571448460924, "mean_raw_obs_processing_ms": 0.08736134985920947, "mean_inference_ms": 1.6115149849969161, "mean_action_processing_ms": 0.0483169028016192}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 504000, "timers": {"sample_time_ms": 10225.552, "sample_throughput": 391.177, "learn_time_ms": 11718.036, "learn_throughput": 341.354, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.604934126138687, "policy_loss": -0.03707513306289911, "vf_loss": 12.63658657670021, "vf_explained_var": 0.5596834421157837, "kl": 0.008033400896238163, "entropy": 0.1738790136296302, "entropy_coeff": 0.0}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 50, "training_iteration": 126, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-42-44", "timestamp": 1618141364, "time_this_iter_s": 20.619360208511353, "time_total_s": 2704.0056698322296, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2704.0056698322296, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 58.14137931034484, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1983.0, "episode_reward_min": 1983.0, "episode_reward_mean": 1983.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1983.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7212571448460924, "mean_raw_obs_processing_ms": 0.08736134985920947, "mean_inference_ms": 1.6115149849969161, "mean_action_processing_ms": 0.0483169028016192}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 508000, "timers": {"sample_time_ms": 9783.478, "sample_throughput": 408.853, "learn_time_ms": 11727.234, "learn_throughput": 341.086, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.541591972112656, "policy_loss": -0.05603188753593713, "vf_loss": 12.5778389275074, "vf_explained_var": 0.6016176342964172, "kl": 0.02931090083438903, "entropy": 0.22096532443538308, "entropy_coeff": 0.0}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 50, "training_iteration": 127, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-43-04", "timestamp": 1618141384, "time_this_iter_s": 19.479187488555908, "time_total_s": 2723.4848573207855, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691df50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cda50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2723.4848573207855, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 58.08571428571429, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1558.0, "episode_reward_min": 1558.0, "episode_reward_mean": 1558.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1558.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7140866466348625, "mean_raw_obs_processing_ms": 0.0876946240580117, "mean_inference_ms": 1.6110275768957054, "mean_action_processing_ms": 0.04830253515601325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 512000, "timers": {"sample_time_ms": 9609.592, "sample_throughput": 416.251, "learn_time_ms": 11730.566, "learn_throughput": 340.99, "update_time_ms": 2.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 12.838779121637344, "policy_loss": -0.034051791415549815, "vf_loss": 12.867073774337769, "vf_explained_var": 0.685827910900116, "kl": 0.005686062853783369, "entropy": 0.19923244416713715, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 51, "training_iteration": 128, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-43-25", "timestamp": 1618141405, "time_this_iter_s": 21.22639226913452, "time_total_s": 2744.71124958992, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691d250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691d610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2744.71124958992, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 57.68999999999999, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1558.0, "episode_reward_min": 1558.0, "episode_reward_mean": 1558.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1558.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7140866466348625, "mean_raw_obs_processing_ms": 0.0876946240580117, "mean_inference_ms": 1.6110275768957054, "mean_action_processing_ms": 0.04830253515601325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 516000, "timers": {"sample_time_ms": 9575.973, "sample_throughput": 417.712, "learn_time_ms": 11751.799, "learn_throughput": 340.373, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 10.843031153082848, "policy_loss": -0.02698100812267512, "vf_loss": 10.865360289812088, "vf_explained_var": 0.4335736036300659, "kl": 0.004594467747665476, "entropy": 0.13625382096506655, "entropy_coeff": 0.0}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 51, "training_iteration": 129, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-43-46", "timestamp": 1618141426, "time_this_iter_s": 20.841676473617554, "time_total_s": 2765.5529260635376, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695b990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2765.5529260635376, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 57.44666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1939.0, "episode_reward_min": 1939.0, "episode_reward_mean": 1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7107177188918355, "mean_raw_obs_processing_ms": 0.08792315410814057, "mean_inference_ms": 1.6106062795692402, "mean_action_processing_ms": 0.04829584334105303}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 520000, "timers": {"sample_time_ms": 9668.95, "sample_throughput": 413.695, "learn_time_ms": 11745.925, "learn_throughput": 340.544, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 9.83223332464695, "policy_loss": -0.024927991238655522, "vf_loss": 9.854125693440437, "vf_explained_var": 0.4059576392173767, "kl": 0.005996665851853322, "entropy": 0.12594447913579643, "entropy_coeff": 0.0}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 52, "training_iteration": 130, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-44-07", "timestamp": 1618141447, "time_this_iter_s": 20.869089603424072, "time_total_s": 2786.4220156669617, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8d910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2786.4220156669617, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 57.91, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1939.0, "episode_reward_min": 1939.0, "episode_reward_mean": 1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7107177188918355, "mean_raw_obs_processing_ms": 0.08792315410814057, "mean_inference_ms": 1.6106062795692402, "mean_action_processing_ms": 0.04829584334105303}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 524000, "timers": {"sample_time_ms": 9711.603, "sample_throughput": 411.878, "learn_time_ms": 11737.119, "learn_throughput": 340.799, "update_time_ms": 2.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 6.954120948910713, "policy_loss": -0.03222632862161845, "vf_loss": 6.982324376702309, "vf_explained_var": 0.26296645402908325, "kl": 0.007946425197587814, "entropy": 0.11371616926044226, "entropy_coeff": 0.0}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 52, "training_iteration": 131, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-44-31", "timestamp": 1618141471, "time_this_iter_s": 23.636081218719482, "time_total_s": 2810.058096885681, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2810.058096885681, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 57.95294117647058, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1939.0, "episode_reward_min": 1939.0, "episode_reward_mean": 1939.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1939.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7107177188918355, "mean_raw_obs_processing_ms": 0.08792315410814057, "mean_inference_ms": 1.6106062795692402, "mean_action_processing_ms": 0.04829584334105303}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 528000, "timers": {"sample_time_ms": 9725.661, "sample_throughput": 411.283, "learn_time_ms": 11731.871, "learn_throughput": 340.952, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": 11.726152211427689, "policy_loss": -0.054436602571513504, "vf_loss": 11.766427248716354, "vf_explained_var": 0.5373175144195557, "kl": 0.02797355060465634, "entropy": 0.18628271156921983, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 52, "training_iteration": 132, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-44-52", "timestamp": 1618141492, "time_this_iter_s": 21.43019461631775, "time_total_s": 2831.488291501999, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2831.488291501999, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 57.89333333333334, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2010.0, "episode_reward_min": 2010.0, "episode_reward_mean": 2010.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2010.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7115935182931996, "mean_raw_obs_processing_ms": 0.0882744698372273, "mean_inference_ms": 1.6105040666108523, "mean_action_processing_ms": 0.048302188585547225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 532000, "timers": {"sample_time_ms": 9606.582, "sample_throughput": 416.381, "learn_time_ms": 11730.574, "learn_throughput": 340.989, "update_time_ms": 2.971}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 11.538150608539581, "policy_loss": -0.03966276359278709, "vf_loss": 11.571750223636627, "vf_explained_var": 0.6326658129692078, "kl": 0.007984279000083916, "entropy": 0.15836636489257216, "entropy_coeff": 0.0}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 53, "training_iteration": 133, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-45-13", "timestamp": 1618141513, "time_this_iter_s": 20.371328353881836, "time_total_s": 2851.8596198558807, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b698cf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac73f410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2851.8596198558807, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 58.20689655172413, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2010.0, "episode_reward_min": 2010.0, "episode_reward_mean": 2010.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2010.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7115935182931996, "mean_raw_obs_processing_ms": 0.0882744698372273, "mean_inference_ms": 1.6105040666108523, "mean_action_processing_ms": 0.048302188585547225}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 536000, "timers": {"sample_time_ms": 9448.644, "sample_throughput": 423.341, "learn_time_ms": 11732.51, "learn_throughput": 340.933, "update_time_ms": 2.967}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 14.968213945627213, "policy_loss": -0.03438011364778504, "vf_loss": 14.996706664562225, "vf_explained_var": 0.4191829562187195, "kl": 0.007752968114800751, "entropy": 0.14429428102448583, "entropy_coeff": 0.0}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 53, "training_iteration": 134, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-45-33", "timestamp": 1618141533, "time_this_iter_s": 20.763296842575073, "time_total_s": 2872.622916698456, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2872.622916698456, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 57.27666666666667, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1721.0, "episode_reward_min": 1721.0, "episode_reward_mean": 1721.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1721.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7070666835693875, "mean_raw_obs_processing_ms": 0.0884419481169662, "mean_inference_ms": 1.6097417929673896, "mean_action_processing_ms": 0.04827605287920912}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 540000, "timers": {"sample_time_ms": 9138.087, "sample_throughput": 437.728, "learn_time_ms": 11757.869, "learn_throughput": 340.198, "update_time_ms": 2.921}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 11.446993470191956, "policy_loss": -0.02796275750733912, "vf_loss": 11.46988108754158, "vf_explained_var": 0.4163578450679779, "kl": 0.006683019048068672, "entropy": 0.1638787891715765, "entropy_coeff": 0.0}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 54, "training_iteration": 135, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-45-53", "timestamp": 1618141553, "time_this_iter_s": 19.80841088294983, "time_total_s": 2892.4313275814056, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f72ab224e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2892.4313275814056, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 58.20357142857142, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1721.0, "episode_reward_min": 1721.0, "episode_reward_mean": 1721.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1721.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7070666835693875, "mean_raw_obs_processing_ms": 0.0884419481169662, "mean_inference_ms": 1.6097417929673896, "mean_action_processing_ms": 0.04827605287920912}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 544000, "timers": {"sample_time_ms": 9002.62, "sample_throughput": 444.315, "learn_time_ms": 11781.05, "learn_throughput": 339.528, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 9.995277464389801, "policy_loss": -0.03933662467170507, "vf_loss": 10.028383821249008, "vf_explained_var": 0.6872848868370056, "kl": 0.0082043640431948, "entropy": 0.16931285988539457, "entropy_coeff": 0.0}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 54, "training_iteration": 136, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-46-13", "timestamp": 1618141573, "time_this_iter_s": 19.496729612350464, "time_total_s": 2911.928057193756, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695bf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2911.928057193756, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 58.02142857142856, "ram_util_percent": 27.25714285714285}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1721.0, "episode_reward_min": 1721.0, "episode_reward_mean": 1721.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1721.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.7070666835693875, "mean_raw_obs_processing_ms": 0.0884419481169662, "mean_inference_ms": 1.6097417929673896, "mean_action_processing_ms": 0.04827605287920912}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 548000, "timers": {"sample_time_ms": 9031.051, "sample_throughput": 442.916, "learn_time_ms": 11766.044, "learn_throughput": 339.961, "update_time_ms": 3.027}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 17.438542276620865, "policy_loss": -0.04102523025358096, "vf_loss": 17.47331964969635, "vf_explained_var": 0.5868011116981506, "kl": 0.008227866390370764, "entropy": 0.2118825730867684, "entropy_coeff": 0.0}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 54, "training_iteration": 137, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-46-32", "timestamp": 1618141592, "time_this_iter_s": 19.613552808761597, "time_total_s": 2931.5416100025177, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695be10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2931.5416100025177, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 57.37499999999999, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1285.0, "episode_reward_min": 1285.0, "episode_reward_mean": 1285.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1285.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6962041763758479, "mean_raw_obs_processing_ms": 0.08875554183785286, "mean_inference_ms": 1.6095272787037522, "mean_action_processing_ms": 0.04826700754506743}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 552000, "timers": {"sample_time_ms": 8900.899, "sample_throughput": 449.393, "learn_time_ms": 11740.921, "learn_throughput": 340.689, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 12.405836373567581, "policy_loss": -0.03120761291938834, "vf_loss": 12.432030200958252, "vf_explained_var": 0.6597483158111572, "kl": 0.006602844121516682, "entropy": 0.22501675644889474, "entropy_coeff": 0.0}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 55, "training_iteration": 138, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-46-52", "timestamp": 1618141612, "time_this_iter_s": 19.67309284210205, "time_total_s": 2951.2147028446198, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695bad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2951.2147028446198, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 58.35714285714285, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1285.0, "episode_reward_min": 1285.0, "episode_reward_mean": 1285.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1285.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6962041763758479, "mean_raw_obs_processing_ms": 0.08875554183785286, "mean_inference_ms": 1.6095272787037522, "mean_action_processing_ms": 0.04826700754506743}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 556000, "timers": {"sample_time_ms": 8790.638, "sample_throughput": 455.03, "learn_time_ms": 11748.804, "learn_throughput": 340.46, "update_time_ms": 2.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 15.550205558538437, "policy_loss": -0.03414005000377074, "vf_loss": 15.576149940490723, "vf_explained_var": 0.47434961795806885, "kl": 0.010792789966217242, "entropy": 0.21279655722901225, "entropy_coeff": 0.0}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 55, "training_iteration": 139, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-47-12", "timestamp": 1618141632, "time_this_iter_s": 19.821086168289185, "time_total_s": 2971.035789012909, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2971.035789012909, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 58.86551724137931, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6890336896620646, "mean_raw_obs_processing_ms": 0.08891202214613551, "mean_inference_ms": 1.608569543349032, "mean_action_processing_ms": 0.048233798015453154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 560000, "timers": {"sample_time_ms": 8622.903, "sample_throughput": 463.881, "learn_time_ms": 11740.343, "learn_throughput": 340.706, "update_time_ms": 3.024}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 12.733920395374298, "policy_loss": -0.03308251063572243, "vf_loss": 12.761006981134415, "vf_explained_var": 0.7418147325515747, "kl": 0.00789583008736372, "entropy": 0.18551746383309364, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 56, "training_iteration": 140, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-47-31", "timestamp": 1618141651, "time_this_iter_s": 19.10860276222229, "time_total_s": 2990.144391775131, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2990.144391775131, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 57.36666666666667, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6890336896620646, "mean_raw_obs_processing_ms": 0.08891202214613551, "mean_inference_ms": 1.608569543349032, "mean_action_processing_ms": 0.048233798015453154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 564000, "timers": {"sample_time_ms": 8287.554, "sample_throughput": 482.651, "learn_time_ms": 11733.688, "learn_throughput": 340.899, "update_time_ms": 3.062}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 21.641282588243484, "policy_loss": -0.03200656169792637, "vf_loss": 21.668561398983, "vf_explained_var": 0.42773884534835815, "kl": 0.00622599041525973, "entropy": 0.1817567623220384, "entropy_coeff": 0.0}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 56, "training_iteration": 141, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-47-51", "timestamp": 1618141671, "time_this_iter_s": 20.216999053955078, "time_total_s": 3010.3613908290863, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7232690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3010.3613908290863, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 58.33103448275862, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6890336896620646, "mean_raw_obs_processing_ms": 0.08891202214613551, "mean_inference_ms": 1.608569543349032, "mean_action_processing_ms": 0.048233798015453154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 568000, "timers": {"sample_time_ms": 8120.615, "sample_throughput": 492.574, "learn_time_ms": 11722.837, "learn_throughput": 341.214, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 10.762563467025757, "policy_loss": -0.04863589257001877, "vf_loss": 10.804764926433563, "vf_explained_var": 0.4817376434803009, "kl": 0.008473552501527593, "entropy": 0.3351936135441065, "entropy_coeff": 0.0}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 56, "training_iteration": 142, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-48-11", "timestamp": 1618141691, "time_this_iter_s": 19.653442859649658, "time_total_s": 3030.014833688736, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d5b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8dfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3030.014833688736, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 58.14999999999999, "ram_util_percent": 27.25}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 814.0, "episode_reward_min": 814.0, "episode_reward_mean": 814.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [814.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6786487413206591, "mean_raw_obs_processing_ms": 0.08927855605787131, "mean_inference_ms": 1.6090262045622514, "mean_action_processing_ms": 0.04824822125413727}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 572000, "timers": {"sample_time_ms": 7989.127, "sample_throughput": 500.68, "learn_time_ms": 11764.905, "learn_throughput": 339.994, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 12.868392556905746, "policy_loss": -0.0313466630759649, "vf_loss": 12.894502848386765, "vf_explained_var": 0.47763246297836304, "kl": 0.006895461949170567, "entropy": 0.2746573551557958, "entropy_coeff": 0.0}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 57, "training_iteration": 143, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-48-30", "timestamp": 1618141710, "time_this_iter_s": 19.47903537750244, "time_total_s": 3049.4938690662384, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b698cb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac73f190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3049.4938690662384, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 58.339285714285715, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 814.0, "episode_reward_min": 814.0, "episode_reward_mean": 814.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [814.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6786487413206591, "mean_raw_obs_processing_ms": 0.08927855605787131, "mean_inference_ms": 1.6090262045622514, "mean_action_processing_ms": 0.04824822125413727}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 576000, "timers": {"sample_time_ms": 7867.22, "sample_throughput": 508.439, "learn_time_ms": 11748.847, "learn_throughput": 340.459, "update_time_ms": 3.046}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 7.068734303116798, "policy_loss": -0.026960737246554345, "vf_loss": 7.090033456683159, "vf_explained_var": 0.613717794418335, "kl": 0.007455695202224888, "entropy": 0.301713059656322, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 57, "training_iteration": 144, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-48-50", "timestamp": 1618141730, "time_this_iter_s": 19.38607668876648, "time_total_s": 3068.879945755005, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b9628510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b698c750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3068.879945755005, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 57.65555555555555, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 721.0, "episode_reward_min": 721.0, "episode_reward_mean": 721.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [721.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.67184924013041, "mean_raw_obs_processing_ms": 0.08947954823048894, "mean_inference_ms": 1.6086307747255142, "mean_action_processing_ms": 0.04823593504832724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 580000, "timers": {"sample_time_ms": 7834.315, "sample_throughput": 510.574, "learn_time_ms": 11777.677, "learn_throughput": 339.626, "update_time_ms": 3.088}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 14.439225494861603, "policy_loss": -0.03203866980038583, "vf_loss": 14.466487765312195, "vf_explained_var": 0.592033863067627, "kl": 0.006290045290370472, "entropy": 0.22969583934172988, "entropy_coeff": 0.0}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 58, "training_iteration": 145, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-49-10", "timestamp": 1618141750, "time_this_iter_s": 19.770758867263794, "time_total_s": 3088.6507046222687, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a047d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3088.6507046222687, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 58.02068965517242, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 721.0, "episode_reward_min": 721.0, "episode_reward_mean": 721.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [721.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.67184924013041, "mean_raw_obs_processing_ms": 0.08947954823048894, "mean_inference_ms": 1.6086307747255142, "mean_action_processing_ms": 0.04823593504832724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 584000, "timers": {"sample_time_ms": 7878.164, "sample_throughput": 507.733, "learn_time_ms": 11757.842, "learn_throughput": 340.198, "update_time_ms": 3.081}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 8.190497696399689, "policy_loss": -0.03394461519201286, "vf_loss": 8.219005391001701, "vf_explained_var": 0.7181830406188965, "kl": 0.007159675835282542, "entropy": 0.26285728020593524, "entropy_coeff": 0.0}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 58, "training_iteration": 146, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-49-29", "timestamp": 1618141769, "time_this_iter_s": 19.73679804801941, "time_total_s": 3108.387502670288, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3108.387502670288, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 57.73214285714285, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 721.0, "episode_reward_min": 721.0, "episode_reward_mean": 721.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [721.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.67184924013041, "mean_raw_obs_processing_ms": 0.08947954823048894, "mean_inference_ms": 1.6086307747255142, "mean_action_processing_ms": 0.04823593504832724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 588000, "timers": {"sample_time_ms": 8056.354, "sample_throughput": 496.502, "learn_time_ms": 11779.827, "learn_throughput": 339.564, "update_time_ms": 2.954}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 16.568573087453842, "policy_loss": -0.019406084436923265, "vf_loss": 16.583866268396378, "vf_explained_var": 0.4480273425579071, "kl": 0.005415808358520735, "entropy": 0.12068996974267066, "entropy_coeff": 0.0}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 58, "training_iteration": 147, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-49-51", "timestamp": 1618141791, "time_this_iter_s": 21.615386724472046, "time_total_s": 3130.00288939476, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3130.00288939476, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 58.02580645161291, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1446.0, "episode_reward_min": 1446.0, "episode_reward_mean": 1446.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1446.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6692968477129753, "mean_raw_obs_processing_ms": 0.08970960198651196, "mean_inference_ms": 1.6071746087642578, "mean_action_processing_ms": 0.048178811702944684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 592000, "timers": {"sample_time_ms": 8159.126, "sample_throughput": 490.249, "learn_time_ms": 11816.189, "learn_throughput": 338.519, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 7.855911776423454, "policy_loss": -0.019815327948890626, "vf_loss": 7.871981084346771, "vf_explained_var": 0.2576100826263428, "kl": 0.004932816904329229, "entropy": 0.10260193585418165, "entropy_coeff": 0.0}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 59, "training_iteration": 148, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-50-12", "timestamp": 1618141812, "time_this_iter_s": 21.06568741798401, "time_total_s": 3151.068576812744, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695bf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3151.068576812744, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 57.61333333333334, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1446.0, "episode_reward_min": 1446.0, "episode_reward_mean": 1446.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1446.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6692968477129753, "mean_raw_obs_processing_ms": 0.08970960198651196, "mean_inference_ms": 1.6071746087642578, "mean_action_processing_ms": 0.048178811702944684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 596000, "timers": {"sample_time_ms": 8192.535, "sample_throughput": 488.249, "learn_time_ms": 11786.154, "learn_throughput": 339.381, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 10.647295892238617, "policy_loss": -0.02671524786273949, "vf_loss": 10.670920252799988, "vf_explained_var": 0.4084358811378479, "kl": 0.008140673831803724, "entropy": 0.12935293768532574, "entropy_coeff": 0.0}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 59, "training_iteration": 149, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-50-32", "timestamp": 1618141832, "time_this_iter_s": 19.855283975601196, "time_total_s": 3170.9238607883453, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d5c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3170.9238607883453, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 57.48571428571429, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1766.0, "episode_reward_min": 1766.0, "episode_reward_mean": 1766.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1766.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6638604420691698, "mean_raw_obs_processing_ms": 0.08989959714164739, "mean_inference_ms": 1.6068780951757344, "mean_action_processing_ms": 0.0481697229391489}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 600000, "timers": {"sample_time_ms": 8252.083, "sample_throughput": 484.726, "learn_time_ms": 11784.594, "learn_throughput": 339.426, "update_time_ms": 3.123}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 12.04993212223053, "policy_loss": -0.04353349166922271, "vf_loss": 12.08879867196083, "vf_explained_var": 0.5964897871017456, "kl": 0.012291241233469918, "entropy": 0.18001072574406862, "entropy_coeff": 0.0}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 60, "training_iteration": 150, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-50-52", "timestamp": 1618141852, "time_this_iter_s": 19.69182324409485, "time_total_s": 3190.61568403244, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69486d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3190.61568403244, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 58.017857142857146, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1766.0, "episode_reward_min": 1766.0, "episode_reward_mean": 1766.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1766.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6638604420691698, "mean_raw_obs_processing_ms": 0.08989959714164739, "mean_inference_ms": 1.6068780951757344, "mean_action_processing_ms": 0.0481697229391489}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 604000, "timers": {"sample_time_ms": 8229.847, "sample_throughput": 486.036, "learn_time_ms": 11785.478, "learn_throughput": 339.401, "update_time_ms": 3.203}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 12.03549113869667, "policy_loss": -0.034344572748523206, "vf_loss": 12.065193891525269, "vf_explained_var": 0.7217848300933838, "kl": 0.012225700629642233, "entropy": 0.18010129779577255, "entropy_coeff": 0.0}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 60, "training_iteration": 151, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-51-12", "timestamp": 1618141872, "time_this_iter_s": 20.00839900970459, "time_total_s": 3210.624083042145, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3210.624083042145, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 58.11379310344827, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1766.0, "episode_reward_min": 1766.0, "episode_reward_mean": 1766.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1766.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6638604420691698, "mean_raw_obs_processing_ms": 0.08989959714164739, "mean_inference_ms": 1.6068780951757344, "mean_action_processing_ms": 0.0481697229391489}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 608000, "timers": {"sample_time_ms": 8172.191, "sample_throughput": 489.465, "learn_time_ms": 11803.786, "learn_throughput": 338.874, "update_time_ms": 3.175}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 12.100143313407898, "policy_loss": -0.0648516429355368, "vf_loss": 12.15028464794159, "vf_explained_var": 0.7024766206741333, "kl": 0.038743153447285295, "entropy": 0.3000280521810055, "entropy_coeff": 0.0}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 60, "training_iteration": 152, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-51-31", "timestamp": 1618141891, "time_this_iter_s": 19.261943340301514, "time_total_s": 3229.8860263824463, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3229.8860263824463, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 57.51481481481481, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1326.0, "episode_reward_min": 1326.0, "episode_reward_mean": 1326.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1326.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6571189480059162, "mean_raw_obs_processing_ms": 0.09017658497460875, "mean_inference_ms": 1.6064472455884475, "mean_action_processing_ms": 0.04814330544827864}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 612000, "timers": {"sample_time_ms": 8343.491, "sample_throughput": 479.416, "learn_time_ms": 11777.705, "learn_throughput": 339.625, "update_time_ms": 3.182}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 13.052707493305206, "policy_loss": -0.021877955878153443, "vf_loss": 13.069760769605637, "vf_explained_var": 0.4825811982154846, "kl": 0.008471224136883393, "entropy": 0.13538432703353465, "entropy_coeff": 0.0}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 61, "training_iteration": 153, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-51-52", "timestamp": 1618141912, "time_this_iter_s": 20.92982792854309, "time_total_s": 3250.8158543109894, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3250.8158543109894, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 58.13, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1326.0, "episode_reward_min": 1326.0, "episode_reward_mean": 1326.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1326.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6571189480059162, "mean_raw_obs_processing_ms": 0.09017658497460875, "mean_inference_ms": 1.6064472455884475, "mean_action_processing_ms": 0.04814330544827864}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 616000, "timers": {"sample_time_ms": 8820.32, "sample_throughput": 453.498, "learn_time_ms": 11770.099, "learn_throughput": 339.844, "update_time_ms": 3.139}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.942297667264938, "policy_loss": -0.02475786753348075, "vf_loss": 9.962924599647522, "vf_explained_var": 0.2520224153995514, "kl": 0.007253039875649847, "entropy": 0.10361741064116359, "entropy_coeff": 0.0}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 61, "training_iteration": 154, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-52-16", "timestamp": 1618141936, "time_this_iter_s": 24.074937105178833, "time_total_s": 3274.890791416168, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b08d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3274.890791416168, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 58.08571428571429, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2182.0, "episode_reward_min": 2182.0, "episode_reward_mean": 2182.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2182.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6664628742787533, "mean_raw_obs_processing_ms": 0.09045188181527596, "mean_inference_ms": 1.6066149320789167, "mean_action_processing_ms": 0.04816269258953903}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 620000, "timers": {"sample_time_ms": 9339.19, "sample_throughput": 428.303, "learn_time_ms": 11742.318, "learn_throughput": 340.648, "update_time_ms": 3.091}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.783391311764717, "policy_loss": -0.028519381638034247, "vf_loss": 6.806888565421104, "vf_explained_var": 0.30135226249694824, "kl": 0.008817873560474254, "entropy": 0.10915985214523971, "entropy_coeff": 0.0}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 62, "training_iteration": 155, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-52-41", "timestamp": 1618141961, "time_this_iter_s": 24.67825961112976, "time_total_s": 3299.569051027298, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b698cf10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3299.569051027298, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 57.542857142857144, "ram_util_percent": 27.200000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2182.0, "episode_reward_min": 2182.0, "episode_reward_mean": 2182.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2182.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6664628742787533, "mean_raw_obs_processing_ms": 0.09045188181527596, "mean_inference_ms": 1.6066149320789167, "mean_action_processing_ms": 0.04816269258953903}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 624000, "timers": {"sample_time_ms": 9423.755, "sample_throughput": 424.459, "learn_time_ms": 11735.582, "learn_throughput": 340.844, "update_time_ms": 3.129}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 11.472150593996048, "policy_loss": -0.03561728389468044, "vf_loss": 11.499038949608803, "vf_explained_var": 0.39251843094825745, "kl": 0.015326491906307638, "entropy": 0.13499848148785532, "entropy_coeff": 0.0}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 62, "training_iteration": 156, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-53-01", "timestamp": 1618141981, "time_this_iter_s": 20.519561767578125, "time_total_s": 3320.088612794876, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b06d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3320.088612794876, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 58.1448275862069, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2182.0, "episode_reward_min": 2182.0, "episode_reward_mean": 2182.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2182.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6664628742787533, "mean_raw_obs_processing_ms": 0.09045188181527596, "mean_inference_ms": 1.6066149320789167, "mean_action_processing_ms": 0.04816269258953903}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 628000, "timers": {"sample_time_ms": 9670.773, "sample_throughput": 413.617, "learn_time_ms": 11716.526, "learn_throughput": 341.398, "update_time_ms": 3.148}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.078813508152962, "policy_loss": -0.01667638315120712, "vf_loss": 5.092052981257439, "vf_explained_var": 0.18583840131759644, "kl": 0.006034503763657995, "entropy": 0.10298108775168657, "entropy_coeff": 0.0}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 62, "training_iteration": 157, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-53-25", "timestamp": 1618142005, "time_this_iter_s": 23.89192223548889, "time_total_s": 3343.980535030365, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3343.980535030365, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 58.017647058823535, "ram_util_percent": 27.22058823529412}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2079.0, "episode_reward_min": 2079.0, "episode_reward_mean": 2079.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2079.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6713454131737722, "mean_raw_obs_processing_ms": 0.0906808065678237, "mean_inference_ms": 1.6053198352646956, "mean_action_processing_ms": 0.04810960391416424}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 632000, "timers": {"sample_time_ms": 9795.935, "sample_throughput": 408.333, "learn_time_ms": 11691.055, "learn_throughput": 342.142, "update_time_ms": 3.165}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.90789869427681, "policy_loss": -0.03382838115794584, "vf_loss": 5.935644790530205, "vf_explained_var": 0.25955259799957275, "kl": 0.010679444501874968, "entropy": 0.113654974848032, "entropy_coeff": 0.0}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 63, "training_iteration": 158, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-53-47", "timestamp": 1618142027, "time_this_iter_s": 22.05879521369934, "time_total_s": 3366.0393302440643, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69124d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3366.0393302440643, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 57.556250000000006, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2079.0, "episode_reward_min": 2079.0, "episode_reward_mean": 2079.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2079.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6713454131737722, "mean_raw_obs_processing_ms": 0.0906808065678237, "mean_inference_ms": 1.6053198352646956, "mean_action_processing_ms": 0.04810960391416424}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 636000, "timers": {"sample_time_ms": 9804.588, "sample_throughput": 407.972, "learn_time_ms": 11692.288, "learn_throughput": 342.106, "update_time_ms": 3.19}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.397965788841248, "policy_loss": -0.03692047990625724, "vf_loss": 7.430117830634117, "vf_explained_var": 0.3167726993560791, "kl": 0.008372559765120968, "entropy": 0.1234022353310138, "entropy_coeff": 0.0}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 63, "training_iteration": 159, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-54-07", "timestamp": 1618142047, "time_this_iter_s": 19.9542498588562, "time_total_s": 3385.9935801029205, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3385.9935801029205, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 57.44642857142858, "ram_util_percent": 27.23571428571429}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2012.0, "episode_reward_min": 2012.0, "episode_reward_mean": 2012.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2012.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.671023130984976, "mean_raw_obs_processing_ms": 0.09083966239945614, "mean_inference_ms": 1.6047372245208322, "mean_action_processing_ms": 0.0480798022220631}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 640000, "timers": {"sample_time_ms": 10079.884, "sample_throughput": 396.83, "learn_time_ms": 11696.919, "learn_throughput": 341.97, "update_time_ms": 2.99}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.054686918854713, "policy_loss": -0.026221129432087764, "vf_loss": 7.075465738773346, "vf_explained_var": 0.3212624192237854, "kl": 0.00955579912988469, "entropy": 0.10357629228383303, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 64, "training_iteration": 160, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-54-30", "timestamp": 1618142070, "time_this_iter_s": 22.4874529838562, "time_total_s": 3408.4810330867767, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3408.4810330867767, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 58.303125, "ram_util_percent": 27.2}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2012.0, "episode_reward_min": 2012.0, "episode_reward_mean": 2012.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2012.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.671023130984976, "mean_raw_obs_processing_ms": 0.09083966239945614, "mean_inference_ms": 1.6047372245208322, "mean_action_processing_ms": 0.0480798022220631}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 644000, "timers": {"sample_time_ms": 10183.188, "sample_throughput": 392.804, "learn_time_ms": 11694.878, "learn_throughput": 342.03, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.85309088230133, "policy_loss": -0.02595328088500537, "vf_loss": 10.875060617923737, "vf_explained_var": 0.5034462809562683, "kl": 0.006994662020588294, "entropy": 0.14604012528434396, "entropy_coeff": 0.0}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 64, "training_iteration": 161, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-54-51", "timestamp": 1618142091, "time_this_iter_s": 21.016740798950195, "time_total_s": 3429.497773885727, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697e390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3429.497773885727, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 57.851612903225806, "ram_util_percent": 27.20000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2012.0, "episode_reward_min": 2012.0, "episode_reward_mean": 2012.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2012.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.671023130984976, "mean_raw_obs_processing_ms": 0.09083966239945614, "mean_inference_ms": 1.6047372245208322, "mean_action_processing_ms": 0.0480798022220631}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 648000, "timers": {"sample_time_ms": 10361.034, "sample_throughput": 386.062, "learn_time_ms": 11712.62, "learn_throughput": 341.512, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 11.540419220924377, "policy_loss": -0.035949840501416475, "vf_loss": 11.571014657616615, "vf_explained_var": 0.34954121708869934, "kl": 0.009401481744134799, "entropy": 0.12333503551781178, "entropy_coeff": 0.0}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 64, "training_iteration": 162, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-55-12", "timestamp": 1618142112, "time_this_iter_s": 21.217766761779785, "time_total_s": 3450.7155406475067, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695b310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3450.7155406475067, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 58.083333333333336, "ram_util_percent": 27.200000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1820.0, "episode_reward_min": 1820.0, "episode_reward_mean": 1820.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1820.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.668187964699951, "mean_raw_obs_processing_ms": 0.09113036700243494, "mean_inference_ms": 1.6041074968867175, "mean_action_processing_ms": 0.04805779911659281}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 652000, "timers": {"sample_time_ms": 10302.554, "sample_throughput": 388.253, "learn_time_ms": 11747.211, "learn_throughput": 340.506, "update_time_ms": 2.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 16.078095108270645, "policy_loss": -0.04360347957117483, "vf_loss": 16.1160030066967, "vf_explained_var": 0.579554557800293, "kl": 0.010000182810472324, "entropy": 0.19424225017428398, "entropy_coeff": 0.0}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 65, "training_iteration": 163, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-55-33", "timestamp": 1618142133, "time_this_iter_s": 20.693164587020874, "time_total_s": 3471.4087052345276, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6959790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3471.4087052345276, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 57.72068965517241, "ram_util_percent": 27.262068965517233}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1820.0, "episode_reward_min": 1820.0, "episode_reward_mean": 1820.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1820.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.668187964699951, "mean_raw_obs_processing_ms": 0.09113036700243494, "mean_inference_ms": 1.6041074968867175, "mean_action_processing_ms": 0.04805779911659281}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 656000, "timers": {"sample_time_ms": 9846.527, "sample_throughput": 406.235, "learn_time_ms": 11764.775, "learn_throughput": 339.998, "update_time_ms": 3.007}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 11.675623998045921, "policy_loss": -0.02711638866458088, "vf_loss": 11.69802576303482, "vf_explained_var": 0.7033085823059082, "kl": 0.008278282650280744, "entropy": 0.20168845169246197, "entropy_coeff": 0.0}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 65, "training_iteration": 164, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-55-53", "timestamp": 1618142153, "time_this_iter_s": 19.692492961883545, "time_total_s": 3491.101198196411, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a041d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3491.101198196411, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 58.37931034482759, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1505.0, "episode_reward_min": 1505.0, "episode_reward_mean": 1505.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1505.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6647914101364862, "mean_raw_obs_processing_ms": 0.09129585680724006, "mean_inference_ms": 1.6036560260090378, "mean_action_processing_ms": 0.0480419706205059}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 660000, "timers": {"sample_time_ms": 9457.152, "sample_throughput": 422.96, "learn_time_ms": 11766.002, "learn_throughput": 339.963, "update_time_ms": 3.014}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.376694425940514, "policy_loss": -0.022729816555511206, "vf_loss": 9.395529508590698, "vf_explained_var": 0.44344407320022583, "kl": 0.006838717381469905, "entropy": 0.11766994162462652, "entropy_coeff": 0.0}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 66, "training_iteration": 165, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-56-13", "timestamp": 1618142173, "time_this_iter_s": 20.799772262573242, "time_total_s": 3511.9009704589844, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6988b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697e790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3511.9009704589844, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 58.15517241379311, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1505.0, "episode_reward_min": 1505.0, "episode_reward_mean": 1505.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1505.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6647914101364862, "mean_raw_obs_processing_ms": 0.09129585680724006, "mean_inference_ms": 1.6036560260090378, "mean_action_processing_ms": 0.0480419706205059}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 664000, "timers": {"sample_time_ms": 9701.545, "sample_throughput": 412.305, "learn_time_ms": 11800.661, "learn_throughput": 338.964, "update_time_ms": 3.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.393073961138725, "policy_loss": -0.025194775720592588, "vf_loss": 6.413638934493065, "vf_explained_var": 0.4053467810153961, "kl": 0.0081290953385178, "entropy": 0.11437074560672045, "entropy_coeff": 0.0}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 66, "training_iteration": 166, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-56-37", "timestamp": 1618142197, "time_this_iter_s": 23.307126760482788, "time_total_s": 3535.208097219467, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3535.208097219467, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 57.6264705882353, "ram_util_percent": 27.299999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1505.0, "episode_reward_min": 1505.0, "episode_reward_mean": 1505.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1505.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6647914101364862, "mean_raw_obs_processing_ms": 0.09129585680724006, "mean_inference_ms": 1.6036560260090378, "mean_action_processing_ms": 0.0480419706205059}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 668000, "timers": {"sample_time_ms": 9306.463, "sample_throughput": 429.809, "learn_time_ms": 11776.572, "learn_throughput": 339.657, "update_time_ms": 3.016}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 18.206864804029465, "policy_loss": -0.050385541922878474, "vf_loss": 18.238658040761948, "vf_explained_var": 0.5072982311248779, "kl": 0.032644699211232364, "entropy": 0.15898722503334284, "entropy_coeff": 0.0}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 66, "training_iteration": 167, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-56-57", "timestamp": 1618142217, "time_this_iter_s": 19.70009994506836, "time_total_s": 3554.9081971645355, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b698c3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b698c590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3554.9081971645355, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 58.324999999999996, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1855.0, "episode_reward_min": 1855.0, "episode_reward_mean": 1855.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1855.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6623712699376164, "mean_raw_obs_processing_ms": 0.09160600346347166, "mean_inference_ms": 1.6033777761126486, "mean_action_processing_ms": 0.04802828940421117}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 672000, "timers": {"sample_time_ms": 9053.719, "sample_throughput": 441.807, "learn_time_ms": 11804.83, "learn_throughput": 338.844, "update_time_ms": 2.987}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.432471126317978, "policy_loss": -0.029335406550671905, "vf_loss": 13.454405605793, "vf_explained_var": 0.509820818901062, "kl": 0.00866312459402252, "entropy": 0.15597169706597924, "entropy_coeff": 0.0}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 67, "training_iteration": 168, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-57-16", "timestamp": 1618142236, "time_this_iter_s": 19.816473722457886, "time_total_s": 3574.7246708869934, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6959490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69590d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3574.7246708869934, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 58.85357142857142, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1855.0, "episode_reward_min": 1855.0, "episode_reward_mean": 1855.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1855.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6623712699376164, "mean_raw_obs_processing_ms": 0.09160600346347166, "mean_inference_ms": 1.6033777761126486, "mean_action_processing_ms": 0.04802828940421117}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 676000, "timers": {"sample_time_ms": 8989.42, "sample_throughput": 444.968, "learn_time_ms": 11786.057, "learn_throughput": 339.384, "update_time_ms": 2.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.781494975090027, "policy_loss": -0.03344914491754025, "vf_loss": 12.80920547246933, "vf_explained_var": 0.44620126485824585, "kl": 0.0067172835260862485, "entropy": 0.1658759107813239, "entropy_coeff": 0.0}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 67, "training_iteration": 169, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-57-36", "timestamp": 1618142256, "time_this_iter_s": 19.12396216392517, "time_total_s": 3593.8486330509186, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6959450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3593.8486330509186, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 57.36296296296297, "ram_util_percent": 27.299999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1633.0, "episode_reward_min": 1633.0, "episode_reward_mean": 1633.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1633.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6587257571444518, "mean_raw_obs_processing_ms": 0.09176847517319199, "mean_inference_ms": 1.602638154187055, "mean_action_processing_ms": 0.047997065391861916}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 680000, "timers": {"sample_time_ms": 8806.338, "sample_throughput": 454.218, "learn_time_ms": 11784.37, "learn_throughput": 339.433, "update_time_ms": 2.988}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 10.575561374425888, "policy_loss": -0.02559948357520625, "vf_loss": 10.597081035375595, "vf_explained_var": 0.5134598016738892, "kl": 0.004775797016918659, "entropy": 0.12756324280053377, "entropy_coeff": 0.0}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 68, "training_iteration": 170, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-57-56", "timestamp": 1618142276, "time_this_iter_s": 20.63863205909729, "time_total_s": 3614.487265110016, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3614.487265110016, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 58.08000000000001, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1633.0, "episode_reward_min": 1633.0, "episode_reward_mean": 1633.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1633.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6587257571444518, "mean_raw_obs_processing_ms": 0.09176847517319199, "mean_inference_ms": 1.602638154187055, "mean_action_processing_ms": 0.047997065391861916}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 684000, "timers": {"sample_time_ms": 8876.559, "sample_throughput": 450.625, "learn_time_ms": 11771.605, "learn_throughput": 339.801, "update_time_ms": 2.998}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 10.611808329820633, "policy_loss": -0.02963392887613736, "vf_loss": 10.637224212288857, "vf_explained_var": 0.4859573245048523, "kl": 0.009874692470475566, "entropy": 0.12776939454488456, "entropy_coeff": 0.0}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 68, "training_iteration": 171, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-58-18", "timestamp": 1618142298, "time_this_iter_s": 21.58963441848755, "time_total_s": 3636.0768995285034, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6988a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3636.0768995285034, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 57.83548387096773, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1633.0, "episode_reward_min": 1633.0, "episode_reward_mean": 1633.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1633.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6587257571444518, "mean_raw_obs_processing_ms": 0.09176847517319199, "mean_inference_ms": 1.602638154187055, "mean_action_processing_ms": 0.047997065391861916}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 688000, "timers": {"sample_time_ms": 8809.165, "sample_throughput": 454.073, "learn_time_ms": 11753.406, "learn_throughput": 340.327, "update_time_ms": 2.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 10.723122328519821, "policy_loss": -0.024376289453357458, "vf_loss": 10.74357858300209, "vf_explained_var": 0.3990880250930786, "kl": 0.009177387051749974, "entropy": 0.136880939360708, "entropy_coeff": 0.0}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 68, "training_iteration": 172, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-58-38", "timestamp": 1618142318, "time_this_iter_s": 20.362746000289917, "time_total_s": 3656.4396455287933, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695fe10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3656.4396455287933, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 58.241379310344826, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1941.0, "episode_reward_min": 1941.0, "episode_reward_mean": 1941.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1941.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6556719575701717, "mean_raw_obs_processing_ms": 0.09201924926397248, "mean_inference_ms": 1.6018349023283776, "mean_action_processing_ms": 0.047959130569974404}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 692000, "timers": {"sample_time_ms": 8745.849, "sample_throughput": 457.36, "learn_time_ms": 11701.913, "learn_throughput": 341.824, "update_time_ms": 2.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 11.612704873085022, "policy_loss": -0.026024037739261985, "vf_loss": 11.634900152683258, "vf_explained_var": 0.3325202465057373, "kl": 0.008963926491560414, "entropy": 0.11080425186082721, "entropy_coeff": 0.0}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 69, "training_iteration": 173, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-58-58", "timestamp": 1618142338, "time_this_iter_s": 19.543787479400635, "time_total_s": 3675.983433008194, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69d5410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b9628490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3675.983433008194, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 58.23214285714287, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1941.0, "episode_reward_min": 1941.0, "episode_reward_mean": 1941.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1941.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6556719575701717, "mean_raw_obs_processing_ms": 0.09201924926397248, "mean_inference_ms": 1.6018349023283776, "mean_action_processing_ms": 0.047959130569974404}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 696000, "timers": {"sample_time_ms": 8780.428, "sample_throughput": 455.559, "learn_time_ms": 11700.828, "learn_throughput": 341.856, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 11.471440464258194, "policy_loss": -0.06529168505221605, "vf_loss": 11.52133658528328, "vf_explained_var": 0.5611752271652222, "kl": 0.03604222656576894, "entropy": 0.1580143803730607, "entropy_coeff": 0.0}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 69, "training_iteration": 174, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-59-18", "timestamp": 1618142358, "time_this_iter_s": 20.0261869430542, "time_total_s": 3696.009619951248, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a042d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3696.009619951248, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 57.614285714285714, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1946.0, "episode_reward_min": 1946.0, "episode_reward_mean": 1946.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1946.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6566225814564841, "mean_raw_obs_processing_ms": 0.092197376420217, "mean_inference_ms": 1.6014390261097933, "mean_action_processing_ms": 0.04794006106676719}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 700000, "timers": {"sample_time_ms": 9029.101, "sample_throughput": 443.012, "learn_time_ms": 11705.327, "learn_throughput": 341.725, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.694086402654648, "policy_loss": -0.07804573199246079, "vf_loss": 7.744768887758255, "vf_explained_var": 0.6770312190055847, "kl": 0.04270693572470918, "entropy": 0.1567647187039256, "entropy_coeff": 0.0}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 70, "training_iteration": 175, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_11-59-41", "timestamp": 1618142381, "time_this_iter_s": 23.331565141677856, "time_total_s": 3719.341185092926, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697e350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3719.341185092926, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 58.04411764705882, "ram_util_percent": 27.299999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1946.0, "episode_reward_min": 1946.0, "episode_reward_mean": 1946.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1946.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6566225814564841, "mean_raw_obs_processing_ms": 0.092197376420217, "mean_inference_ms": 1.6014390261097933, "mean_action_processing_ms": 0.04794006106676719}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 704000, "timers": {"sample_time_ms": 8728.163, "sample_throughput": 458.287, "learn_time_ms": 11704.866, "learn_throughput": 341.738, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 9.921877607703209, "policy_loss": -0.058825393265578896, "vf_loss": 9.956867784261703, "vf_explained_var": 0.5139058828353882, "kl": 0.024800269136903808, "entropy": 0.15264182211831212, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 70, "training_iteration": 176, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-00-01", "timestamp": 1618142401, "time_this_iter_s": 20.291853427886963, "time_total_s": 3739.633038520813, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695f950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3739.633038520813, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 57.603571428571435, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1946.0, "episode_reward_min": 1946.0, "episode_reward_mean": 1946.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1946.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6566225814564841, "mean_raw_obs_processing_ms": 0.092197376420217, "mean_inference_ms": 1.6014390261097933, "mean_action_processing_ms": 0.04794006106676719}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 708000, "timers": {"sample_time_ms": 8712.337, "sample_throughput": 459.119, "learn_time_ms": 11740.003, "learn_throughput": 340.715, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4416259765625001, "cur_lr": 5e-05, "total_loss": 11.487643003463745, "policy_loss": -0.020952361985109746, "vf_loss": 11.503065258264542, "vf_explained_var": 0.40046414732933044, "kl": 0.0038360064063454047, "entropy": 0.11197659350000322, "entropy_coeff": 0.0}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 70, "training_iteration": 177, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-00-21", "timestamp": 1618142421, "time_this_iter_s": 19.892608880996704, "time_total_s": 3759.5256474018097, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6988490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6988ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3759.5256474018097, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 58.203448275862065, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1638.0, "episode_reward_min": 1638.0, "episode_reward_mean": 1638.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6523790201190035, "mean_raw_obs_processing_ms": 0.09245082141078924, "mean_inference_ms": 1.6006392513206789, "mean_action_processing_ms": 0.047915215247474705}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 712000, "timers": {"sample_time_ms": 8836.068, "sample_throughput": 452.69, "learn_time_ms": 11723.125, "learn_throughput": 341.206, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 23.32311499118805, "policy_loss": -0.03318715438945219, "vf_loss": 23.338054656982422, "vf_explained_var": 0.5870952606201172, "kl": 0.02531551697757095, "entropy": 0.12939568352885544, "entropy_coeff": 0.0}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 71, "training_iteration": 178, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-00-42", "timestamp": 1618142442, "time_this_iter_s": 20.884584188461304, "time_total_s": 3780.410231590271, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f4e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3780.410231590271, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 58.21666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1638.0, "episode_reward_min": 1638.0, "episode_reward_mean": 1638.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6523790201190035, "mean_raw_obs_processing_ms": 0.09245082141078924, "mean_inference_ms": 1.6006392513206789, "mean_action_processing_ms": 0.047915215247474705}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 716000, "timers": {"sample_time_ms": 8904.33, "sample_throughput": 449.22, "learn_time_ms": 11740.424, "learn_throughput": 340.703, "update_time_ms": 2.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 5.12345714867115, "policy_loss": -0.017973555077333003, "vf_loss": 5.13750921189785, "vf_explained_var": 0.2527626156806946, "kl": 0.0036269151351007167, "entropy": 0.09604772250168025, "entropy_coeff": 0.0}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 71, "training_iteration": 179, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-01-02", "timestamp": 1618142462, "time_this_iter_s": 19.978283882141113, "time_total_s": 3800.388515472412, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac73f190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3800.388515472412, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 58.39642857142859, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1884.0, "episode_reward_min": 1884.0, "episode_reward_mean": 1884.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1884.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6501871469674668, "mean_raw_obs_processing_ms": 0.0926589510044095, "mean_inference_ms": 1.6004476071186196, "mean_action_processing_ms": 0.0479034126064926}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 720000, "timers": {"sample_time_ms": 8958.455, "sample_throughput": 446.506, "learn_time_ms": 11743.992, "learn_throughput": 340.6, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5406097412109375, "cur_lr": 5e-05, "total_loss": 9.03887477517128, "policy_loss": -0.028374343586619943, "vf_loss": 9.06253182888031, "vf_explained_var": 0.5117799043655396, "kl": 0.008725943342142273, "entropy": 0.10709605016745627, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 72, "training_iteration": 180, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-01-24", "timestamp": 1618142484, "time_this_iter_s": 21.221703052520752, "time_total_s": 3821.610218524933, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3821.610218524933, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 57.88387096774194, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1884.0, "episode_reward_min": 1884.0, "episode_reward_mean": 1884.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1884.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6501871469674668, "mean_raw_obs_processing_ms": 0.0926589510044095, "mean_inference_ms": 1.6004476071186196, "mean_action_processing_ms": 0.0479034126064926}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 724000, "timers": {"sample_time_ms": 8791.512, "sample_throughput": 454.984, "learn_time_ms": 11758.868, "learn_throughput": 340.169, "update_time_ms": 2.947}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5406097412109375, "cur_lr": 5e-05, "total_loss": 8.607071846723557, "policy_loss": -0.01969111748621799, "vf_loss": 8.623067736625671, "vf_explained_var": 0.3512364327907562, "kl": 0.0068351888621691614, "entropy": 0.11166455340571702, "entropy_coeff": 0.0}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 72, "training_iteration": 181, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-01-44", "timestamp": 1618142504, "time_this_iter_s": 20.070099115371704, "time_total_s": 3841.6803176403046, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3841.6803176403046, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 58.278571428571425, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1884.0, "episode_reward_min": 1884.0, "episode_reward_mean": 1884.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1884.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6501871469674668, "mean_raw_obs_processing_ms": 0.0926589510044095, "mean_inference_ms": 1.6004476071186196, "mean_action_processing_ms": 0.0479034126064926}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 728000, "timers": {"sample_time_ms": 8840.864, "sample_throughput": 452.444, "learn_time_ms": 11771.508, "learn_throughput": 339.804, "update_time_ms": 2.955}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5406097412109375, "cur_lr": 5e-05, "total_loss": 8.680087551474571, "policy_loss": -0.03171164559898898, "vf_loss": 8.70787027478218, "vf_explained_var": 0.3173687160015106, "kl": 0.007267514221894089, "entropy": 0.10650867829099298, "entropy_coeff": 0.0}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 72, "training_iteration": 182, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-02-05", "timestamp": 1618142525, "time_this_iter_s": 20.981335639953613, "time_total_s": 3862.661653280258, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6959ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69597d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3862.661653280258, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 57.66999999999999, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2034.0, "episode_reward_min": 2034.0, "episode_reward_mean": 2034.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2034.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.647454466773884, "mean_raw_obs_processing_ms": 0.09298410213593201, "mean_inference_ms": 1.600068691592883, "mean_action_processing_ms": 0.047896166026565955}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 732000, "timers": {"sample_time_ms": 8994.445, "sample_throughput": 444.719, "learn_time_ms": 11802.295, "learn_throughput": 338.917, "update_time_ms": 2.98}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5406097412109375, "cur_lr": 5e-05, "total_loss": 8.779513642191887, "policy_loss": -0.023649339127587155, "vf_loss": 8.799284517765045, "vf_explained_var": 0.3664628565311432, "kl": 0.007174013102485333, "entropy": 0.10836239578202367, "entropy_coeff": 0.0}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 73, "training_iteration": 183, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-02-26", "timestamp": 1618142546, "time_this_iter_s": 21.38528323173523, "time_total_s": 3884.0469365119934, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6959f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3884.0469365119934, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 58.63225806451614, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2034.0, "episode_reward_min": 2034.0, "episode_reward_mean": 2034.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2034.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.647454466773884, "mean_raw_obs_processing_ms": 0.09298410213593201, "mean_inference_ms": 1.600068691592883, "mean_action_processing_ms": 0.047896166026565955}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 736000, "timers": {"sample_time_ms": 9179.755, "sample_throughput": 435.741, "learn_time_ms": 11818.175, "learn_throughput": 338.462, "update_time_ms": 2.977}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5406097412109375, "cur_lr": 5e-05, "total_loss": 15.716623097658157, "policy_loss": -0.05845369672169909, "vf_loss": 15.749732851982117, "vf_explained_var": 0.6208389401435852, "kl": 0.04688034043647349, "entropy": 0.1416342630982399, "entropy_coeff": 0.0}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 73, "training_iteration": 184, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-02-48", "timestamp": 1618142568, "time_this_iter_s": 22.040687084197998, "time_total_s": 3906.0876235961914, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3906.0876235961914, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 58.18387096774194, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1912.0, "episode_reward_min": 1912.0, "episode_reward_mean": 1912.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1912.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.647610759646055, "mean_raw_obs_processing_ms": 0.09317384384792368, "mean_inference_ms": 1.59967917283137, "mean_action_processing_ms": 0.04788087612005497}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 740000, "timers": {"sample_time_ms": 8933.281, "sample_throughput": 447.764, "learn_time_ms": 11823.352, "learn_throughput": 338.314, "update_time_ms": 2.955}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8109146118164063, "cur_lr": 5e-05, "total_loss": 9.939720153808594, "policy_loss": -0.029894855921156704, "vf_loss": 9.96478120982647, "vf_explained_var": 0.4261668026447296, "kl": 0.005960760376183316, "entropy": 0.10243437974713743, "entropy_coeff": 0.0}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 74, "training_iteration": 185, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-03-09", "timestamp": 1618142589, "time_this_iter_s": 20.91852355003357, "time_total_s": 3927.006147146225, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695f450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3927.006147146225, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 57.49333333333334, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1912.0, "episode_reward_min": 1912.0, "episode_reward_mean": 1912.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1912.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.647610759646055, "mean_raw_obs_processing_ms": 0.09317384384792368, "mean_inference_ms": 1.59967917283137, "mean_action_processing_ms": 0.04788087612005497}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 744000, "timers": {"sample_time_ms": 9299.429, "sample_throughput": 430.134, "learn_time_ms": 11802.487, "learn_throughput": 338.912, "update_time_ms": 2.975}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8109146118164063, "cur_lr": 5e-05, "total_loss": 5.803082562983036, "policy_loss": -0.019138224073685706, "vf_loss": 5.818548321723938, "vf_explained_var": 0.30803990364074707, "kl": 0.004528904475591844, "entropy": 0.08377661323174834, "entropy_coeff": 0.0}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 74, "training_iteration": 186, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-03-33", "timestamp": 1618142613, "time_this_iter_s": 23.747831344604492, "time_total_s": 3950.7539784908295, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697be50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3950.7539784908295, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 58.51764705882353, "ram_util_percent": 27.299999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1912.0, "episode_reward_min": 1912.0, "episode_reward_mean": 1912.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1912.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.647610759646055, "mean_raw_obs_processing_ms": 0.09317384384792368, "mean_inference_ms": 1.59967917283137, "mean_action_processing_ms": 0.04788087612005497}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 748000, "timers": {"sample_time_ms": 9464.269, "sample_throughput": 422.642, "learn_time_ms": 11783.771, "learn_throughput": 339.45, "update_time_ms": 3.007}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 8.765409722924232, "policy_loss": -0.021844556380528957, "vf_loss": 8.784366846084595, "vf_explained_var": 0.35881614685058594, "kl": 0.007121636241208762, "entropy": 0.09324952098540962, "entropy_coeff": 0.0}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 74, "training_iteration": 187, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-03-54", "timestamp": 1618142634, "time_this_iter_s": 21.356237173080444, "time_total_s": 3972.11021566391, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bde90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bdcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3972.11021566391, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 57.9741935483871, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2226.0, "episode_reward_min": 2226.0, "episode_reward_mean": 2226.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2226.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6511116481334003, "mean_raw_obs_processing_ms": 0.09349400276127338, "mean_inference_ms": 1.5996281769913367, "mean_action_processing_ms": 0.04786572026338287}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 752000, "timers": {"sample_time_ms": 9547.385, "sample_throughput": 418.963, "learn_time_ms": 11790.412, "learn_throughput": 339.259, "update_time_ms": 3.072}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 5.477710589766502, "policy_loss": -0.0292772124230396, "vf_loss": 5.503582939505577, "vf_explained_var": 0.31078359484672546, "kl": 0.008397590259846766, "entropy": 0.09588180994614959, "entropy_coeff": 0.0}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 75, "training_iteration": 188, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-04-16", "timestamp": 1618142656, "time_this_iter_s": 21.780250310897827, "time_total_s": 3993.8904659748077, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3993.8904659748077, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 57.964516129032255, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2226.0, "episode_reward_min": 2226.0, "episode_reward_mean": 2226.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2226.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6511116481334003, "mean_raw_obs_processing_ms": 0.09349400276127338, "mean_inference_ms": 1.5996281769913367, "mean_action_processing_ms": 0.04786572026338287}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 756000, "timers": {"sample_time_ms": 9675.706, "sample_throughput": 413.407, "learn_time_ms": 11780.618, "learn_throughput": 339.541, "update_time_ms": 3.093}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 7.766550585627556, "policy_loss": -0.029967612790642306, "vf_loss": 7.790481731295586, "vf_explained_var": 0.44681552052497864, "kl": 0.014888105157297105, "entropy": 0.1187799924518913, "entropy_coeff": 0.0}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 75, "training_iteration": 189, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-04-37", "timestamp": 1618142677, "time_this_iter_s": 21.163490533828735, "time_total_s": 4015.0539565086365, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8ddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4015.0539565086365, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 58.04333333333332, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2034.0, "episode_reward_min": 2034.0, "episode_reward_mean": 2034.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2034.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6510465390785422, "mean_raw_obs_processing_ms": 0.09372175019116412, "mean_inference_ms": 1.5996471259448595, "mean_action_processing_ms": 0.04786112316529992}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 760000, "timers": {"sample_time_ms": 9717.268, "sample_throughput": 411.638, "learn_time_ms": 11777.645, "learn_throughput": 339.626, "update_time_ms": 3.076}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 9.142421439290047, "policy_loss": -0.03240683127660304, "vf_loss": 9.171307474374771, "vf_explained_var": 0.3504587411880493, "kl": 0.008683588966960087, "entropy": 0.10349517629947513, "entropy_coeff": 0.0}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 76, "training_iteration": 190, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-04-59", "timestamp": 1618142699, "time_this_iter_s": 21.60075354576111, "time_total_s": 4036.6547100543976, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4036.6547100543976, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 58.048387096774185, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2034.0, "episode_reward_min": 2034.0, "episode_reward_mean": 2034.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2034.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6510465390785422, "mean_raw_obs_processing_ms": 0.09372175019116412, "mean_inference_ms": 1.5996471259448595, "mean_action_processing_ms": 0.04786112316529992}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 764000, "timers": {"sample_time_ms": 10014.872, "sample_throughput": 399.406, "learn_time_ms": 11761.105, "learn_throughput": 340.104, "update_time_ms": 3.024}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 6.749883860349655, "policy_loss": -0.030239586834795773, "vf_loss": 6.776449143886566, "vf_explained_var": 0.22905251383781433, "kl": 0.009062324919796083, "entropy": 0.10050603933632374, "entropy_coeff": 0.0}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 76, "training_iteration": 191, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-05-22", "timestamp": 1618142722, "time_this_iter_s": 22.8808434009552, "time_total_s": 4059.535553455353, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695f490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8ddd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4059.535553455353, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 57.7125, "ram_util_percent": 27.3}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2034.0, "episode_reward_min": 2034.0, "episode_reward_mean": 2034.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2034.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6510465390785422, "mean_raw_obs_processing_ms": 0.09372175019116412, "mean_inference_ms": 1.5996471259448595, "mean_action_processing_ms": 0.04786112316529992}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 768000, "timers": {"sample_time_ms": 10007.461, "sample_throughput": 399.702, "learn_time_ms": 11751.15, "learn_throughput": 340.392, "update_time_ms": 3.129}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 10.826598539948463, "policy_loss": -0.035729403723962605, "vf_loss": 10.858067065477371, "vf_explained_var": 0.47770214080810547, "kl": 0.010508666025998536, "entropy": 0.10396021604537964, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 76, "training_iteration": 192, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-05-43", "timestamp": 1618142743, "time_this_iter_s": 20.809656143188477, "time_total_s": 4080.3452095985413, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8ded0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4080.3452095985413, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 58.24999999999999, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1800.0, "episode_reward_min": 1800.0, "episode_reward_mean": 1800.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1800.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6505025018665933, "mean_raw_obs_processing_ms": 0.09408960514105441, "mean_inference_ms": 1.5999812926010963, "mean_action_processing_ms": 0.047878054196626336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 772000, "timers": {"sample_time_ms": 9936.625, "sample_throughput": 402.551, "learn_time_ms": 11746.539, "learn_throughput": 340.526, "update_time_ms": 3.103}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40545730590820317, "cur_lr": 5e-05, "total_loss": 33.934293150901794, "policy_loss": -0.0015880977734923363, "vf_loss": 33.9355531334877, "vf_explained_var": 0.14886152744293213, "kl": 0.0008090973833532189, "entropy": 0.005047633036156185, "entropy_coeff": 0.0}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 77, "training_iteration": 193, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-06-03", "timestamp": 1618142763, "time_this_iter_s": 20.633206129074097, "time_total_s": 4100.978415727615, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6948510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4100.978415727615, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 58.62666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1800.0, "episode_reward_min": 1800.0, "episode_reward_mean": 1800.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1800.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6505025018665933, "mean_raw_obs_processing_ms": 0.09408960514105441, "mean_inference_ms": 1.5999812926010963, "mean_action_processing_ms": 0.047878054196626336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 776000, "timers": {"sample_time_ms": 9702.965, "sample_throughput": 412.245, "learn_time_ms": 11749.498, "learn_throughput": 340.44, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20272865295410158, "cur_lr": 5e-05, "total_loss": 9.128493502736092, "policy_loss": -0.03252459075883962, "vf_loss": 9.137415453791618, "vf_explained_var": -0.00013046525418758392, "kl": 0.11642474343534559, "entropy": 0.24935547076165676, "entropy_coeff": 0.0}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 77, "training_iteration": 194, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-06-23", "timestamp": 1618142783, "time_this_iter_s": 19.733662605285645, "time_total_s": 4120.712078332901, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4120.712078332901, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 58.08571428571429, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 888.0, "episode_reward_min": 888.0, "episode_reward_mean": 888.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [888.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6465597287605798, "mean_raw_obs_processing_ms": 0.09429560334119239, "mean_inference_ms": 1.599870137269156, "mean_action_processing_ms": 0.04789192558151177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 780000, "timers": {"sample_time_ms": 9644.744, "sample_throughput": 414.734, "learn_time_ms": 11738.3, "learn_throughput": 340.765, "update_time_ms": 3.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 10.57357007265091, "policy_loss": -0.024957188172265887, "vf_loss": 10.594901382923126, "vf_explained_var": 0.1470986306667328, "kl": 0.011923453290364705, "entropy": 0.09284398448653519, "entropy_coeff": 0.0}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 78, "training_iteration": 195, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-06-43", "timestamp": 1618142803, "time_this_iter_s": 20.221090078353882, "time_total_s": 4140.933168411255, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4140.933168411255, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 58.027586206896544, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 888.0, "episode_reward_min": 888.0, "episode_reward_mean": 888.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [888.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6465597287605798, "mean_raw_obs_processing_ms": 0.09429560334119239, "mean_inference_ms": 1.599870137269156, "mean_action_processing_ms": 0.04789192558151177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 784000, "timers": {"sample_time_ms": 9217.675, "sample_throughput": 433.949, "learn_time_ms": 11739.345, "learn_throughput": 340.735, "update_time_ms": 3.059}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 9.248368486762047, "policy_loss": -0.03957073501078412, "vf_loss": 9.28451257944107, "vf_explained_var": 0.5086220502853394, "kl": 0.011268274975009263, "entropy": 0.15936633618548512, "entropy_coeff": 0.0}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 78, "training_iteration": 196, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-07-03", "timestamp": 1618142823, "time_this_iter_s": 19.487098932266235, "time_total_s": 4160.420267343521, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8dc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b695f910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4160.420267343521, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 58.47857142857142, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 888.0, "episode_reward_min": 888.0, "episode_reward_mean": 888.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [888.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6465597287605798, "mean_raw_obs_processing_ms": 0.09429560334119239, "mean_inference_ms": 1.599870137269156, "mean_action_processing_ms": 0.04789192558151177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 788000, "timers": {"sample_time_ms": 9344.395, "sample_throughput": 428.064, "learn_time_ms": 11749.462, "learn_throughput": 340.441, "update_time_ms": 3.064}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 9.750081300735474, "policy_loss": -0.02491677537909709, "vf_loss": 9.772737458348274, "vf_explained_var": 0.3407832086086273, "kl": 0.007433360166032799, "entropy": 0.08681804733350873, "entropy_coeff": 0.0}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 78, "training_iteration": 197, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-07-26", "timestamp": 1618142846, "time_this_iter_s": 22.727192640304565, "time_total_s": 4183.147459983826, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4183.147459983826, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 58.440625, "ram_util_percent": 27.3}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1804.0, "episode_reward_min": 1804.0, "episode_reward_mean": 1804.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1804.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6457201861532169, "mean_raw_obs_processing_ms": 0.09456821504029282, "mean_inference_ms": 1.599367400241294, "mean_action_processing_ms": 0.04786351751975851}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 792000, "timers": {"sample_time_ms": 9276.393, "sample_throughput": 431.202, "learn_time_ms": 11733.397, "learn_throughput": 340.907, "update_time_ms": 3.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 9.89022096991539, "policy_loss": -0.02403796842554584, "vf_loss": 9.911707013845444, "vf_explained_var": 0.39018699526786804, "kl": 0.008392508803808596, "entropy": 0.10603217442985624, "entropy_coeff": 0.0}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 79, "training_iteration": 198, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-07-47", "timestamp": 1618142867, "time_this_iter_s": 20.942294597625732, "time_total_s": 4204.089754581451, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723bbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4204.089754581451, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 58.14666666666666, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1804.0, "episode_reward_min": 1804.0, "episode_reward_mean": 1804.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1804.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6457201861532169, "mean_raw_obs_processing_ms": 0.09456821504029282, "mean_inference_ms": 1.599367400241294, "mean_action_processing_ms": 0.04786351751975851}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 796000, "timers": {"sample_time_ms": 9086.977, "sample_throughput": 440.19, "learn_time_ms": 11754.568, "learn_throughput": 340.293, "update_time_ms": 3.047}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 10.4644256234169, "policy_loss": -0.03454806542140432, "vf_loss": 10.496614187955856, "vf_explained_var": 0.4159868657588959, "kl": 0.00775934562261682, "entropy": 0.11763447639532387, "entropy_coeff": 0.0}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 79, "training_iteration": 199, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-08-06", "timestamp": 1618142886, "time_this_iter_s": 19.483949422836304, "time_total_s": 4223.573704004288, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4223.573704004288, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 58.574999999999996, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1907.0, "episode_reward_min": 1907.0, "episode_reward_mean": 1907.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1907.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6458071691657326, "mean_raw_obs_processing_ms": 0.09471089594176718, "mean_inference_ms": 1.5986332061428872, "mean_action_processing_ms": 0.04783302258663238}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 800000, "timers": {"sample_time_ms": 9216.391, "sample_throughput": 434.009, "learn_time_ms": 11768.535, "learn_throughput": 339.889, "update_time_ms": 3.042}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 8.05350111424923, "policy_loss": -0.02737412555143237, "vf_loss": 8.078288838267326, "vf_explained_var": 0.4305828809738159, "kl": 0.008505701363901608, "entropy": 0.09145889966748655, "entropy_coeff": 0.0}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 80, "training_iteration": 200, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-08-29", "timestamp": 1618142909, "time_this_iter_s": 23.035414695739746, "time_total_s": 4246.6091187000275, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4246.6091187000275, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 57.90909090909091, "ram_util_percent": 27.3}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1907.0, "episode_reward_min": 1907.0, "episode_reward_mean": 1907.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1907.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6458071691657326, "mean_raw_obs_processing_ms": 0.09471089594176718, "mean_inference_ms": 1.5986332061428872, "mean_action_processing_ms": 0.04783302258663238}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 804000, "timers": {"sample_time_ms": 9025.955, "sample_throughput": 443.166, "learn_time_ms": 11771.635, "learn_throughput": 339.8, "update_time_ms": 3.052}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 7.7952451556921005, "policy_loss": -0.027978076424915344, "vf_loss": 7.820548340678215, "vf_explained_var": 0.31113913655281067, "kl": 0.008795998350251466, "entropy": 0.09270225116051733, "entropy_coeff": 0.0}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 80, "training_iteration": 201, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-08-50", "timestamp": 1618142930, "time_this_iter_s": 21.006932973861694, "time_total_s": 4267.616051673889, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a6be10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4267.616051673889, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 58.25666666666666, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1907.0, "episode_reward_min": 1907.0, "episode_reward_mean": 1907.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1907.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6458071691657326, "mean_raw_obs_processing_ms": 0.09471089594176718, "mean_inference_ms": 1.5986332061428872, "mean_action_processing_ms": 0.04783302258663238}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 808000, "timers": {"sample_time_ms": 9257.661, "sample_throughput": 432.075, "learn_time_ms": 11771.324, "learn_throughput": 339.809, "update_time_ms": 2.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 7.085307255387306, "policy_loss": -0.021610811236314476, "vf_loss": 7.104353547096252, "vf_explained_var": 0.28878480195999146, "kl": 0.008433069131569937, "entropy": 0.09518775600008667, "entropy_coeff": 0.0}}, "num_steps_sampled": 808000, "num_steps_trained": 808000}, "done": false, "episodes_total": 80, "training_iteration": 202, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-09-13", "timestamp": 1618142953, "time_this_iter_s": 23.119347095489502, "time_total_s": 4290.735398769379, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4290.735398769379, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 58.05757575757576, "ram_util_percent": 27.363636363636363}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2166.0, "episode_reward_min": 2166.0, "episode_reward_mean": 2166.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2166.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474850322374978, "mean_raw_obs_processing_ms": 0.09499456217838856, "mean_inference_ms": 1.5981917536017738, "mean_action_processing_ms": 0.04781255271623255}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 812000, "timers": {"sample_time_ms": 9317.792, "sample_throughput": 429.286, "learn_time_ms": 11758.807, "learn_throughput": 340.171, "update_time_ms": 2.958}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 12.009612038731575, "policy_loss": -0.025933649856597185, "vf_loss": 12.032776266336441, "vf_explained_var": 0.4525832533836365, "kl": 0.009107587713515386, "entropy": 0.10277313506230712, "entropy_coeff": 0.0}}, "num_steps_sampled": 812000, "num_steps_trained": 812000}, "done": false, "episodes_total": 81, "training_iteration": 203, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-09-34", "timestamp": 1618142974, "time_this_iter_s": 21.10946035385132, "time_total_s": 4311.84485912323, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697ee50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4311.84485912323, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 58.34333333333333, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2166.0, "episode_reward_min": 2166.0, "episode_reward_mean": 2166.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2166.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474850322374978, "mean_raw_obs_processing_ms": 0.09499456217838856, "mean_inference_ms": 1.5981917536017738, "mean_action_processing_ms": 0.04781255271623255}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 816000, "timers": {"sample_time_ms": 9624.706, "sample_throughput": 415.597, "learn_time_ms": 11726.321, "learn_throughput": 341.113, "update_time_ms": 2.921}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 11.10210108757019, "policy_loss": -0.02736453717807308, "vf_loss": 11.126696050167084, "vf_explained_var": 0.5362886190414429, "kl": 0.009107375371968374, "entropy": 0.10921994922682643, "entropy_coeff": 0.0}}, "num_steps_sampled": 816000, "num_steps_trained": 816000}, "done": false, "episodes_total": 81, "training_iteration": 204, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-09-57", "timestamp": 1618142997, "time_this_iter_s": 22.47525453567505, "time_total_s": 4334.320113658905, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4334.320113658905, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 57.853125, "ram_util_percent": 27.3}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1843.0, "episode_reward_min": 1843.0, "episode_reward_mean": 1843.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1843.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474841662309727, "mean_raw_obs_processing_ms": 0.09519853699742162, "mean_inference_ms": 1.5982428709133467, "mean_action_processing_ms": 0.04780877115536896}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 820000, "timers": {"sample_time_ms": 9634.365, "sample_throughput": 415.18, "learn_time_ms": 11729.443, "learn_throughput": 341.022, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 11.020173370838165, "policy_loss": -0.03283599455608055, "vf_loss": 11.04900848865509, "vf_explained_var": 0.5703991651535034, "kl": 0.013156405737390742, "entropy": 0.139779380755499, "entropy_coeff": 0.0}}, "num_steps_sampled": 820000, "num_steps_trained": 820000}, "done": false, "episodes_total": 82, "training_iteration": 205, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-10-17", "timestamp": 1618143017, "time_this_iter_s": 20.35257339477539, "time_total_s": 4354.67268705368, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4354.67268705368, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 58.57241379310345, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1843.0, "episode_reward_min": 1843.0, "episode_reward_mean": 1843.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1843.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474841662309727, "mean_raw_obs_processing_ms": 0.09519853699742162, "mean_inference_ms": 1.5982428709133467, "mean_action_processing_ms": 0.04780877115536896}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 824000, "timers": {"sample_time_ms": 10217.9, "sample_throughput": 391.47, "learn_time_ms": 11747.105, "learn_throughput": 340.509, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 9.384330421686172, "policy_loss": -0.023459780495613813, "vf_loss": 9.405437171459198, "vf_explained_var": 0.26658084988594055, "kl": 0.007738228378002532, "entropy": 0.08247860707342625, "entropy_coeff": 0.0}}, "num_steps_sampled": 824000, "num_steps_trained": 824000}, "done": false, "episodes_total": 82, "training_iteration": 206, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-10-43", "timestamp": 1618143043, "time_this_iter_s": 25.496031999588013, "time_total_s": 4380.168719053268, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4380.168719053268, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 58.01944444444444, "ram_util_percent": 27.299999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1843.0, "episode_reward_min": 1843.0, "episode_reward_mean": 1843.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1843.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6474841662309727, "mean_raw_obs_processing_ms": 0.09519853699742162, "mean_inference_ms": 1.5982428709133467, "mean_action_processing_ms": 0.04780877115536896}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 828000, "timers": {"sample_time_ms": 10264.998, "sample_throughput": 389.674, "learn_time_ms": 11741.388, "learn_throughput": 340.675, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 3.842609725892544, "policy_loss": -0.016600062779616565, "vf_loss": 3.8568954095244408, "vf_explained_var": 0.31796085834503174, "kl": 0.007610748281877022, "entropy": 0.0750542018795386, "entropy_coeff": 0.0}}, "num_steps_sampled": 828000, "num_steps_trained": 828000}, "done": false, "episodes_total": 82, "training_iteration": 207, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-11-06", "timestamp": 1618143066, "time_this_iter_s": 23.138941049575806, "time_total_s": 4403.307660102844, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695fc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4403.307660102844, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 57.88484848484848, "ram_util_percent": 27.3}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2190.0, "episode_reward_min": 2190.0, "episode_reward_mean": 2190.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2190.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6529989927788517, "mean_raw_obs_processing_ms": 0.09549570240137481, "mean_inference_ms": 1.5980433745224552, "mean_action_processing_ms": 0.04779387051611501}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 832000, "timers": {"sample_time_ms": 10186.399, "sample_throughput": 392.68, "learn_time_ms": 11755.376, "learn_throughput": 340.27, "update_time_ms": 2.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 9.009136959910393, "policy_loss": -0.040654600743437186, "vf_loss": 9.043984979391098, "vf_explained_var": 0.3727705776691437, "kl": 0.019094540999503806, "entropy": 0.1226784570608288, "entropy_coeff": 0.0}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 83, "training_iteration": 208, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-11-26", "timestamp": 1618143086, "time_this_iter_s": 20.295262813568115, "time_total_s": 4423.602922916412, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697ecd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697e210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4423.602922916412, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 58.406896551724145, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2190.0, "episode_reward_min": 2190.0, "episode_reward_mean": 2190.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2190.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6529989927788517, "mean_raw_obs_processing_ms": 0.09549570240137481, "mean_inference_ms": 1.5980433745224552, "mean_action_processing_ms": 0.04779387051611501}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 836000, "timers": {"sample_time_ms": 10233.911, "sample_throughput": 390.857, "learn_time_ms": 11758.376, "learn_throughput": 340.183, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 7.680397719144821, "policy_loss": -0.027584296592976898, "vf_loss": 7.7050522565841675, "vf_explained_var": 0.47895145416259766, "kl": 0.00963420973130269, "entropy": 0.10843395465053618, "entropy_coeff": 0.0}}, "num_steps_sampled": 836000, "num_steps_trained": 836000}, "done": false, "episodes_total": 83, "training_iteration": 209, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-11-46", "timestamp": 1618143106, "time_this_iter_s": 19.991841077804565, "time_total_s": 4443.594763994217, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697e290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4443.594763994217, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 58.45517241379311, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2050.0, "episode_reward_min": 2050.0, "episode_reward_mean": 2050.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2050.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6510407204677099, "mean_raw_obs_processing_ms": 0.09569696489340843, "mean_inference_ms": 1.5979411504805203, "mean_action_processing_ms": 0.04778557407650933}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 840000, "timers": {"sample_time_ms": 10078.635, "sample_throughput": 396.879, "learn_time_ms": 11749.813, "learn_throughput": 340.431, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 7.079956978559494, "policy_loss": -0.028496543498476967, "vf_loss": 7.10533282160759, "vf_explained_var": 0.3261467218399048, "kl": 0.010262414580211043, "entropy": 0.09564045537263155, "entropy_coeff": 0.0}}, "num_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 84, "training_iteration": 210, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-12-08", "timestamp": 1618143128, "time_this_iter_s": 21.40051245689392, "time_total_s": 4464.995276451111, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4464.995276451111, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 58.519999999999996, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2050.0, "episode_reward_min": 2050.0, "episode_reward_mean": 2050.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2050.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6510407204677099, "mean_raw_obs_processing_ms": 0.09569696489340843, "mean_inference_ms": 1.5979411504805203, "mean_action_processing_ms": 0.04778557407650933}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 844000, "timers": {"sample_time_ms": 9992.101, "sample_throughput": 400.316, "learn_time_ms": 11746.615, "learn_throughput": 340.524, "update_time_ms": 2.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 6.72771754860878, "policy_loss": -0.0182545316638425, "vf_loss": 6.743165597319603, "vf_explained_var": 0.4185478389263153, "kl": 0.009229064104147255, "entropy": 0.10024333058390766, "entropy_coeff": 0.0}}, "num_steps_sampled": 844000, "num_steps_trained": 844000}, "done": false, "episodes_total": 84, "training_iteration": 211, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-12-28", "timestamp": 1618143148, "time_this_iter_s": 20.11228322982788, "time_total_s": 4485.107559680939, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4485.107559680939, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 57.72758620689655, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2050.0, "episode_reward_min": 2050.0, "episode_reward_mean": 2050.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2050.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6510407204677099, "mean_raw_obs_processing_ms": 0.09569696489340843, "mean_inference_ms": 1.5979411504805203, "mean_action_processing_ms": 0.04778557407650933}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 848000, "timers": {"sample_time_ms": 9747.082, "sample_throughput": 410.379, "learn_time_ms": 11746.638, "learn_throughput": 340.523, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 8.184552058577538, "policy_loss": -0.03866781436954625, "vf_loss": 8.21829479932785, "vf_explained_var": 0.3358389139175415, "kl": 0.016196278269489994, "entropy": 0.11917585367336869, "entropy_coeff": 0.0}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 84, "training_iteration": 212, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-12-49", "timestamp": 1618143169, "time_this_iter_s": 20.672210454940796, "time_total_s": 4505.7797701358795, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697ea50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697e750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4505.7797701358795, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 58.34, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6477892393167597, "mean_raw_obs_processing_ms": 0.09593884195053842, "mean_inference_ms": 1.5972042433084608, "mean_action_processing_ms": 0.04774980470126872}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 852000, "timers": {"sample_time_ms": 9640.807, "sample_throughput": 414.903, "learn_time_ms": 11742.226, "learn_throughput": 340.651, "update_time_ms": 2.824}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 8.42578537762165, "policy_loss": -0.03522646595956758, "vf_loss": 8.457639187574387, "vf_explained_var": 0.5179784297943115, "kl": 0.011090825399151072, "entropy": 0.12821261514909565, "entropy_coeff": 0.0}}, "num_steps_sampled": 852000, "num_steps_trained": 852000}, "done": false, "episodes_total": 85, "training_iteration": 213, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-13-09", "timestamp": 1618143189, "time_this_iter_s": 20.00109577178955, "time_total_s": 4525.780865907669, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bde50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4525.780865907669, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 58.425000000000004, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6477892393167597, "mean_raw_obs_processing_ms": 0.09593884195053842, "mean_inference_ms": 1.5972042433084608, "mean_action_processing_ms": 0.04774980470126872}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 856000, "timers": {"sample_time_ms": 9320.082, "sample_throughput": 429.181, "learn_time_ms": 11737.466, "learn_throughput": 340.789, "update_time_ms": 2.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 15.666469365358353, "policy_loss": -0.038226908654905856, "vf_loss": 15.699810177087784, "vf_explained_var": 0.4712476432323456, "kl": 0.016067721036961302, "entropy": 0.22708171093836427, "entropy_coeff": 0.0}}, "num_steps_sampled": 856000, "num_steps_trained": 856000}, "done": false, "episodes_total": 85, "training_iteration": 214, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-13-28", "timestamp": 1618143208, "time_this_iter_s": 19.22299599647522, "time_total_s": 4545.003861904144, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69126d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723b710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4545.003861904144, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 58.27499999999999, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1479.0, "episode_reward_min": 1479.0, "episode_reward_mean": 1479.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1479.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6435366544090416, "mean_raw_obs_processing_ms": 0.09609709338797437, "mean_inference_ms": 1.596527473227488, "mean_action_processing_ms": 0.04772740985535853}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 860000, "timers": {"sample_time_ms": 9207.658, "sample_throughput": 434.421, "learn_time_ms": 11715.099, "learn_throughput": 341.44, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 11.393809527158737, "policy_loss": -0.030183998052962124, "vf_loss": 11.421083807945251, "vf_explained_var": 0.43560582399368286, "kl": 0.00956836347177159, "entropy": 0.1597342942841351, "entropy_coeff": 0.0}}, "num_steps_sampled": 860000, "num_steps_trained": 860000}, "done": false, "episodes_total": 86, "training_iteration": 215, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-13-47", "timestamp": 1618143227, "time_this_iter_s": 19.003941297531128, "time_total_s": 4564.007803201675, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4564.007803201675, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 57.711111111111116, "ram_util_percent": 27.299999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1479.0, "episode_reward_min": 1479.0, "episode_reward_mean": 1479.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1479.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6435366544090416, "mean_raw_obs_processing_ms": 0.09609709338797437, "mean_inference_ms": 1.596527473227488, "mean_action_processing_ms": 0.04772740985535853}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 864000, "timers": {"sample_time_ms": 8599.59, "sample_throughput": 465.138, "learn_time_ms": 11684.724, "learn_throughput": 342.327, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 12.65342378616333, "policy_loss": -0.04655101866228506, "vf_loss": 12.695619404315948, "vf_explained_var": 0.6262308359146118, "kl": 0.014322382485261187, "entropy": 0.2263252236880362, "entropy_coeff": 0.0}}, "num_steps_sampled": 864000, "num_steps_trained": 864000}, "done": false, "episodes_total": 86, "training_iteration": 216, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-14-06", "timestamp": 1618143246, "time_this_iter_s": 19.11366605758667, "time_total_s": 4583.121469259262, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cd590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4583.121469259262, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 58.211111111111116, "ram_util_percent": 27.362962962962957}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1479.0, "episode_reward_min": 1479.0, "episode_reward_mean": 1479.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1479.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6435366544090416, "mean_raw_obs_processing_ms": 0.09609709338797437, "mean_inference_ms": 1.596527473227488, "mean_action_processing_ms": 0.04772740985535853}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 868000, "timers": {"sample_time_ms": 8377.684, "sample_throughput": 477.459, "learn_time_ms": 11676.246, "learn_throughput": 342.576, "update_time_ms": 2.767}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 17.053152590990067, "policy_loss": -0.04097946500405669, "vf_loss": 17.088866025209427, "vf_explained_var": 0.6457382440567017, "kl": 0.017318218218861148, "entropy": 0.16397530515678227, "entropy_coeff": 0.0}}, "num_steps_sampled": 868000, "num_steps_trained": 868000}, "done": false, "episodes_total": 86, "training_iteration": 217, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-14-27", "timestamp": 1618143267, "time_this_iter_s": 20.834764003753662, "time_total_s": 4603.956233263016, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdb10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4603.956233263016, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 57.46333333333333, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1607.0, "episode_reward_min": 1607.0, "episode_reward_mean": 1607.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1607.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6434487394729825, "mean_raw_obs_processing_ms": 0.09627150237233609, "mean_inference_ms": 1.5949954415418246, "mean_action_processing_ms": 0.047667605906333906}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 872000, "timers": {"sample_time_ms": 8604.225, "sample_throughput": 464.888, "learn_time_ms": 11647.497, "learn_throughput": 343.421, "update_time_ms": 2.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 10.103953778743744, "policy_loss": -0.03718168841442093, "vf_loss": 10.13637663424015, "vf_explained_var": 0.50578373670578, "kl": 0.015649322391254827, "entropy": 0.1319858585484326, "entropy_coeff": 0.0}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 87, "training_iteration": 218, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-14-49", "timestamp": 1618143289, "time_this_iter_s": 22.273452758789062, "time_total_s": 4626.229686021805, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b695fe10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4626.229686021805, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 57.946875000000006, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1607.0, "episode_reward_min": 1607.0, "episode_reward_mean": 1607.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1607.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6434487394729825, "mean_raw_obs_processing_ms": 0.09627150237233609, "mean_inference_ms": 1.5949954415418246, "mean_action_processing_ms": 0.047667605906333906}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 876000, "timers": {"sample_time_ms": 8659.205, "sample_throughput": 461.936, "learn_time_ms": 11614.417, "learn_throughput": 344.4, "update_time_ms": 3.16}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 5.850136339664459, "policy_loss": -0.03485063707921654, "vf_loss": 5.882631778717041, "vf_explained_var": 0.22873422503471375, "kl": 0.0077447516086976975, "entropy": 0.0947771230712533, "entropy_coeff": 0.0}}, "num_steps_sampled": 876000, "num_steps_trained": 876000}, "done": false, "episodes_total": 87, "training_iteration": 219, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-15-09", "timestamp": 1618143309, "time_this_iter_s": 20.207635402679443, "time_total_s": 4646.437321424484, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4646.437321424484, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 57.54827586206897, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1894.0, "episode_reward_min": 1894.0, "episode_reward_mean": 1894.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1894.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6408562839177319, "mean_raw_obs_processing_ms": 0.09638018601379619, "mean_inference_ms": 1.593956818217728, "mean_action_processing_ms": 0.04762748269489105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 880000, "timers": {"sample_time_ms": 8436.356, "sample_throughput": 474.138, "learn_time_ms": 11586.989, "learn_throughput": 345.215, "update_time_ms": 3.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 9.819458782672882, "policy_loss": -0.04045219873660244, "vf_loss": 9.853962868452072, "vf_explained_var": 0.6264286637306213, "kl": 0.019560269807698205, "entropy": 0.17502119718119502, "entropy_coeff": 0.0}}, "num_steps_sampled": 880000, "num_steps_trained": 880000}, "done": false, "episodes_total": 88, "training_iteration": 220, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-15-28", "timestamp": 1618143328, "time_this_iter_s": 18.896153688430786, "time_total_s": 4665.333475112915, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a041d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4665.333475112915, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 57.74444444444444, "ram_util_percent": 27.3037037037037}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1894.0, "episode_reward_min": 1894.0, "episode_reward_mean": 1894.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1894.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6408562839177319, "mean_raw_obs_processing_ms": 0.09638018601379619, "mean_inference_ms": 1.593956818217728, "mean_action_processing_ms": 0.04762748269489105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 884000, "timers": {"sample_time_ms": 8431.299, "sample_throughput": 474.423, "learn_time_ms": 11578.505, "learn_throughput": 345.468, "update_time_ms": 3.194}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 13.309972047805786, "policy_loss": -0.03673128498485312, "vf_loss": 13.343811452388763, "vf_explained_var": 0.36988452076911926, "kl": 0.0095095434171526, "entropy": 0.13916716782841831, "entropy_coeff": 0.0}}, "num_steps_sampled": 884000, "num_steps_trained": 884000}, "done": false, "episodes_total": 88, "training_iteration": 221, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-15-48", "timestamp": 1618143348, "time_this_iter_s": 19.97775149345398, "time_total_s": 4685.311226606369, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4685.311226606369, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 58.221428571428575, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1894.0, "episode_reward_min": 1894.0, "episode_reward_mean": 1894.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1894.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6408562839177319, "mean_raw_obs_processing_ms": 0.09638018601379619, "mean_inference_ms": 1.593956818217728, "mean_action_processing_ms": 0.04762748269489105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 888000, "timers": {"sample_time_ms": 8316.592, "sample_throughput": 480.966, "learn_time_ms": 11547.676, "learn_throughput": 346.39, "update_time_ms": 3.443}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 12.966791450977325, "policy_loss": -0.03058801294537261, "vf_loss": 12.992834687232971, "vf_explained_var": 0.6770874261856079, "kl": 0.014946205570595339, "entropy": 0.21786689897999167, "entropy_coeff": 0.0}}, "num_steps_sampled": 888000, "num_steps_trained": 888000}, "done": false, "episodes_total": 88, "training_iteration": 222, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-16-08", "timestamp": 1618143368, "time_this_iter_s": 19.2143816947937, "time_total_s": 4704.525608301163, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a096d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab529c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4704.525608301163, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 57.32857142857143, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1575.0, "episode_reward_min": 1575.0, "episode_reward_mean": 1575.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1575.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6387795473867439, "mean_raw_obs_processing_ms": 0.09660021548563316, "mean_inference_ms": 1.5931795396400366, "mean_action_processing_ms": 0.047592254332795084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 892000, "timers": {"sample_time_ms": 8503.856, "sample_throughput": 470.375, "learn_time_ms": 11531.057, "learn_throughput": 346.889, "update_time_ms": 3.453}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 12.6219821870327, "policy_loss": -0.04215099985594861, "vf_loss": 12.658878415822983, "vf_explained_var": 0.46549779176712036, "kl": 0.017280127707635984, "entropy": 0.1243826886638999, "entropy_coeff": 0.0}}, "num_steps_sampled": 892000, "num_steps_trained": 892000}, "done": false, "episodes_total": 89, "training_iteration": 223, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-16-29", "timestamp": 1618143389, "time_this_iter_s": 21.707496166229248, "time_total_s": 4726.233104467392, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cd510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cd890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4726.233104467392, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 58.145161290322584, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1575.0, "episode_reward_min": 1575.0, "episode_reward_mean": 1575.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1575.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6387795473867439, "mean_raw_obs_processing_ms": 0.09660021548563316, "mean_inference_ms": 1.5931795396400366, "mean_action_processing_ms": 0.047592254332795084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 896000, "timers": {"sample_time_ms": 8572.718, "sample_throughput": 466.596, "learn_time_ms": 11532.647, "learn_throughput": 346.841, "update_time_ms": 3.479}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3040929794311524, "cur_lr": 5e-05, "total_loss": 16.14628890156746, "policy_loss": -0.05141134705627337, "vf_loss": 16.191578805446625, "vf_explained_var": 0.5328444242477417, "kl": 0.020128837175434455, "entropy": 0.17705942294560373, "entropy_coeff": 0.0}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 89, "training_iteration": 224, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-16-49", "timestamp": 1618143409, "time_this_iter_s": 19.92432427406311, "time_total_s": 4746.157428741455, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a96d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4746.157428741455, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 58.36071428571428, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1776.0, "episode_reward_min": 1776.0, "episode_reward_mean": 1776.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1776.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6361884336027326, "mean_raw_obs_processing_ms": 0.0967565929024578, "mean_inference_ms": 1.5927298751424985, "mean_action_processing_ms": 0.04757170530684952}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 900000, "timers": {"sample_time_ms": 8644.998, "sample_throughput": 462.695, "learn_time_ms": 11593.206, "learn_throughput": 345.03, "update_time_ms": 3.468}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 12.47054585814476, "policy_loss": -0.03697993897367269, "vf_loss": 12.503397405147552, "vf_explained_var": 0.5712207555770874, "kl": 0.009050691238371655, "entropy": 0.1307283565402031, "entropy_coeff": 0.0}}, "num_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 90, "training_iteration": 225, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-17-10", "timestamp": 1618143430, "time_this_iter_s": 20.335577726364136, "time_total_s": 4766.493006467819, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a5c990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cdf90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4766.493006467819, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 59.47241379310345, "ram_util_percent": 27.306896551724133}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1776.0, "episode_reward_min": 1776.0, "episode_reward_mean": 1776.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1776.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6361884336027326, "mean_raw_obs_processing_ms": 0.0967565929024578, "mean_inference_ms": 1.5927298751424985, "mean_action_processing_ms": 0.04757170530684952}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 904000, "timers": {"sample_time_ms": 8924.625, "sample_throughput": 448.198, "learn_time_ms": 11644.408, "learn_throughput": 343.513, "update_time_ms": 3.506}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 9.2778440117836, "policy_loss": -0.023289740551263094, "vf_loss": 9.297766834497452, "vf_explained_var": 0.22554314136505127, "kl": 0.007381552044535056, "entropy": 0.09686708659864962, "entropy_coeff": 0.0}}, "num_steps_sampled": 904000, "num_steps_trained": 904000}, "done": false, "episodes_total": 90, "training_iteration": 226, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-17-32", "timestamp": 1618143452, "time_this_iter_s": 22.421382427215576, "time_total_s": 4788.914388895035, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686af10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4788.914388895035, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 27.3}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1776.0, "episode_reward_min": 1776.0, "episode_reward_mean": 1776.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1776.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6361884336027326, "mean_raw_obs_processing_ms": 0.0967565929024578, "mean_inference_ms": 1.5927298751424985, "mean_action_processing_ms": 0.04757170530684952}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 908000, "timers": {"sample_time_ms": 8846.228, "sample_throughput": 452.17, "learn_time_ms": 11634.722, "learn_throughput": 343.798, "update_time_ms": 3.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 10.207952007651329, "policy_loss": -0.028684826858807355, "vf_loss": 10.231837034225464, "vf_explained_var": 0.4342767596244812, "kl": 0.010522745156777091, "entropy": 0.1183359685819596, "entropy_coeff": 0.0}}, "num_steps_sampled": 908000, "num_steps_trained": 908000}, "done": false, "episodes_total": 90, "training_iteration": 227, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-17-52", "timestamp": 1618143472, "time_this_iter_s": 19.95344090461731, "time_total_s": 4808.867829799652, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691fd50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691fa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4808.867829799652, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 58.70344827586207, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1928.0, "episode_reward_min": 1928.0, "episode_reward_mean": 1928.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1928.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6334448240147978, "mean_raw_obs_processing_ms": 0.09710963062358735, "mean_inference_ms": 1.5929798657847543, "mean_action_processing_ms": 0.04758491286436969}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 912000, "timers": {"sample_time_ms": 8569.683, "sample_throughput": 466.762, "learn_time_ms": 11655.279, "learn_throughput": 343.192, "update_time_ms": 3.576}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 12.736596494913101, "policy_loss": -0.038336454483214766, "vf_loss": 12.769369184970856, "vf_explained_var": 0.5478243231773376, "kl": 0.012197514646686614, "entropy": 0.21918469574302435, "entropy_coeff": 0.0}}, "num_steps_sampled": 912000, "num_steps_trained": 912000}, "done": false, "episodes_total": 91, "training_iteration": 228, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-18-12", "timestamp": 1618143492, "time_this_iter_s": 19.71393895149231, "time_total_s": 4828.581768751144, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4828.581768751144, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 58.13214285714285, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1928.0, "episode_reward_min": 1928.0, "episode_reward_mean": 1928.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1928.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6334448240147978, "mean_raw_obs_processing_ms": 0.09710963062358735, "mean_inference_ms": 1.5929798657847543, "mean_action_processing_ms": 0.04758491286436969}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 916000, "timers": {"sample_time_ms": 8871.609, "sample_throughput": 450.877, "learn_time_ms": 11668.796, "learn_throughput": 342.795, "update_time_ms": 3.174}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 11.554296880960464, "policy_loss": -0.026291087735444307, "vf_loss": 11.57700628042221, "vf_explained_var": 0.3876926600933075, "kl": 0.007852397618989926, "entropy": 0.11093660723417997, "entropy_coeff": 0.0}}, "num_steps_sampled": 916000, "num_steps_trained": 916000}, "done": false, "episodes_total": 91, "training_iteration": 229, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-18-35", "timestamp": 1618143515, "time_this_iter_s": 23.361760139465332, "time_total_s": 4851.94352889061, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69127d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4851.94352889061, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 58.86363636363637, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1940.0, "episode_reward_min": 1940.0, "episode_reward_mean": 1940.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1940.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.637257921992838, "mean_raw_obs_processing_ms": 0.09739493636878387, "mean_inference_ms": 1.5936410636448115, "mean_action_processing_ms": 0.047611854206326076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 920000, "timers": {"sample_time_ms": 9315.812, "sample_throughput": 429.377, "learn_time_ms": 11683.03, "learn_throughput": 342.377, "update_time_ms": 3.15}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 5.189513802528381, "policy_loss": -0.03003021253971383, "vf_loss": 5.216335758566856, "vf_explained_var": 0.24521063268184662, "kl": 0.007033540488919243, "entropy": 0.08432858716696501, "entropy_coeff": 0.0}}, "num_steps_sampled": 920000, "num_steps_trained": 920000}, "done": false, "episodes_total": 92, "training_iteration": 230, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-18-59", "timestamp": 1618143539, "time_this_iter_s": 23.479151248931885, "time_total_s": 4875.422680139542, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686ad50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686a190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4875.422680139542, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 58.08529411764707, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1940.0, "episode_reward_min": 1940.0, "episode_reward_mean": 1940.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1940.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.637257921992838, "mean_raw_obs_processing_ms": 0.09739493636878387, "mean_inference_ms": 1.5936410636448115, "mean_action_processing_ms": 0.047611854206326076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 924000, "timers": {"sample_time_ms": 9532.93, "sample_throughput": 419.598, "learn_time_ms": 11709.806, "learn_throughput": 341.594, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 10.218210205435753, "policy_loss": -0.03911454233457334, "vf_loss": 10.251352906227112, "vf_explained_var": 0.3428846001625061, "kl": 0.013092092733131722, "entropy": 0.11598543240688741, "entropy_coeff": 0.0}}, "num_steps_sampled": 924000, "num_steps_trained": 924000}, "done": false, "episodes_total": 92, "training_iteration": 231, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-19-21", "timestamp": 1618143561, "time_this_iter_s": 22.412912368774414, "time_total_s": 4897.835592508316, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b694a050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b694a290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4897.835592508316, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 58.50625000000001, "ram_util_percent": 27.38125}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1940.0, "episode_reward_min": 1940.0, "episode_reward_mean": 1940.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1940.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.637257921992838, "mean_raw_obs_processing_ms": 0.09739493636878387, "mean_inference_ms": 1.5936410636448115, "mean_action_processing_ms": 0.047611854206326076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 928000, "timers": {"sample_time_ms": 9533.764, "sample_throughput": 419.561, "learn_time_ms": 11806.397, "learn_throughput": 338.799, "update_time_ms": 2.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 12.297195702791214, "policy_loss": -0.023878852240159176, "vf_loss": 12.316757708787918, "vf_explained_var": 0.4710797667503357, "kl": 0.009463823880651034, "entropy": 0.12652655481360853, "entropy_coeff": 0.0}}, "num_steps_sampled": 928000, "num_steps_trained": 928000}, "done": false, "episodes_total": 92, "training_iteration": 232, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-19-41", "timestamp": 1618143581, "time_this_iter_s": 20.189322471618652, "time_total_s": 4918.024914979935, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b694a7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4918.024914979935, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 58.7344827586207, "ram_util_percent": 27.379310344827584}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1872.0, "episode_reward_min": 1872.0, "episode_reward_mean": 1872.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1872.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6364396034337998, "mean_raw_obs_processing_ms": 0.09771125822345555, "mean_inference_ms": 1.5937510563384742, "mean_action_processing_ms": 0.04763010520916108}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 932000, "timers": {"sample_time_ms": 9516.732, "sample_throughput": 420.312, "learn_time_ms": 11836.506, "learn_throughput": 337.938, "update_time_ms": 3.023}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 9.77533732354641, "policy_loss": -0.027058144129114226, "vf_loss": 9.798776671290398, "vf_explained_var": 0.46270716190338135, "kl": 0.007933246553875506, "entropy": 0.12145654205232859, "entropy_coeff": 0.0}}, "num_steps_sampled": 932000, "num_steps_trained": 932000}, "done": false, "episodes_total": 93, "training_iteration": 233, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-20-03", "timestamp": 1618143603, "time_this_iter_s": 21.83730912208557, "time_total_s": 4939.86222410202, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4939.86222410202, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 58.12903225806452, "ram_util_percent": 27.34516129032257}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1872.0, "episode_reward_min": 1872.0, "episode_reward_mean": 1872.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1872.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6364396034337998, "mean_raw_obs_processing_ms": 0.09771125822345555, "mean_inference_ms": 1.5937510563384742, "mean_action_processing_ms": 0.04763010520916108}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 936000, "timers": {"sample_time_ms": 9684.296, "sample_throughput": 413.04, "learn_time_ms": 11851.226, "learn_throughput": 337.518, "update_time_ms": 3.05}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45613946914672854, "cur_lr": 5e-05, "total_loss": 12.671233236789703, "policy_loss": -0.0444005043245852, "vf_loss": 12.706092923879623, "vf_explained_var": 0.43951907753944397, "kl": 0.020916622917866334, "entropy": 0.1343311513774097, "entropy_coeff": 0.0}}, "num_steps_sampled": 936000, "num_steps_trained": 936000}, "done": false, "episodes_total": 93, "training_iteration": 234, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-20-25", "timestamp": 1618143625, "time_this_iter_s": 21.749592304229736, "time_total_s": 4961.61181640625, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b694ac10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b694a790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4961.61181640625, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 58.21935483870967, "ram_util_percent": 27.29999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2145.0, "episode_reward_min": 2145.0, "episode_reward_mean": 2145.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2145.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6352203865489026, "mean_raw_obs_processing_ms": 0.09793835351233078, "mean_inference_ms": 1.5938324314437666, "mean_action_processing_ms": 0.04763312040801061}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 940000, "timers": {"sample_time_ms": 9692.804, "sample_throughput": 412.677, "learn_time_ms": 11798.568, "learn_throughput": 339.024, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 6.742754280567169, "policy_loss": -0.034836306120269, "vf_loss": 6.773429647088051, "vf_explained_var": 0.31757986545562744, "kl": 0.00608147015736904, "entropy": 0.10144372214563191, "entropy_coeff": 0.0}}, "num_steps_sampled": 940000, "num_steps_trained": 940000}, "done": false, "episodes_total": 94, "training_iteration": 235, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-20-45", "timestamp": 1618143645, "time_this_iter_s": 19.89106583595276, "time_total_s": 4981.502882242203, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686afd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b694a590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4981.502882242203, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 58.70357142857143, "ram_util_percent": 27.396428571428565}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2145.0, "episode_reward_min": 2145.0, "episode_reward_mean": 2145.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2145.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6352203865489026, "mean_raw_obs_processing_ms": 0.09793835351233078, "mean_inference_ms": 1.5938324314437666, "mean_action_processing_ms": 0.04763312040801061}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 944000, "timers": {"sample_time_ms": 9485.017, "sample_throughput": 421.718, "learn_time_ms": 11785.335, "learn_throughput": 339.405, "update_time_ms": 3.186}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 16.434584468603134, "policy_loss": -0.019884660869138315, "vf_loss": 16.446908175945282, "vf_explained_var": 0.4898023307323456, "kl": 0.011051265813875943, "entropy": 0.11972106504254043, "entropy_coeff": 0.0}}, "num_steps_sampled": 944000, "num_steps_trained": 944000}, "done": false, "episodes_total": 94, "training_iteration": 236, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-21-05", "timestamp": 1618143665, "time_this_iter_s": 20.215604782104492, "time_total_s": 5001.718487024307, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5001.718487024307, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 57.6655172413793, "ram_util_percent": 27.303448275862063}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2145.0, "episode_reward_min": 2145.0, "episode_reward_mean": 2145.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2145.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6352203865489026, "mean_raw_obs_processing_ms": 0.09793835351233078, "mean_inference_ms": 1.5938324314437666, "mean_action_processing_ms": 0.04763312040801061}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 948000, "timers": {"sample_time_ms": 9385.995, "sample_throughput": 426.167, "learn_time_ms": 11815.951, "learn_throughput": 338.525, "update_time_ms": 3.202}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 11.628310024738312, "policy_loss": -0.033036685548722744, "vf_loss": 11.656023383140564, "vf_explained_var": 0.5163389444351196, "kl": 0.0077806221233913675, "entropy": 0.1594609327148646, "entropy_coeff": 0.0}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 94, "training_iteration": 237, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-21-24", "timestamp": 1618143684, "time_this_iter_s": 19.268200397491455, "time_total_s": 5020.986687421799, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5020.986687421799, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 58.71071428571429, "ram_util_percent": 27.353571428571424}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1256.0, "episode_reward_min": 1256.0, "episode_reward_mean": 1256.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1256.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6303877915559607, "mean_raw_obs_processing_ms": 0.09826422159661323, "mean_inference_ms": 1.5939117341105773, "mean_action_processing_ms": 0.04763946818343432}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 952000, "timers": {"sample_time_ms": 9468.276, "sample_throughput": 422.463, "learn_time_ms": 11816.971, "learn_throughput": 338.496, "update_time_ms": 3.237}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 11.515454828739166, "policy_loss": -0.029535814392147586, "vf_loss": 11.538889557123184, "vf_explained_var": 0.5111933946609497, "kl": 0.008916795501136221, "entropy": 0.12732840632088482, "entropy_coeff": 0.0}}, "num_steps_sampled": 952000, "num_steps_trained": 952000}, "done": false, "episodes_total": 95, "training_iteration": 238, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-21-45", "timestamp": 1618143705, "time_this_iter_s": 20.546504735946655, "time_total_s": 5041.533192157745, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5041.533192157745, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 58.85172413793103, "ram_util_percent": 27.327586206896544}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1256.0, "episode_reward_min": 1256.0, "episode_reward_mean": 1256.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1256.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6303877915559607, "mean_raw_obs_processing_ms": 0.09826422159661323, "mean_inference_ms": 1.5939117341105773, "mean_action_processing_ms": 0.04763946818343432}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 956000, "timers": {"sample_time_ms": 9204.028, "sample_throughput": 434.592, "learn_time_ms": 11814.644, "learn_throughput": 338.563, "update_time_ms": 3.269}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 11.96319779753685, "policy_loss": -0.03608097409596667, "vf_loss": 11.993938237428665, "vf_explained_var": 0.48234665393829346, "kl": 0.007805418717907742, "entropy": 0.12896105577237904, "entropy_coeff": 0.0}}, "num_steps_sampled": 956000, "num_steps_trained": 956000}, "done": false, "episodes_total": 95, "training_iteration": 239, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-22-06", "timestamp": 1618143726, "time_this_iter_s": 20.691766500473022, "time_total_s": 5062.224958658218, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69522d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5062.224958658218, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 58.69333333333332, "ram_util_percent": 27.299999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1930.0, "episode_reward_min": 1930.0, "episode_reward_mean": 1930.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1930.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6284996427301155, "mean_raw_obs_processing_ms": 0.09852330778124335, "mean_inference_ms": 1.5943693051066117, "mean_action_processing_ms": 0.04765856616335246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 960000, "timers": {"sample_time_ms": 8917.118, "sample_throughput": 448.575, "learn_time_ms": 11832.458, "learn_throughput": 338.053, "update_time_ms": 3.273}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 7.011429712176323, "policy_loss": -0.025528418889734894, "vf_loss": 7.032346233725548, "vf_explained_var": 0.35575035214424133, "kl": 0.006740401964634657, "entropy": 0.09542813524603844, "entropy_coeff": 0.0}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 96, "training_iteration": 240, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-22-27", "timestamp": 1618143747, "time_this_iter_s": 20.787765502929688, "time_total_s": 5083.012724161148, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686a990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5083.012724161148, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 58.599999999999994, "ram_util_percent": 27.38275862068965}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1930.0, "episode_reward_min": 1930.0, "episode_reward_mean": 1930.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1930.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6284996427301155, "mean_raw_obs_processing_ms": 0.09852330778124335, "mean_inference_ms": 1.5943693051066117, "mean_action_processing_ms": 0.04765856616335246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 964000, "timers": {"sample_time_ms": 8801.772, "sample_throughput": 454.454, "learn_time_ms": 11819.571, "learn_throughput": 338.422, "update_time_ms": 3.308}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 9.937777161598206, "policy_loss": -0.02742814924567938, "vf_loss": 9.960945442318916, "vf_explained_var": 0.383508563041687, "kl": 0.0062258343532448635, "entropy": 0.10032418556511402, "entropy_coeff": 0.0}}, "num_steps_sampled": 964000, "num_steps_trained": 964000}, "done": false, "episodes_total": 96, "training_iteration": 241, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-22-48", "timestamp": 1618143768, "time_this_iter_s": 21.130765676498413, "time_total_s": 5104.1434898376465, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5104.1434898376465, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 57.68333333333332, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1930.0, "episode_reward_min": 1930.0, "episode_reward_mean": 1930.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1930.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6284996427301155, "mean_raw_obs_processing_ms": 0.09852330778124335, "mean_inference_ms": 1.5943693051066117, "mean_action_processing_ms": 0.04765856616335246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 968000, "timers": {"sample_time_ms": 8828.946, "sample_throughput": 453.055, "learn_time_ms": 11737.975, "learn_throughput": 340.774, "update_time_ms": 3.241}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 11.767827332019806, "policy_loss": -0.026904256257694215, "vf_loss": 11.788951635360718, "vf_explained_var": 0.4917950928211212, "kl": 0.008448060092632659, "entropy": 0.1640674825757742, "entropy_coeff": 0.0}}, "num_steps_sampled": 968000, "num_steps_trained": 968000}, "done": false, "episodes_total": 96, "training_iteration": 242, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-23-07", "timestamp": 1618143787, "time_this_iter_s": 19.64491605758667, "time_total_s": 5123.788405895233, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b0d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723bad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5123.788405895233, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 58.76206896551725, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1945.0, "episode_reward_min": 1945.0, "episode_reward_mean": 1945.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1945.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6250693197773444, "mean_raw_obs_processing_ms": 0.09885895113775901, "mean_inference_ms": 1.594294008660773, "mean_action_processing_ms": 0.0476580623019376}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 972000, "timers": {"sample_time_ms": 8635.743, "sample_throughput": 463.191, "learn_time_ms": 11734.534, "learn_throughput": 340.874, "update_time_ms": 3.219}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 10.182373732328415, "policy_loss": -0.025415700976736844, "vf_loss": 10.202931761741638, "vf_explained_var": 0.44627517461776733, "kl": 0.007099529699189588, "entropy": 0.10833058366551995, "entropy_coeff": 0.0}}, "num_steps_sampled": 972000, "num_steps_trained": 972000}, "done": false, "episodes_total": 97, "training_iteration": 243, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-23-27", "timestamp": 1618143807, "time_this_iter_s": 19.87334442138672, "time_total_s": 5143.66175031662, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cdb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5143.66175031662, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 58.564285714285724, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1945.0, "episode_reward_min": 1945.0, "episode_reward_mean": 1945.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1945.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6250693197773444, "mean_raw_obs_processing_ms": 0.09885895113775901, "mean_inference_ms": 1.594294008660773, "mean_action_processing_ms": 0.0476580623019376}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 976000, "timers": {"sample_time_ms": 8418.392, "sample_throughput": 475.15, "learn_time_ms": 11801.875, "learn_throughput": 338.929, "update_time_ms": 3.175}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 9.663977593183517, "policy_loss": -0.028185672272229567, "vf_loss": 9.687137186527252, "vf_explained_var": 0.3791445195674896, "kl": 0.007345733836700674, "entropy": 0.12386510078795254, "entropy_coeff": 0.0}}, "num_steps_sampled": 976000, "num_steps_trained": 976000}, "done": false, "episodes_total": 97, "training_iteration": 244, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-23-48", "timestamp": 1618143828, "time_this_iter_s": 20.250946283340454, "time_total_s": 5163.91269659996, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697be10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5163.91269659996, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 58.686206896551724, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1459.0, "episode_reward_min": 1459.0, "episode_reward_mean": 1459.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1459.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6220637686095547, "mean_raw_obs_processing_ms": 0.09910243392824274, "mean_inference_ms": 1.5943269695330673, "mean_action_processing_ms": 0.04766481946421085}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 980000, "timers": {"sample_time_ms": 8446.475, "sample_throughput": 473.57, "learn_time_ms": 11790.612, "learn_throughput": 339.253, "update_time_ms": 3.206}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 13.612895876169205, "policy_loss": -0.041263048886321485, "vf_loss": 13.646879732608795, "vf_explained_var": 0.6504324078559875, "kl": 0.010638874082360417, "entropy": 0.2498278971761465, "entropy_coeff": 0.0}}, "num_steps_sampled": 980000, "num_steps_trained": 980000}, "done": false, "episodes_total": 98, "training_iteration": 245, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-24-08", "timestamp": 1618143848, "time_this_iter_s": 20.057118892669678, "time_total_s": 5183.96981549263, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5183.96981549263, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 58.04827586206897, "ram_util_percent": 27.32413793103448}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1459.0, "episode_reward_min": 1459.0, "episode_reward_mean": 1459.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1459.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6220637686095547, "mean_raw_obs_processing_ms": 0.09910243392824274, "mean_inference_ms": 1.5943269695330673, "mean_action_processing_ms": 0.04766481946421085}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 984000, "timers": {"sample_time_ms": 8493.478, "sample_throughput": 470.95, "learn_time_ms": 11755.222, "learn_throughput": 340.274, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 11.687282368540764, "policy_loss": -0.04482447780901566, "vf_loss": 11.71322338283062, "vf_explained_var": 0.7984585762023926, "kl": 0.027598841057624668, "entropy": 0.16013507451862097, "entropy_coeff": 0.0}}, "num_steps_sampled": 984000, "num_steps_trained": 984000}, "done": false, "episodes_total": 98, "training_iteration": 246, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-24-28", "timestamp": 1618143868, "time_this_iter_s": 20.328426361083984, "time_total_s": 5204.298241853714, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5204.298241853714, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 58.4, "ram_util_percent": 27.32068965517241}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1459.0, "episode_reward_min": 1459.0, "episode_reward_mean": 1459.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1459.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6220637686095547, "mean_raw_obs_processing_ms": 0.09910243392824274, "mean_inference_ms": 1.5943269695330673, "mean_action_processing_ms": 0.04766481946421085}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 988000, "timers": {"sample_time_ms": 8587.102, "sample_throughput": 465.815, "learn_time_ms": 11794.28, "learn_throughput": 339.147, "update_time_ms": 3.061}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5e-05, "total_loss": 18.365272998809814, "policy_loss": -0.03002554876729846, "vf_loss": 18.389592587947845, "vf_explained_var": 0.5255163908004761, "kl": 0.00555985596292885, "entropy": 0.15261798026040196, "entropy_coeff": 0.0}}, "num_steps_sampled": 988000, "num_steps_trained": 988000}, "done": false, "episodes_total": 98, "training_iteration": 247, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-24-49", "timestamp": 1618143889, "time_this_iter_s": 20.59848976135254, "time_total_s": 5224.8967316150665, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d58d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5224.8967316150665, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 58.841379310344834, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1637.0, "episode_reward_min": 1637.0, "episode_reward_mean": 1637.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1637.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6182269530835214, "mean_raw_obs_processing_ms": 0.09941794747568553, "mean_inference_ms": 1.5941013510800002, "mean_action_processing_ms": 0.047661580648355344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 992000, "timers": {"sample_time_ms": 8481.561, "sample_throughput": 471.611, "learn_time_ms": 11805.061, "learn_throughput": 338.838, "update_time_ms": 2.99}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5e-05, "total_loss": 12.395419180393219, "policy_loss": -0.022399084526114166, "vf_loss": 12.412888556718826, "vf_explained_var": 0.5851559042930603, "kl": 0.004803193238331005, "entropy": 0.1545958041679114, "entropy_coeff": 0.0}}, "num_steps_sampled": 992000, "num_steps_trained": 992000}, "done": false, "episodes_total": 99, "training_iteration": 248, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-25-08", "timestamp": 1618143908, "time_this_iter_s": 19.596180200576782, "time_total_s": 5244.492911815643, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5244.492911815643, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 58.621428571428574, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1637.0, "episode_reward_min": 1637.0, "episode_reward_mean": 1637.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1637.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6182269530835214, "mean_raw_obs_processing_ms": 0.09941794747568553, "mean_inference_ms": 1.5941013510800002, "mean_action_processing_ms": 0.047661580648355344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 996000, "timers": {"sample_time_ms": 8326.049, "sample_throughput": 480.42, "learn_time_ms": 11814.649, "learn_throughput": 338.563, "update_time_ms": 2.961}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 15.28381821513176, "policy_loss": -0.04228334466461092, "vf_loss": 15.321381449699402, "vf_explained_var": 0.42813506722450256, "kl": 0.009197807492455468, "entropy": 0.17413518158718944, "entropy_coeff": 0.0}}, "num_steps_sampled": 996000, "num_steps_trained": 996000}, "done": false, "episodes_total": 99, "training_iteration": 249, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-25-28", "timestamp": 1618143928, "time_this_iter_s": 19.23263669013977, "time_total_s": 5263.725548505783, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5263.725548505783, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 58.00000000000001, "ram_util_percent": 27.38518518518518}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1583.0, "episode_reward_min": 1583.0, "episode_reward_mean": 1583.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6148138275823364, "mean_raw_obs_processing_ms": 0.09957794197555533, "mean_inference_ms": 1.5935921885943196, "mean_action_processing_ms": 0.0476507606835899}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1000000, "timers": {"sample_time_ms": 8205.013, "sample_throughput": 487.507, "learn_time_ms": 11841.552, "learn_throughput": 337.794, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 9.657657101750374, "policy_loss": -0.026726988464361057, "vf_loss": 9.6803759932518, "vf_explained_var": 0.4608986973762512, "kl": 0.0078109990718076006, "entropy": 0.13879533135332167, "entropy_coeff": 0.0}}, "num_steps_sampled": 1000000, "num_steps_trained": 1000000}, "done": false, "episodes_total": 100, "training_iteration": 250, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-25-47", "timestamp": 1618143947, "time_this_iter_s": 19.84583020210266, "time_total_s": 5283.571378707886, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b694a1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723bad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5283.571378707886, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 58.54827586206897, "ram_util_percent": 27.34482758620689}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1583.0, "episode_reward_min": 1583.0, "episode_reward_mean": 1583.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6148138275823364, "mean_raw_obs_processing_ms": 0.09957794197555533, "mean_inference_ms": 1.5935921885943196, "mean_action_processing_ms": 0.0476507606835899}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1004000, "timers": {"sample_time_ms": 7991.613, "sample_throughput": 500.525, "learn_time_ms": 11874.121, "learn_throughput": 336.867, "update_time_ms": 2.915}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 55.5042062997818, "policy_loss": -0.03139811591245234, "vf_loss": 55.53015971183777, "vf_explained_var": -0.1346266269683838, "kl": 0.010609432254568674, "entropy": 0.28581816609948874, "entropy_coeff": 0.0}}, "num_steps_sampled": 1004000, "num_steps_trained": 1004000}, "done": false, "episodes_total": 100, "training_iteration": 251, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-26-07", "timestamp": 1618143967, "time_this_iter_s": 19.32453465461731, "time_total_s": 5302.895913362503, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8dd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5302.895913362503, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 57.91851851851852, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1583.0, "episode_reward_min": 1583.0, "episode_reward_mean": 1583.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6148138275823364, "mean_raw_obs_processing_ms": 0.09957794197555533, "mean_inference_ms": 1.5935921885943196, "mean_action_processing_ms": 0.0476507606835899}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1008000, "timers": {"sample_time_ms": 8089.126, "sample_throughput": 494.491, "learn_time_ms": 11870.72, "learn_throughput": 336.964, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 39.77329480648041, "policy_loss": -0.043228990922216326, "vf_loss": 39.81186783313751, "vf_explained_var": 0.20752719044685364, "kl": 0.009073721346794628, "entropy": 0.20493471948429942, "entropy_coeff": 0.0}}, "num_steps_sampled": 1008000, "num_steps_trained": 1008000}, "done": false, "episodes_total": 100, "training_iteration": 252, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-26-27", "timestamp": 1618143987, "time_this_iter_s": 20.588128805160522, "time_total_s": 5323.484042167664, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6937550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5323.484042167664, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 58.94333333333334, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -826.0, "episode_reward_min": -826.0, "episode_reward_mean": -826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6101000207815817, "mean_raw_obs_processing_ms": 0.09992921749746454, "mean_inference_ms": 1.5938458593292049, "mean_action_processing_ms": 0.047664670859372746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1012000, "timers": {"sample_time_ms": 8083.033, "sample_throughput": 494.864, "learn_time_ms": 11925.102, "learn_throughput": 335.427, "update_time_ms": 2.944}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 14.390531867742538, "policy_loss": -0.037798715638928115, "vf_loss": 14.423546522855759, "vf_explained_var": 0.638217031955719, "kl": 0.009323367310571484, "entropy": 0.174154884647578, "entropy_coeff": 0.0}}, "num_steps_sampled": 1012000, "num_steps_trained": 1012000}, "done": false, "episodes_total": 101, "training_iteration": 253, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-26-48", "timestamp": 1618144008, "time_this_iter_s": 20.35632586479187, "time_total_s": 5343.840368032455, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f7360b947d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5343.840368032455, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 58.8206896551724, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -826.0, "episode_reward_min": -826.0, "episode_reward_mean": -826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6101000207815817, "mean_raw_obs_processing_ms": 0.09992921749746454, "mean_inference_ms": 1.5938458593292049, "mean_action_processing_ms": 0.047664670859372746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1016000, "timers": {"sample_time_ms": 8146.766, "sample_throughput": 490.992, "learn_time_ms": 11863.205, "learn_throughput": 337.177, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 20.176415741443634, "policy_loss": -0.021202433214057237, "vf_loss": 20.193876445293427, "vf_explained_var": 0.5063439607620239, "kl": 0.007291277899639681, "entropy": 0.12116338056512177, "entropy_coeff": 0.0}}, "num_steps_sampled": 1016000, "num_steps_trained": 1016000}, "done": false, "episodes_total": 101, "training_iteration": 254, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-27-08", "timestamp": 1618144028, "time_this_iter_s": 20.265380859375, "time_total_s": 5364.10574889183, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6937ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691fd90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5364.10574889183, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 58.46896551724138, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1912.0, "episode_reward_min": -1912.0, "episode_reward_mean": -1912.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1912.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6095791317060437, "mean_raw_obs_processing_ms": 0.10012369320691639, "mean_inference_ms": 1.5940067457804796, "mean_action_processing_ms": 0.04765715274423095}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1020000, "timers": {"sample_time_ms": 8320.656, "sample_throughput": 480.731, "learn_time_ms": 11871.039, "learn_throughput": 336.955, "update_time_ms": 2.968}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 11.723535418510437, "policy_loss": -0.025396454497240484, "vf_loss": 11.744872987270355, "vf_explained_var": 0.3437461256980896, "kl": 0.00791000285971677, "entropy": 0.10232707299292088, "entropy_coeff": 0.0}}, "num_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 102, "training_iteration": 255, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-27-30", "timestamp": 1618144050, "time_this_iter_s": 21.87456464767456, "time_total_s": 5385.980313539505, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5385.980313539505, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 59.15806451612903, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1912.0, "episode_reward_min": -1912.0, "episode_reward_mean": -1912.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1912.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6095791317060437, "mean_raw_obs_processing_ms": 0.10012369320691639, "mean_inference_ms": 1.5940067457804796, "mean_action_processing_ms": 0.04765715274423095}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1024000, "timers": {"sample_time_ms": 8682.92, "sample_throughput": 460.675, "learn_time_ms": 11882.367, "learn_throughput": 336.633, "update_time_ms": 2.955}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 6.938884735107422, "policy_loss": -0.021507694385945797, "vf_loss": 6.956995248794556, "vf_explained_var": 0.1272338330745697, "kl": 0.006620056876272429, "entropy": 0.09428457077592611, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 102, "training_iteration": 256, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-27-54", "timestamp": 1618144074, "time_this_iter_s": 24.065350770950317, "time_total_s": 5410.045664310455, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b04d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5410.045664310455, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 58.0529411764706, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1912.0, "episode_reward_min": -1912.0, "episode_reward_mean": -1912.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1912.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6095791317060437, "mean_raw_obs_processing_ms": 0.10012369320691639, "mean_inference_ms": 1.5940067457804796, "mean_action_processing_ms": 0.04765715274423095}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1028000, "timers": {"sample_time_ms": 9085.355, "sample_throughput": 440.269, "learn_time_ms": 11817.757, "learn_throughput": 338.474, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 5.373874917626381, "policy_loss": -0.01400419679703191, "vf_loss": 5.384146958589554, "vf_explained_var": 0.3861275911331177, "kl": 0.007272957718669204, "entropy": 0.09220627776812762, "entropy_coeff": 0.0}}, "num_steps_sampled": 1028000, "num_steps_trained": 1028000}, "done": false, "episodes_total": 102, "training_iteration": 257, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-28-18", "timestamp": 1618144098, "time_this_iter_s": 23.97442102432251, "time_total_s": 5434.020085334778, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a045d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5434.020085334778, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 58.3, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -2225.0, "episode_reward_min": -2225.0, "episode_reward_mean": -2225.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2225.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6161583109060765, "mean_raw_obs_processing_ms": 0.10047692628082984, "mean_inference_ms": 1.5943951176169724, "mean_action_processing_ms": 0.04767228074960056}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1032000, "timers": {"sample_time_ms": 9435.959, "sample_throughput": 423.91, "learn_time_ms": 11856.765, "learn_throughput": 337.36, "update_time_ms": 2.985}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 7.2592688500881195, "policy_loss": -0.027508262952324003, "vf_loss": 7.28203259408474, "vf_explained_var": 0.4000255763530731, "kl": 0.009245820139767602, "entropy": 0.11205986072309315, "entropy_coeff": 0.0}}, "num_steps_sampled": 1032000, "num_steps_trained": 1032000}, "done": false, "episodes_total": 103, "training_iteration": 258, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-28-42", "timestamp": 1618144122, "time_this_iter_s": 23.49644112586975, "time_total_s": 5457.516526460648, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5457.516526460648, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 58.4030303030303, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -2225.0, "episode_reward_min": -2225.0, "episode_reward_mean": -2225.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2225.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6161583109060765, "mean_raw_obs_processing_ms": 0.10047692628082984, "mean_inference_ms": 1.5943951176169724, "mean_action_processing_ms": 0.04767228074960056}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1036000, "timers": {"sample_time_ms": 9869.54, "sample_throughput": 405.287, "learn_time_ms": 11832.454, "learn_throughput": 338.053, "update_time_ms": 2.966}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 10.470845609903336, "policy_loss": -0.015024693857412785, "vf_loss": 10.482290923595428, "vf_explained_var": 0.5509754419326782, "kl": 0.006975323798542377, "entropy": 0.10342682641930878, "entropy_coeff": 0.0}}, "num_steps_sampled": 1036000, "num_steps_trained": 1036000}, "done": false, "episodes_total": 103, "training_iteration": 259, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-29-05", "timestamp": 1618144145, "time_this_iter_s": 23.32498550415039, "time_total_s": 5480.841511964798, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cdad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5480.841511964798, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 58.10909090909092, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1971.0, "episode_reward_min": -1971.0, "episode_reward_mean": -1971.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1971.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6192704990715404, "mean_raw_obs_processing_ms": 0.10070580739452958, "mean_inference_ms": 1.5944754869399362, "mean_action_processing_ms": 0.04767754674551005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1040000, "timers": {"sample_time_ms": 10169.754, "sample_throughput": 393.323, "learn_time_ms": 11800.917, "learn_throughput": 338.957, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 7.5214866399765015, "policy_loss": -0.01565921795554459, "vf_loss": 7.532867223024368, "vf_explained_var": 0.4025871157646179, "kl": 0.008337880892213434, "entropy": 0.11499742371961474, "entropy_coeff": 0.0}}, "num_steps_sampled": 1040000, "num_steps_trained": 1040000}, "done": false, "episodes_total": 104, "training_iteration": 260, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-29-27", "timestamp": 1618144167, "time_this_iter_s": 22.53370451927185, "time_total_s": 5503.37521648407, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6948190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5503.37521648407, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 58.663636363636364, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1971.0, "episode_reward_min": -1971.0, "episode_reward_mean": -1971.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1971.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6192704990715404, "mean_raw_obs_processing_ms": 0.10070580739452958, "mean_inference_ms": 1.5944754869399362, "mean_action_processing_ms": 0.04767754674551005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1044000, "timers": {"sample_time_ms": 10239.286, "sample_throughput": 390.652, "learn_time_ms": 11788.794, "learn_throughput": 339.305, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 10.60717487335205, "policy_loss": -0.02729059406556189, "vf_loss": 10.629825353622437, "vf_explained_var": 0.39199185371398926, "kl": 0.009042034856975079, "entropy": 0.12786017265170813, "entropy_coeff": 0.0}}, "num_steps_sampled": 1044000, "num_steps_trained": 1044000}, "done": false, "episodes_total": 104, "training_iteration": 261, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-29-47", "timestamp": 1618144187, "time_this_iter_s": 19.899301052093506, "time_total_s": 5523.274517536163, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691ffd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5523.274517536163, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 58.04642857142856, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1971.0, "episode_reward_min": -1971.0, "episode_reward_mean": -1971.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1971.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6192704990715404, "mean_raw_obs_processing_ms": 0.10070580739452958, "mean_inference_ms": 1.5944754869399362, "mean_action_processing_ms": 0.04767754674551005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1048000, "timers": {"sample_time_ms": 10151.795, "sample_throughput": 394.019, "learn_time_ms": 11818.385, "learn_throughput": 338.456, "update_time_ms": 2.999}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 12.618181467056274, "policy_loss": -0.03177184780361131, "vf_loss": 12.64475193619728, "vf_explained_var": 0.6274675130844116, "kl": 0.01013557644910179, "entropy": 0.16964733554050326, "entropy_coeff": 0.0}}, "num_steps_sampled": 1048000, "num_steps_trained": 1048000}, "done": false, "episodes_total": 104, "training_iteration": 262, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-30-07", "timestamp": 1618144207, "time_this_iter_s": 20.005841732025146, "time_total_s": 5543.2803592681885, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5543.2803592681885, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 58.76896551724138, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1465.0, "episode_reward_min": -1465.0, "episode_reward_mean": -1465.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1465.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6155735948006937, "mean_raw_obs_processing_ms": 0.10099640554130129, "mean_inference_ms": 1.594294116081351, "mean_action_processing_ms": 0.04768234310171849}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1052000, "timers": {"sample_time_ms": 10214.353, "sample_throughput": 391.606, "learn_time_ms": 11763.498, "learn_throughput": 340.035, "update_time_ms": 2.986}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 10.585495695471764, "policy_loss": -0.025983152154367417, "vf_loss": 10.606455117464066, "vf_explained_var": 0.5292282104492188, "kl": 0.009789688105229288, "entropy": 0.14482686528936028, "entropy_coeff": 0.0}}, "num_steps_sampled": 1052000, "num_steps_trained": 1052000}, "done": false, "episodes_total": 105, "training_iteration": 263, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-30-28", "timestamp": 1618144228, "time_this_iter_s": 20.43018913269043, "time_total_s": 5563.710548400879, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6884250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6884b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5563.710548400879, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 58.93448275862069, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1465.0, "episode_reward_min": -1465.0, "episode_reward_mean": -1465.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1465.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6155735948006937, "mean_raw_obs_processing_ms": 0.10099640554130129, "mean_inference_ms": 1.594294116081351, "mean_action_processing_ms": 0.04768234310171849}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1056000, "timers": {"sample_time_ms": 10366.25, "sample_throughput": 385.868, "learn_time_ms": 11767.139, "learn_throughput": 339.93, "update_time_ms": 2.982}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 13.78353664278984, "policy_loss": -0.020312470325734466, "vf_loss": 13.799647212028503, "vf_explained_var": 0.47826603055000305, "kl": 0.008188185223843902, "entropy": 0.12913108826614916, "entropy_coeff": 0.0}}, "num_steps_sampled": 1056000, "num_steps_trained": 1056000}, "done": false, "episodes_total": 105, "training_iteration": 264, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-30-50", "timestamp": 1618144250, "time_this_iter_s": 21.82328963279724, "time_total_s": 5585.533838033676, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68841d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5585.533838033676, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 58.21935483870967, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1370.0, "episode_reward_min": -1370.0, "episode_reward_mean": -1370.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1370.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164717468068479, "mean_raw_obs_processing_ms": 0.10117383760015206, "mean_inference_ms": 1.5939248497968859, "mean_action_processing_ms": 0.04767557113444159}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1060000, "timers": {"sample_time_ms": 10311.806, "sample_throughput": 387.905, "learn_time_ms": 11780.772, "learn_throughput": 339.536, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 10.010544463992119, "policy_loss": -0.02376521154656075, "vf_loss": 10.029849275946617, "vf_explained_var": 0.826899528503418, "kl": 0.008692303134012036, "entropy": 0.1106096429284662, "entropy_coeff": 0.0}}, "num_steps_sampled": 1060000, "num_steps_trained": 1060000}, "done": false, "episodes_total": 106, "training_iteration": 265, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-31-11", "timestamp": 1618144271, "time_this_iter_s": 21.46882152557373, "time_total_s": 5607.00265955925, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5607.00265955925, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 57.983870967741936, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1370.0, "episode_reward_min": -1370.0, "episode_reward_mean": -1370.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1370.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164717468068479, "mean_raw_obs_processing_ms": 0.10117383760015206, "mean_inference_ms": 1.5939248497968859, "mean_action_processing_ms": 0.04767557113444159}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1064000, "timers": {"sample_time_ms": 9948.9, "sample_throughput": 402.054, "learn_time_ms": 11812.436, "learn_throughput": 338.626, "update_time_ms": 2.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 26.357766807079315, "policy_loss": -0.03091335977660492, "vf_loss": 26.384268403053284, "vf_explained_var": 0.47307121753692627, "kl": 0.008597376814577729, "entropy": 0.06459886557422578, "entropy_coeff": 0.0}}, "num_steps_sampled": 1064000, "num_steps_trained": 1064000}, "done": false, "episodes_total": 106, "training_iteration": 266, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-31-32", "timestamp": 1618144292, "time_this_iter_s": 20.75305151939392, "time_total_s": 5627.755711078644, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697b490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5627.755711078644, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 58.70689655172414, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1370.0, "episode_reward_min": -1370.0, "episode_reward_mean": -1370.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1370.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6164717468068479, "mean_raw_obs_processing_ms": 0.10117383760015206, "mean_inference_ms": 1.5939248497968859, "mean_action_processing_ms": 0.04767557113444159}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1068000, "timers": {"sample_time_ms": 9670.661, "sample_throughput": 413.622, "learn_time_ms": 11852.561, "learn_throughput": 337.48, "update_time_ms": 2.934}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 13.3690747320652, "policy_loss": -0.050548910396173596, "vf_loss": 13.413700997829437, "vf_explained_var": 0.37948501110076904, "kl": 0.011541487037902698, "entropy": 0.2632369166240096, "entropy_coeff": 0.0}}, "num_steps_sampled": 1068000, "num_steps_trained": 1068000}, "done": false, "episodes_total": 106, "training_iteration": 267, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-31-54", "timestamp": 1618144314, "time_this_iter_s": 21.59350895881653, "time_total_s": 5649.34922003746, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5649.34922003746, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 58.548387096774185, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1296.0, "episode_reward_min": -1296.0, "episode_reward_mean": -1296.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1296.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6178157635795696, "mean_raw_obs_processing_ms": 0.10149203025395558, "mean_inference_ms": 1.5940150934849473, "mean_action_processing_ms": 0.047679522815388245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1072000, "timers": {"sample_time_ms": 9752.055, "sample_throughput": 410.17, "learn_time_ms": 11808.456, "learn_throughput": 338.74, "update_time_ms": 2.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 8.605624049901962, "policy_loss": -0.03989387914771214, "vf_loss": 8.640579640865326, "vf_explained_var": 0.28833186626434326, "kl": 0.00962340879777912, "entropy": 0.23137327982112765, "entropy_coeff": 0.0}}, "num_steps_sampled": 1072000, "num_steps_trained": 1072000}, "done": false, "episodes_total": 107, "training_iteration": 268, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-32-18", "timestamp": 1618144338, "time_this_iter_s": 23.868685007095337, "time_total_s": 5673.217905044556, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5673.217905044556, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 58.17647058823529, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1296.0, "episode_reward_min": -1296.0, "episode_reward_mean": -1296.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1296.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6178157635795696, "mean_raw_obs_processing_ms": 0.10149203025395558, "mean_inference_ms": 1.5940150934849473, "mean_action_processing_ms": 0.047679522815388245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1076000, "timers": {"sample_time_ms": 9554.2, "sample_throughput": 418.664, "learn_time_ms": 11840.676, "learn_throughput": 337.819, "update_time_ms": 2.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 11.92309096455574, "policy_loss": -0.039809750800486654, "vf_loss": 11.95815822482109, "vf_explained_var": 0.5892548561096191, "kl": 0.009241764870239422, "entropy": 0.24353475822135806, "entropy_coeff": 0.0}}, "num_steps_sampled": 1076000, "num_steps_trained": 1076000}, "done": false, "episodes_total": 107, "training_iteration": 269, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-32-39", "timestamp": 1618144359, "time_this_iter_s": 21.670467376708984, "time_total_s": 5694.888372421265, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a090d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f4e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5694.888372421265, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 58.819354838709664, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1200.0, "episode_reward_min": -1200.0, "episode_reward_mean": -1200.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1200.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6172835482326138, "mean_raw_obs_processing_ms": 0.10173794522994743, "mean_inference_ms": 1.5943033072699575, "mean_action_processing_ms": 0.047689651995919784}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1080000, "timers": {"sample_time_ms": 9398.567, "sample_throughput": 425.597, "learn_time_ms": 11843.162, "learn_throughput": 337.748, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 8.002754852175713, "policy_loss": -0.04329155852610711, "vf_loss": 8.04010485112667, "vf_explained_var": 0.8239442706108093, "kl": 0.011578166551771574, "entropy": 0.30637615313753486, "entropy_coeff": 0.0}}, "num_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 108, "training_iteration": 270, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-33-00", "timestamp": 1618144380, "time_this_iter_s": 21.00001859664917, "time_total_s": 5715.888391017914, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6884ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68847d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5715.888391017914, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 58.99333333333334, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1200.0, "episode_reward_min": -1200.0, "episode_reward_mean": -1200.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1200.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6172835482326138, "mean_raw_obs_processing_ms": 0.10173794522994743, "mean_inference_ms": 1.5943033072699575, "mean_action_processing_ms": 0.047689651995919784}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1084000, "timers": {"sample_time_ms": 9535.811, "sample_throughput": 419.471, "learn_time_ms": 11833.501, "learn_throughput": 338.023, "update_time_ms": 2.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 13.527657836675644, "policy_loss": -0.03228675841819495, "vf_loss": 13.55556669831276, "vf_explained_var": 0.37523263692855835, "kl": 0.008531369065167382, "entropy": 0.2401237883605063, "entropy_coeff": 0.0}}, "num_steps_sampled": 1084000, "num_steps_trained": 1084000}, "done": false, "episodes_total": 108, "training_iteration": 271, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-33-21", "timestamp": 1618144401, "time_this_iter_s": 21.172235250473022, "time_total_s": 5737.060626268387, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5737.060626268387, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 58.53, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1200.0, "episode_reward_min": -1200.0, "episode_reward_mean": -1200.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1200.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6172835482326138, "mean_raw_obs_processing_ms": 0.10173794522994743, "mean_inference_ms": 1.5943033072699575, "mean_action_processing_ms": 0.047689651995919784}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1088000, "timers": {"sample_time_ms": 9783.411, "sample_throughput": 408.855, "learn_time_ms": 11822.47, "learn_throughput": 338.339, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 6.882036671042442, "policy_loss": -0.035977799678221345, "vf_loss": 6.912228748202324, "vf_explained_var": 0.7518005967140198, "kl": 0.011274924501776695, "entropy": 0.26770116621628404, "entropy_coeff": 0.0}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 108, "training_iteration": 272, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-33-44", "timestamp": 1618144424, "time_this_iter_s": 22.371620416641235, "time_total_s": 5759.432246685028, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5759.432246685028, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 58.325, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1272.0, "episode_reward_min": -1272.0, "episode_reward_mean": -1272.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1272.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6195412220220807, "mean_raw_obs_processing_ms": 0.10199707925390467, "mean_inference_ms": 1.5937995679474788, "mean_action_processing_ms": 0.04766914915713134}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1092000, "timers": {"sample_time_ms": 9991.816, "sample_throughput": 400.328, "learn_time_ms": 11816.014, "learn_throughput": 338.524, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 8.59485550224781, "policy_loss": -0.059432525478769094, "vf_loss": 8.647654414176941, "vf_explained_var": 0.38314422965049744, "kl": 0.01292730399291031, "entropy": 0.31476384587585926, "entropy_coeff": 0.0}}, "num_steps_sampled": 1092000, "num_steps_trained": 1092000}, "done": false, "episodes_total": 109, "training_iteration": 273, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-34-06", "timestamp": 1618144446, "time_this_iter_s": 22.449313163757324, "time_total_s": 5781.881559848785, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6884d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a048d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5781.881559848785, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 58.1875, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1272.0, "episode_reward_min": -1272.0, "episode_reward_mean": -1272.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1272.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6195412220220807, "mean_raw_obs_processing_ms": 0.10199707925390467, "mean_inference_ms": 1.5937995679474788, "mean_action_processing_ms": 0.04766914915713134}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1096000, "timers": {"sample_time_ms": 9881.191, "sample_throughput": 404.809, "learn_time_ms": 11802.664, "learn_throughput": 338.907, "update_time_ms": 2.831}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 8.001904413104057, "policy_loss": -0.046578898560255766, "vf_loss": 8.04257994890213, "vf_explained_var": 0.44438183307647705, "kl": 0.011503884830744937, "entropy": 0.35022107046097517, "entropy_coeff": 0.0}}, "num_steps_sampled": 1096000, "num_steps_trained": 1096000}, "done": false, "episodes_total": 109, "training_iteration": 274, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-34-27", "timestamp": 1618144467, "time_this_iter_s": 20.583816289901733, "time_total_s": 5802.465376138687, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b02d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5802.465376138687, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 58.53999999999999, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1162.0, "episode_reward_min": -1162.0, "episode_reward_mean": -1162.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6173450937416346, "mean_raw_obs_processing_ms": 0.10219285127728964, "mean_inference_ms": 1.5936694148813593, "mean_action_processing_ms": 0.04766508971086927}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1100000, "timers": {"sample_time_ms": 9686.062, "sample_throughput": 412.965, "learn_time_ms": 11819.277, "learn_throughput": 338.43, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 7.950502574443817, "policy_loss": -0.05380995775340125, "vf_loss": 7.998515740036964, "vf_explained_var": 0.5861042737960815, "kl": 0.0112964865838876, "entropy": 0.38035658840090036, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 110, "training_iteration": 275, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-34-47", "timestamp": 1618144487, "time_this_iter_s": 19.682718992233276, "time_total_s": 5822.14809513092, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6884390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5822.14809513092, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 58.725, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1162.0, "episode_reward_min": -1162.0, "episode_reward_mean": -1162.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6173450937416346, "mean_raw_obs_processing_ms": 0.10219285127728964, "mean_inference_ms": 1.5936694148813593, "mean_action_processing_ms": 0.04766508971086927}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1104000, "timers": {"sample_time_ms": 9884.914, "sample_throughput": 404.657, "learn_time_ms": 11790.04, "learn_throughput": 339.269, "update_time_ms": 2.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 10.223042100667953, "policy_loss": -0.054821359051857144, "vf_loss": 10.271547585725784, "vf_explained_var": 0.24865826964378357, "kl": 0.012307997880270705, "entropy": 0.33811640553176403, "entropy_coeff": 0.0}}, "num_steps_sampled": 1104000, "num_steps_trained": 1104000}, "done": false, "episodes_total": 110, "training_iteration": 276, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-35-09", "timestamp": 1618144509, "time_this_iter_s": 22.447516679763794, "time_total_s": 5844.595611810684, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5844.595611810684, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 58.003125, "ram_util_percent": 27.4}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1162.0, "episode_reward_min": -1162.0, "episode_reward_mean": -1162.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6173450937416346, "mean_raw_obs_processing_ms": 0.10219285127728964, "mean_inference_ms": 1.5936694148813593, "mean_action_processing_ms": 0.04766508971086927}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1108000, "timers": {"sample_time_ms": 9943.222, "sample_throughput": 402.284, "learn_time_ms": 11753.954, "learn_throughput": 340.311, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 8.740737706422806, "policy_loss": -0.05443299820763059, "vf_loss": 8.788305684924126, "vf_explained_var": 0.4369108974933624, "kl": 0.01337793908896856, "entropy": 0.35472411662340164, "entropy_coeff": 0.0}}, "num_steps_sampled": 1108000, "num_steps_trained": 1108000}, "done": false, "episodes_total": 110, "training_iteration": 277, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-35-31", "timestamp": 1618144531, "time_this_iter_s": 21.817211151123047, "time_total_s": 5866.412822961807, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bdfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5866.412822961807, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 58.14838709677419, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1126.0, "episode_reward_min": -1126.0, "episode_reward_mean": -1126.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1126.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6178293808406542, "mean_raw_obs_processing_ms": 0.10249591862146772, "mean_inference_ms": 1.5935619649519759, "mean_action_processing_ms": 0.04765838880037859}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1112000, "timers": {"sample_time_ms": 9574.333, "sample_throughput": 417.784, "learn_time_ms": 11762.424, "learn_throughput": 340.066, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 8.252390637993813, "policy_loss": -0.042201685428153723, "vf_loss": 8.289039731025696, "vf_explained_var": 0.5711374282836914, "kl": 0.01082025183859514, "entropy": 0.22385742352344096, "entropy_coeff": 0.0}}, "num_steps_sampled": 1112000, "num_steps_trained": 1112000}, "done": false, "episodes_total": 111, "training_iteration": 278, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-35-51", "timestamp": 1618144551, "time_this_iter_s": 20.262407541275024, "time_total_s": 5886.675230503082, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686a890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5886.675230503082, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 58.565517241379304, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1126.0, "episode_reward_min": -1126.0, "episode_reward_mean": -1126.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1126.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6178293808406542, "mean_raw_obs_processing_ms": 0.10249591862146772, "mean_inference_ms": 1.5935619649519759, "mean_action_processing_ms": 0.04765838880037859}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1116000, "timers": {"sample_time_ms": 9455.674, "sample_throughput": 423.026, "learn_time_ms": 11763.389, "learn_throughput": 340.038, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 7.552607163786888, "policy_loss": -0.052513555565383285, "vf_loss": 7.599311172962189, "vf_explained_var": 0.625811755657196, "kl": 0.011321059937472455, "entropy": 0.40285237319767475, "entropy_coeff": 0.0}}, "num_steps_sampled": 1116000, "num_steps_trained": 1116000}, "done": false, "episodes_total": 111, "training_iteration": 279, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-36-12", "timestamp": 1618144572, "time_this_iter_s": 20.495431423187256, "time_total_s": 5907.1706619262695, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686aad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5907.1706619262695, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 58.37586206896551, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -593.0, "episode_reward_min": -593.0, "episode_reward_mean": -593.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6152594437375354, "mean_raw_obs_processing_ms": 0.10274235799212901, "mean_inference_ms": 1.5938419427067816, "mean_action_processing_ms": 0.04767115181103291}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1120000, "timers": {"sample_time_ms": 9345.979, "sample_throughput": 427.992, "learn_time_ms": 11780.424, "learn_throughput": 339.546, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 7.930674359202385, "policy_loss": -0.06557748088380322, "vf_loss": 7.989603787660599, "vf_explained_var": 0.4456177353858948, "kl": 0.012955274927662686, "entropy": 0.397277956828475, "entropy_coeff": 0.0}}, "num_steps_sampled": 1120000, "num_steps_trained": 1120000}, "done": false, "episodes_total": 112, "training_iteration": 280, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-36-32", "timestamp": 1618144592, "time_this_iter_s": 20.077224016189575, "time_total_s": 5927.247885942459, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697be10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5927.247885942459, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 58.84827586206895, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -593.0, "episode_reward_min": -593.0, "episode_reward_mean": -593.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6152594437375354, "mean_raw_obs_processing_ms": 0.10274235799212901, "mean_inference_ms": 1.5938419427067816, "mean_action_processing_ms": 0.04767115181103291}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1124000, "timers": {"sample_time_ms": 9269.798, "sample_throughput": 431.509, "learn_time_ms": 11762.512, "learn_throughput": 340.063, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 2.500079058110714, "policy_loss": -0.044114896620158106, "vf_loss": 2.5357268303632736, "vf_explained_var": 0.5295922160148621, "kl": 0.016500003781402484, "entropy": 0.404116646386683, "entropy_coeff": 0.0}}, "num_steps_sampled": 1124000, "num_steps_trained": 1124000}, "done": false, "episodes_total": 112, "training_iteration": 281, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-36-52", "timestamp": 1618144612, "time_this_iter_s": 20.234480381011963, "time_total_s": 5947.482366323471, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68ebf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691fbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5947.482366323471, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 58.73793103448275, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -593.0, "episode_reward_min": -593.0, "episode_reward_mean": -593.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6152594437375354, "mean_raw_obs_processing_ms": 0.10274235799212901, "mean_inference_ms": 1.5938419427067816, "mean_action_processing_ms": 0.04767115181103291}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1128000, "timers": {"sample_time_ms": 9107.238, "sample_throughput": 439.211, "learn_time_ms": 11821.18, "learn_throughput": 338.376, "update_time_ms": 2.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 4.690706916153431, "policy_loss": -0.06813175132265314, "vf_loss": 4.7528108805418015, "vf_explained_var": 0.6568062901496887, "kl": 0.011746370641048998, "entropy": 0.4376973630860448, "entropy_coeff": 0.0}}, "num_steps_sampled": 1128000, "num_steps_trained": 1128000}, "done": false, "episodes_total": 112, "training_iteration": 282, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-37-14", "timestamp": 1618144634, "time_this_iter_s": 21.340837955474854, "time_total_s": 5968.823204278946, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68e29d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68e2190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5968.823204278946, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 59.35806451612902, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -517.0, "episode_reward_min": -517.0, "episode_reward_mean": -517.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-517.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6123805344083442, "mean_raw_obs_processing_ms": 0.10310100046633439, "mean_inference_ms": 1.594206376845301, "mean_action_processing_ms": 0.04769041112200487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1132000, "timers": {"sample_time_ms": 8885.066, "sample_throughput": 450.194, "learn_time_ms": 11857.307, "learn_throughput": 337.345, "update_time_ms": 2.98}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 6.08590704202652, "policy_loss": -0.05385320674395189, "vf_loss": 6.133203163743019, "vf_explained_var": 0.4063321053981781, "kl": 0.012777939613442868, "entropy": 0.35100523103028536, "entropy_coeff": 0.0}}, "num_steps_sampled": 1132000, "num_steps_trained": 1132000}, "done": false, "episodes_total": 113, "training_iteration": 283, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-37-34", "timestamp": 1618144654, "time_this_iter_s": 20.592676162719727, "time_total_s": 5989.415880441666, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b9628350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5989.415880441666, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 58.827586206896555, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -517.0, "episode_reward_min": -517.0, "episode_reward_mean": -517.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-517.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6123805344083442, "mean_raw_obs_processing_ms": 0.10310100046633439, "mean_inference_ms": 1.594206376845301, "mean_action_processing_ms": 0.04769041112200487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1136000, "timers": {"sample_time_ms": 8827.684, "sample_throughput": 453.12, "learn_time_ms": 11883.021, "learn_throughput": 336.615, "update_time_ms": 3.003}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 3.3042448237538338, "policy_loss": -0.06808611686574295, "vf_loss": 3.3645124211907387, "vf_explained_var": 0.7168821692466736, "kl": 0.01523609590367414, "entropy": 0.4710159804672003, "entropy_coeff": 0.0}}, "num_steps_sampled": 1136000, "num_steps_trained": 1136000}, "done": false, "episodes_total": 113, "training_iteration": 284, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-37-54", "timestamp": 1618144674, "time_this_iter_s": 20.265134811401367, "time_total_s": 6009.681015253067, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6009.681015253067, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 58.07931034482758, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -496.0, "episode_reward_min": -496.0, "episode_reward_mean": -496.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-496.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6097074091856469, "mean_raw_obs_processing_ms": 0.10329093028922623, "mean_inference_ms": 1.5940443480419306, "mean_action_processing_ms": 0.0476840192808869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1140000, "timers": {"sample_time_ms": 8813.236, "sample_throughput": 453.863, "learn_time_ms": 11869.258, "learn_throughput": 337.005, "update_time_ms": 3.047}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 2.148063961416483, "policy_loss": -0.046546929399482906, "vf_loss": 2.18743465654552, "vf_explained_var": 0.5774041414260864, "kl": 0.013984485762193799, "entropy": 0.4258885309100151, "entropy_coeff": 0.0}}, "num_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 114, "training_iteration": 285, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-38-14", "timestamp": 1618144694, "time_this_iter_s": 19.403197288513184, "time_total_s": 6029.08421254158, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f9d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6029.08421254158, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 58.76785714285713, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -496.0, "episode_reward_min": -496.0, "episode_reward_mean": -496.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-496.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6097074091856469, "mean_raw_obs_processing_ms": 0.10329093028922623, "mean_inference_ms": 1.5940443480419306, "mean_action_processing_ms": 0.0476840192808869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1144000, "timers": {"sample_time_ms": 8540.813, "sample_throughput": 468.339, "learn_time_ms": 11887.346, "learn_throughput": 336.492, "update_time_ms": 3.064}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 2.3400129675865173, "policy_loss": -0.04802041522634681, "vf_loss": 2.3811596296727657, "vf_explained_var": 0.6602777242660522, "kl": 0.013395033805863932, "entropy": 0.4272303069010377, "entropy_coeff": 0.0}}, "num_steps_sampled": 1144000, "num_steps_trained": 1144000}, "done": false, "episodes_total": 114, "training_iteration": 286, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-38-34", "timestamp": 1618144714, "time_this_iter_s": 19.904316425323486, "time_total_s": 6048.988528966904, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a96d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6048.988528966904, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 58.521428571428565, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -496.0, "episode_reward_min": -496.0, "episode_reward_mean": -496.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-496.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6097074091856469, "mean_raw_obs_processing_ms": 0.10329093028922623, "mean_inference_ms": 1.5940443480419306, "mean_action_processing_ms": 0.0476840192808869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1148000, "timers": {"sample_time_ms": 8331.371, "sample_throughput": 480.113, "learn_time_ms": 11899.594, "learn_throughput": 336.146, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 3.0075794756412506, "policy_loss": -0.05744164744100999, "vf_loss": 3.055443197488785, "vf_explained_var": 0.5208190083503723, "kl": 0.01866475274437107, "entropy": 0.4526927238330245, "entropy_coeff": 0.0}}, "num_steps_sampled": 1148000, "num_steps_trained": 1148000}, "done": false, "episodes_total": 114, "training_iteration": 287, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-38-54", "timestamp": 1618144734, "time_this_iter_s": 19.846029043197632, "time_total_s": 6068.834558010101, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fa10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6068.834558010101, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 58.69642857142856, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -333.0, "episode_reward_min": -333.0, "episode_reward_mean": -333.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6056008080074581, "mean_raw_obs_processing_ms": 0.10356583500351425, "mean_inference_ms": 1.593842103237429, "mean_action_processing_ms": 0.04767372770481084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1152000, "timers": {"sample_time_ms": 8265.555, "sample_throughput": 483.936, "learn_time_ms": 11897.069, "learn_throughput": 336.217, "update_time_ms": 3.073}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 1.250050861388445, "policy_loss": -0.04547972267027944, "vf_loss": 1.2875023484230042, "vf_explained_var": 0.2921285927295685, "kl": 0.01564483920810744, "entropy": 0.30244680773466825, "entropy_coeff": 0.0}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 115, "training_iteration": 288, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-39-13", "timestamp": 1618144753, "time_this_iter_s": 19.580787181854248, "time_total_s": 6088.415345191956, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68e29d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6088.415345191956, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 58.785714285714285, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -333.0, "episode_reward_min": -333.0, "episode_reward_mean": -333.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6056008080074581, "mean_raw_obs_processing_ms": 0.10356583500351425, "mean_inference_ms": 1.593842103237429, "mean_action_processing_ms": 0.04767372770481084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1156000, "timers": {"sample_time_ms": 8168.076, "sample_throughput": 489.711, "learn_time_ms": 11882.534, "learn_throughput": 336.629, "update_time_ms": 3.08}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 1.3661719355732203, "policy_loss": -0.041297732037492096, "vf_loss": 1.4014035146683455, "vf_explained_var": 0.5929309129714966, "kl": 0.011821226828033105, "entropy": 0.47469924855977297, "entropy_coeff": 0.0}}, "num_steps_sampled": 1156000, "num_steps_trained": 1156000}, "done": false, "episodes_total": 115, "training_iteration": 289, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-39-33", "timestamp": 1618144773, "time_this_iter_s": 19.37168836593628, "time_total_s": 6107.787033557892, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6107.787033557892, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 58.164285714285704, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -207.0, "episode_reward_min": -207.0, "episode_reward_mean": -207.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6028086470401041, "mean_raw_obs_processing_ms": 0.10371172900888019, "mean_inference_ms": 1.593331743536796, "mean_action_processing_ms": 0.04765416180757788}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1160000, "timers": {"sample_time_ms": 8115.523, "sample_throughput": 492.883, "learn_time_ms": 11870.362, "learn_throughput": 336.974, "update_time_ms": 3.118}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 1.2378417905420065, "policy_loss": -0.05137672234559432, "vf_loss": 1.2806139457970858, "vf_explained_var": 0.5613677501678467, "kl": 0.016767915920354426, "entropy": 0.48400659672915936, "entropy_coeff": 0.0}}, "num_steps_sampled": 1160000, "num_steps_trained": 1160000}, "done": false, "episodes_total": 116, "training_iteration": 290, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-39-52", "timestamp": 1618144792, "time_this_iter_s": 19.42955255508423, "time_total_s": 6127.216586112976, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686af90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6127.216586112976, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 58.82142857142857, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -207.0, "episode_reward_min": -207.0, "episode_reward_mean": -207.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6028086470401041, "mean_raw_obs_processing_ms": 0.10371172900888019, "mean_inference_ms": 1.593331743536796, "mean_action_processing_ms": 0.04765416180757788}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1164000, "timers": {"sample_time_ms": 8052.449, "sample_throughput": 496.743, "learn_time_ms": 11904.007, "learn_throughput": 336.021, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.7686416199430823, "policy_loss": -0.05789125931914896, "vf_loss": 0.820041467435658, "vf_explained_var": 0.72357577085495, "kl": 0.012649956974200904, "entropy": 0.422718602232635, "entropy_coeff": 0.0}}, "num_steps_sampled": 1164000, "num_steps_trained": 1164000}, "done": false, "episodes_total": 116, "training_iteration": 291, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-40-12", "timestamp": 1618144812, "time_this_iter_s": 19.938575744628906, "time_total_s": 6147.155161857605, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8df90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6147.155161857605, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 59.02142857142858, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -207.0, "episode_reward_min": -207.0, "episode_reward_mean": -207.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6028086470401041, "mean_raw_obs_processing_ms": 0.10371172900888019, "mean_inference_ms": 1.593331743536796, "mean_action_processing_ms": 0.04765416180757788}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1168000, "timers": {"sample_time_ms": 7910.639, "sample_throughput": 505.648, "learn_time_ms": 11846.011, "learn_throughput": 337.666, "update_time_ms": 3.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 1.9752972200512886, "policy_loss": -0.05341388989472762, "vf_loss": 2.022225681692362, "vf_explained_var": 0.5735788345336914, "kl": 0.012638306739972904, "entropy": 0.3966122893616557, "entropy_coeff": 0.0}}, "num_steps_sampled": 1168000, "num_steps_trained": 1168000}, "done": false, "episodes_total": 116, "training_iteration": 292, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-40-31", "timestamp": 1618144831, "time_this_iter_s": 19.333880186080933, "time_total_s": 6166.489042043686, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b9628490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6166.489042043686, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 57.792857142857144, "ram_util_percent": 27.40357142857142}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -209.0, "episode_reward_min": -209.0, "episode_reward_mean": -209.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5986629584188671, "mean_raw_obs_processing_ms": 0.10396257662312347, "mean_inference_ms": 1.5928939487174387, "mean_action_processing_ms": 0.047635134617982126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1172000, "timers": {"sample_time_ms": 7832.261, "sample_throughput": 510.708, "learn_time_ms": 11820.003, "learn_throughput": 338.409, "update_time_ms": 3.065}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.6078432174399495, "policy_loss": -0.04764977836748585, "vf_loss": 0.6479664873331785, "vf_explained_var": 0.42875880002975464, "kl": 0.01466706075007096, "entropy": 0.5244193598628044, "entropy_coeff": 0.0}}, "num_steps_sampled": 1172000, "num_steps_trained": 1172000}, "done": false, "episodes_total": 117, "training_iteration": 293, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-40-51", "timestamp": 1618144851, "time_this_iter_s": 19.547338247299194, "time_total_s": 6186.036380290985, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b72289d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fe90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6186.036380290985, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 59.025, "ram_util_percent": 27.449999999999996}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -209.0, "episode_reward_min": -209.0, "episode_reward_mean": -209.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5986629584188671, "mean_raw_obs_processing_ms": 0.10396257662312347, "mean_inference_ms": 1.5928939487174387, "mean_action_processing_ms": 0.047635134617982126}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1176000, "timers": {"sample_time_ms": 7752.088, "sample_throughput": 515.99, "learn_time_ms": 11827.209, "learn_throughput": 338.203, "update_time_ms": 3.086}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.5342453494668007, "policy_loss": -0.05181961634662002, "vf_loss": 0.5784267717972398, "vf_explained_var": 0.4926270842552185, "kl": 0.014884705800795928, "entropy": 0.4111325163394213, "entropy_coeff": 0.0}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 117, "training_iteration": 294, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-41-11", "timestamp": 1618144871, "time_this_iter_s": 19.536367893218994, "time_total_s": 6205.572748184204, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68ebb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6205.572748184204, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 58.17142857142858, "ram_util_percent": 27.49642857142857}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -93.0, "episode_reward_min": -93.0, "episode_reward_mean": -93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.595942794152186, "mean_raw_obs_processing_ms": 0.10412664014630736, "mean_inference_ms": 1.5926012453681788, "mean_action_processing_ms": 0.04762151084934383}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1180000, "timers": {"sample_time_ms": 7785.618, "sample_throughput": 513.768, "learn_time_ms": 11848.242, "learn_throughput": 337.603, "update_time_ms": 3.071}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.6263493625447154, "policy_loss": -0.04877559543820098, "vf_loss": 0.6677355859428644, "vf_explained_var": 0.5623092651367188, "kl": 0.014399820123799145, "entropy": 0.4401637641713023, "entropy_coeff": 0.0}}, "num_steps_sampled": 1180000, "num_steps_trained": 1180000}, "done": false, "episodes_total": 118, "training_iteration": 295, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-41-31", "timestamp": 1618144891, "time_this_iter_s": 19.94717025756836, "time_total_s": 6225.5199184417725, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6225.5199184417725, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 58.99285714285715, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -93.0, "episode_reward_min": -93.0, "episode_reward_mean": -93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.595942794152186, "mean_raw_obs_processing_ms": 0.10412664014630736, "mean_inference_ms": 1.5926012453681788, "mean_action_processing_ms": 0.04762151084934383}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1184000, "timers": {"sample_time_ms": 7934.119, "sample_throughput": 504.152, "learn_time_ms": 11831.945, "learn_throughput": 338.068, "update_time_ms": 3.131}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.35920495132450014, "policy_loss": -0.04028614770504646, "vf_loss": 0.3941594334319234, "vf_explained_var": 0.7957025170326233, "kl": 0.01038993195106741, "entropy": 0.45372886024415493, "entropy_coeff": 0.0}}, "num_steps_sampled": 1184000, "num_steps_trained": 1184000}, "done": false, "episodes_total": 118, "training_iteration": 296, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-41-52", "timestamp": 1618144912, "time_this_iter_s": 21.227805614471436, "time_total_s": 6246.747724056244, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69520d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6246.747724056244, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 58.84193548387096, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -93.0, "episode_reward_min": -93.0, "episode_reward_mean": -93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.595942794152186, "mean_raw_obs_processing_ms": 0.10412664014630736, "mean_inference_ms": 1.5926012453681788, "mean_action_processing_ms": 0.04762151084934383}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1188000, "timers": {"sample_time_ms": 7937.042, "sample_throughput": 503.966, "learn_time_ms": 11857.872, "learn_throughput": 337.329, "update_time_ms": 3.115}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.19017579592764378, "policy_loss": -0.0190687442664057, "vf_loss": 0.2051100074313581, "vf_explained_var": 0.20213335752487183, "kl": 0.008057053142692894, "entropy": 0.33604465052485466, "entropy_coeff": 0.0}}, "num_steps_sampled": 1188000, "num_steps_trained": 1188000}, "done": false, "episodes_total": 118, "training_iteration": 297, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-42-12", "timestamp": 1618144932, "time_this_iter_s": 20.131495714187622, "time_total_s": 6266.8792197704315, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68e2fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6266.8792197704315, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 59.26071428571428, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -39.0, "episode_reward_min": -39.0, "episode_reward_mean": -39.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5926742395986779, "mean_raw_obs_processing_ms": 0.10450074130499178, "mean_inference_ms": 1.5932948909823657, "mean_action_processing_ms": 0.047659102522933976}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1192000, "timers": {"sample_time_ms": 7975.908, "sample_throughput": 501.51, "learn_time_ms": 11864.702, "learn_throughput": 337.134, "update_time_ms": 3.262}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.2136778841377236, "policy_loss": -0.0425462243729271, "vf_loss": 0.2482829955406487, "vf_explained_var": 0.5747168660163879, "kl": 0.015475030581001192, "entropy": 0.4434355106204748, "entropy_coeff": 0.0}}, "num_steps_sampled": 1192000, "num_steps_trained": 1192000}, "done": false, "episodes_total": 119, "training_iteration": 298, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-42-32", "timestamp": 1618144952, "time_this_iter_s": 20.037633895874023, "time_total_s": 6286.9168536663055, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68e2d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6286.9168536663055, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 57.84137931034482, "ram_util_percent": 27.49655172413793}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -39.0, "episode_reward_min": -39.0, "episode_reward_mean": -39.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5926742395986779, "mean_raw_obs_processing_ms": 0.10450074130499178, "mean_inference_ms": 1.5932948909823657, "mean_action_processing_ms": 0.047659102522933976}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1196000, "timers": {"sample_time_ms": 8026.135, "sample_throughput": 498.372, "learn_time_ms": 11873.055, "learn_throughput": 336.897, "update_time_ms": 3.293}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.38132290728390217, "policy_loss": -0.05194940586807206, "vf_loss": 0.42532804794609547, "vf_explained_var": 0.6278496980667114, "kl": 0.015481171489227563, "entropy": 0.47962492145597935, "entropy_coeff": 0.0}}, "num_steps_sampled": 1196000, "num_steps_trained": 1196000}, "done": false, "episodes_total": 119, "training_iteration": 299, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-42-52", "timestamp": 1618144972, "time_this_iter_s": 19.957725524902344, "time_total_s": 6306.874579191208, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6306.874579191208, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 58.903571428571425, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -75.0, "episode_reward_min": -75.0, "episode_reward_mean": -75.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5905395631189243, "mean_raw_obs_processing_ms": 0.10472812130817212, "mean_inference_ms": 1.5933565950350086, "mean_action_processing_ms": 0.04766682089783002}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1200000, "timers": {"sample_time_ms": 8114.348, "sample_throughput": 492.954, "learn_time_ms": 11852.947, "learn_throughput": 337.469, "update_time_ms": 3.242}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.30698988516815007, "policy_loss": -0.03660355374449864, "vf_loss": 0.33461145870387554, "vf_explained_var": 0.45278677344322205, "kl": 0.017503365757875144, "entropy": 0.5499011129140854, "entropy_coeff": 0.0}}, "num_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 120, "training_iteration": 300, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-43-12", "timestamp": 1618144992, "time_this_iter_s": 20.11057424545288, "time_total_s": 6326.985153436661, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69f96d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6326.985153436661, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 59.07241379310345, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -75.0, "episode_reward_min": -75.0, "episode_reward_mean": -75.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5905395631189243, "mean_raw_obs_processing_ms": 0.10472812130817212, "mean_inference_ms": 1.5933565950350086, "mean_action_processing_ms": 0.04766682089783002}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1204000, "timers": {"sample_time_ms": 8095.599, "sample_throughput": 494.096, "learn_time_ms": 11837.087, "learn_throughput": 337.921, "update_time_ms": 3.244}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 0.09692865546094254, "policy_loss": -0.058775956684257835, "vf_loss": 0.14139402215369046, "vf_explained_var": 0.38260191679000854, "kl": 0.027887360600288957, "entropy": 0.5326879378408194, "entropy_coeff": 0.0}}, "num_steps_sampled": 1204000, "num_steps_trained": 1204000}, "done": false, "episodes_total": 120, "training_iteration": 301, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-43-32", "timestamp": 1618145012, "time_this_iter_s": 19.595619678497314, "time_total_s": 6346.580773115158, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cded0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6346.580773115158, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 58.00714285714287, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -75.0, "episode_reward_min": -75.0, "episode_reward_mean": -75.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5905395631189243, "mean_raw_obs_processing_ms": 0.10472812130817212, "mean_inference_ms": 1.5933565950350086, "mean_action_processing_ms": 0.04766682089783002}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1208000, "timers": {"sample_time_ms": 8186.836, "sample_throughput": 488.589, "learn_time_ms": 11842.664, "learn_throughput": 337.762, "update_time_ms": 3.243}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.35986891598440707, "policy_loss": -0.06032243784284219, "vf_loss": 0.4097096864134073, "vf_explained_var": 0.5735350847244263, "kl": 0.013617230957606807, "entropy": 0.5146525101736188, "entropy_coeff": 0.0}}, "num_steps_sampled": 1208000, "num_steps_trained": 1208000}, "done": false, "episodes_total": 120, "training_iteration": 302, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-43-52", "timestamp": 1618145032, "time_this_iter_s": 20.305020809173584, "time_total_s": 6366.885793924332, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68db710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68db8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6366.885793924332, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 58.782758620689656, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -66.0, "episode_reward_min": -66.0, "episode_reward_mean": -66.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5873407157959494, "mean_raw_obs_processing_ms": 0.10499028947857128, "mean_inference_ms": 1.5929047854570444, "mean_action_processing_ms": 0.047649856672431684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1212000, "timers": {"sample_time_ms": 8198.374, "sample_throughput": 487.902, "learn_time_ms": 11842.505, "learn_throughput": 337.766, "update_time_ms": 3.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.24110970459878445, "policy_loss": -0.04298110265517607, "vf_loss": 0.27234035870060325, "vf_explained_var": 0.38782474398612976, "kl": 0.015265573121723719, "entropy": 0.40897767152637243, "entropy_coeff": 0.0}}, "num_steps_sampled": 1212000, "num_steps_trained": 1212000}, "done": false, "episodes_total": 121, "training_iteration": 303, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-44-12", "timestamp": 1618145052, "time_this_iter_s": 19.661938667297363, "time_total_s": 6386.547732591629, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691fe90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6386.547732591629, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 58.63928571428573, "ram_util_percent": 27.399999999999995}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -66.0, "episode_reward_min": -66.0, "episode_reward_mean": -66.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5873407157959494, "mean_raw_obs_processing_ms": 0.10499028947857128, "mean_inference_ms": 1.5929047854570444, "mean_action_processing_ms": 0.047649856672431684}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1216000, "timers": {"sample_time_ms": 8257.4, "sample_throughput": 484.414, "learn_time_ms": 11834.123, "learn_throughput": 338.006, "update_time_ms": 3.245}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.0987902263586875, "policy_loss": -0.03563886880874634, "vf_loss": 0.12792991870082915, "vf_explained_var": 0.40399643778800964, "kl": 0.00844339397008298, "entropy": 0.5683501716703176, "entropy_coeff": 0.0}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 121, "training_iteration": 304, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-44-32", "timestamp": 1618145072, "time_this_iter_s": 20.04215955734253, "time_total_s": 6406.589892148972, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69003d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6406.589892148972, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 58.89310344827586, "ram_util_percent": 27.39999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -27.0, "episode_reward_min": -27.0, "episode_reward_mean": -27.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5851870295547464, "mean_raw_obs_processing_ms": 0.10515046451267378, "mean_inference_ms": 1.5925277468522068, "mean_action_processing_ms": 0.04763438080313285}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1220000, "timers": {"sample_time_ms": 8236.235, "sample_throughput": 485.659, "learn_time_ms": 11814.56, "learn_throughput": 338.565, "update_time_ms": 3.25}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.218547836644575, "policy_loss": -0.043986577715259045, "vf_loss": 0.25607931381091475, "vf_explained_var": 0.45501279830932617, "kl": 0.008386129382415675, "entropy": 0.4493424417451024, "entropy_coeff": 0.0}}, "num_steps_sampled": 1220000, "num_steps_trained": 1220000}, "done": false, "episodes_total": 122, "training_iteration": 305, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-44-51", "timestamp": 1618145091, "time_this_iter_s": 19.539491415023804, "time_total_s": 6426.129383563995, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6426.129383563995, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 57.989285714285714, "ram_util_percent": 27.49642857142857}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -27.0, "episode_reward_min": -27.0, "episode_reward_mean": -27.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5851870295547464, "mean_raw_obs_processing_ms": 0.10515046451267378, "mean_inference_ms": 1.5925277468522068, "mean_action_processing_ms": 0.04763438080313285}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1224000, "timers": {"sample_time_ms": 8191.267, "sample_throughput": 488.325, "learn_time_ms": 11803.609, "learn_throughput": 338.879, "update_time_ms": 3.175}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.05529563961317763, "policy_loss": -0.04231900308514014, "vf_loss": 0.08920111623592675, "vf_explained_var": 0.6875372529029846, "kl": 0.010930413322057575, "entropy": 0.5670297518372536, "entropy_coeff": 0.0}}, "num_steps_sampled": 1224000, "num_steps_trained": 1224000}, "done": false, "episodes_total": 122, "training_iteration": 306, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-45-12", "timestamp": 1618145112, "time_this_iter_s": 20.66660451889038, "time_total_s": 6446.795988082886, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6446.795988082886, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 58.94827586206897, "ram_util_percent": 27.40344827586206}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -27.0, "episode_reward_min": -27.0, "episode_reward_mean": -27.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5851870295547464, "mean_raw_obs_processing_ms": 0.10515046451267378, "mean_inference_ms": 1.5925277468522068, "mean_action_processing_ms": 0.04763438080313285}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1228000, "timers": {"sample_time_ms": 8211.631, "sample_throughput": 487.114, "learn_time_ms": 11788.327, "learn_throughput": 339.319, "update_time_ms": 3.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.1486457110149786, "policy_loss": -0.044317651307210326, "vf_loss": 0.1829660446383059, "vf_explained_var": 0.5048778057098389, "kl": 0.012987988884560764, "entropy": 0.5151990698650479, "entropy_coeff": 0.0}}, "num_steps_sampled": 1228000, "num_steps_trained": 1228000}, "done": false, "episodes_total": 122, "training_iteration": 307, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-45-32", "timestamp": 1618145132, "time_this_iter_s": 20.181589365005493, "time_total_s": 6466.977577447891, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68e2f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6466.977577447891, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 59.10689655172415, "ram_util_percent": 27.49655172413793}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -33.0, "episode_reward_min": -33.0, "episode_reward_mean": -33.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5821629045133082, "mean_raw_obs_processing_ms": 0.10551578298689665, "mean_inference_ms": 1.59296965378465, "mean_action_processing_ms": 0.04765564205541044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1232000, "timers": {"sample_time_ms": 8212.29, "sample_throughput": 487.075, "learn_time_ms": 11793.83, "learn_throughput": 339.16, "update_time_ms": 3.103}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.10622452944517136, "policy_loss": -0.036816450010519475, "vf_loss": 0.13433772511780262, "vf_explained_var": 0.5101211667060852, "kl": 0.011306810920359567, "entropy": 0.520301784388721, "entropy_coeff": 0.0}}, "num_steps_sampled": 1232000, "num_steps_trained": 1232000}, "done": false, "episodes_total": 123, "training_iteration": 308, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-45-53", "timestamp": 1618145153, "time_this_iter_s": 20.100648403167725, "time_total_s": 6487.078225851059, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6487.078225851059, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 58.13103448275862, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -33.0, "episode_reward_min": -33.0, "episode_reward_mean": -33.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5821629045133082, "mean_raw_obs_processing_ms": 0.10551578298689665, "mean_inference_ms": 1.59296965378465, "mean_action_processing_ms": 0.04765564205541044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1236000, "timers": {"sample_time_ms": 8222.478, "sample_throughput": 486.471, "learn_time_ms": 11802.682, "learn_throughput": 338.906, "update_time_ms": 3.083}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.021613791352137923, "policy_loss": -0.0422762036905624, "vf_loss": 0.055744551587849855, "vf_explained_var": 0.6775771379470825, "kl": 0.010582131173578091, "entropy": 0.5478679779917002, "entropy_coeff": 0.0}}, "num_steps_sampled": 1236000, "num_steps_trained": 1236000}, "done": false, "episodes_total": 123, "training_iteration": 309, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-46-13", "timestamp": 1618145173, "time_this_iter_s": 20.148103952407837, "time_total_s": 6507.226329803467, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68e2c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6507.226329803467, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 59.12758620689654, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -4.0, "episode_reward_min": -4.0, "episode_reward_mean": -4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5798257529801948, "mean_raw_obs_processing_ms": 0.10574275956667634, "mean_inference_ms": 1.593356273439509, "mean_action_processing_ms": 0.04767336653959521}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1240000, "timers": {"sample_time_ms": 8213.078, "sample_throughput": 487.028, "learn_time_ms": 11828.885, "learn_throughput": 338.155, "update_time_ms": 3.138}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.11774110549595207, "policy_loss": -0.0325868173094932, "vf_loss": 0.13943131011910737, "vf_explained_var": 0.266525000333786, "kl": 0.014156305929645896, "entropy": 0.6106132958084345, "entropy_coeff": 0.0}}, "num_steps_sampled": 1240000, "num_steps_trained": 1240000}, "done": false, "episodes_total": 124, "training_iteration": 310, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-46-33", "timestamp": 1618145193, "time_this_iter_s": 20.278881549835205, "time_total_s": 6527.505211353302, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69527d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6527.505211353302, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 59.40344827586207, "ram_util_percent": 27.47586206896551}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -4.0, "episode_reward_min": -4.0, "episode_reward_mean": -4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5798257529801948, "mean_raw_obs_processing_ms": 0.10574275956667634, "mean_inference_ms": 1.593356273439509, "mean_action_processing_ms": 0.04767336653959521}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1244000, "timers": {"sample_time_ms": 8271.59, "sample_throughput": 483.583, "learn_time_ms": 11832.771, "learn_throughput": 338.044, "update_time_ms": 3.135}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.042583959409967065, "policy_loss": -0.02314828592352569, "vf_loss": 0.05930397263728082, "vf_explained_var": 0.4840605854988098, "kl": 0.008351278578629717, "entropy": 0.4980509215965867, "entropy_coeff": 0.0}}, "num_steps_sampled": 1244000, "num_steps_trained": 1244000}, "done": false, "episodes_total": 124, "training_iteration": 311, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-46-53", "timestamp": 1618145213, "time_this_iter_s": 20.21737790107727, "time_total_s": 6547.722589254379, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a5ca50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686a610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6547.722589254379, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 58.339285714285715, "ram_util_percent": 27.48928571428571}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -4.0, "episode_reward_min": -4.0, "episode_reward_mean": -4.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5798257529801948, "mean_raw_obs_processing_ms": 0.10574275956667634, "mean_inference_ms": 1.593356273439509, "mean_action_processing_ms": 0.04767336653959521}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1248000, "timers": {"sample_time_ms": 8229.745, "sample_throughput": 486.042, "learn_time_ms": 11872.894, "learn_throughput": 336.902, "update_time_ms": 3.11}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": -0.00769904931075871, "policy_loss": -0.015891306538833305, "vf_loss": 0.002701361765502952, "vf_explained_var": -0.0939219519495964, "kl": 0.0071334853491862305, "entropy": 0.4732446139678359, "entropy_coeff": 0.0}}, "num_steps_sampled": 1248000, "num_steps_trained": 1248000}, "done": false, "episodes_total": 124, "training_iteration": 312, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-47-14", "timestamp": 1618145234, "time_this_iter_s": 20.288535356521606, "time_total_s": 6568.011124610901, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6568.011124610901, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 59.53103448275862, "ram_util_percent": 27.48620689655172}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.576419329361813, "mean_raw_obs_processing_ms": 0.10606254958905047, "mean_inference_ms": 1.5935503240906586, "mean_action_processing_ms": 0.04768129450257132}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1252000, "timers": {"sample_time_ms": 8253.226, "sample_throughput": 484.659, "learn_time_ms": 11865.29, "learn_throughput": 337.118, "update_time_ms": 3.093}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": -0.010238848510198295, "policy_loss": -0.021337233658414334, "vf_loss": 0.001136770062657888, "vf_explained_var": -0.009625300765037537, "kl": 0.012941611770656891, "entropy": 0.6043860595673323, "entropy_coeff": 0.0}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 125, "training_iteration": 313, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-47-33", "timestamp": 1618145253, "time_this_iter_s": 19.817607879638672, "time_total_s": 6587.82873249054, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6587.82873249054, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 59.165517241379305, "ram_util_percent": 27.489655172413794}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.576419329361813, "mean_raw_obs_processing_ms": 0.10606254958905047, "mean_inference_ms": 1.5935503240906586, "mean_action_processing_ms": 0.04768129450257132}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1256000, "timers": {"sample_time_ms": 8307.875, "sample_throughput": 481.471, "learn_time_ms": 11850.01, "learn_throughput": 337.552, "update_time_ms": 3.114}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.1831165908370167, "policy_loss": -0.05956265272106975, "vf_loss": 0.23292721947655082, "vf_explained_var": 0.5649106502532959, "kl": 0.01266931889404077, "entropy": 0.5597720080986619, "entropy_coeff": 0.0}}, "num_steps_sampled": 1256000, "num_steps_trained": 1256000}, "done": false, "episodes_total": 125, "training_iteration": 314, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-47-54", "timestamp": 1618145274, "time_this_iter_s": 20.43922209739685, "time_total_s": 6608.267954587936, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723ba50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a8ded0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6608.267954587936, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 59.341379310344834, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -24.0, "episode_reward_min": -24.0, "episode_reward_mean": -24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5743111941860329, "mean_raw_obs_processing_ms": 0.10626526565611763, "mean_inference_ms": 1.593676635506742, "mean_action_processing_ms": 0.04768427837418005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1260000, "timers": {"sample_time_ms": 8313.782, "sample_throughput": 481.129, "learn_time_ms": 11872.95, "learn_throughput": 336.9, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.09203216643072665, "policy_loss": -0.04110665406915359, "vf_loss": 0.1231155563145876, "vf_explained_var": 0.49130213260650635, "kl": 0.01302170188864693, "entropy": 0.4461751813068986, "entropy_coeff": 0.0}}, "num_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 126, "training_iteration": 315, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-48-14", "timestamp": 1618145294, "time_this_iter_s": 19.82774519920349, "time_total_s": 6628.09569978714, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7228a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cdb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6628.09569978714, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 58.135714285714286, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -24.0, "episode_reward_min": -24.0, "episode_reward_mean": -24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5743111941860329, "mean_raw_obs_processing_ms": 0.10626526565611763, "mean_inference_ms": 1.593676635506742, "mean_action_processing_ms": 0.04768427837418005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1264000, "timers": {"sample_time_ms": 8214.771, "sample_throughput": 486.928, "learn_time_ms": 11889.061, "learn_throughput": 336.444, "update_time_ms": 3.188}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.13068730582017452, "policy_loss": -0.03909331536851823, "vf_loss": 0.16196471452713013, "vf_explained_var": 0.6038254499435425, "kl": 0.010154021438211203, "entropy": 0.5225948849692941, "entropy_coeff": 0.0}}, "num_steps_sampled": 1264000, "num_steps_trained": 1264000}, "done": false, "episodes_total": 126, "training_iteration": 316, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-48-34", "timestamp": 1618145314, "time_this_iter_s": 19.839277982711792, "time_total_s": 6647.934977769852, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6647.934977769852, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 58.65172413793104, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -24.0, "episode_reward_min": -24.0, "episode_reward_mean": -24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5743111941860329, "mean_raw_obs_processing_ms": 0.10626526565611763, "mean_inference_ms": 1.593676635506742, "mean_action_processing_ms": 0.04768427837418005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1268000, "timers": {"sample_time_ms": 8151.341, "sample_throughput": 490.717, "learn_time_ms": 11908.155, "learn_throughput": 335.904, "update_time_ms": 3.179}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.20919417345430702, "policy_loss": -0.03412333520827815, "vf_loss": 0.23598840227350593, "vf_explained_var": 0.5396043062210083, "kl": 0.009521596191916615, "entropy": 0.4588841451331973, "entropy_coeff": 0.0}}, "num_steps_sampled": 1268000, "num_steps_trained": 1268000}, "done": false, "episodes_total": 126, "training_iteration": 317, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-48-53", "timestamp": 1618145333, "time_this_iter_s": 19.7416672706604, "time_total_s": 6667.676645040512, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6667.676645040512, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 59.23571428571429, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -9.0, "episode_reward_min": -9.0, "episode_reward_mean": -9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.571044757280839, "mean_raw_obs_processing_ms": 0.10648663470630415, "mean_inference_ms": 1.5929302983250404, "mean_action_processing_ms": 0.04765246426742004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1272000, "timers": {"sample_time_ms": 8086.273, "sample_throughput": 494.665, "learn_time_ms": 11885.396, "learn_throughput": 336.547, "update_time_ms": 3.122}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.0008650855015730485, "policy_loss": -0.021725970116676763, "vf_loss": 0.01589884009445086, "vf_explained_var": -0.0742209255695343, "kl": 0.008694174510310404, "entropy": 0.637094285339117, "entropy_coeff": 0.0}}, "num_steps_sampled": 1272000, "num_steps_trained": 1272000}, "done": false, "episodes_total": 127, "training_iteration": 318, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-49-13", "timestamp": 1618145353, "time_this_iter_s": 19.22069239616394, "time_total_s": 6686.897337436676, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6686.897337436676, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 58.12222222222222, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -9.0, "episode_reward_min": -9.0, "episode_reward_mean": -9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.571044757280839, "mean_raw_obs_processing_ms": 0.10648663470630415, "mean_inference_ms": 1.5929302983250404, "mean_action_processing_ms": 0.04765246426742004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1276000, "timers": {"sample_time_ms": 8049.527, "sample_throughput": 496.924, "learn_time_ms": 11871.192, "learn_throughput": 336.95, "update_time_ms": 3.149}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.004452017252333462, "policy_loss": -0.028639437980018556, "vf_loss": 0.026532871735980734, "vf_explained_var": 0.44329214096069336, "kl": 0.008520566654624417, "entropy": 0.5340590570122004, "entropy_coeff": 0.0}}, "num_steps_sampled": 1276000, "num_steps_trained": 1276000}, "done": false, "episodes_total": 127, "training_iteration": 319, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-49-32", "timestamp": 1618145372, "time_this_iter_s": 19.64027190208435, "time_total_s": 6706.53760933876, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686ae10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6706.53760933876, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 58.914285714285704, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5686693707160249, "mean_raw_obs_processing_ms": 0.10664796897880678, "mean_inference_ms": 1.5925978830382839, "mean_action_processing_ms": 0.04763777762515074}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1280000, "timers": {"sample_time_ms": 7961.572, "sample_throughput": 502.413, "learn_time_ms": 11867.311, "learn_throughput": 337.06, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": -0.008174682559911162, "policy_loss": -0.011756701482227072, "vf_loss": 0.0005355258640520333, "vf_explained_var": -0.10650458931922913, "kl": 0.003957845525292214, "entropy": 0.3410566570237279, "entropy_coeff": 0.0}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 128, "training_iteration": 320, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-49-52", "timestamp": 1618145392, "time_this_iter_s": 19.35838770866394, "time_total_s": 6725.895997047424, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68db590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68dbed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6725.895997047424, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 58.04999999999999, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5686693707160249, "mean_raw_obs_processing_ms": 0.10664796897880678, "mean_inference_ms": 1.5925978830382839, "mean_action_processing_ms": 0.04763777762515074}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1284000, "timers": {"sample_time_ms": 7904.646, "sample_throughput": 506.032, "learn_time_ms": 11842.117, "learn_throughput": 337.777, "update_time_ms": 3.075}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3848676770925522, "cur_lr": 5e-05, "total_loss": -0.012941404536832124, "policy_loss": -0.014260249387007207, "vf_loss": 0.0001529159077335862, "vf_explained_var": -0.4034324586391449, "kl": 0.0030294242278614547, "entropy": 0.312282407656312, "entropy_coeff": 0.0}}, "num_steps_sampled": 1284000, "num_steps_trained": 1284000}, "done": false, "episodes_total": 128, "training_iteration": 321, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-50-11", "timestamp": 1618145411, "time_this_iter_s": 19.396138191223145, "time_total_s": 6745.2921352386475, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6745.2921352386475, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 59.10714285714285, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5686693707160249, "mean_raw_obs_processing_ms": 0.10664796897880678, "mean_inference_ms": 1.5925978830382839, "mean_action_processing_ms": 0.04763777762515074}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1288000, "timers": {"sample_time_ms": 7894.848, "sample_throughput": 506.66, "learn_time_ms": 11815.501, "learn_throughput": 338.538, "update_time_ms": 3.079}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": -0.011907442240044475, "policy_loss": -0.014779259625356644, "vf_loss": 0.00136231567375944, "vf_explained_var": 0.22823108732700348, "kl": 0.007844262610888109, "entropy": 0.3694627722725272, "entropy_coeff": 0.0}}, "num_steps_sampled": 1288000, "num_steps_trained": 1288000}, "done": false, "episodes_total": 128, "training_iteration": 322, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-50-31", "timestamp": 1618145431, "time_this_iter_s": 19.921488046646118, "time_total_s": 6765.213623285294, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6765.213623285294, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 59.56071428571429, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5652014039938462, "mean_raw_obs_processing_ms": 0.10692368286858574, "mean_inference_ms": 1.5923546755978963, "mean_action_processing_ms": 0.04763096944120173}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1292000, "timers": {"sample_time_ms": 7864.328, "sample_throughput": 508.626, "learn_time_ms": 11831.392, "learn_throughput": 338.084, "update_time_ms": 3.13}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": -0.021257807034999132, "policy_loss": -0.02273760733078234, "vf_loss": 1.0591003665183507e-05, "vf_explained_var": -0.3434242010116577, "kl": 0.007634876867086859, "entropy": 0.35825163405388594, "entropy_coeff": 0.0}}, "num_steps_sampled": 1292000, "num_steps_trained": 1292000}, "done": false, "episodes_total": 129, "training_iteration": 323, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-50-51", "timestamp": 1618145451, "time_this_iter_s": 19.675920486450195, "time_total_s": 6784.889543771744, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a04c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6874710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6784.889543771744, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 58.260714285714286, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5652014039938462, "mean_raw_obs_processing_ms": 0.10692368286858574, "mean_inference_ms": 1.5923546755978963, "mean_action_processing_ms": 0.04763096944120173}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1296000, "timers": {"sample_time_ms": 7793.763, "sample_throughput": 513.231, "learn_time_ms": 11825.852, "learn_throughput": 338.242, "update_time_ms": 3.078}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": 0.0009591969719622284, "policy_loss": -0.03063871036283672, "vf_loss": 0.022264123792410828, "vf_explained_var": 0.42088890075683594, "kl": 0.04850388003978878, "entropy": 0.5436208061873913, "entropy_coeff": 0.0}}, "num_steps_sampled": 1296000, "num_steps_trained": 1296000}, "done": false, "episodes_total": 129, "training_iteration": 324, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-51-10", "timestamp": 1618145470, "time_this_iter_s": 19.67657971382141, "time_total_s": 6804.566123485565, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b684a5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b684ac50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6804.566123485565, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 59.09642857142857, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5629248541909057, "mean_raw_obs_processing_ms": 0.10711175400307393, "mean_inference_ms": 1.592306248478437, "mean_action_processing_ms": 0.04762862429821869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1300000, "timers": {"sample_time_ms": 7800.422, "sample_throughput": 512.793, "learn_time_ms": 11813.601, "learn_throughput": 338.593, "update_time_ms": 3.491}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2886507578194142, "cur_lr": 5e-05, "total_loss": -0.018440776562783867, "policy_loss": -0.02057173679349944, "vf_loss": 0.00036406148501555435, "vf_explained_var": -0.6724370121955872, "kl": 0.006121235172031447, "entropy": 0.4800626980140805, "entropy_coeff": 0.0}}, "num_steps_sampled": 1300000, "num_steps_trained": 1300000}, "done": false, "episodes_total": 130, "training_iteration": 325, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-51-30", "timestamp": 1618145490, "time_this_iter_s": 19.771406650543213, "time_total_s": 6824.337530136108, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b684ae90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6824.337530136108, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 58.63103448275862, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5629248541909057, "mean_raw_obs_processing_ms": 0.10711175400307393, "mean_inference_ms": 1.592306248478437, "mean_action_processing_ms": 0.04762862429821869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1304000, "timers": {"sample_time_ms": 7805.264, "sample_throughput": 512.475, "learn_time_ms": 11809.881, "learn_throughput": 338.699, "update_time_ms": 3.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2886507578194142, "cur_lr": 5e-05, "total_loss": -0.014805579965468496, "policy_loss": -0.01624477340374142, "vf_loss": 2.3536662361323124e-05, "vf_explained_var": -0.6394094824790955, "kl": 0.004904388853901764, "entropy": 0.482943631708622, "entropy_coeff": 0.0}}, "num_steps_sampled": 1304000, "num_steps_trained": 1304000}, "done": false, "episodes_total": 130, "training_iteration": 326, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-51-50", "timestamp": 1618145510, "time_this_iter_s": 19.85071611404419, "time_total_s": 6844.188246250153, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6844.188246250153, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 58.59285714285715, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5629248541909057, "mean_raw_obs_processing_ms": 0.10711175400307393, "mean_inference_ms": 1.592306248478437, "mean_action_processing_ms": 0.04762862429821869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1308000, "timers": {"sample_time_ms": 7873.636, "sample_throughput": 508.024, "learn_time_ms": 11793.787, "learn_throughput": 339.162, "update_time_ms": 3.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1443253789097071, "cur_lr": 5e-05, "total_loss": -0.005984261864796281, "policy_loss": -0.050615494226804, "vf_loss": 0.04070605686865747, "vf_explained_var": 0.6751089096069336, "kl": 0.0271967135486193, "entropy": 0.46315905824303627, "entropy_coeff": 0.0}}, "num_steps_sampled": 1308000, "num_steps_trained": 1308000}, "done": false, "episodes_total": 130, "training_iteration": 327, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-52-10", "timestamp": 1618145530, "time_this_iter_s": 20.26362705230713, "time_total_s": 6864.45187330246, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691fc90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6864.45187330246, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 59.089655172413806, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5597599289033274, "mean_raw_obs_processing_ms": 0.1074296193165601, "mean_inference_ms": 1.5923266865672516, "mean_action_processing_ms": 0.04762480485132019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1312000, "timers": {"sample_time_ms": 7902.808, "sample_throughput": 506.149, "learn_time_ms": 11818.005, "learn_throughput": 338.467, "update_time_ms": 3.454}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.21648806836456064, "cur_lr": 5e-05, "total_loss": 0.060635175788775086, "policy_loss": -0.03594793917727657, "vf_loss": 0.08856190252117813, "vf_explained_var": 0.39520978927612305, "kl": 0.037051528808660805, "entropy": 0.48102494049817324, "entropy_coeff": 0.0}}, "num_steps_sampled": 1312000, "num_steps_trained": 1312000}, "done": false, "episodes_total": 131, "training_iteration": 328, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-52-30", "timestamp": 1618145550, "time_this_iter_s": 19.751805782318115, "time_total_s": 6884.203679084778, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6884.203679084778, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 58.574999999999996, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -1.0, "episode_reward_min": -1.0, "episode_reward_mean": -1.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5597599289033274, "mean_raw_obs_processing_ms": 0.1074296193165601, "mean_inference_ms": 1.5923266865672516, "mean_action_processing_ms": 0.04762480485132019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1316000, "timers": {"sample_time_ms": 7925.867, "sample_throughput": 504.677, "learn_time_ms": 11808.743, "learn_throughput": 338.732, "update_time_ms": 3.453}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.32473210254684093, "cur_lr": 5e-05, "total_loss": -0.015660714387195185, "policy_loss": -0.03802773606730625, "vf_loss": 0.016917419590754434, "vf_explained_var": 0.43102747201919556, "kl": 0.01678184760385193, "entropy": 0.45538861583918333, "entropy_coeff": 0.0}}, "num_steps_sampled": 1316000, "num_steps_trained": 1316000}, "done": false, "episodes_total": 131, "training_iteration": 329, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-52-50", "timestamp": 1618145570, "time_this_iter_s": 19.78134775161743, "time_total_s": 6903.985026836395, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6903.985026836395, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 58.939285714285724, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5576892895918149, "mean_raw_obs_processing_ms": 0.10762190522587885, "mean_inference_ms": 1.592218857235995, "mean_action_processing_ms": 0.04762136091996962}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1320000, "timers": {"sample_time_ms": 7959.46, "sample_throughput": 502.547, "learn_time_ms": 11803.249, "learn_throughput": 338.89, "update_time_ms": 3.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.32473210254684093, "cur_lr": 5e-05, "total_loss": 0.04630183760309592, "policy_loss": -0.04384904375183396, "vf_loss": 0.08115389209706336, "vf_explained_var": 0.3529278039932251, "kl": 0.027705876214895397, "entropy": 0.5954320747405291, "entropy_coeff": 0.0}}, "num_steps_sampled": 1320000, "num_steps_trained": 1320000}, "done": false, "episodes_total": 132, "training_iteration": 330, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-53-10", "timestamp": 1618145590, "time_this_iter_s": 19.638190746307373, "time_total_s": 6923.623217582703, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b684add0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b684abd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6923.623217582703, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 59.39285714285713, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5576892895918149, "mean_raw_obs_processing_ms": 0.10762190522587885, "mean_inference_ms": 1.592218857235995, "mean_action_processing_ms": 0.04762136091996962}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1324000, "timers": {"sample_time_ms": 7987.878, "sample_throughput": 500.759, "learn_time_ms": 11810.721, "learn_throughput": 338.675, "update_time_ms": 3.505}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 0.1500335456803441, "policy_loss": -0.042778513161465526, "vf_loss": 0.18753791856579483, "vf_explained_var": 0.5737195014953613, "kl": 0.010827675738255493, "entropy": 0.5956694167107344, "entropy_coeff": 0.0}}, "num_steps_sampled": 1324000, "num_steps_trained": 1324000}, "done": false, "episodes_total": 132, "training_iteration": 331, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-53-29", "timestamp": 1618145609, "time_this_iter_s": 19.753254652023315, "time_total_s": 6943.376472234726, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b684aa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b684ac90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6943.376472234726, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 57.91724137931034, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5576892895918149, "mean_raw_obs_processing_ms": 0.10762190522587885, "mean_inference_ms": 1.592218857235995, "mean_action_processing_ms": 0.04762136091996962}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1328000, "timers": {"sample_time_ms": 7992.118, "sample_throughput": 500.493, "learn_time_ms": 11819.286, "learn_throughput": 338.43, "update_time_ms": 3.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 0.10335995524656028, "policy_loss": -0.0452906149730552, "vf_loss": 0.14145600609481335, "vf_explained_var": 0.3628826439380646, "kl": 0.014770252819289453, "entropy": 0.4794447533786297, "entropy_coeff": 0.0}}, "num_steps_sampled": 1328000, "num_steps_trained": 1328000}, "done": false, "episodes_total": 132, "training_iteration": 332, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-53-49", "timestamp": 1618145629, "time_this_iter_s": 20.04930543899536, "time_total_s": 6963.425777673721, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6963.425777673721, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 59.503571428571426, "ram_util_percent": 27.59285714285715}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5549191242761614, "mean_raw_obs_processing_ms": 0.10791966477530825, "mean_inference_ms": 1.5920879716091063, "mean_action_processing_ms": 0.047614846016347745}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1332000, "timers": {"sample_time_ms": 8045.074, "sample_throughput": 497.199, "learn_time_ms": 11802.626, "learn_throughput": 338.908, "update_time_ms": 3.498}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4870981538202614, "cur_lr": 5e-05, "total_loss": 0.12800965167116374, "policy_loss": -0.05894516862463206, "vf_loss": 0.17643224191851914, "vf_explained_var": 0.381339430809021, "kl": 0.021602588007226586, "entropy": 0.5694035179913044, "entropy_coeff": 0.0}}, "num_steps_sampled": 1332000, "num_steps_trained": 1332000}, "done": false, "episodes_total": 133, "training_iteration": 333, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-54-10", "timestamp": 1618145650, "time_this_iter_s": 20.037624835968018, "time_total_s": 6983.463402509689, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fa90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab21d1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6983.463402509689, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 58.948275862068975, "ram_util_percent": 27.541379310344826}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 2.0, "episode_reward_min": 2.0, "episode_reward_mean": 2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5549191242761614, "mean_raw_obs_processing_ms": 0.10791966477530825, "mean_inference_ms": 1.5920879716091063, "mean_action_processing_ms": 0.047614846016347745}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1336000, "timers": {"sample_time_ms": 8040.086, "sample_throughput": 497.507, "learn_time_ms": 11801.184, "learn_throughput": 338.949, "update_time_ms": 3.495}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7306472307303921, "cur_lr": 5e-05, "total_loss": 0.05063240183517337, "policy_loss": -0.05915588076459244, "vf_loss": 0.09060294181108475, "vf_explained_var": 0.279935747385025, "kl": 0.02625800744863227, "entropy": 0.5731020085513592, "entropy_coeff": 0.0}}, "num_steps_sampled": 1336000, "num_steps_trained": 1336000}, "done": false, "episodes_total": 133, "training_iteration": 334, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-54-29", "timestamp": 1618145669, "time_this_iter_s": 19.61166214942932, "time_total_s": 7003.075064659119, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7003.075064659119, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 58.12857142857143, "ram_util_percent": 27.58928571428572}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -8.0, "episode_reward_min": -8.0, "episode_reward_mean": -8.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5531281618951573, "mean_raw_obs_processing_ms": 0.10810025585136564, "mean_inference_ms": 1.591918968621991, "mean_action_processing_ms": 0.04760549305590054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1340000, "timers": {"sample_time_ms": 8076.152, "sample_throughput": 495.285, "learn_time_ms": 11814.121, "learn_throughput": 338.578, "update_time_ms": 3.068}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.08119120125775225, "policy_loss": -0.03726444675703533, "vf_loss": 0.11072639026679099, "vf_explained_var": 0.44587182998657227, "kl": 0.007052427914459258, "entropy": 0.5513548674061894, "entropy_coeff": 0.0}}, "num_steps_sampled": 1340000, "num_steps_trained": 1340000}, "done": false, "episodes_total": 134, "training_iteration": 335, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-54-49", "timestamp": 1618145689, "time_this_iter_s": 20.262514114379883, "time_total_s": 7023.3375787734985, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691ffd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7023.3375787734985, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 59.06551724137931, "ram_util_percent": 27.59655172413794}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -8.0, "episode_reward_min": -8.0, "episode_reward_mean": -8.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5531281618951573, "mean_raw_obs_processing_ms": 0.10810025585136564, "mean_inference_ms": 1.591918968621991, "mean_action_processing_ms": 0.04760549305590054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1344000, "timers": {"sample_time_ms": 8064.11, "sample_throughput": 496.025, "learn_time_ms": 11809.126, "learn_throughput": 338.721, "update_time_ms": 3.01}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.03287347900914028, "policy_loss": -0.03943154093576595, "vf_loss": 0.06163963186554611, "vf_explained_var": 0.3228299021720886, "kl": 0.009731453450513072, "entropy": 0.56947279907763, "entropy_coeff": 0.0}}, "num_steps_sampled": 1344000, "num_steps_trained": 1344000}, "done": false, "episodes_total": 134, "training_iteration": 336, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-55-09", "timestamp": 1618145709, "time_this_iter_s": 19.67793297767639, "time_total_s": 7043.015511751175, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7043.015511751175, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 58.92142857142857, "ram_util_percent": 27.521428571428572}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": -8.0, "episode_reward_min": -8.0, "episode_reward_mean": -8.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5531281618951573, "mean_raw_obs_processing_ms": 0.10810025585136564, "mean_inference_ms": 1.591918968621991, "mean_action_processing_ms": 0.04760549305590054}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1348000, "timers": {"sample_time_ms": 7995.581, "sample_throughput": 500.276, "learn_time_ms": 11807.81, "learn_throughput": 338.759, "update_time_ms": 2.982}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.07688536029309034, "policy_loss": -0.04193152757943608, "vf_loss": 0.10984513652510941, "vf_explained_var": 0.5090654492378235, "kl": 0.008186117789591663, "entropy": 0.4413570733740926, "entropy_coeff": 0.0}}, "num_steps_sampled": 1348000, "num_steps_trained": 1348000}, "done": false, "episodes_total": 134, "training_iteration": 337, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-55-29", "timestamp": 1618145729, "time_this_iter_s": 19.56619095802307, "time_total_s": 7062.581702709198, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bdc50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7062.581702709198, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 58.15357142857142, "ram_util_percent": 27.517857142857142}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 14.0, "episode_reward_min": 14.0, "episode_reward_mean": 14.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5501305239767265, "mean_raw_obs_processing_ms": 0.10835599062041332, "mean_inference_ms": 1.59156087561293, "mean_action_processing_ms": 0.04758536417324104}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1352000, "timers": {"sample_time_ms": 8013.752, "sample_throughput": 499.142, "learn_time_ms": 11787.204, "learn_throughput": 339.351, "update_time_ms": 3.059}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.025325540453195572, "policy_loss": -0.030071944114752114, "vf_loss": 0.04711332742590457, "vf_explained_var": 0.5339753031730652, "kl": 0.007558739904197864, "entropy": 0.573446162045002, "entropy_coeff": 0.0}}, "num_steps_sampled": 1352000, "num_steps_trained": 1352000}, "done": false, "episodes_total": 135, "training_iteration": 338, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-55-49", "timestamp": 1618145749, "time_this_iter_s": 19.73111867904663, "time_total_s": 7082.312821388245, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6874b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7082.312821388245, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 59.22857142857142, "ram_util_percent": 27.51071428571429}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 14.0, "episode_reward_min": 14.0, "episode_reward_mean": 14.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5501305239767265, "mean_raw_obs_processing_ms": 0.10835599062041332, "mean_inference_ms": 1.59156087561293, "mean_action_processing_ms": 0.04758536417324104}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1356000, "timers": {"sample_time_ms": 8026.273, "sample_throughput": 498.363, "learn_time_ms": 11794.638, "learn_throughput": 339.137, "update_time_ms": 3.029}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.03832088352646679, "policy_loss": -0.048428416484966874, "vf_loss": 0.07777994428761303, "vf_explained_var": 0.49468374252319336, "kl": 0.008183938247384503, "entropy": 0.5667104385793209, "entropy_coeff": 0.0}}, "num_steps_sampled": 1356000, "num_steps_trained": 1356000}, "done": false, "episodes_total": 135, "training_iteration": 339, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-56-09", "timestamp": 1618145769, "time_this_iter_s": 19.97629714012146, "time_total_s": 7102.289118528366, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6874810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7102.289118528366, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 59.12413793103448, "ram_util_percent": 27.572413793103454}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 13.0, "episode_reward_min": 13.0, "episode_reward_mean": 13.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5482123626734745, "mean_raw_obs_processing_ms": 0.1085492605166229, "mean_inference_ms": 1.5915595037999586, "mean_action_processing_ms": 0.04758272704369489}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1360000, "timers": {"sample_time_ms": 8033.389, "sample_throughput": 497.922, "learn_time_ms": 11805.606, "learn_throughput": 338.822, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.11826901388121769, "policy_loss": -0.03751684434246272, "vf_loss": 0.14655273244716227, "vf_explained_var": 0.40544411540031433, "kl": 0.008424611572991125, "entropy": 0.5359309148043394, "entropy_coeff": 0.0}}, "num_steps_sampled": 1360000, "num_steps_trained": 1360000}, "done": false, "episodes_total": 136, "training_iteration": 340, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-56-28", "timestamp": 1618145788, "time_this_iter_s": 19.821152925491333, "time_total_s": 7122.110271453857, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7122.110271453857, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 58.317857142857136, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 13.0, "episode_reward_min": 13.0, "episode_reward_mean": 13.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5482123626734745, "mean_raw_obs_processing_ms": 0.1085492605166229, "mean_inference_ms": 1.5915595037999586, "mean_action_processing_ms": 0.04758272704369489}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1364000, "timers": {"sample_time_ms": 7993.13, "sample_throughput": 500.43, "learn_time_ms": 11828.256, "learn_throughput": 338.173, "update_time_ms": 3.019}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.027513692315551452, "policy_loss": -0.034762606548611075, "vf_loss": 0.05512338306289166, "vf_explained_var": 0.26165828108787537, "kl": 0.006526556833705399, "entropy": 0.5214363243430853, "entropy_coeff": 0.0}}, "num_steps_sampled": 1364000, "num_steps_trained": 1364000}, "done": false, "episodes_total": 136, "training_iteration": 341, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-56-48", "timestamp": 1618145808, "time_this_iter_s": 19.576637744903564, "time_total_s": 7141.686909198761, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68eb950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68eb1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7141.686909198761, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 59.31071428571429, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 13.0, "episode_reward_min": 13.0, "episode_reward_mean": 13.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5482123626734745, "mean_raw_obs_processing_ms": 0.1085492605166229, "mean_inference_ms": 1.5915595037999586, "mean_action_processing_ms": 0.04758272704369489}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1368000, "timers": {"sample_time_ms": 7959.836, "sample_throughput": 502.523, "learn_time_ms": 11820.388, "learn_throughput": 338.398, "update_time_ms": 3.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.018969617813127115, "policy_loss": -0.042703937768237665, "vf_loss": 0.0527826669276692, "vf_explained_var": 0.380376935005188, "kl": 0.008112341063679196, "entropy": 0.44091694988310337, "entropy_coeff": 0.0}}, "num_steps_sampled": 1368000, "num_steps_trained": 1368000}, "done": false, "episodes_total": 136, "training_iteration": 342, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-57-08", "timestamp": 1618145828, "time_this_iter_s": 19.639065742492676, "time_total_s": 7161.325974941254, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7161.325974941254, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 58.75714285714286, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 5.0, "episode_reward_min": 5.0, "episode_reward_mean": 5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5453088745446675, "mean_raw_obs_processing_ms": 0.10878656482489324, "mean_inference_ms": 1.5910036653970077, "mean_action_processing_ms": 0.047558646946637494}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1372000, "timers": {"sample_time_ms": 7923.676, "sample_throughput": 504.816, "learn_time_ms": 11848.774, "learn_throughput": 337.588, "update_time_ms": 3.074}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": 0.016762105020461604, "policy_loss": -0.02884641569107771, "vf_loss": 0.038846511859446764, "vf_explained_var": 0.49249589443206787, "kl": 0.006169879590743221, "entropy": 0.3404128523543477, "entropy_coeff": 0.0}}, "num_steps_sampled": 1372000, "num_steps_trained": 1372000}, "done": false, "episodes_total": 137, "training_iteration": 343, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-57-28", "timestamp": 1618145848, "time_this_iter_s": 19.95755934715271, "time_total_s": 7181.283534288406, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723ba10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7181.283534288406, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 59.26206896551724, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 5.0, "episode_reward_min": 5.0, "episode_reward_mean": 5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5453088745446675, "mean_raw_obs_processing_ms": 0.10878656482489324, "mean_inference_ms": 1.5910036653970077, "mean_action_processing_ms": 0.047558646946637494}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1376000, "timers": {"sample_time_ms": 7906.082, "sample_throughput": 505.94, "learn_time_ms": 11867.762, "learn_throughput": 337.048, "update_time_ms": 3.093}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": -0.015461960196262226, "policy_loss": -0.02485471172258258, "vf_loss": 0.0010675596840883372, "vf_explained_var": -0.09765620529651642, "kl": 0.0075961792026646435, "entropy": 0.37815548852086067, "entropy_coeff": 0.0}}, "num_steps_sampled": 1376000, "num_steps_trained": 1376000}, "done": false, "episodes_total": 137, "training_iteration": 344, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-57-47", "timestamp": 1618145867, "time_this_iter_s": 19.625429153442383, "time_total_s": 7200.908963441849, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68a9bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b723ba90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7200.908963441849, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 59.22499999999999, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5432297353346016, "mean_raw_obs_processing_ms": 0.10894909804011813, "mean_inference_ms": 1.5906728076303662, "mean_action_processing_ms": 0.04754376093322183}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1380000, "timers": {"sample_time_ms": 7843.553, "sample_throughput": 509.973, "learn_time_ms": 11838.62, "learn_throughput": 337.877, "update_time_ms": 3.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0959708460955881, "cur_lr": 5e-05, "total_loss": -0.010087275790283456, "policy_loss": -0.014626463525928557, "vf_loss": 0.001748888757902023, "vf_explained_var": -0.10532994568347931, "kl": 0.002545960896895849, "entropy": 0.3837365638464689, "entropy_coeff": 0.0}}, "num_steps_sampled": 1380000, "num_steps_trained": 1380000}, "done": false, "episodes_total": 138, "training_iteration": 345, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-58-07", "timestamp": 1618145887, "time_this_iter_s": 19.34516429901123, "time_total_s": 7220.25412774086, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68a6d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68a9910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7220.25412774086, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 58.42962962962964, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5432297353346016, "mean_raw_obs_processing_ms": 0.10894909804011813, "mean_inference_ms": 1.5906728076303662, "mean_action_processing_ms": 0.04754376093322183}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1384000, "timers": {"sample_time_ms": 7834.702, "sample_throughput": 510.549, "learn_time_ms": 11857.594, "learn_throughput": 337.337, "update_time_ms": 3.1}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 0.002140220138244331, "policy_loss": -0.03969401941867545, "vf_loss": 0.036614531301893294, "vf_explained_var": 0.4334149956703186, "kl": 0.009525263958494179, "entropy": 0.3986956039443612, "entropy_coeff": 0.0}}, "num_steps_sampled": 1384000, "num_steps_trained": 1384000}, "done": false, "episodes_total": 138, "training_iteration": 346, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-58-26", "timestamp": 1618145906, "time_this_iter_s": 19.783616542816162, "time_total_s": 7240.037744283676, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cdcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7240.037744283676, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 59.353571428571435, "ram_util_percent": 27.52857142857143}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5432297353346016, "mean_raw_obs_processing_ms": 0.10894909804011813, "mean_inference_ms": 1.5906728076303662, "mean_action_processing_ms": 0.04754376093322183}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1388000, "timers": {"sample_time_ms": 7852.235, "sample_throughput": 509.409, "learn_time_ms": 11872.209, "learn_throughput": 336.921, "update_time_ms": 3.106}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 0.2048318402376026, "policy_loss": -0.05203650574549101, "vf_loss": 0.24849584931507707, "vf_explained_var": 0.4818745255470276, "kl": 0.015278686652891338, "entropy": 0.5702442303299904, "entropy_coeff": 0.0}}, "num_steps_sampled": 1388000, "num_steps_trained": 1388000}, "done": false, "episodes_total": 138, "training_iteration": 347, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-58-46", "timestamp": 1618145926, "time_this_iter_s": 19.884355783462524, "time_total_s": 7259.922100067139, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7259.922100067139, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 58.9448275862069, "ram_util_percent": 27.510344827586206}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 18.0, "episode_reward_min": 18.0, "episode_reward_mean": 18.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5402967801092435, "mean_raw_obs_processing_ms": 0.1092114638552447, "mean_inference_ms": 1.5903588154109831, "mean_action_processing_ms": 0.04752884799200275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1392000, "timers": {"sample_time_ms": 7835.363, "sample_throughput": 510.506, "learn_time_ms": 11880.514, "learn_throughput": 336.686, "update_time_ms": 3.061}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5479854230477941, "cur_lr": 5e-05, "total_loss": 0.2077498760772869, "policy_loss": -0.07121126353740692, "vf_loss": 0.2659251452423632, "vf_explained_var": 0.4553990960121155, "kl": 0.02378894464345649, "entropy": 0.5033234767615795, "entropy_coeff": 0.0}}, "num_steps_sampled": 1392000, "num_steps_trained": 1392000}, "done": false, "episodes_total": 139, "training_iteration": 348, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-59-06", "timestamp": 1618145946, "time_this_iter_s": 19.642861127853394, "time_total_s": 7279.564961194992, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68311d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7279.564961194992, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 58.214285714285715, "ram_util_percent": 27.50357142857143}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 18.0, "episode_reward_min": 18.0, "episode_reward_mean": 18.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5402967801092435, "mean_raw_obs_processing_ms": 0.1092114638552447, "mean_inference_ms": 1.5903588154109831, "mean_action_processing_ms": 0.04752884799200275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1396000, "timers": {"sample_time_ms": 7872.318, "sample_throughput": 508.11, "learn_time_ms": 11882.293, "learn_throughput": 336.635, "update_time_ms": 3.067}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.5734434295445681, "policy_loss": -0.04157574032433331, "vf_loss": 0.6073263604193926, "vf_explained_var": 0.24729789793491364, "kl": 0.009358899915241636, "entropy": 0.44852058682590723, "entropy_coeff": 0.0}}, "num_steps_sampled": 1396000, "num_steps_trained": 1396000}, "done": false, "episodes_total": 139, "training_iteration": 349, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-59-26", "timestamp": 1618145966, "time_this_iter_s": 20.364776134490967, "time_total_s": 7299.929737329483, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c0710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68c0550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7299.929737329483, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 59.296551724137935, "ram_util_percent": 27.5}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 74.0, "episode_reward_min": 74.0, "episode_reward_mean": 74.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5387917665317294, "mean_raw_obs_processing_ms": 0.10938709620020473, "mean_inference_ms": 1.5901851509775538, "mean_action_processing_ms": 0.0475204143668815}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1400000, "timers": {"sample_time_ms": 7850.841, "sample_throughput": 509.5, "learn_time_ms": 11896.361, "learn_throughput": 336.237, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.28881770791485906, "policy_loss": -0.045354495057836175, "vf_loss": 0.3255140813998878, "vf_explained_var": 0.557772696018219, "kl": 0.010533273802138865, "entropy": 0.4414237020537257, "entropy_coeff": 0.0}}, "num_steps_sampled": 1400000, "num_steps_trained": 1400000}, "done": false, "episodes_total": 140, "training_iteration": 350, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_12-59-46", "timestamp": 1618145986, "time_this_iter_s": 19.746047735214233, "time_total_s": 7319.675785064697, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7319.675785064697, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 27.50357142857143}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 74.0, "episode_reward_min": 74.0, "episode_reward_mean": 74.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5387917665317294, "mean_raw_obs_processing_ms": 0.10938709620020473, "mean_inference_ms": 1.5901851509775538, "mean_action_processing_ms": 0.0475204143668815}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1404000, "timers": {"sample_time_ms": 7859.249, "sample_throughput": 508.955, "learn_time_ms": 11881.547, "learn_throughput": 336.657, "update_time_ms": 3.063}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.3666849914006889, "policy_loss": -0.03513685427606106, "vf_loss": 0.39424116676673293, "vf_explained_var": 0.5694769620895386, "kl": 0.009222490145475604, "entropy": 0.43997300043702126, "entropy_coeff": 0.0}}, "num_steps_sampled": 1404000, "num_steps_trained": 1404000}, "done": false, "episodes_total": 140, "training_iteration": 351, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-00-06", "timestamp": 1618146006, "time_this_iter_s": 19.514147758483887, "time_total_s": 7339.189932823181, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68a97d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7339.189932823181, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 58.050000000000004, "ram_util_percent": 27.50714285714286}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 74.0, "episode_reward_min": 74.0, "episode_reward_mean": 74.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5387917665317294, "mean_raw_obs_processing_ms": 0.10938709620020473, "mean_inference_ms": 1.5901851509775538, "mean_action_processing_ms": 0.0475204143668815}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1408000, "timers": {"sample_time_ms": 7882.283, "sample_throughput": 507.467, "learn_time_ms": 11859.145, "learn_throughput": 337.292, "update_time_ms": 3.002}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.06462952436413616, "policy_loss": -0.06278686982113868, "vf_loss": 0.11650674184784293, "vf_explained_var": 0.6006650924682617, "kl": 0.01327243575360626, "entropy": 0.435507008805871, "entropy_coeff": 0.0}}, "num_steps_sampled": 1408000, "num_steps_trained": 1408000}, "done": false, "episodes_total": 140, "training_iteration": 352, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-00-25", "timestamp": 1618146025, "time_this_iter_s": 19.644118547439575, "time_total_s": 7358.834051370621, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7a8df10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7358.834051370621, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 59.33214285714286, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 43.0, "episode_reward_min": 43.0, "episode_reward_mean": 43.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5358806551944136, "mean_raw_obs_processing_ms": 0.10963247841681996, "mean_inference_ms": 1.5896730097812797, "mean_action_processing_ms": 0.047497564230150335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1412000, "timers": {"sample_time_ms": 7831.57, "sample_throughput": 510.753, "learn_time_ms": 11848.632, "learn_throughput": 337.592, "update_time_ms": 2.996}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.2241378107573837, "policy_loss": -0.040608018229249865, "vf_loss": 0.25650398805737495, "vf_explained_var": 0.46100911498069763, "kl": 0.010026838703197427, "entropy": 0.42321247421205044, "entropy_coeff": 0.0}}, "num_steps_sampled": 1412000, "num_steps_trained": 1412000}, "done": false, "episodes_total": 141, "training_iteration": 353, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-00-45", "timestamp": 1618146045, "time_this_iter_s": 19.347469329833984, "time_total_s": 7378.181520700455, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68a9590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7378.181520700455, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 58.192857142857136, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 43.0, "episode_reward_min": 43.0, "episode_reward_mean": 43.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5358806551944136, "mean_raw_obs_processing_ms": 0.10963247841681996, "mean_inference_ms": 1.5896730097812797, "mean_action_processing_ms": 0.047497564230150335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1416000, "timers": {"sample_time_ms": 7928.988, "sample_throughput": 504.478, "learn_time_ms": 11824.223, "learn_throughput": 338.289, "update_time_ms": 2.996}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.9021318852901459, "policy_loss": -0.05094762914814055, "vf_loss": 0.9423261173069477, "vf_explained_var": 0.43038803339004517, "kl": 0.013082349469186738, "entropy": 0.43964679911732674, "entropy_coeff": 0.0}}, "num_steps_sampled": 1416000, "num_steps_trained": 1416000}, "done": false, "episodes_total": 141, "training_iteration": 354, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-01-05", "timestamp": 1618146065, "time_this_iter_s": 20.355236530303955, "time_total_s": 7398.536757230759, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68dbc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7398.536757230759, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 59.61379310344827, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 155.0, "episode_reward_min": 155.0, "episode_reward_mean": 155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5343872620383399, "mean_raw_obs_processing_ms": 0.10985782972907773, "mean_inference_ms": 1.5899196022654676, "mean_action_processing_ms": 0.0475013406788693}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1420000, "timers": {"sample_time_ms": 7990.707, "sample_throughput": 500.581, "learn_time_ms": 11834.344, "learn_throughput": 337.999, "update_time_ms": 3.045}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 1.4958414118736982, "policy_loss": -0.054346403368981555, "vf_loss": 1.5388027280569077, "vf_explained_var": 0.413263201713562, "kl": 0.013850827715941705, "entropy": 0.4364551790058613, "entropy_coeff": 0.0}}, "num_steps_sampled": 1420000, "num_steps_trained": 1420000}, "done": false, "episodes_total": 142, "training_iteration": 355, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-01-25", "timestamp": 1618146085, "time_this_iter_s": 20.06469202041626, "time_total_s": 7418.601449251175, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68a6b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b09d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7418.601449251175, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 59.721428571428575, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 155.0, "episode_reward_min": 155.0, "episode_reward_mean": 155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5343872620383399, "mean_raw_obs_processing_ms": 0.10985782972907773, "mean_inference_ms": 1.5899196022654676, "mean_action_processing_ms": 0.0475013406788693}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1424000, "timers": {"sample_time_ms": 8021.195, "sample_throughput": 498.679, "learn_time_ms": 11816.971, "learn_throughput": 338.496, "update_time_ms": 3.061}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.29443935956805944, "policy_loss": -0.023095311829820275, "vf_loss": 0.311050889082253, "vf_explained_var": 0.6027381420135498, "kl": 0.007888022046245169, "entropy": 0.3443496357649565, "entropy_coeff": 0.0}}, "num_steps_sampled": 1424000, "num_steps_trained": 1424000}, "done": false, "episodes_total": 142, "training_iteration": 356, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-01-45", "timestamp": 1618146105, "time_this_iter_s": 19.911765813827515, "time_total_s": 7438.513215065002, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68a6650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7438.513215065002, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 58.272413793103446, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 155.0, "episode_reward_min": 155.0, "episode_reward_mean": 155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5343872620383399, "mean_raw_obs_processing_ms": 0.10985782972907773, "mean_inference_ms": 1.5899196022654676, "mean_action_processing_ms": 0.0475013406788693}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1428000, "timers": {"sample_time_ms": 8015.778, "sample_throughput": 499.016, "learn_time_ms": 11802.213, "learn_throughput": 338.919, "update_time_ms": 3.092}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.399135013576597, "policy_loss": -0.03555876819882542, "vf_loss": 0.4293402307666838, "vf_explained_var": 0.6365727186203003, "kl": 0.006513009138870984, "entropy": 0.34334462508559227, "entropy_coeff": 0.0}}, "num_steps_sampled": 1428000, "num_steps_trained": 1428000}, "done": false, "episodes_total": 142, "training_iteration": 357, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-02-05", "timestamp": 1618146125, "time_this_iter_s": 19.684160232543945, "time_total_s": 7458.197375297546, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7458.197375297546, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 59.614285714285714, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 93.0, "episode_reward_min": 93.0, "episode_reward_mean": 93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5315637665853766, "mean_raw_obs_processing_ms": 0.11012954953049646, "mean_inference_ms": 1.5896906939888074, "mean_action_processing_ms": 0.04749149313956006}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1432000, "timers": {"sample_time_ms": 7997.92, "sample_throughput": 500.13, "learn_time_ms": 11811.556, "learn_throughput": 338.651, "update_time_ms": 3.106}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 1.5187533721327782, "policy_loss": -0.05284337582997978, "vf_loss": 1.5626521334052086, "vf_explained_var": 0.47438523173332214, "kl": 0.010881821915972978, "entropy": 0.3481277236714959, "entropy_coeff": 0.0}}, "num_steps_sampled": 1432000, "num_steps_trained": 1432000}, "done": false, "episodes_total": 143, "training_iteration": 358, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-02-25", "timestamp": 1618146145, "time_this_iter_s": 19.5600745677948, "time_total_s": 7477.757449865341, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7477.757449865341, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 59.05357142857142, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 93.0, "episode_reward_min": 93.0, "episode_reward_mean": 93.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5315637665853766, "mean_raw_obs_processing_ms": 0.11012954953049646, "mean_inference_ms": 1.5896906939888074, "mean_action_processing_ms": 0.04749149313956006}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1436000, "timers": {"sample_time_ms": 7919.016, "sample_throughput": 505.113, "learn_time_ms": 11815.063, "learn_throughput": 338.551, "update_time_ms": 3.104}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.9166849181056023, "policy_loss": -0.04128437989857048, "vf_loss": 0.947470024228096, "vf_explained_var": 0.5377486348152161, "kl": 0.012773180555086583, "entropy": 0.42425150889903307, "entropy_coeff": 0.0}}, "num_steps_sampled": 1436000, "num_steps_trained": 1436000}, "done": false, "episodes_total": 143, "training_iteration": 359, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-02-44", "timestamp": 1618146164, "time_this_iter_s": 19.610560178756714, "time_total_s": 7497.368010044098, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68a9910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7497.368010044098, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 58.44285714285714, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 94.0, "episode_reward_min": 94.0, "episode_reward_mean": 94.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5297497054054823, "mean_raw_obs_processing_ms": 0.11030693407508817, "mean_inference_ms": 1.5895172521606802, "mean_action_processing_ms": 0.04748327017504805}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1440000, "timers": {"sample_time_ms": 7940.75, "sample_throughput": 503.731, "learn_time_ms": 11787.161, "learn_throughput": 339.352, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.27807270316407084, "policy_loss": -0.025856566440779716, "vf_loss": 0.2970779659226537, "vf_explained_var": 0.23506568372249603, "kl": 0.008335151520441286, "entropy": 0.18312110332772136, "entropy_coeff": 0.0}}, "num_steps_sampled": 1440000, "num_steps_trained": 1440000}, "done": false, "episodes_total": 144, "training_iteration": 360, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-03-04", "timestamp": 1618146184, "time_this_iter_s": 19.684422731399536, "time_total_s": 7517.052432775497, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c0cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7517.052432775497, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 59.357142857142854, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 94.0, "episode_reward_min": 94.0, "episode_reward_mean": 94.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5297497054054823, "mean_raw_obs_processing_ms": 0.11030693407508817, "mean_inference_ms": 1.5895172521606802, "mean_action_processing_ms": 0.04748327017504805}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1444000, "timers": {"sample_time_ms": 7930.493, "sample_throughput": 504.382, "learn_time_ms": 11831.666, "learn_throughput": 338.076, "update_time_ms": 3.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8219781345716911, "cur_lr": 5e-05, "total_loss": 0.00781451683724299, "policy_loss": -0.012283778167329729, "vf_loss": 0.017817566287703812, "vf_explained_var": -0.06298316270112991, "kl": 0.002774682016024599, "entropy": 0.03963285544887185, "entropy_coeff": 0.0}}, "num_steps_sampled": 1444000, "num_steps_trained": 1444000}, "done": false, "episodes_total": 144, "training_iteration": 361, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-03-24", "timestamp": 1618146204, "time_this_iter_s": 19.857476234436035, "time_total_s": 7536.9099090099335, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d54d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7536.9099090099335, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 58.99310344827586, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 94.0, "episode_reward_min": 94.0, "episode_reward_mean": 94.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5297497054054823, "mean_raw_obs_processing_ms": 0.11030693407508817, "mean_inference_ms": 1.5895172521606802, "mean_action_processing_ms": 0.04748327017504805}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1448000, "timers": {"sample_time_ms": 7919.828, "sample_throughput": 505.061, "learn_time_ms": 11836.54, "learn_throughput": 337.937, "update_time_ms": 3.564}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.41098906728584556, "cur_lr": 5e-05, "total_loss": 1.0552128124982119, "policy_loss": -0.061102810548618436, "vf_loss": 1.102132162079215, "vf_explained_var": 0.5450339913368225, "kl": 0.034510567667894065, "entropy": 0.2655572728253901, "entropy_coeff": 0.0}}, "num_steps_sampled": 1448000, "num_steps_trained": 1448000}, "done": false, "episodes_total": 144, "training_iteration": 362, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-03-43", "timestamp": 1618146223, "time_this_iter_s": 19.58655333518982, "time_total_s": 7556.496462345123, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7556.496462345123, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 58.510714285714286, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 81.0, "episode_reward_min": 81.0, "episode_reward_mean": 81.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5270903526296343, "mean_raw_obs_processing_ms": 0.11055142267245001, "mean_inference_ms": 1.5890563424320963, "mean_action_processing_ms": 0.04746312131652498}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1452000, "timers": {"sample_time_ms": 7961.67, "sample_throughput": 502.407, "learn_time_ms": 11803.519, "learn_throughput": 338.882, "update_time_ms": 3.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6164836009287683, "cur_lr": 5e-05, "total_loss": 0.8400245811790228, "policy_loss": -0.036747649719472975, "vf_loss": 0.8690081369131804, "vf_explained_var": 0.5549074411392212, "kl": 0.01259415884851478, "entropy": 0.2901663361117244, "entropy_coeff": 0.0}}, "num_steps_sampled": 1452000, "num_steps_trained": 1452000}, "done": false, "episodes_total": 145, "training_iteration": 363, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-04-03", "timestamp": 1618146243, "time_this_iter_s": 19.433544397354126, "time_total_s": 7575.930006742477, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68a6c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7575.930006742477, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 59.22592592592593, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 81.0, "episode_reward_min": 81.0, "episode_reward_mean": 81.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5270903526296343, "mean_raw_obs_processing_ms": 0.11055142267245001, "mean_inference_ms": 1.5890563424320963, "mean_action_processing_ms": 0.04746312131652498}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1456000, "timers": {"sample_time_ms": 7843.537, "sample_throughput": 509.974, "learn_time_ms": 11805.026, "learn_throughput": 338.839, "update_time_ms": 3.57}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6164836009287683, "cur_lr": 5e-05, "total_loss": 0.9880701303482056, "policy_loss": -0.059332326520234346, "vf_loss": 1.034257479943335, "vf_explained_var": 0.48180168867111206, "kl": 0.021322543441783637, "entropy": 0.4778941012918949, "entropy_coeff": 0.0}}, "num_steps_sampled": 1456000, "num_steps_trained": 1456000}, "done": false, "episodes_total": 145, "training_iteration": 364, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-04-22", "timestamp": 1618146262, "time_this_iter_s": 19.190144777297974, "time_total_s": 7595.120151519775, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68c0e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7595.120151519775, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 58.003571428571426, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 213.0, "episode_reward_min": 213.0, "episode_reward_mean": 213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5253639628566829, "mean_raw_obs_processing_ms": 0.11069782510190293, "mean_inference_ms": 1.5886251774263813, "mean_action_processing_ms": 0.04744168226280642}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1460000, "timers": {"sample_time_ms": 7802.254, "sample_throughput": 512.672, "learn_time_ms": 11783.217, "learn_throughput": 339.466, "update_time_ms": 3.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 3.0529699325561523, "policy_loss": -0.04781880532391369, "vf_loss": 3.0898620635271072, "vf_explained_var": 0.3217126727104187, "kl": 0.011816127662314102, "entropy": 0.3565324451774359, "entropy_coeff": 0.0}}, "num_steps_sampled": 1460000, "num_steps_trained": 1460000}, "done": false, "episodes_total": 146, "training_iteration": 365, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-04-42", "timestamp": 1618146282, "time_this_iter_s": 19.434137105941772, "time_total_s": 7614.554288625717, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c0550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac82c3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7614.554288625717, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 213.0, "episode_reward_min": 213.0, "episode_reward_mean": 213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5253639628566829, "mean_raw_obs_processing_ms": 0.11069782510190293, "mean_inference_ms": 1.5886251774263813, "mean_action_processing_ms": 0.04744168226280642}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1464000, "timers": {"sample_time_ms": 7780.694, "sample_throughput": 514.093, "learn_time_ms": 11757.667, "learn_throughput": 340.204, "update_time_ms": 3.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 1.9004806354641914, "policy_loss": -0.05268842616351321, "vf_loss": 1.9360623508691788, "vf_explained_var": 0.48917821049690247, "kl": 0.01849923019472044, "entropy": 0.2959236325696111, "entropy_coeff": 0.0}}, "num_steps_sampled": 1464000, "num_steps_trained": 1464000}, "done": false, "episodes_total": 146, "training_iteration": 366, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-05-01", "timestamp": 1618146301, "time_this_iter_s": 19.43805432319641, "time_total_s": 7633.992342948914, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67df6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67dfe90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7633.992342948914, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 57.989285714285714, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 213.0, "episode_reward_min": 213.0, "episode_reward_mean": 213.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5253639628566829, "mean_raw_obs_processing_ms": 0.11069782510190293, "mean_inference_ms": 1.5886251774263813, "mean_action_processing_ms": 0.04744168226280642}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1468000, "timers": {"sample_time_ms": 7764.018, "sample_throughput": 515.197, "learn_time_ms": 11734.08, "learn_throughput": 340.887, "update_time_ms": 3.572}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 1.2456067986786366, "policy_loss": -0.037248633918352425, "vf_loss": 1.2729970924556255, "vf_explained_var": 0.6078199148178101, "kl": 0.010660838452167809, "entropy": 0.3647785149514675, "entropy_coeff": 0.0}}, "num_steps_sampled": 1468000, "num_steps_trained": 1468000}, "done": false, "episodes_total": 146, "training_iteration": 367, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-05-20", "timestamp": 1618146320, "time_this_iter_s": 19.2832350730896, "time_total_s": 7653.275578022003, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d57d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7653.275578022003, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 58.77499999999999, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 179.0, "episode_reward_min": 179.0, "episode_reward_mean": 179.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5226426386764985, "mean_raw_obs_processing_ms": 0.11095285879366756, "mean_inference_ms": 1.5882440987523196, "mean_action_processing_ms": 0.047432303599446245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1472000, "timers": {"sample_time_ms": 7769.88, "sample_throughput": 514.808, "learn_time_ms": 11693.037, "learn_throughput": 342.084, "update_time_ms": 3.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 0.6170244133099914, "policy_loss": -0.033786951506044716, "vf_loss": 0.6408384293317795, "vf_explained_var": 0.6586220264434814, "kl": 0.010784761107061058, "entropy": 0.2920276988297701, "entropy_coeff": 0.0}}, "num_steps_sampled": 1472000, "num_steps_trained": 1472000}, "done": false, "episodes_total": 147, "training_iteration": 368, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-05-40", "timestamp": 1618146340, "time_this_iter_s": 19.20758032798767, "time_total_s": 7672.483158349991, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d56d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68a6cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7672.483158349991, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 58.03703703703704, "ram_util_percent": 27.629629629629637}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 179.0, "episode_reward_min": 179.0, "episode_reward_mean": 179.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5226426386764985, "mean_raw_obs_processing_ms": 0.11095285879366756, "mean_inference_ms": 1.5882440987523196, "mean_action_processing_ms": 0.047432303599446245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1476000, "timers": {"sample_time_ms": 7744.209, "sample_throughput": 516.515, "learn_time_ms": 11667.423, "learn_throughput": 342.835, "update_time_ms": 3.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 0.28889315109699965, "policy_loss": -0.034323303611017764, "vf_loss": 0.3129718713462353, "vf_explained_var": 0.24160268902778625, "kl": 0.01107851580309216, "entropy": 0.2999524772167206, "entropy_coeff": 0.0}}, "num_steps_sampled": 1476000, "num_steps_trained": 1476000}, "done": false, "episodes_total": 147, "training_iteration": 369, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-05-59", "timestamp": 1618146359, "time_this_iter_s": 19.096923828125, "time_total_s": 7691.580082178116, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac73f190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7691.580082178116, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 59.233333333333334, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 155.0, "episode_reward_min": 155.0, "episode_reward_mean": 155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.521440620022774, "mean_raw_obs_processing_ms": 0.11109334633813245, "mean_inference_ms": 1.5877441237936907, "mean_action_processing_ms": 0.04741038150826776}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1480000, "timers": {"sample_time_ms": 7789.324, "sample_throughput": 513.523, "learn_time_ms": 11672.301, "learn_throughput": 342.692, "update_time_ms": 3.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 2.406889107078314, "policy_loss": -0.026645932579413056, "vf_loss": 2.426647000014782, "vf_explained_var": 0.5670155882835388, "kl": 0.007448715841746889, "entropy": 0.20986108109354973, "entropy_coeff": 0.0}}, "num_steps_sampled": 1480000, "num_steps_trained": 1480000}, "done": false, "episodes_total": 148, "training_iteration": 370, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-06-19", "timestamp": 1618146379, "time_this_iter_s": 20.185925006866455, "time_total_s": 7711.766007184982, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bde90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f4e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7711.766007184982, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 58.07931034482759, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 155.0, "episode_reward_min": 155.0, "episode_reward_mean": 155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.521440620022774, "mean_raw_obs_processing_ms": 0.11109334633813245, "mean_inference_ms": 1.5877441237936907, "mean_action_processing_ms": 0.04741038150826776}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1484000, "timers": {"sample_time_ms": 7840.196, "sample_throughput": 510.191, "learn_time_ms": 11612.75, "learn_throughput": 344.449, "update_time_ms": 3.045}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9247254013931525, "cur_lr": 5e-05, "total_loss": 1.8407951667904854, "policy_loss": -0.004346190864453092, "vf_loss": 1.8434372767806053, "vf_explained_var": 0.3094918727874756, "kl": 0.0018427903041811078, "entropy": 0.08704166510142386, "entropy_coeff": 0.0}}, "num_steps_sampled": 1484000, "num_steps_trained": 1484000}, "done": false, "episodes_total": 148, "training_iteration": 371, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-06-39", "timestamp": 1618146399, "time_this_iter_s": 19.76958131790161, "time_total_s": 7731.535588502884, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a6be10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7731.535588502884, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 58.33793103448276, "ram_util_percent": 27.610344827586218}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 155.0, "episode_reward_min": 155.0, "episode_reward_mean": 155.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.521440620022774, "mean_raw_obs_processing_ms": 0.11109334633813245, "mean_inference_ms": 1.5877441237936907, "mean_action_processing_ms": 0.04741038150826776}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1488000, "timers": {"sample_time_ms": 7932.277, "sample_throughput": 504.269, "learn_time_ms": 11601.345, "learn_throughput": 344.788, "update_time_ms": 3.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.46236270069657626, "cur_lr": 5e-05, "total_loss": 2.5668014250695705, "policy_loss": -0.04854078765492886, "vf_loss": 2.5973078459501266, "vf_explained_var": 0.591222882270813, "kl": 0.03900477470597252, "entropy": 0.2836745115928352, "entropy_coeff": 0.0}}, "num_steps_sampled": 1488000, "num_steps_trained": 1488000}, "done": false, "episodes_total": 148, "training_iteration": 372, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-06-59", "timestamp": 1618146419, "time_this_iter_s": 20.39590287208557, "time_total_s": 7751.9314913749695, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c0ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7751.9314913749695, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 58.768965517241384, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 253.0, "episode_reward_min": 253.0, "episode_reward_mean": 253.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [253.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.51983168771821, "mean_raw_obs_processing_ms": 0.11133676096513796, "mean_inference_ms": 1.5872732189151602, "mean_action_processing_ms": 0.047389751981630035}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1492000, "timers": {"sample_time_ms": 7921.6, "sample_throughput": 504.949, "learn_time_ms": 11651.967, "learn_throughput": 343.29, "update_time_ms": 2.978}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 4.167615152895451, "policy_loss": -0.050060176727129146, "vf_loss": 4.206962518393993, "vf_explained_var": 0.4891449213027954, "kl": 0.015446568751940504, "entropy": 0.30528242513537407, "entropy_coeff": 0.0}}, "num_steps_sampled": 1492000, "num_steps_trained": 1492000}, "done": false, "episodes_total": 149, "training_iteration": 373, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-07-19", "timestamp": 1618146439, "time_this_iter_s": 19.831512928009033, "time_total_s": 7771.7630043029785, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdd50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bdd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7771.7630043029785, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 59.278571428571425, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 253.0, "episode_reward_min": 253.0, "episode_reward_mean": 253.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [253.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.51983168771821, "mean_raw_obs_processing_ms": 0.11133676096513796, "mean_inference_ms": 1.5872732189151602, "mean_action_processing_ms": 0.047389751981630035}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1496000, "timers": {"sample_time_ms": 7918.411, "sample_throughput": 505.152, "learn_time_ms": 11660.926, "learn_throughput": 343.026, "update_time_ms": 2.934}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 4.324855282902718, "policy_loss": -0.042983884806744754, "vf_loss": 4.359941512346268, "vf_explained_var": 0.45751500129699707, "kl": 0.011387419974198565, "entropy": 0.325218403711915, "entropy_coeff": 0.0}}, "num_steps_sampled": 1496000, "num_steps_trained": 1496000}, "done": false, "episodes_total": 149, "training_iteration": 374, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-07-38", "timestamp": 1618146458, "time_this_iter_s": 19.24794840812683, "time_total_s": 7791.010952711105, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68db750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7791.010952711105, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 58.592592592592595, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 469.0, "episode_reward_min": 469.0, "episode_reward_mean": 469.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5182773808140927, "mean_raw_obs_processing_ms": 0.1114998059806693, "mean_inference_ms": 1.586952650203411, "mean_action_processing_ms": 0.04737447584423168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1500000, "timers": {"sample_time_ms": 7952.776, "sample_throughput": 502.969, "learn_time_ms": 11652.597, "learn_throughput": 343.271, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 3.56225323677063, "policy_loss": -0.04344024817692116, "vf_loss": 3.5920396894216537, "vf_explained_var": 0.507157564163208, "kl": 0.019687019084813073, "entropy": 0.2432347321882844, "entropy_coeff": 0.0}}, "num_steps_sampled": 1500000, "num_steps_trained": 1500000}, "done": false, "episodes_total": 150, "training_iteration": 375, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-07-58", "timestamp": 1618146478, "time_this_iter_s": 19.69018840789795, "time_total_s": 7810.701141119003, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68314d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7810.701141119003, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 58.55862068965517, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 469.0, "episode_reward_min": 469.0, "episode_reward_mean": 469.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5182773808140927, "mean_raw_obs_processing_ms": 0.1114998059806693, "mean_inference_ms": 1.586952650203411, "mean_action_processing_ms": 0.04737447584423168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1504000, "timers": {"sample_time_ms": 7984.002, "sample_throughput": 501.002, "learn_time_ms": 11657.874, "learn_throughput": 343.116, "update_time_ms": 2.869}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6935440510448644, "cur_lr": 5e-05, "total_loss": 3.2867570891976357, "policy_loss": -0.0455073572229594, "vf_loss": 3.3162499964237213, "vf_explained_var": 0.36369791626930237, "kl": 0.023090742412023246, "entropy": 0.25966645358130336, "entropy_coeff": 0.0}}, "num_steps_sampled": 1504000, "num_steps_trained": 1504000}, "done": false, "episodes_total": 150, "training_iteration": 376, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-08-18", "timestamp": 1618146498, "time_this_iter_s": 19.803226232528687, "time_total_s": 7830.504367351532, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69523d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7830.504367351532, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 57.942857142857136, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 469.0, "episode_reward_min": 469.0, "episode_reward_mean": 469.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5182773808140927, "mean_raw_obs_processing_ms": 0.1114998059806693, "mean_inference_ms": 1.586952650203411, "mean_action_processing_ms": 0.04737447584423168}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1508000, "timers": {"sample_time_ms": 8045.771, "sample_throughput": 497.156, "learn_time_ms": 11666.814, "learn_throughput": 342.853, "update_time_ms": 2.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 5.22538136690855, "policy_loss": -0.0383061621687375, "vf_loss": 5.254422038793564, "vf_explained_var": 0.48441827297210693, "kl": 0.008906428309273906, "entropy": 0.2892465153709054, "entropy_coeff": 0.0}}, "num_steps_sampled": 1508000, "num_steps_trained": 1508000}, "done": false, "episodes_total": 150, "training_iteration": 377, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-08-38", "timestamp": 1618146518, "time_this_iter_s": 19.98936414718628, "time_total_s": 7850.493731498718, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723bbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fe10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7850.493731498718, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 59.02142857142858, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 326.0, "episode_reward_min": 326.0, "episode_reward_mean": 326.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5165027772040492, "mean_raw_obs_processing_ms": 0.11174024701866443, "mean_inference_ms": 1.586450596641598, "mean_action_processing_ms": 0.04735416337646554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1512000, "timers": {"sample_time_ms": 8052.199, "sample_throughput": 496.759, "learn_time_ms": 11669.532, "learn_throughput": 342.773, "update_time_ms": 2.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 2.315427165478468, "policy_loss": -0.021112809714395553, "vf_loss": 2.3301813825964928, "vf_explained_var": 0.6149463653564453, "kl": 0.006112177550676279, "entropy": 0.3393639037385583, "entropy_coeff": 0.0}}, "num_steps_sampled": 1512000, "num_steps_trained": 1512000}, "done": false, "episodes_total": 151, "training_iteration": 378, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-08-57", "timestamp": 1618146537, "time_this_iter_s": 19.296167850494385, "time_total_s": 7869.789899349213, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69524d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7869.789899349213, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 58.86428571428572, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 326.0, "episode_reward_min": 326.0, "episode_reward_mean": 326.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5165027772040492, "mean_raw_obs_processing_ms": 0.11174024701866443, "mean_inference_ms": 1.586450596641598, "mean_action_processing_ms": 0.04735416337646554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1516000, "timers": {"sample_time_ms": 8032.01, "sample_throughput": 498.007, "learn_time_ms": 11677.39, "learn_throughput": 342.542, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 2.9095557406544685, "policy_loss": -0.028262446052394807, "vf_loss": 2.9301190227270126, "vf_explained_var": 0.423197865486145, "kl": 0.007400762682664208, "entropy": 0.27641989197582006, "entropy_coeff": 0.0}}, "num_steps_sampled": 1516000, "num_steps_trained": 1516000}, "done": false, "episodes_total": 151, "training_iteration": 379, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-09-16", "timestamp": 1618146556, "time_this_iter_s": 18.972574949264526, "time_total_s": 7888.762474298477, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7888.762474298477, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 57.98518518518519, "ram_util_percent": 27.607407407407415}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 276.0, "episode_reward_min": 276.0, "episode_reward_mean": 276.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5147727544192542, "mean_raw_obs_processing_ms": 0.11188324403255583, "mean_inference_ms": 1.585958728195329, "mean_action_processing_ms": 0.047333683539086555}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1520000, "timers": {"sample_time_ms": 7962.182, "sample_throughput": 502.375, "learn_time_ms": 11654.59, "learn_throughput": 343.212, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0403160765672965, "cur_lr": 5e-05, "total_loss": 2.8472611121833324, "policy_loss": -0.022436234343331307, "vf_loss": 2.865109246224165, "vf_explained_var": 0.6693785190582275, "kl": 0.004410344932693988, "entropy": 0.17700852314010262, "entropy_coeff": 0.0}}, "num_steps_sampled": 1520000, "num_steps_trained": 1520000}, "done": false, "episodes_total": 152, "training_iteration": 380, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-09-35", "timestamp": 1618146575, "time_this_iter_s": 19.262182474136353, "time_total_s": 7908.0246567726135, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bda90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68c0e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7908.0246567726135, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 58.86071428571427, "ram_util_percent": 27.63214285714286}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 276.0, "episode_reward_min": 276.0, "episode_reward_mean": 276.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5147727544192542, "mean_raw_obs_processing_ms": 0.11188324403255583, "mean_inference_ms": 1.585958728195329, "mean_action_processing_ms": 0.047333683539086555}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1524000, "timers": {"sample_time_ms": 7952.863, "sample_throughput": 502.964, "learn_time_ms": 11649.032, "learn_throughput": 343.376, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 3.1020453721284866, "policy_loss": -0.04873372602742165, "vf_loss": 3.1392138078808784, "vf_explained_var": 0.7685250043869019, "kl": 0.022234131349250674, "entropy": 0.18583689932711422, "entropy_coeff": 0.0}}, "num_steps_sampled": 1524000, "num_steps_trained": 1524000}, "done": false, "episodes_total": 152, "training_iteration": 381, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-09-55", "timestamp": 1618146595, "time_this_iter_s": 19.619171380996704, "time_total_s": 7927.64382815361, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7927.64382815361, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 58.41785714285714, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 276.0, "episode_reward_min": 276.0, "episode_reward_mean": 276.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5147727544192542, "mean_raw_obs_processing_ms": 0.11188324403255583, "mean_inference_ms": 1.585958728195329, "mean_action_processing_ms": 0.047333683539086555}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1528000, "timers": {"sample_time_ms": 7863.29, "sample_throughput": 508.693, "learn_time_ms": 11638.635, "learn_throughput": 343.683, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 3.675359159708023, "policy_loss": -0.06725311244372278, "vf_loss": 3.7149167209863663, "vf_explained_var": 0.3897433876991272, "kl": 0.03549631737405434, "entropy": 0.25923563726246357, "entropy_coeff": 0.0}}, "num_steps_sampled": 1528000, "num_steps_trained": 1528000}, "done": false, "episodes_total": 152, "training_iteration": 382, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-10-14", "timestamp": 1618146614, "time_this_iter_s": 19.39663338661194, "time_total_s": 7947.040461540222, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7947.040461540222, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 59.33703703703704, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 362.0, "episode_reward_min": 362.0, "episode_reward_mean": 362.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5123164655628465, "mean_raw_obs_processing_ms": 0.1121289675131515, "mean_inference_ms": 1.585553314092482, "mean_action_processing_ms": 0.04731619708866197}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1532000, "timers": {"sample_time_ms": 7826.515, "sample_throughput": 511.083, "learn_time_ms": 11593.153, "learn_throughput": 345.031, "update_time_ms": 2.959}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1703555861382087, "cur_lr": 5e-05, "total_loss": 2.479986075311899, "policy_loss": -0.009869135916233063, "vf_loss": 2.484721329063177, "vf_explained_var": 0.5252002477645874, "kl": 0.004386620792502072, "entropy": 0.2759645697660744, "entropy_coeff": 0.0}}, "num_steps_sampled": 1532000, "num_steps_trained": 1532000}, "done": false, "episodes_total": 153, "training_iteration": 383, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-10-34", "timestamp": 1618146634, "time_this_iter_s": 19.012648820877075, "time_total_s": 7966.053110361099, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fa90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7966.053110361099, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 58.01428571428571, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 362.0, "episode_reward_min": 362.0, "episode_reward_mean": 362.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5123164655628465, "mean_raw_obs_processing_ms": 0.1121289675131515, "mean_inference_ms": 1.585553314092482, "mean_action_processing_ms": 0.04731619708866197}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1536000, "timers": {"sample_time_ms": 7987.656, "sample_throughput": 500.773, "learn_time_ms": 11590.177, "learn_throughput": 345.12, "update_time_ms": 2.959}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 3.9697157815098763, "policy_loss": -0.04735676932614297, "vf_loss": 4.006942071020603, "vf_explained_var": 0.6349332332611084, "kl": 0.01731181902869139, "entropy": 0.2454898813739419, "entropy_coeff": 0.0}}, "num_steps_sampled": 1536000, "num_steps_trained": 1536000}, "done": false, "episodes_total": 153, "training_iteration": 384, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-10-54", "timestamp": 1618146654, "time_this_iter_s": 20.827084064483643, "time_total_s": 7986.880194425583, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686a7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7986.880194425583, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 59.120689655172406, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 375.0, "episode_reward_min": 375.0, "episode_reward_mean": 375.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5121911063929337, "mean_raw_obs_processing_ms": 0.1122958536267361, "mean_inference_ms": 1.5853393057112584, "mean_action_processing_ms": 0.047305117890115655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1540000, "timers": {"sample_time_ms": 8050.649, "sample_throughput": 496.854, "learn_time_ms": 11604.737, "learn_throughput": 344.687, "update_time_ms": 2.975}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 5.774280101060867, "policy_loss": -0.03117556549841538, "vf_loss": 5.794368654489517, "vf_explained_var": 0.4795808494091034, "kl": 0.018946300639072433, "entropy": 0.20035192370414734, "entropy_coeff": 0.0}}, "num_steps_sampled": 1540000, "num_steps_trained": 1540000}, "done": false, "episodes_total": 154, "training_iteration": 385, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-11-15", "timestamp": 1618146675, "time_this_iter_s": 20.46696639060974, "time_total_s": 8007.347160816193, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68313d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8007.347160816193, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 58.96, "ram_util_percent": 27.603333333333342}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 375.0, "episode_reward_min": 375.0, "episode_reward_mean": 375.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5121911063929337, "mean_raw_obs_processing_ms": 0.1122958536267361, "mean_inference_ms": 1.5853393057112584, "mean_action_processing_ms": 0.047305117890115655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1544000, "timers": {"sample_time_ms": 8071.429, "sample_throughput": 495.575, "learn_time_ms": 11619.426, "learn_throughput": 344.251, "update_time_ms": 2.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5851777930691043, "cur_lr": 5e-05, "total_loss": 1.8411755226552486, "policy_loss": -0.05425984528847039, "vf_loss": 1.8531504236161709, "vf_explained_var": 0.6642362475395203, "kl": 0.07225992949679494, "entropy": 0.17098883306607604, "entropy_coeff": 0.0}}, "num_steps_sampled": 1544000, "num_steps_trained": 1544000}, "done": false, "episodes_total": 154, "training_iteration": 386, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-11-35", "timestamp": 1618146695, "time_this_iter_s": 20.158777236938477, "time_total_s": 8027.505938053131, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8027.505938053131, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 58.33571428571428, "ram_util_percent": 27.600000000000005}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 375.0, "episode_reward_min": 375.0, "episode_reward_mean": 375.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5121911063929337, "mean_raw_obs_processing_ms": 0.1122958536267361, "mean_inference_ms": 1.5853393057112584, "mean_action_processing_ms": 0.047305117890115655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1548000, "timers": {"sample_time_ms": 8162.593, "sample_throughput": 490.04, "learn_time_ms": 11611.854, "learn_throughput": 344.476, "update_time_ms": 2.988}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 4.55836296081543, "policy_loss": -0.03147745179012418, "vf_loss": 4.581042177975178, "vf_explained_var": 0.4807840585708618, "kl": 0.010023543727584183, "entropy": 0.14898220635950565, "entropy_coeff": 0.0}}, "num_steps_sampled": 1548000, "num_steps_trained": 1548000}, "done": false, "episodes_total": 154, "training_iteration": 387, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-11-56", "timestamp": 1618146716, "time_this_iter_s": 20.827006101608276, "time_total_s": 8048.332944154739, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67f6c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8048.332944154739, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 58.480000000000004, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 282.0, "episode_reward_min": 282.0, "episode_reward_mean": 282.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5113479891774402, "mean_raw_obs_processing_ms": 0.11255121660078647, "mean_inference_ms": 1.5850330904417076, "mean_action_processing_ms": 0.04729086692918939}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1552000, "timers": {"sample_time_ms": 8212.535, "sample_throughput": 487.06, "learn_time_ms": 11615.738, "learn_throughput": 344.36, "update_time_ms": 2.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 3.9214023798704147, "policy_loss": -0.01676527882227674, "vf_loss": 3.9336680993437767, "vf_explained_var": 0.42595919966697693, "kl": 0.005126135743921623, "entropy": 0.119752251310274, "entropy_coeff": 0.0}}, "num_steps_sampled": 1552000, "num_steps_trained": 1552000}, "done": false, "episodes_total": 155, "training_iteration": 388, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-12-16", "timestamp": 1618146736, "time_this_iter_s": 19.838497400283813, "time_total_s": 8068.171441555023, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8068.171441555023, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 59.04285714285715, "ram_util_percent": 27.68214285714286}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 282.0, "episode_reward_min": 282.0, "episode_reward_mean": 282.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5113479891774402, "mean_raw_obs_processing_ms": 0.11255121660078647, "mean_inference_ms": 1.5850330904417076, "mean_action_processing_ms": 0.04729086692918939}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1556000, "timers": {"sample_time_ms": 8330.097, "sample_throughput": 480.186, "learn_time_ms": 11626.744, "learn_throughput": 344.034, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 5.0245565846562386, "policy_loss": -0.02503520206664689, "vf_loss": 5.044187285006046, "vf_explained_var": 0.581196665763855, "kl": 0.00615710967394989, "entropy": 0.13355239038355649, "entropy_coeff": 0.0}}, "num_steps_sampled": 1556000, "num_steps_trained": 1556000}, "done": false, "episodes_total": 155, "training_iteration": 389, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-12-36", "timestamp": 1618146756, "time_this_iter_s": 20.26031470298767, "time_total_s": 8088.431756258011, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8088.431756258011, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 59.12413793103447, "ram_util_percent": 27.67931034482759}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.510172982273869, "mean_raw_obs_processing_ms": 0.11275783747577534, "mean_inference_ms": 1.5851558725611343, "mean_action_processing_ms": 0.047293638057602484}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1560000, "timers": {"sample_time_ms": 8396.619, "sample_throughput": 476.382, "learn_time_ms": 11650.267, "learn_throughput": 343.34, "update_time_ms": 3.027}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 5.548211857676506, "policy_loss": -0.030033898598048836, "vf_loss": 5.570856720209122, "vf_explained_var": 0.4085431694984436, "kl": 0.008418006342253648, "entropy": 0.20476490631699562, "entropy_coeff": 0.0}}, "num_steps_sampled": 1560000, "num_steps_trained": 1560000}, "done": false, "episodes_total": 156, "training_iteration": 390, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-12-56", "timestamp": 1618146776, "time_this_iter_s": 20.160578966140747, "time_total_s": 8108.592335224152, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69f9310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8108.592335224152, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 58.46551724137932, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.510172982273869, "mean_raw_obs_processing_ms": 0.11275783747577534, "mean_inference_ms": 1.5851558725611343, "mean_action_processing_ms": 0.047293638057602484}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1564000, "timers": {"sample_time_ms": 8474.387, "sample_throughput": 472.011, "learn_time_ms": 11665.149, "learn_throughput": 342.902, "update_time_ms": 3.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 4.168970339000225, "policy_loss": -0.023467840044759214, "vf_loss": 4.18673101067543, "vf_explained_var": 0.49025553464889526, "kl": 0.006501927891804371, "entropy": 0.17393070040270686, "entropy_coeff": 0.0}}, "num_steps_sampled": 1564000, "num_steps_trained": 1564000}, "done": false, "episodes_total": 156, "training_iteration": 391, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-13-17", "timestamp": 1618146797, "time_this_iter_s": 20.547433376312256, "time_total_s": 8129.139768600464, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691f650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69121d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8129.139768600464, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 59.168965517241396, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.510172982273869, "mean_raw_obs_processing_ms": 0.11275783747577534, "mean_inference_ms": 1.5851558725611343, "mean_action_processing_ms": 0.047293638057602484}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1568000, "timers": {"sample_time_ms": 8650.068, "sample_throughput": 462.424, "learn_time_ms": 11698.562, "learn_throughput": 341.922, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8777666896036564, "cur_lr": 5e-05, "total_loss": 7.394032403826714, "policy_loss": -0.036895220895530656, "vf_loss": 7.404898822307587, "vf_explained_var": 0.5483598113059998, "kl": 0.02965349319856614, "entropy": 0.16375200124457479, "entropy_coeff": 0.0}}, "num_steps_sampled": 1568000, "num_steps_trained": 1568000}, "done": false, "episodes_total": 156, "training_iteration": 392, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-13-38", "timestamp": 1618146818, "time_this_iter_s": 21.48760223388672, "time_total_s": 8150.627370834351, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8150.627370834351, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 58.9, "ram_util_percent": 27.60000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 445.0, "episode_reward_min": 445.0, "episode_reward_mean": 445.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5097542708362366, "mean_raw_obs_processing_ms": 0.11311327024400358, "mean_inference_ms": 1.585712296368295, "mean_action_processing_ms": 0.047312589934857256}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1572000, "timers": {"sample_time_ms": 8876.409, "sample_throughput": 450.633, "learn_time_ms": 11744.827, "learn_throughput": 340.575, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3166500344054848, "cur_lr": 5e-05, "total_loss": 5.939342513680458, "policy_loss": -0.01156631697085686, "vf_loss": 5.946379438042641, "vf_explained_var": 0.47313418984413147, "kl": 0.0034400711992930155, "entropy": 0.10471998946741223, "entropy_coeff": 0.0}}, "num_steps_sampled": 1572000, "num_steps_trained": 1572000}, "done": false, "episodes_total": 157, "training_iteration": 393, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-14-00", "timestamp": 1618146840, "time_this_iter_s": 21.735483646392822, "time_total_s": 8172.362854480743, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b7232c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67f6150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8172.362854480743, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 59.25483870967742, "ram_util_percent": 27.690322580645173}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 445.0, "episode_reward_min": 445.0, "episode_reward_mean": 445.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5097542708362366, "mean_raw_obs_processing_ms": 0.11311327024400358, "mean_inference_ms": 1.585712296368295, "mean_action_processing_ms": 0.047312589934857256}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1576000, "timers": {"sample_time_ms": 8872.528, "sample_throughput": 450.83, "learn_time_ms": 11736.242, "learn_throughput": 340.825, "update_time_ms": 2.964}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6583250172027424, "cur_lr": 5e-05, "total_loss": 6.768215894699097, "policy_loss": -0.018197051074821502, "vf_loss": 6.775892809033394, "vf_explained_var": 0.4002504348754883, "kl": 0.015980078314896673, "entropy": 0.17506058886647224, "entropy_coeff": 0.0}}, "num_steps_sampled": 1576000, "num_steps_trained": 1576000}, "done": false, "episodes_total": 157, "training_iteration": 394, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-14-21", "timestamp": 1618146861, "time_this_iter_s": 20.705135107040405, "time_total_s": 8193.067989587784, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ab4fac90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8193.067989587784, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 58.906666666666666, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 438.0, "episode_reward_min": 438.0, "episode_reward_mean": 438.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5088619393153029, "mean_raw_obs_processing_ms": 0.1133090634507985, "mean_inference_ms": 1.5857248436028362, "mean_action_processing_ms": 0.047312223995508974}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1580000, "timers": {"sample_time_ms": 8795.924, "sample_throughput": 454.756, "learn_time_ms": 11761.42, "learn_throughput": 340.095, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6583250172027424, "cur_lr": 5e-05, "total_loss": 4.901105105876923, "policy_loss": -0.01645020628347993, "vf_loss": 4.913293436169624, "vf_explained_var": 0.7449188232421875, "kl": 0.006473857050877996, "entropy": 0.07667221268638968, "entropy_coeff": 0.0}}, "num_steps_sampled": 1580000, "num_steps_trained": 1580000}, "done": false, "episodes_total": 158, "training_iteration": 395, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-14-41", "timestamp": 1618146881, "time_this_iter_s": 19.952147960662842, "time_total_s": 8213.020137548447, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8213.020137548447, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 27.692857142857147}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 438.0, "episode_reward_min": 438.0, "episode_reward_mean": 438.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5088619393153029, "mean_raw_obs_processing_ms": 0.1133090634507985, "mean_inference_ms": 1.5857248436028362, "mean_action_processing_ms": 0.047312223995508974}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1584000, "timers": {"sample_time_ms": 8772.832, "sample_throughput": 455.953, "learn_time_ms": 11785.762, "learn_throughput": 339.393, "update_time_ms": 2.986}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6583250172027424, "cur_lr": 5e-05, "total_loss": 7.9532919228076935, "policy_loss": -0.029735909076407552, "vf_loss": 7.976007461547852, "vf_explained_var": 0.6547030806541443, "kl": 0.010663955064956099, "entropy": 0.1569150621071458, "entropy_coeff": 0.0}}, "num_steps_sampled": 1584000, "num_steps_trained": 1584000}, "done": false, "episodes_total": 158, "training_iteration": 396, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-15-01", "timestamp": 1618146901, "time_this_iter_s": 20.173357725143433, "time_total_s": 8233.19349527359, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b01d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8233.19349527359, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 59.220689655172414, "ram_util_percent": 27.672413793103452}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 438.0, "episode_reward_min": 438.0, "episode_reward_mean": 438.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5088619393153029, "mean_raw_obs_processing_ms": 0.1133090634507985, "mean_inference_ms": 1.5857248436028362, "mean_action_processing_ms": 0.047312223995508974}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1588000, "timers": {"sample_time_ms": 8681.044, "sample_throughput": 460.774, "learn_time_ms": 11810.751, "learn_throughput": 338.674, "update_time_ms": 2.935}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6583250172027424, "cur_lr": 5e-05, "total_loss": 5.201478585600853, "policy_loss": -0.029663116962183267, "vf_loss": 5.223705053329468, "vf_explained_var": 0.604076087474823, "kl": 0.011296289681922644, "entropy": 0.10252255713567138, "entropy_coeff": 0.0}}, "num_steps_sampled": 1588000, "num_steps_trained": 1588000}, "done": false, "episodes_total": 158, "training_iteration": 397, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-15-21", "timestamp": 1618146921, "time_this_iter_s": 20.158989191055298, "time_total_s": 8253.352484464645, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69009d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691fb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8253.352484464645, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 58.99655172413792, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 383.0, "episode_reward_min": 383.0, "episode_reward_mean": 383.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5068251366623235, "mean_raw_obs_processing_ms": 0.11360948191924543, "mean_inference_ms": 1.5857070274183307, "mean_action_processing_ms": 0.04730975891005588}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1592000, "timers": {"sample_time_ms": 8655.497, "sample_throughput": 462.134, "learn_time_ms": 11879.756, "learn_throughput": 336.707, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6583250172027424, "cur_lr": 5e-05, "total_loss": 6.546545892953873, "policy_loss": -0.06091884564375505, "vf_loss": 6.579090043902397, "vf_explained_var": 0.5828427076339722, "kl": 0.04310149882803671, "entropy": 0.19770717667415738, "entropy_coeff": 0.0}}, "num_steps_sampled": 1592000, "num_steps_trained": 1592000}, "done": false, "episodes_total": 159, "training_iteration": 398, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-15-41", "timestamp": 1618146941, "time_this_iter_s": 20.271872997283936, "time_total_s": 8273.62435746193, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a5cb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8273.62435746193, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 59.2896551724138, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 383.0, "episode_reward_min": 383.0, "episode_reward_mean": 383.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5068251366623235, "mean_raw_obs_processing_ms": 0.11360948191924543, "mean_inference_ms": 1.5857070274183307, "mean_action_processing_ms": 0.04730975891005588}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1596000, "timers": {"sample_time_ms": 8624.229, "sample_throughput": 463.81, "learn_time_ms": 11883.039, "learn_throughput": 336.614, "update_time_ms": 2.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 3.8983327746391296, "policy_loss": -0.01732151093892753, "vf_loss": 3.9089296981692314, "vf_explained_var": 0.5062874555587769, "kl": 0.006809760148826172, "entropy": 0.13526605640072376, "entropy_coeff": 0.0}}, "num_steps_sampled": 1596000, "num_steps_trained": 1596000}, "done": false, "episodes_total": 159, "training_iteration": 399, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-16-01", "timestamp": 1618146961, "time_this_iter_s": 19.981180906295776, "time_total_s": 8293.605538368225, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699fd90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67f6c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8293.605538368225, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 58.50714285714287, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 463.0, "episode_reward_min": 463.0, "episode_reward_mean": 463.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [463.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5063264501561142, "mean_raw_obs_processing_ms": 0.11378643330113704, "mean_inference_ms": 1.5855265320568868, "mean_action_processing_ms": 0.04730353185454118}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1600000, "timers": {"sample_time_ms": 8701.969, "sample_throughput": 459.666, "learn_time_ms": 11924.226, "learn_throughput": 335.452, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 8.977209374308586, "policy_loss": -0.023497578396927565, "vf_loss": 8.992888525128365, "vf_explained_var": 0.48932647705078125, "kl": 0.007917427763459273, "entropy": 0.16619509202428162, "entropy_coeff": 0.0}}, "num_steps_sampled": 1600000, "num_steps_trained": 1600000}, "done": false, "episodes_total": 160, "training_iteration": 400, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-16-23", "timestamp": 1618146983, "time_this_iter_s": 21.34650230407715, "time_total_s": 8314.952040672302, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69009d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8314.952040672302, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 58.97096774193548, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 463.0, "episode_reward_min": 463.0, "episode_reward_mean": 463.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [463.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5063264501561142, "mean_raw_obs_processing_ms": 0.11378643330113704, "mean_inference_ms": 1.5855265320568868, "mean_action_processing_ms": 0.04730353185454118}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1604000, "timers": {"sample_time_ms": 8770.452, "sample_throughput": 456.077, "learn_time_ms": 11955.487, "learn_throughput": 334.574, "update_time_ms": 2.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 8.17073205113411, "policy_loss": -0.0288651556475088, "vf_loss": 8.192604839801788, "vf_explained_var": 0.49965548515319824, "kl": 0.007080884177412372, "entropy": 0.17769168340601027, "entropy_coeff": 0.0}}, "num_steps_sampled": 1604000, "num_steps_trained": 1604000}, "done": false, "episodes_total": 160, "training_iteration": 401, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-16-44", "timestamp": 1618147004, "time_this_iter_s": 21.54379677772522, "time_total_s": 8336.495837450027, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68b2950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686ad90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8336.495837450027, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 58.98387096774194, "ram_util_percent": 27.66451612903227}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 463.0, "episode_reward_min": 463.0, "episode_reward_mean": 463.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [463.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5063264501561142, "mean_raw_obs_processing_ms": 0.11378643330113704, "mean_inference_ms": 1.5855265320568868, "mean_action_processing_ms": 0.04730353185454118}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1608000, "timers": {"sample_time_ms": 8696.791, "sample_throughput": 459.94, "learn_time_ms": 11976.982, "learn_throughput": 333.974, "update_time_ms": 2.831}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 5.330812156200409, "policy_loss": -0.02213555935304612, "vf_loss": 5.347330927848816, "vf_explained_var": 0.553078830242157, "kl": 0.005688020937668625, "entropy": 0.0823866871651262, "entropy_coeff": 0.0}}, "num_steps_sampled": 1608000, "num_steps_trained": 1608000}, "done": false, "episodes_total": 160, "training_iteration": 402, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-17-05", "timestamp": 1618147025, "time_this_iter_s": 20.965635061264038, "time_total_s": 8357.461472511292, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69005d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69125d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8357.461472511292, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 59.61000000000001, "ram_util_percent": 27.656666666666677}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 557.0, "episode_reward_min": 557.0, "episode_reward_mean": 557.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [557.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5053482922986536, "mean_raw_obs_processing_ms": 0.11413066903374602, "mean_inference_ms": 1.586118546274199, "mean_action_processing_ms": 0.04731926011811977}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1612000, "timers": {"sample_time_ms": 8614.208, "sample_throughput": 464.349, "learn_time_ms": 11929.996, "learn_throughput": 335.289, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 5.581389918923378, "policy_loss": -0.015441839001141489, "vf_loss": 5.589965373277664, "vf_explained_var": 0.2613474428653717, "kl": 0.006953376723686233, "entropy": 0.13764726324006915, "entropy_coeff": 0.0}}, "num_steps_sampled": 1612000, "num_steps_trained": 1612000}, "done": false, "episodes_total": 161, "training_iteration": 403, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-17-26", "timestamp": 1618147046, "time_this_iter_s": 20.44119119644165, "time_total_s": 8377.902663707733, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699ff50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fe90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8377.902663707733, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 60.158620689655166, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 557.0, "episode_reward_min": 557.0, "episode_reward_mean": 557.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [557.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5053482922986536, "mean_raw_obs_processing_ms": 0.11413066903374602, "mean_inference_ms": 1.586118546274199, "mean_action_processing_ms": 0.04731926011811977}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1616000, "timers": {"sample_time_ms": 8459.37, "sample_throughput": 472.848, "learn_time_ms": 11963.896, "learn_throughput": 334.339, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 2.6344678103923798, "policy_loss": -0.01898957375669852, "vf_loss": 2.6484000086784363, "vf_explained_var": 0.207423597574234, "kl": 0.005121418369526509, "entropy": 0.16860333131626248, "entropy_coeff": 0.0}}, "num_steps_sampled": 1616000, "num_steps_trained": 1616000}, "done": false, "episodes_total": 161, "training_iteration": 404, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-17-45", "timestamp": 1618147065, "time_this_iter_s": 19.494170427322388, "time_total_s": 8397.396834135056, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c03d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8397.396834135056, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 58.40714285714285, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 77.0, "episode_reward_min": 77.0, "episode_reward_mean": 77.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5038218540641971, "mean_raw_obs_processing_ms": 0.1143399926502486, "mean_inference_ms": 1.5862001485286485, "mean_action_processing_ms": 0.04732103281862983}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1620000, "timers": {"sample_time_ms": 8520.419, "sample_throughput": 469.46, "learn_time_ms": 11959.176, "learn_throughput": 334.471, "update_time_ms": 2.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9874875258041136, "cur_lr": 5e-05, "total_loss": 2.2395517081022263, "policy_loss": -0.00885553570697084, "vf_loss": 2.246071480214596, "vf_explained_var": 0.2908118963241577, "kl": 0.0023653064454265404, "entropy": 0.09748071036301553, "entropy_coeff": 0.0}}, "num_steps_sampled": 1620000, "num_steps_trained": 1620000}, "done": false, "episodes_total": 162, "training_iteration": 405, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-18-06", "timestamp": 1618147086, "time_this_iter_s": 20.517555952072144, "time_total_s": 8417.914390087128, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8417.914390087128, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 59.63793103448277, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 77.0, "episode_reward_min": 77.0, "episode_reward_mean": 77.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5038218540641971, "mean_raw_obs_processing_ms": 0.1143399926502486, "mean_inference_ms": 1.5862001485286485, "mean_action_processing_ms": 0.04732103281862983}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1624000, "timers": {"sample_time_ms": 8476.084, "sample_throughput": 471.916, "learn_time_ms": 11964.402, "learn_throughput": 334.325, "update_time_ms": 2.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 0.6220694007351995, "policy_loss": 0.005640075949486345, "vf_loss": 0.6164288362488151, "vf_explained_var": 0.00012142397463321686, "kl": 9.984756488279345e-07, "entropy": 0.0006967513199924724, "entropy_coeff": 0.0}}, "num_steps_sampled": 1624000, "num_steps_trained": 1624000}, "done": false, "episodes_total": 162, "training_iteration": 406, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-18-26", "timestamp": 1618147106, "time_this_iter_s": 19.782212734222412, "time_total_s": 8437.69660282135, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8437.69660282135, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 59.596428571428575, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 77.0, "episode_reward_min": 77.0, "episode_reward_mean": 77.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5038218540641971, "mean_raw_obs_processing_ms": 0.1143399926502486, "mean_inference_ms": 1.5862001485286485, "mean_action_processing_ms": 0.04732103281862983}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1628000, "timers": {"sample_time_ms": 8479.745, "sample_throughput": 471.712, "learn_time_ms": 11967.791, "learn_throughput": 334.23, "update_time_ms": 2.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2468718814510284, "cur_lr": 5e-05, "total_loss": 0.10712576704099774, "policy_loss": -0.0008968788315542042, "vf_loss": 0.10802160180173814, "vf_explained_var": -0.0014608260244131088, "kl": 4.203445321593335e-06, "entropy": 0.0005008393081880058, "entropy_coeff": 0.0}}, "num_steps_sampled": 1628000, "num_steps_trained": 1628000}, "done": false, "episodes_total": 162, "training_iteration": 407, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-18-46", "timestamp": 1618147126, "time_this_iter_s": 20.22500228881836, "time_total_s": 8457.921605110168, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a98d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8457.921605110168, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 58.5551724137931, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5018885516838174, "mean_raw_obs_processing_ms": 0.1146432532620407, "mean_inference_ms": 1.5861368838565788, "mean_action_processing_ms": 0.04732098438012336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1632000, "timers": {"sample_time_ms": 8519.742, "sample_throughput": 469.498, "learn_time_ms": 11907.541, "learn_throughput": 335.922, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1234359407255142, "cur_lr": 5e-05, "total_loss": 0.020620823197532445, "policy_loss": 0.0026748832897283137, "vf_loss": 0.0179457523918245, "vf_explained_var": -0.0043000634759664536, "kl": 1.500501326745507e-06, "entropy": 0.00040032911601883825, "entropy_coeff": 0.0}}, "num_steps_sampled": 1632000, "num_steps_trained": 1632000}, "done": false, "episodes_total": 163, "training_iteration": 408, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-19-06", "timestamp": 1618147146, "time_this_iter_s": 20.069833993911743, "time_total_s": 8477.99143910408, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8477.99143910408, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 59.358620689655176, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5018885516838174, "mean_raw_obs_processing_ms": 0.1146432532620407, "mean_inference_ms": 1.5861368838565788, "mean_action_processing_ms": 0.04732098438012336}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1636000, "timers": {"sample_time_ms": 8479.954, "sample_throughput": 471.701, "learn_time_ms": 11925.319, "learn_throughput": 335.421, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0617179703627571, "cur_lr": 5e-05, "total_loss": -0.012645030044950545, "policy_loss": -0.01635417074430734, "vf_loss": 0.00355852138454793, "vf_explained_var": -0.002842109650373459, "kl": 0.00244043105703895, "entropy": 0.016414691315731034, "entropy_coeff": 0.0}}, "num_steps_sampled": 1636000, "num_steps_trained": 1636000}, "done": false, "episodes_total": 163, "training_iteration": 409, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-19-26", "timestamp": 1618147166, "time_this_iter_s": 19.761199712753296, "time_total_s": 8497.752638816833, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cf090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cf450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8497.752638816833, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 59.54285714285714, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 249.0, "episode_reward_min": 249.0, "episode_reward_mean": 249.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5014060383817986, "mean_raw_obs_processing_ms": 0.11482772411044305, "mean_inference_ms": 1.5859775623065622, "mean_action_processing_ms": 0.04731728180689574}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1640000, "timers": {"sample_time_ms": 8523.35, "sample_throughput": 469.299, "learn_time_ms": 11924.032, "learn_throughput": 335.457, "update_time_ms": 2.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03085898518137855, "cur_lr": 5e-05, "total_loss": 7.341895431280136, "policy_loss": -0.05017629882786423, "vf_loss": 7.389800429344177, "vf_explained_var": 0.5299453735351562, "kl": 0.07360459864139557, "entropy": 0.21208463283255696, "entropy_coeff": 0.0}}, "num_steps_sampled": 1640000, "num_steps_trained": 1640000}, "done": false, "episodes_total": 164, "training_iteration": 410, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-19-48", "timestamp": 1618147188, "time_this_iter_s": 21.772185802459717, "time_total_s": 8519.524824619293, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8519.524824619293, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 59.19999999999999, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 249.0, "episode_reward_min": 249.0, "episode_reward_mean": 249.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5014060383817986, "mean_raw_obs_processing_ms": 0.11482772411044305, "mean_inference_ms": 1.5859775623065622, "mean_action_processing_ms": 0.04731728180689574}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1644000, "timers": {"sample_time_ms": 8612.864, "sample_throughput": 464.422, "learn_time_ms": 11879.248, "learn_throughput": 336.722, "update_time_ms": 2.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04628847777206782, "cur_lr": 5e-05, "total_loss": 8.322855338454247, "policy_loss": -0.04971320618642494, "vf_loss": 8.370313942432404, "vf_explained_var": 0.4551355242729187, "kl": 0.04870758968172595, "entropy": 0.18171973945572972, "entropy_coeff": 0.0}}, "num_steps_sampled": 1644000, "num_steps_trained": 1644000}, "done": false, "episodes_total": 164, "training_iteration": 411, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-20-10", "timestamp": 1618147210, "time_this_iter_s": 21.99350881576538, "time_total_s": 8541.518333435059, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68db210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8541.518333435059, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 58.46875, "ram_util_percent": 27.7}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 249.0, "episode_reward_min": 249.0, "episode_reward_mean": 249.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5014060383817986, "mean_raw_obs_processing_ms": 0.11482772411044305, "mean_inference_ms": 1.5859775623065622, "mean_action_processing_ms": 0.04731728180689574}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1648000, "timers": {"sample_time_ms": 8666.299, "sample_throughput": 461.558, "learn_time_ms": 11864.627, "learn_throughput": 337.137, "update_time_ms": 2.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06943271665810173, "cur_lr": 5e-05, "total_loss": 6.403412610292435, "policy_loss": -0.03361961539485492, "vf_loss": 6.43483804166317, "vf_explained_var": 0.41677427291870117, "kl": 0.031601231516106054, "entropy": 0.1669818670488894, "entropy_coeff": 0.0}}, "num_steps_sampled": 1648000, "num_steps_trained": 1648000}, "done": false, "episodes_total": 164, "training_iteration": 412, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-20-31", "timestamp": 1618147231, "time_this_iter_s": 21.350821018218994, "time_total_s": 8562.869154453278, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8562.869154453278, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 58.953333333333326, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 793.0, "episode_reward_min": 793.0, "episode_reward_mean": 793.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [793.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5018463771371711, "mean_raw_obs_processing_ms": 0.11510389238224823, "mean_inference_ms": 1.5856783352785793, "mean_action_processing_ms": 0.04730597168486773}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1652000, "timers": {"sample_time_ms": 8589.839, "sample_throughput": 465.666, "learn_time_ms": 11902.027, "learn_throughput": 336.077, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10414907498715259, "cur_lr": 5e-05, "total_loss": 5.833786457777023, "policy_loss": -0.03620643774047494, "vf_loss": 5.867036879062653, "vf_explained_var": 0.44691747426986694, "kl": 0.02838250259810593, "entropy": 0.1775924765970558, "entropy_coeff": 0.0}}, "num_steps_sampled": 1652000, "num_steps_trained": 1652000}, "done": false, "episodes_total": 165, "training_iteration": 413, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-20-51", "timestamp": 1618147251, "time_this_iter_s": 20.053014516830444, "time_total_s": 8582.922168970108, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b08d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8582.922168970108, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 58.54482758620689, "ram_util_percent": 27.61034482758621}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 793.0, "episode_reward_min": 793.0, "episode_reward_mean": 793.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [793.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5018463771371711, "mean_raw_obs_processing_ms": 0.11510389238224823, "mean_inference_ms": 1.5856783352785793, "mean_action_processing_ms": 0.04730597168486773}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1656000, "timers": {"sample_time_ms": 8665.613, "sample_throughput": 461.595, "learn_time_ms": 11879.46, "learn_throughput": 336.716, "update_time_ms": 3.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15622361248072889, "cur_lr": 5e-05, "total_loss": 6.403190642595291, "policy_loss": -0.04472507489845157, "vf_loss": 6.443000465631485, "vf_explained_var": 0.650565505027771, "kl": 0.03146267408737913, "entropy": 0.22412727214396, "entropy_coeff": 0.0}}, "num_steps_sampled": 1656000, "num_steps_trained": 1656000}, "done": false, "episodes_total": 165, "training_iteration": 414, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-21-11", "timestamp": 1618147271, "time_this_iter_s": 20.02734088897705, "time_total_s": 8602.949509859085, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b96370d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8602.949509859085, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 59.54642857142858, "ram_util_percent": 27.61428571428572}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 565.0, "episode_reward_min": 565.0, "episode_reward_mean": 565.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [565.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.500596411306667, "mean_raw_obs_processing_ms": 0.11530014224744017, "mean_inference_ms": 1.585556866848683, "mean_action_processing_ms": 0.04730129092630223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1660000, "timers": {"sample_time_ms": 8591.014, "sample_throughput": 465.603, "learn_time_ms": 11919.235, "learn_throughput": 335.592, "update_time_ms": 2.999}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2343354187210933, "cur_lr": 5e-05, "total_loss": 5.727030873298645, "policy_loss": -0.031223194324411452, "vf_loss": 5.755058288574219, "vf_explained_var": 0.5850011110305786, "kl": 0.013637878670124337, "entropy": 0.18978909635916352, "entropy_coeff": 0.0}}, "num_steps_sampled": 1660000, "num_steps_trained": 1660000}, "done": false, "episodes_total": 166, "training_iteration": 415, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-21-31", "timestamp": 1618147291, "time_this_iter_s": 20.167497873306274, "time_total_s": 8623.117007732391, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdf50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8623.117007732391, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 59.41379310344828, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 565.0, "episode_reward_min": 565.0, "episode_reward_mean": 565.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [565.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.500596411306667, "mean_raw_obs_processing_ms": 0.11530014224744017, "mean_inference_ms": 1.585556866848683, "mean_action_processing_ms": 0.04730129092630223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1664000, "timers": {"sample_time_ms": 8583.902, "sample_throughput": 465.989, "learn_time_ms": 11937.293, "learn_throughput": 335.084, "update_time_ms": 2.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2343354187210933, "cur_lr": 5e-05, "total_loss": 2.6913410238921642, "policy_loss": -0.03251949022524059, "vf_loss": 2.7194831911474466, "vf_explained_var": 0.6301605105400085, "kl": 0.018679740896914154, "entropy": 0.21685748361051083, "entropy_coeff": 0.0}}, "num_steps_sampled": 1664000, "num_steps_trained": 1664000}, "done": false, "episodes_total": 166, "training_iteration": 416, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-21-51", "timestamp": 1618147311, "time_this_iter_s": 19.891496658325195, "time_total_s": 8643.008504390717, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cf4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8643.008504390717, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 58.732142857142854, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 565.0, "episode_reward_min": 565.0, "episode_reward_mean": 565.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [565.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.500596411306667, "mean_raw_obs_processing_ms": 0.11530014224744017, "mean_inference_ms": 1.585556866848683, "mean_action_processing_ms": 0.04730129092630223}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1668000, "timers": {"sample_time_ms": 8570.942, "sample_throughput": 466.693, "learn_time_ms": 11944.508, "learn_throughput": 334.882, "update_time_ms": 2.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2343354187210933, "cur_lr": 5e-05, "total_loss": 9.848538786172867, "policy_loss": -0.08222544123418629, "vf_loss": 9.904075339436531, "vf_explained_var": 0.4959128499031067, "kl": 0.11389124323613942, "entropy": 0.24449877440929413, "entropy_coeff": 0.0}}, "num_steps_sampled": 1668000, "num_steps_trained": 1668000}, "done": false, "episodes_total": 166, "training_iteration": 417, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-22-12", "timestamp": 1618147332, "time_this_iter_s": 20.171335220336914, "time_total_s": 8663.179839611053, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69526d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8663.179839611053, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 59.18620689655174, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 390.0, "episode_reward_min": 390.0, "episode_reward_mean": 390.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4990978287498319, "mean_raw_obs_processing_ms": 0.11559067633413868, "mean_inference_ms": 1.5854036008535013, "mean_action_processing_ms": 0.04729543613882199}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1672000, "timers": {"sample_time_ms": 8635.143, "sample_throughput": 463.223, "learn_time_ms": 11930.342, "learn_throughput": 335.28, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.35150312808163997, "cur_lr": 5e-05, "total_loss": 6.53565613925457, "policy_loss": -0.04027456766925752, "vf_loss": 6.571539804339409, "vf_explained_var": 0.45197802782058716, "kl": 0.012491380563005805, "entropy": 0.14036632189527154, "entropy_coeff": 0.0}}, "num_steps_sampled": 1672000, "num_steps_trained": 1672000}, "done": false, "episodes_total": 167, "training_iteration": 418, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-22-32", "timestamp": 1618147352, "time_this_iter_s": 20.567999839782715, "time_total_s": 8683.747839450836, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8683.747839450836, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 59.29333333333332, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 390.0, "episode_reward_min": 390.0, "episode_reward_mean": 390.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4990978287498319, "mean_raw_obs_processing_ms": 0.11559067633413868, "mean_inference_ms": 1.5854036008535013, "mean_action_processing_ms": 0.04729543613882199}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1676000, "timers": {"sample_time_ms": 8783.201, "sample_throughput": 455.415, "learn_time_ms": 11947.39, "learn_throughput": 334.801, "update_time_ms": 3.031}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.35150312808163997, "cur_lr": 5e-05, "total_loss": 7.402942627668381, "policy_loss": -0.057208298676414415, "vf_loss": 7.444949373602867, "vf_explained_var": 0.5124408006668091, "kl": 0.04324706248007715, "entropy": 0.18048191163688898, "entropy_coeff": 0.0}}, "num_steps_sampled": 1676000, "num_steps_trained": 1676000}, "done": false, "episodes_total": 167, "training_iteration": 419, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-22-54", "timestamp": 1618147374, "time_this_iter_s": 21.41720962524414, "time_total_s": 8705.16504907608, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8705.16504907608, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 58.87, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 978.0, "episode_reward_min": 978.0, "episode_reward_mean": 978.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [978.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.499173803600998, "mean_raw_obs_processing_ms": 0.11577239652692906, "mean_inference_ms": 1.5852124472653712, "mean_action_processing_ms": 0.04729078605743631}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1680000, "timers": {"sample_time_ms": 8718.914, "sample_throughput": 458.773, "learn_time_ms": 11919.128, "learn_throughput": 335.595, "update_time_ms": 3.024}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 7.070093274116516, "policy_loss": -0.03813790687127039, "vf_loss": 7.097788497805595, "vf_explained_var": 0.3877354860305786, "kl": 0.01980573803302832, "entropy": 0.13552065915428102, "entropy_coeff": 0.0}}, "num_steps_sampled": 1680000, "num_steps_trained": 1680000}, "done": false, "episodes_total": 168, "training_iteration": 420, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-23-14", "timestamp": 1618147394, "time_this_iter_s": 20.847439527511597, "time_total_s": 8726.012488603592, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a5c6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8726.012488603592, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 58.126666666666665, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 978.0, "episode_reward_min": 978.0, "episode_reward_mean": 978.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [978.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.499173803600998, "mean_raw_obs_processing_ms": 0.11577239652692906, "mean_inference_ms": 1.5852124472653712, "mean_action_processing_ms": 0.04729078605743631}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1684000, "timers": {"sample_time_ms": 8521.509, "sample_throughput": 469.4, "learn_time_ms": 11922.119, "learn_throughput": 335.511, "update_time_ms": 3.003}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 7.7382765263319016, "policy_loss": -0.01659806675161235, "vf_loss": 7.752010554075241, "vf_explained_var": 0.543694257736206, "kl": 0.005431812802271452, "entropy": 0.05828173190820962, "entropy_coeff": 0.0}}, "num_steps_sampled": 1684000, "num_steps_trained": 1684000}, "done": false, "episodes_total": 168, "training_iteration": 421, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-23-35", "timestamp": 1618147415, "time_this_iter_s": 20.04993772506714, "time_total_s": 8746.062426328659, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b691ff90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8746.062426328659, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 59.331034482758625, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 978.0, "episode_reward_min": 978.0, "episode_reward_mean": 978.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [978.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.499173803600998, "mean_raw_obs_processing_ms": 0.11577239652692906, "mean_inference_ms": 1.5852124472653712, "mean_action_processing_ms": 0.04729078605743631}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1688000, "timers": {"sample_time_ms": 8424.547, "sample_throughput": 474.803, "learn_time_ms": 11940.555, "learn_throughput": 334.993, "update_time_ms": 2.958}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 6.445946514606476, "policy_loss": -0.034303169581107795, "vf_loss": 6.471697881817818, "vf_explained_var": 0.5105260610580444, "kl": 0.016219320008531213, "entropy": 0.12401777086779475, "entropy_coeff": 0.0}}, "num_steps_sampled": 1688000, "num_steps_trained": 1688000}, "done": false, "episodes_total": 168, "training_iteration": 422, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-23-55", "timestamp": 1618147435, "time_this_iter_s": 20.56792950630188, "time_total_s": 8766.630355834961, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8766.630355834961, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 59.817241379310346, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 636.0, "episode_reward_min": 636.0, "episode_reward_mean": 636.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [636.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4979011997898992, "mean_raw_obs_processing_ms": 0.11611012011820808, "mean_inference_ms": 1.585476397344971, "mean_action_processing_ms": 0.047303351893120904}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1692000, "timers": {"sample_time_ms": 8538.588, "sample_throughput": 468.462, "learn_time_ms": 11934.111, "learn_throughput": 335.174, "update_time_ms": 2.94}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 8.698700591921806, "policy_loss": -0.026283129991497844, "vf_loss": 8.719082996249199, "vf_explained_var": 0.42551034688949585, "kl": 0.011191475845407695, "entropy": 0.13150964421220124, "entropy_coeff": 0.0}}, "num_steps_sampled": 1692000, "num_steps_trained": 1692000}, "done": false, "episodes_total": 169, "training_iteration": 423, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-24-16", "timestamp": 1618147456, "time_this_iter_s": 21.125067949295044, "time_total_s": 8787.755423784256, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68c0c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8787.755423784256, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 59.156666666666666, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 636.0, "episode_reward_min": 636.0, "episode_reward_mean": 636.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [636.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4979011997898992, "mean_raw_obs_processing_ms": 0.11611012011820808, "mean_inference_ms": 1.585476397344971, "mean_action_processing_ms": 0.047303351893120904}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1696000, "timers": {"sample_time_ms": 8561.551, "sample_throughput": 467.205, "learn_time_ms": 11948.935, "learn_throughput": 334.758, "update_time_ms": 3.006}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 9.3255764991045, "policy_loss": -0.022796753648435697, "vf_loss": 9.342971697449684, "vf_explained_var": 0.4896950125694275, "kl": 0.010244774559396319, "entropy": 0.14083730173297226, "entropy_coeff": 0.0}}, "num_steps_sampled": 1696000, "num_steps_trained": 1696000}, "done": false, "episodes_total": 169, "training_iteration": 424, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-24-37", "timestamp": 1618147477, "time_this_iter_s": 20.408387660980225, "time_total_s": 8808.163811445236, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6799190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6799850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8808.163811445236, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 58.55517241379311, "ram_util_percent": 27.751724137931024}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 709.0, "episode_reward_min": 709.0, "episode_reward_mean": 709.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [709.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49686441112961666, "mean_raw_obs_processing_ms": 0.11629095066861551, "mean_inference_ms": 1.585267566499416, "mean_action_processing_ms": 0.04729349566020712}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1700000, "timers": {"sample_time_ms": 8548.749, "sample_throughput": 467.905, "learn_time_ms": 11909.603, "learn_throughput": 335.863, "update_time_ms": 3.015}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 4.665126800537109, "policy_loss": -0.031245400896295905, "vf_loss": 4.687348395586014, "vf_explained_var": 0.6606550812721252, "kl": 0.01711467234417796, "entropy": 0.19053464382886887, "entropy_coeff": 0.0}}, "num_steps_sampled": 1700000, "num_steps_trained": 1700000}, "done": false, "episodes_total": 170, "training_iteration": 425, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-24-56", "timestamp": 1618147496, "time_this_iter_s": 19.647133350372314, "time_total_s": 8827.810944795609, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8827.810944795609, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 59.172413793103445, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 709.0, "episode_reward_min": 709.0, "episode_reward_mean": 709.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [709.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49686441112961666, "mean_raw_obs_processing_ms": 0.11629095066861551, "mean_inference_ms": 1.585267566499416, "mean_action_processing_ms": 0.04729349566020712}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1704000, "timers": {"sample_time_ms": 8718.212, "sample_throughput": 458.81, "learn_time_ms": 11864.769, "learn_throughput": 337.133, "update_time_ms": 3.045}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 9.14699512720108, "policy_loss": -0.031018914422020316, "vf_loss": 9.16957901418209, "vf_explained_var": 0.7134698033332825, "kl": 0.015998010407201946, "entropy": 0.12316121556796134, "entropy_coeff": 0.0}}, "num_steps_sampled": 1704000, "num_steps_trained": 1704000}, "done": false, "episodes_total": 170, "training_iteration": 426, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-25-18", "timestamp": 1618147518, "time_this_iter_s": 21.137657165527344, "time_total_s": 8848.948601961136, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a90d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8848.948601961136, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 59.46000000000001, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 709.0, "episode_reward_min": 709.0, "episode_reward_mean": 709.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [709.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49686441112961666, "mean_raw_obs_processing_ms": 0.11629095066861551, "mean_inference_ms": 1.585267566499416, "mean_action_processing_ms": 0.04729349566020712}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1708000, "timers": {"sample_time_ms": 8670.431, "sample_throughput": 461.338, "learn_time_ms": 11867.093, "learn_throughput": 337.067, "update_time_ms": 3.224}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 8.084494680166245, "policy_loss": -0.029302385839400813, "vf_loss": 8.108451381325722, "vf_explained_var": 0.7002450227737427, "kl": 0.01013871718896553, "entropy": 0.11497740214690566, "entropy_coeff": 0.0}}, "num_steps_sampled": 1708000, "num_steps_trained": 1708000}, "done": false, "episodes_total": 170, "training_iteration": 427, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-25-37", "timestamp": 1618147537, "time_this_iter_s": 19.719709157943726, "time_total_s": 8868.66831111908, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cf350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68b7350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8868.66831111908, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 58.628571428571426, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 882.0, "episode_reward_min": 882.0, "episode_reward_mean": 882.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [882.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49544599902251957, "mean_raw_obs_processing_ms": 0.1166097701296593, "mean_inference_ms": 1.5854533032177305, "mean_action_processing_ms": 0.0473015959578595}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1712000, "timers": {"sample_time_ms": 8618.562, "sample_throughput": 464.115, "learn_time_ms": 11891.327, "learn_throughput": 336.38, "update_time_ms": 3.258}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 7.284473821520805, "policy_loss": -0.022673181316349655, "vf_loss": 7.301210597157478, "vf_explained_var": 0.674172580242157, "kl": 0.011258829443249851, "entropy": 0.15952143911272287, "entropy_coeff": 0.0}}, "num_steps_sampled": 1712000, "num_steps_trained": 1712000}, "done": false, "episodes_total": 171, "training_iteration": 428, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-25-58", "timestamp": 1618147558, "time_this_iter_s": 20.291377305984497, "time_total_s": 8888.959688425064, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68b7f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8888.959688425064, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 59.40689655172414, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 882.0, "episode_reward_min": 882.0, "episode_reward_mean": 882.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [882.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49544599902251957, "mean_raw_obs_processing_ms": 0.1166097701296593, "mean_inference_ms": 1.5854533032177305, "mean_action_processing_ms": 0.0473015959578595}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1716000, "timers": {"sample_time_ms": 8523.524, "sample_throughput": 469.289, "learn_time_ms": 11897.97, "learn_throughput": 336.192, "update_time_ms": 3.229}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 5.471509411931038, "policy_loss": -0.02253200556151569, "vf_loss": 5.487957313656807, "vf_explained_var": 0.5827980041503906, "kl": 0.011539247003383934, "entropy": 0.14843955356627703, "entropy_coeff": 0.0}}, "num_steps_sampled": 1716000, "num_steps_trained": 1716000}, "done": false, "episodes_total": 171, "training_iteration": 429, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-26-18", "timestamp": 1618147578, "time_this_iter_s": 20.527220726013184, "time_total_s": 8909.486909151077, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8909.486909151077, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 59.765517241379314, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 297.0, "episode_reward_min": 297.0, "episode_reward_mean": 297.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49401317155064245, "mean_raw_obs_processing_ms": 0.11681004708078743, "mean_inference_ms": 1.5853872416191255, "mean_action_processing_ms": 0.047300810814738276}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1720000, "timers": {"sample_time_ms": 8382.581, "sample_throughput": 477.18, "learn_time_ms": 11882.061, "learn_throughput": 336.642, "update_time_ms": 3.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 2.086261034011841, "policy_loss": -0.024890942077036016, "vf_loss": 2.1049710623919964, "vf_explained_var": 0.5083286166191101, "kl": 0.011722845170879737, "entropy": 0.17013491573743522, "entropy_coeff": 0.0}}, "num_steps_sampled": 1720000, "num_steps_trained": 1720000}, "done": false, "episodes_total": 172, "training_iteration": 430, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-26-38", "timestamp": 1618147598, "time_this_iter_s": 19.277390718460083, "time_total_s": 8928.764299869537, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a09090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8928.764299869537, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 58.271428571428565, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 297.0, "episode_reward_min": 297.0, "episode_reward_mean": 297.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49401317155064245, "mean_raw_obs_processing_ms": 0.11681004708078743, "mean_inference_ms": 1.5853872416191255, "mean_action_processing_ms": 0.047300810814738276}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1724000, "timers": {"sample_time_ms": 8426.766, "sample_throughput": 474.678, "learn_time_ms": 11893.235, "learn_throughput": 336.326, "update_time_ms": 3.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 3.249440524727106, "policy_loss": -0.01659578742692247, "vf_loss": 3.2606019973754883, "vf_explained_var": 0.7880377769470215, "kl": 0.010306706302799284, "entropy": 0.1478659373242408, "entropy_coeff": 0.0}}, "num_steps_sampled": 1724000, "num_steps_trained": 1724000}, "done": false, "episodes_total": 172, "training_iteration": 431, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-26-58", "timestamp": 1618147618, "time_this_iter_s": 20.600619077682495, "time_total_s": 8949.36491894722, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6831b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67992d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8949.36491894722, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 59.42068965517242, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 297.0, "episode_reward_min": 297.0, "episode_reward_mean": 297.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49401317155064245, "mean_raw_obs_processing_ms": 0.11681004708078743, "mean_inference_ms": 1.5853872416191255, "mean_action_processing_ms": 0.047300810814738276}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1728000, "timers": {"sample_time_ms": 8378.355, "sample_throughput": 477.421, "learn_time_ms": 11908.977, "learn_throughput": 335.881, "update_time_ms": 3.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 0.4681819281540811, "policy_loss": -0.006392868293914944, "vf_loss": 0.4729483532719314, "vf_explained_var": 0.6312888860702515, "kl": 0.003084726668021176, "entropy": 0.04127123689977452, "entropy_coeff": 0.0}}, "num_steps_sampled": 1728000, "num_steps_trained": 1728000}, "done": false, "episodes_total": 172, "training_iteration": 432, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-27-18", "timestamp": 1618147638, "time_this_iter_s": 20.239362239837646, "time_total_s": 8969.604281187057, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8969.604281187057, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 60.189655172413794, "ram_util_percent": 27.648275862068967}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 199.0, "episode_reward_min": 199.0, "episode_reward_mean": 199.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49195434075221467, "mean_raw_obs_processing_ms": 0.11715496475873625, "mean_inference_ms": 1.5857185622305423, "mean_action_processing_ms": 0.04731966971895712}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1732000, "timers": {"sample_time_ms": 8253.138, "sample_throughput": 484.664, "learn_time_ms": 11896.71, "learn_throughput": 336.227, "update_time_ms": 3.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.26362734606122995, "cur_lr": 5e-05, "total_loss": 1.8030490353703499, "policy_loss": -0.059472449647728354, "vf_loss": 1.8472417630255222, "vf_explained_var": 0.697751522064209, "kl": 0.057959687896072865, "entropy": 0.21245003677904606, "entropy_coeff": 0.0}}, "num_steps_sampled": 1732000, "num_steps_trained": 1732000}, "done": false, "episodes_total": 173, "training_iteration": 433, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-27-38", "timestamp": 1618147658, "time_this_iter_s": 19.75454020500183, "time_total_s": 8989.35882139206, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8989.35882139206, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 58.58214285714285, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 199.0, "episode_reward_min": 199.0, "episode_reward_mean": 199.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49195434075221467, "mean_raw_obs_processing_ms": 0.11715496475873625, "mean_inference_ms": 1.5857185622305423, "mean_action_processing_ms": 0.04731966971895712}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1736000, "timers": {"sample_time_ms": 8293.918, "sample_throughput": 482.281, "learn_time_ms": 11903.518, "learn_throughput": 336.035, "update_time_ms": 3.332}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3954410190918449, "cur_lr": 5e-05, "total_loss": 6.876960352063179, "policy_loss": -0.030538443650584668, "vf_loss": 6.9017513692379, "vf_explained_var": 0.6589518189430237, "kl": 0.014534096466377378, "entropy": 0.13962590810842812, "entropy_coeff": 0.0}}, "num_steps_sampled": 1736000, "num_steps_trained": 1736000}, "done": false, "episodes_total": 173, "training_iteration": 434, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-27-59", "timestamp": 1618147679, "time_this_iter_s": 20.87829089164734, "time_total_s": 9010.237112283707, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69526d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9010.237112283707, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 58.92666666666667, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 723.0, "episode_reward_min": 723.0, "episode_reward_mean": 723.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [723.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49198456844614247, "mean_raw_obs_processing_ms": 0.11733016801724584, "mean_inference_ms": 1.5856289439352322, "mean_action_processing_ms": 0.047310899669234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1740000, "timers": {"sample_time_ms": 8450.987, "sample_throughput": 473.317, "learn_time_ms": 11911.065, "learn_throughput": 335.822, "update_time_ms": 3.354}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3954410190918449, "cur_lr": 5e-05, "total_loss": 7.720156952738762, "policy_loss": -0.029015735839493573, "vf_loss": 7.743270859122276, "vf_explained_var": 0.597303569316864, "kl": 0.01492480190063361, "entropy": 0.1330651924945414, "entropy_coeff": 0.0}}, "num_steps_sampled": 1740000, "num_steps_trained": 1740000}, "done": false, "episodes_total": 174, "training_iteration": 435, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-28-20", "timestamp": 1618147700, "time_this_iter_s": 21.29380464553833, "time_total_s": 9031.530916929245, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68b7950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69527d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9031.530916929245, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 59.08709677419355, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 723.0, "episode_reward_min": 723.0, "episode_reward_mean": 723.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [723.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49198456844614247, "mean_raw_obs_processing_ms": 0.11733016801724584, "mean_inference_ms": 1.5856289439352322, "mean_action_processing_ms": 0.047310899669234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1744000, "timers": {"sample_time_ms": 8547.574, "sample_throughput": 467.969, "learn_time_ms": 11924.128, "learn_throughput": 335.454, "update_time_ms": 3.321}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3954410190918449, "cur_lr": 5e-05, "total_loss": 9.95875070989132, "policy_loss": -0.029993206961080432, "vf_loss": 9.984248355031013, "vf_explained_var": 0.36634182929992676, "kl": 0.011368488951120526, "entropy": 0.10387183004058897, "entropy_coeff": 0.0}}, "num_steps_sampled": 1744000, "num_steps_trained": 1744000}, "done": false, "episodes_total": 174, "training_iteration": 436, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-28-43", "timestamp": 1618147723, "time_this_iter_s": 22.23290991783142, "time_total_s": 9053.763826847076, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68b7690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69d5c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9053.763826847076, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 59.37419354838708, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 723.0, "episode_reward_min": 723.0, "episode_reward_mean": 723.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [723.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49198456844614247, "mean_raw_obs_processing_ms": 0.11733016801724584, "mean_inference_ms": 1.5856289439352322, "mean_action_processing_ms": 0.047310899669234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1748000, "timers": {"sample_time_ms": 8763.797, "sample_throughput": 456.423, "learn_time_ms": 11915.812, "learn_throughput": 335.688, "update_time_ms": 3.18}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3954410190918449, "cur_lr": 5e-05, "total_loss": 7.41431425511837, "policy_loss": -0.035813764261547476, "vf_loss": 7.444215014576912, "vf_explained_var": 0.502532958984375, "kl": 0.014952972807805054, "entropy": 0.1241002173628658, "entropy_coeff": 0.0}}, "num_steps_sampled": 1748000, "num_steps_trained": 1748000}, "done": false, "episodes_total": 174, "training_iteration": 437, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-29-05", "timestamp": 1618147745, "time_this_iter_s": 21.79340171813965, "time_total_s": 9075.557228565216, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723bad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68b77d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9075.557228565216, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 59.00322580645161, "ram_util_percent": 27.745161290322585}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1323.0, "episode_reward_min": 1323.0, "episode_reward_mean": 1323.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1323.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4928268373739807, "mean_raw_obs_processing_ms": 0.11767339671610716, "mean_inference_ms": 1.5859438488566944, "mean_action_processing_ms": 0.04732136959351772}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1752000, "timers": {"sample_time_ms": 8867.482, "sample_throughput": 451.086, "learn_time_ms": 11919.715, "learn_throughput": 335.579, "update_time_ms": 3.172}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3954410190918449, "cur_lr": 5e-05, "total_loss": 9.163301393389702, "policy_loss": -0.03459680173546076, "vf_loss": 9.193044126033783, "vf_explained_var": 0.4082685708999634, "kl": 0.012275166096515022, "entropy": 0.1217780914157629, "entropy_coeff": 0.0}}, "num_steps_sampled": 1752000, "num_steps_trained": 1752000}, "done": false, "episodes_total": 175, "training_iteration": 438, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-29-26", "timestamp": 1618147766, "time_this_iter_s": 21.36872148513794, "time_total_s": 9096.925950050354, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9096.925950050354, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 27.748387096774184}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1323.0, "episode_reward_min": 1323.0, "episode_reward_mean": 1323.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1323.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4928268373739807, "mean_raw_obs_processing_ms": 0.11767339671610716, "mean_inference_ms": 1.5859438488566944, "mean_action_processing_ms": 0.04732136959351772}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1756000, "timers": {"sample_time_ms": 9034.848, "sample_throughput": 442.73, "learn_time_ms": 11884.726, "learn_throughput": 336.566, "update_time_ms": 3.209}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3954410190918449, "cur_lr": 5e-05, "total_loss": 9.154724478721619, "policy_loss": -0.044914283615071326, "vf_loss": 9.19110743701458, "vf_explained_var": 0.4338333010673523, "kl": 0.021574351063463837, "entropy": 0.1489884816110134, "entropy_coeff": 0.0}}, "num_steps_sampled": 1756000, "num_steps_trained": 1756000}, "done": false, "episodes_total": 175, "training_iteration": 439, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-29-48", "timestamp": 1618147788, "time_this_iter_s": 21.849896907806396, "time_total_s": 9118.77584695816, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9118.77584695816, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 59.145161290322584, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1053.0, "episode_reward_min": 1053.0, "episode_reward_mean": 1053.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1053.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49342412155178916, "mean_raw_obs_processing_ms": 0.1178688182915265, "mean_inference_ms": 1.585925519215282, "mean_action_processing_ms": 0.047318543701231876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1760000, "timers": {"sample_time_ms": 9225.91, "sample_throughput": 433.562, "learn_time_ms": 11906.446, "learn_throughput": 335.952, "update_time_ms": 3.257}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5931615286377674, "cur_lr": 5e-05, "total_loss": 9.844452932476997, "policy_loss": -0.09561377327190712, "vf_loss": 9.889558717608452, "vf_explained_var": 0.6306643486022949, "kl": 0.08515023137442768, "entropy": 0.22876314958557487, "entropy_coeff": 0.0}}, "num_steps_sampled": 1760000, "num_steps_trained": 1760000}, "done": false, "episodes_total": 176, "training_iteration": 440, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-30-09", "timestamp": 1618147809, "time_this_iter_s": 21.40429711341858, "time_total_s": 9140.180144071579, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9140.180144071579, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 58.94838709677419, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1053.0, "episode_reward_min": 1053.0, "episode_reward_mean": 1053.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1053.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49342412155178916, "mean_raw_obs_processing_ms": 0.1178688182915265, "mean_inference_ms": 1.585925519215282, "mean_action_processing_ms": 0.047318543701231876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1764000, "timers": {"sample_time_ms": 9216.493, "sample_throughput": 434.005, "learn_time_ms": 11916.652, "learn_throughput": 335.665, "update_time_ms": 3.278}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.338362485170364, "policy_loss": -0.03160730312811211, "vf_loss": 7.36334815621376, "vf_explained_var": 0.6309547424316406, "kl": 0.00744210128323175, "entropy": 0.13360606390051544, "entropy_coeff": 0.0}}, "num_steps_sampled": 1764000, "num_steps_trained": 1764000}, "done": false, "episodes_total": 176, "training_iteration": 441, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-30-30", "timestamp": 1618147830, "time_this_iter_s": 20.608240604400635, "time_total_s": 9160.78838467598, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699fe50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9160.78838467598, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 59.59655172413793, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1053.0, "episode_reward_min": 1053.0, "episode_reward_mean": 1053.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1053.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49342412155178916, "mean_raw_obs_processing_ms": 0.1178688182915265, "mean_inference_ms": 1.585925519215282, "mean_action_processing_ms": 0.047318543701231876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1768000, "timers": {"sample_time_ms": 9411.984, "sample_throughput": 424.99, "learn_time_ms": 11884.186, "learn_throughput": 336.582, "update_time_ms": 3.324}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.020859196782112, "policy_loss": -0.03082773950882256, "vf_loss": 6.044251531362534, "vf_explained_var": 0.37932565808296204, "kl": 0.00835689804807771, "entropy": 0.11976926284842193, "entropy_coeff": 0.0}}, "num_steps_sampled": 1768000, "num_steps_trained": 1768000}, "done": false, "episodes_total": 176, "training_iteration": 442, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-30-52", "timestamp": 1618147852, "time_this_iter_s": 21.873781442642212, "time_total_s": 9182.662166118622, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bdbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9182.662166118622, "timesteps_since_restore": 0, "iterations_since_restore": 442, "perf": {"cpu_util_percent": 59.70645161290322, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1036.0, "episode_reward_min": 1036.0, "episode_reward_mean": 1036.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1036.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4938493814540453, "mean_raw_obs_processing_ms": 0.11822428016192069, "mean_inference_ms": 1.58628612253975, "mean_action_processing_ms": 0.04733526255442904}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1772000, "timers": {"sample_time_ms": 9668.323, "sample_throughput": 413.722, "learn_time_ms": 11896.598, "learn_throughput": 336.231, "update_time_ms": 3.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.642292693257332, "policy_loss": -0.027060512773459777, "vf_loss": 6.66311414539814, "vf_explained_var": 0.42937570810317993, "kl": 0.007012300833594054, "entropy": 0.10975906089879572, "entropy_coeff": 0.0}}, "num_steps_sampled": 1772000, "num_steps_trained": 1772000}, "done": false, "episodes_total": 177, "training_iteration": 443, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-31-14", "timestamp": 1618147874, "time_this_iter_s": 22.438781023025513, "time_total_s": 9205.100947141647, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697bf10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686a350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9205.100947141647, "timesteps_since_restore": 0, "iterations_since_restore": 443, "perf": {"cpu_util_percent": 59.08125, "ram_util_percent": 27.7}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1036.0, "episode_reward_min": 1036.0, "episode_reward_mean": 1036.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1036.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4938493814540453, "mean_raw_obs_processing_ms": 0.11822428016192069, "mean_inference_ms": 1.58628612253975, "mean_action_processing_ms": 0.04733526255442904}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1776000, "timers": {"sample_time_ms": 9723.925, "sample_throughput": 411.357, "learn_time_ms": 11906.507, "learn_throughput": 335.951, "update_time_ms": 3.128}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.659593552350998, "policy_loss": -0.025749935361091048, "vf_loss": 7.678144857287407, "vf_explained_var": 0.49623560905456543, "kl": 0.00809070860123029, "entropy": 0.1203693796414882, "entropy_coeff": 0.0}}, "num_steps_sampled": 1776000, "num_steps_trained": 1776000}, "done": false, "episodes_total": 177, "training_iteration": 444, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-31-36", "timestamp": 1618147896, "time_this_iter_s": 21.536729097366333, "time_total_s": 9226.637676239014, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b72284d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9226.637676239014, "timesteps_since_restore": 0, "iterations_since_restore": 444, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1330.0, "episode_reward_min": 1330.0, "episode_reward_mean": 1330.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1330.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49470295625662697, "mean_raw_obs_processing_ms": 0.1184442106537569, "mean_inference_ms": 1.5864723048655995, "mean_action_processing_ms": 0.04733909119989905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1780000, "timers": {"sample_time_ms": 9878.622, "sample_throughput": 404.915, "learn_time_ms": 11874.274, "learn_throughput": 336.863, "update_time_ms": 3.071}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 9.908586293458939, "policy_loss": -0.030103634810075164, "vf_loss": 9.92858824133873, "vf_explained_var": 0.3744598925113678, "kl": 0.011353481590049341, "entropy": 0.12300363229587674, "entropy_coeff": 0.0}}, "num_steps_sampled": 1780000, "num_steps_trained": 1780000}, "done": false, "episodes_total": 178, "training_iteration": 445, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-31-58", "timestamp": 1618147918, "time_this_iter_s": 22.515952110290527, "time_total_s": 9249.153628349304, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68d5c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9249.153628349304, "timesteps_since_restore": 0, "iterations_since_restore": 445, "perf": {"cpu_util_percent": 59.409375, "ram_util_percent": 27.7}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1330.0, "episode_reward_min": 1330.0, "episode_reward_mean": 1330.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1330.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49470295625662697, "mean_raw_obs_processing_ms": 0.1184442106537569, "mean_inference_ms": 1.5864723048655995, "mean_action_processing_ms": 0.04733909119989905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1784000, "timers": {"sample_time_ms": 9964.722, "sample_throughput": 401.416, "learn_time_ms": 11889.476, "learn_throughput": 336.432, "update_time_ms": 3.047}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 8.064458668231964, "policy_loss": -0.030664092191727832, "vf_loss": 8.087130337953568, "vf_explained_var": 0.48338139057159424, "kl": 0.008982742743683048, "entropy": 0.1078536061104387, "entropy_coeff": 0.0}}, "num_steps_sampled": 1784000, "num_steps_trained": 1784000}, "done": false, "episodes_total": 178, "training_iteration": 446, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-32-22", "timestamp": 1618147942, "time_this_iter_s": 23.24596381187439, "time_total_s": 9272.399592161179, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686ad10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9272.399592161179, "timesteps_since_restore": 0, "iterations_since_restore": 446, "perf": {"cpu_util_percent": 58.89117647058824, "ram_util_percent": 27.700000000000003}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1330.0, "episode_reward_min": 1330.0, "episode_reward_mean": 1330.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1330.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49470295625662697, "mean_raw_obs_processing_ms": 0.1184442106537569, "mean_inference_ms": 1.5864723048655995, "mean_action_processing_ms": 0.04733909119989905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1788000, "timers": {"sample_time_ms": 10041.665, "sample_throughput": 398.34, "learn_time_ms": 11867.792, "learn_throughput": 337.047, "update_time_ms": 2.996}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 9.877009764313698, "policy_loss": -0.026872889371588826, "vf_loss": 9.896467208862305, "vf_explained_var": 0.5048997402191162, "kl": 0.008334062862559222, "entropy": 0.12153688294347376, "entropy_coeff": 0.0}}, "num_steps_sampled": 1788000, "num_steps_trained": 1788000}, "done": false, "episodes_total": 178, "training_iteration": 447, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-32-44", "timestamp": 1618147964, "time_this_iter_s": 22.34551239013672, "time_total_s": 9294.745104551315, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68b7490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9294.745104551315, "timesteps_since_restore": 0, "iterations_since_restore": 447, "perf": {"cpu_util_percent": 58.48125, "ram_util_percent": 27.7}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1400.0, "episode_reward_min": 1400.0, "episode_reward_mean": 1400.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1400.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4972865569842986, "mean_raw_obs_processing_ms": 0.11873050419988528, "mean_inference_ms": 1.5862896488472527, "mean_action_processing_ms": 0.04733554160227048}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1792000, "timers": {"sample_time_ms": 10099.781, "sample_throughput": 396.048, "learn_time_ms": 11853.428, "learn_throughput": 337.455, "update_time_ms": 2.972}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 10.097720444202423, "policy_loss": -0.028792563651222736, "vf_loss": 10.119767129421234, "vf_explained_var": 0.4640597105026245, "kl": 0.007581957193906419, "entropy": 0.114995471900329, "entropy_coeff": 0.0}}, "num_steps_sampled": 1792000, "num_steps_trained": 1792000}, "done": false, "episodes_total": 179, "training_iteration": 448, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-33-06", "timestamp": 1618147986, "time_this_iter_s": 21.80542540550232, "time_total_s": 9316.550529956818, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67b2a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9316.550529956818, "timesteps_since_restore": 0, "iterations_since_restore": 448, "perf": {"cpu_util_percent": 59.28064516129033, "ram_util_percent": 27.70000000000001}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1400.0, "episode_reward_min": 1400.0, "episode_reward_mean": 1400.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1400.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4972865569842986, "mean_raw_obs_processing_ms": 0.11873050419988528, "mean_inference_ms": 1.5862896488472527, "mean_action_processing_ms": 0.04733554160227048}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1796000, "timers": {"sample_time_ms": 9921.329, "sample_throughput": 403.172, "learn_time_ms": 11854.865, "learn_throughput": 337.414, "update_time_ms": 2.972}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 8.279120564460754, "policy_loss": -0.02940025192219764, "vf_loss": 8.30087111890316, "vf_explained_var": 0.5414682626724243, "kl": 0.008597492007538676, "entropy": 0.14216727833263576, "entropy_coeff": 0.0}}, "num_steps_sampled": 1796000, "num_steps_trained": 1796000}, "done": false, "episodes_total": 179, "training_iteration": 449, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-33-26", "timestamp": 1618148006, "time_this_iter_s": 20.079005241394043, "time_total_s": 9336.629535198212, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bd4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9336.629535198212, "timesteps_since_restore": 0, "iterations_since_restore": 449, "perf": {"cpu_util_percent": 59.72857142857142, "ram_util_percent": 27.735714285714284}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 995.0, "episode_reward_min": 995.0, "episode_reward_mean": 995.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [995.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4967147400150536, "mean_raw_obs_processing_ms": 0.11894053791989566, "mean_inference_ms": 1.5863794830431128, "mean_action_processing_ms": 0.04733934262651945}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1800000, "timers": {"sample_time_ms": 9920.554, "sample_throughput": 403.203, "learn_time_ms": 11845.138, "learn_throughput": 337.691, "update_time_ms": 2.951}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.983565926551819, "policy_loss": -0.024579894787166268, "vf_loss": 8.001426935195923, "vf_explained_var": 0.6935696601867676, "kl": 0.0075514284617383964, "entropy": 0.1748270783573389, "entropy_coeff": 0.0}}, "num_steps_sampled": 1800000, "num_steps_trained": 1800000}, "done": false, "episodes_total": 180, "training_iteration": 450, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-33-47", "timestamp": 1618148027, "time_this_iter_s": 21.29675793647766, "time_total_s": 9357.92629313469, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69124d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9357.92629313469, "timesteps_since_restore": 0, "iterations_since_restore": 450, "perf": {"cpu_util_percent": 59.04193548387097, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 995.0, "episode_reward_min": 995.0, "episode_reward_mean": 995.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [995.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4967147400150536, "mean_raw_obs_processing_ms": 0.11894053791989566, "mean_inference_ms": 1.5863794830431128, "mean_action_processing_ms": 0.04733934262651945}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1804000, "timers": {"sample_time_ms": 9990.99, "sample_throughput": 400.361, "learn_time_ms": 11852.93, "learn_throughput": 337.469, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.175808146595955, "policy_loss": -0.03003466231166385, "vf_loss": 6.200435534119606, "vf_explained_var": 0.2674162983894348, "kl": 0.006077494486817159, "entropy": 0.09965861402451992, "entropy_coeff": 0.0}}, "num_steps_sampled": 1804000, "num_steps_trained": 1804000}, "done": false, "episodes_total": 180, "training_iteration": 451, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-34-09", "timestamp": 1618148049, "time_this_iter_s": 21.395212411880493, "time_total_s": 9379.32150554657, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6799b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6799290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9379.32150554657, "timesteps_since_restore": 0, "iterations_since_restore": 451, "perf": {"cpu_util_percent": 59.36666666666667, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 995.0, "episode_reward_min": 995.0, "episode_reward_mean": 995.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [995.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4967147400150536, "mean_raw_obs_processing_ms": 0.11894053791989566, "mean_inference_ms": 1.5863794830431128, "mean_action_processing_ms": 0.04733934262651945}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1808000, "timers": {"sample_time_ms": 9934.213, "sample_throughput": 402.649, "learn_time_ms": 11865.659, "learn_throughput": 337.107, "update_time_ms": 3.003}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.4440402537584305, "policy_loss": -0.015503044181969017, "vf_loss": 7.453271180391312, "vf_explained_var": 0.40630483627319336, "kl": 0.007049326828564517, "entropy": 0.12516681011766195, "entropy_coeff": 0.0}}, "num_steps_sampled": 1808000, "num_steps_trained": 1808000}, "done": false, "episodes_total": 180, "training_iteration": 452, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-34-30", "timestamp": 1618148070, "time_this_iter_s": 21.42858338356018, "time_total_s": 9400.75008893013, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b686a0d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6799d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9400.75008893013, "timesteps_since_restore": 0, "iterations_since_restore": 452, "perf": {"cpu_util_percent": 59.25161290322581, "ram_util_percent": 27.706451612903237}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1327.0, "episode_reward_min": 1327.0, "episode_reward_mean": 1327.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1327.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4973254499932625, "mean_raw_obs_processing_ms": 0.119212333728045, "mean_inference_ms": 1.5861000132369114, "mean_action_processing_ms": 0.04732938456037621}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1812000, "timers": {"sample_time_ms": 9828.28, "sample_throughput": 406.989, "learn_time_ms": 11868.606, "learn_throughput": 337.024, "update_time_ms": 3.133}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 9.776917815208435, "policy_loss": -0.026999268564395607, "vf_loss": 9.794390305876732, "vf_explained_var": 0.45085984468460083, "kl": 0.010707351742894389, "entropy": 0.12658728938549757, "entropy_coeff": 0.0}}, "num_steps_sampled": 1812000, "num_steps_trained": 1812000}, "done": false, "episodes_total": 181, "training_iteration": 453, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-34-52", "timestamp": 1618148092, "time_this_iter_s": 21.413095474243164, "time_total_s": 9422.163184404373, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b686ac10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9422.163184404373, "timesteps_since_restore": 0, "iterations_since_restore": 453, "perf": {"cpu_util_percent": 58.18, "ram_util_percent": 27.723333333333343}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1327.0, "episode_reward_min": 1327.0, "episode_reward_mean": 1327.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1327.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4973254499932625, "mean_raw_obs_processing_ms": 0.119212333728045, "mean_inference_ms": 1.5861000132369114, "mean_action_processing_ms": 0.04732938456037621}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1816000, "timers": {"sample_time_ms": 9829.146, "sample_throughput": 406.953, "learn_time_ms": 11854.742, "learn_throughput": 337.418, "update_time_ms": 3.299}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.409480571746826, "policy_loss": -0.0304773481329903, "vf_loss": 6.433410704135895, "vf_explained_var": 0.4889505207538605, "kl": 0.007358570626820438, "entropy": 0.12399138184264302, "entropy_coeff": 0.0}}, "num_steps_sampled": 1816000, "num_steps_trained": 1816000}, "done": false, "episodes_total": 181, "training_iteration": 454, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-35-13", "timestamp": 1618148113, "time_this_iter_s": 21.40595316886902, "time_total_s": 9443.569137573242, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69128d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67998d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9443.569137573242, "timesteps_since_restore": 0, "iterations_since_restore": 454, "perf": {"cpu_util_percent": 59.238709677419344, "ram_util_percent": 27.703225806451623}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1446.0, "episode_reward_min": 1446.0, "episode_reward_mean": 1446.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1446.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4979280164659061, "mean_raw_obs_processing_ms": 0.11939813438456495, "mean_inference_ms": 1.5860216639517417, "mean_action_processing_ms": 0.047327355433909944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1820000, "timers": {"sample_time_ms": 9734.487, "sample_throughput": 410.91, "learn_time_ms": 11896.108, "learn_throughput": 336.244, "update_time_ms": 3.303}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 5.930326700210571, "policy_loss": -0.03223027876811102, "vf_loss": 5.955612629652023, "vf_explained_var": 0.39994722604751587, "kl": 0.007804888882674277, "entropy": 0.11037747259251773, "entropy_coeff": 0.0}}, "num_steps_sampled": 1820000, "num_steps_trained": 1820000}, "done": false, "episodes_total": 182, "training_iteration": 455, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-35-35", "timestamp": 1618148135, "time_this_iter_s": 21.983067989349365, "time_total_s": 9465.552205562592, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67b2450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9465.552205562592, "timesteps_since_restore": 0, "iterations_since_restore": 455, "perf": {"cpu_util_percent": 59.032258064516135, "ram_util_percent": 27.745161290322578}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1446.0, "episode_reward_min": 1446.0, "episode_reward_mean": 1446.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1446.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4979280164659061, "mean_raw_obs_processing_ms": 0.11939813438456495, "mean_inference_ms": 1.5860216639517417, "mean_action_processing_ms": 0.047327355433909944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1824000, "timers": {"sample_time_ms": 9581.589, "sample_throughput": 417.467, "learn_time_ms": 11877.818, "learn_throughput": 336.762, "update_time_ms": 3.436}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.097444981336594, "policy_loss": -0.024971508333692327, "vf_loss": 7.111979439854622, "vf_explained_var": 0.37300634384155273, "kl": 0.011730620564776473, "entropy": 0.12505330424755812, "entropy_coeff": 0.0}}, "num_steps_sampled": 1824000, "num_steps_trained": 1824000}, "done": false, "episodes_total": 182, "training_iteration": 456, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-35-57", "timestamp": 1618148157, "time_this_iter_s": 21.534040451049805, "time_total_s": 9487.086246013641, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d5350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9487.086246013641, "timesteps_since_restore": 0, "iterations_since_restore": 456, "perf": {"cpu_util_percent": 59.174193548387095, "ram_util_percent": 27.787096774193536}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1446.0, "episode_reward_min": 1446.0, "episode_reward_mean": 1446.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1446.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4979280164659061, "mean_raw_obs_processing_ms": 0.11939813438456495, "mean_inference_ms": 1.5860216639517417, "mean_action_processing_ms": 0.047327355433909944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1828000, "timers": {"sample_time_ms": 9514.107, "sample_throughput": 420.428, "learn_time_ms": 11892.186, "learn_throughput": 336.355, "update_time_ms": 3.442}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.827036902308464, "policy_loss": -0.03888241294771433, "vf_loss": 7.8567004352808, "vf_explained_var": 0.3640613555908203, "kl": 0.010361189248214941, "entropy": 0.11388895404525101, "entropy_coeff": 0.0}}, "num_steps_sampled": 1828000, "num_steps_trained": 1828000}, "done": false, "episodes_total": 182, "training_iteration": 457, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-36-18", "timestamp": 1618148178, "time_this_iter_s": 21.816636085510254, "time_total_s": 9508.902882099152, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9508.902882099152, "timesteps_since_restore": 0, "iterations_since_restore": 457, "perf": {"cpu_util_percent": 59.277419354838706, "ram_util_percent": 27.703225806451623}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1334.0, "episode_reward_min": 1334.0, "episode_reward_mean": 1334.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1334.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.498594724421698, "mean_raw_obs_processing_ms": 0.11973053969328559, "mean_inference_ms": 1.5862362545966753, "mean_action_processing_ms": 0.04733411928273629}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1832000, "timers": {"sample_time_ms": 9482.09, "sample_throughput": 421.848, "learn_time_ms": 11906.701, "learn_throughput": 335.945, "update_time_ms": 3.444}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 8.510558053851128, "policy_loss": -0.02250671701040119, "vf_loss": 8.52696467936039, "vf_explained_var": 0.35921961069107056, "kl": 0.006855912477476522, "entropy": 0.11603234382346272, "entropy_coeff": 0.0}}, "num_steps_sampled": 1832000, "num_steps_trained": 1832000}, "done": false, "episodes_total": 183, "training_iteration": 458, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-36-40", "timestamp": 1618148200, "time_this_iter_s": 21.632288932800293, "time_total_s": 9530.535171031952, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7a5c990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9530.535171031952, "timesteps_since_restore": 0, "iterations_since_restore": 458, "perf": {"cpu_util_percent": 59.16129032258064, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1334.0, "episode_reward_min": 1334.0, "episode_reward_mean": 1334.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1334.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.498594724421698, "mean_raw_obs_processing_ms": 0.11973053969328559, "mean_inference_ms": 1.5862362545966753, "mean_action_processing_ms": 0.04733411928273629}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1836000, "timers": {"sample_time_ms": 9452.353, "sample_throughput": 423.175, "learn_time_ms": 11902.884, "learn_throughput": 336.053, "update_time_ms": 3.415}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.440480157732964, "policy_loss": -0.033519620657898486, "vf_loss": 7.466528087854385, "vf_explained_var": 0.4388431906700134, "kl": 0.008397589845117182, "entropy": 0.1606706017628312, "entropy_coeff": 0.0}}, "num_steps_sampled": 1836000, "num_steps_trained": 1836000}, "done": false, "episodes_total": 183, "training_iteration": 459, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-37-00", "timestamp": 1618148220, "time_this_iter_s": 19.74748992919922, "time_total_s": 9550.282660961151, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67b2350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b691f0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9550.282660961151, "timesteps_since_restore": 0, "iterations_since_restore": 459, "perf": {"cpu_util_percent": 59.66785714285713, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 876.0, "episode_reward_min": 876.0, "episode_reward_mean": 876.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [876.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49749367837805786, "mean_raw_obs_processing_ms": 0.11991241238050994, "mean_inference_ms": 1.586161124338022, "mean_action_processing_ms": 0.04732849824556715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1840000, "timers": {"sample_time_ms": 9347.499, "sample_throughput": 427.922, "learn_time_ms": 11947.545, "learn_throughput": 334.797, "update_time_ms": 3.384}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 7.233783692121506, "policy_loss": -0.014972959121223539, "vf_loss": 7.243200868368149, "vf_explained_var": 0.619978666305542, "kl": 0.006244266347493976, "entropy": 0.1310440539382398, "entropy_coeff": 0.0}}, "num_steps_sampled": 1840000, "num_steps_trained": 1840000}, "done": false, "episodes_total": 184, "training_iteration": 460, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-37-21", "timestamp": 1618148241, "time_this_iter_s": 20.694525241851807, "time_total_s": 9570.977186203003, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b723b1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69001d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9570.977186203003, "timesteps_since_restore": 0, "iterations_since_restore": 460, "perf": {"cpu_util_percent": 59.81333333333334, "ram_util_percent": 27.706666666666674}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 876.0, "episode_reward_min": 876.0, "episode_reward_mean": 876.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [876.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49749367837805786, "mean_raw_obs_processing_ms": 0.11991241238050994, "mean_inference_ms": 1.586161124338022, "mean_action_processing_ms": 0.04732849824556715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1844000, "timers": {"sample_time_ms": 9219.922, "sample_throughput": 433.843, "learn_time_ms": 11964.958, "learn_throughput": 334.31, "update_time_ms": 3.33}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 5.326538130640984, "policy_loss": -0.03247906675096601, "vf_loss": 5.353237688541412, "vf_explained_var": 0.7144615650177002, "kl": 0.006495696936326567, "entropy": 0.1257118326611817, "entropy_coeff": 0.0}}, "num_steps_sampled": 1844000, "num_steps_trained": 1844000}, "done": false, "episodes_total": 184, "training_iteration": 461, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-37-41", "timestamp": 1618148261, "time_this_iter_s": 20.291886568069458, "time_total_s": 9591.269072771072, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6a04fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9591.269072771072, "timesteps_since_restore": 0, "iterations_since_restore": 461, "perf": {"cpu_util_percent": 58.76551724137931, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 876.0, "episode_reward_min": 876.0, "episode_reward_mean": 876.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [876.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49749367837805786, "mean_raw_obs_processing_ms": 0.11991241238050994, "mean_inference_ms": 1.586161124338022, "mean_action_processing_ms": 0.04732849824556715}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1848000, "timers": {"sample_time_ms": 9210.887, "sample_throughput": 434.269, "learn_time_ms": 11921.476, "learn_throughput": 335.529, "update_time_ms": 3.333}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.910270601511002, "policy_loss": -0.009002854581922293, "vf_loss": 6.91813737154007, "vf_explained_var": 0.3315836787223816, "kl": 0.0012769524990403625, "entropy": 0.008297086973470869, "entropy_coeff": 0.0}}, "num_steps_sampled": 1848000, "num_steps_trained": 1848000}, "done": false, "episodes_total": 184, "training_iteration": 462, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-38-02", "timestamp": 1618148282, "time_this_iter_s": 20.90457272529602, "time_total_s": 9612.173645496368, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67b2110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bdb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9612.173645496368, "timesteps_since_restore": 0, "iterations_since_restore": 462, "perf": {"cpu_util_percent": 59.739999999999995, "ram_util_percent": 27.74666666666666}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 358.0, "episode_reward_min": 358.0, "episode_reward_mean": 358.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49599604056177893, "mean_raw_obs_processing_ms": 0.12024155364314251, "mean_inference_ms": 1.5864557359855016, "mean_action_processing_ms": 0.04734033158740239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1852000, "timers": {"sample_time_ms": 9083.651, "sample_throughput": 440.352, "learn_time_ms": 11903.33, "learn_throughput": 336.04, "update_time_ms": 3.226}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.44487114647832554, "cur_lr": 5e-05, "total_loss": 1.0631409119814634, "policy_loss": 0.00361718560452573, "vf_loss": 1.0595236606895924, "vf_explained_var": -0.0015118513256311417, "kl": 1.5301166667036625e-07, "entropy": 0.0010622501595207723, "entropy_coeff": 0.0}}, "num_steps_sampled": 1852000, "num_steps_trained": 1852000}, "done": false, "episodes_total": 185, "training_iteration": 463, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-38-22", "timestamp": 1618148302, "time_this_iter_s": 19.95736813545227, "time_total_s": 9632.13101363182, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cf410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6831410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9632.13101363182, "timesteps_since_restore": 0, "iterations_since_restore": 463, "perf": {"cpu_util_percent": 59.63928571428572, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 358.0, "episode_reward_min": 358.0, "episode_reward_mean": 358.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49599604056177893, "mean_raw_obs_processing_ms": 0.12024155364314251, "mean_inference_ms": 1.5864557359855016, "mean_action_processing_ms": 0.04734033158740239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1856000, "timers": {"sample_time_ms": 9064.516, "sample_throughput": 441.281, "learn_time_ms": 11938.291, "learn_throughput": 335.056, "update_time_ms": 3.025}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22243557323916277, "cur_lr": 5e-05, "total_loss": 5.944474846124649, "policy_loss": -0.033789118053391576, "vf_loss": 5.962920755147934, "vf_explained_var": 0.8415259122848511, "kl": 0.0689778687665239, "entropy": 0.1496528098359704, "entropy_coeff": 0.0}}, "num_steps_sampled": 1856000, "num_steps_trained": 1856000}, "done": false, "episodes_total": 185, "training_iteration": 464, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-38-43", "timestamp": 1618148323, "time_this_iter_s": 21.56515598297119, "time_total_s": 9653.696169614792, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6912510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9653.696169614792, "timesteps_since_restore": 0, "iterations_since_restore": 464, "perf": {"cpu_util_percent": 59.54193548387097, "ram_util_percent": 27.796774193548377}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 709.0, "episode_reward_min": 709.0, "episode_reward_mean": 709.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [709.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4953392351053946, "mean_raw_obs_processing_ms": 0.12045942849453255, "mean_inference_ms": 1.5866853825455267, "mean_action_processing_ms": 0.047349683238746554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1860000, "timers": {"sample_time_ms": 8917.67, "sample_throughput": 448.548, "learn_time_ms": 11903.259, "learn_throughput": 336.042, "update_time_ms": 3.055}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33365335985874417, "cur_lr": 5e-05, "total_loss": 8.34367361664772, "policy_loss": -0.03579960216302425, "vf_loss": 8.371268004179, "vf_explained_var": 0.4869591295719147, "kl": 0.024591986933955923, "entropy": 0.12483117752708495, "entropy_coeff": 0.0}}, "num_steps_sampled": 1860000, "num_steps_trained": 1860000}, "done": false, "episodes_total": 186, "training_iteration": 465, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-39-04", "timestamp": 1618148344, "time_this_iter_s": 20.167017459869385, "time_total_s": 9673.863187074661, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c0750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9673.863187074661, "timesteps_since_restore": 0, "iterations_since_restore": 465, "perf": {"cpu_util_percent": 58.42758620689656, "ram_util_percent": 27.703448275862076}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 709.0, "episode_reward_min": 709.0, "episode_reward_mean": 709.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [709.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4953392351053946, "mean_raw_obs_processing_ms": 0.12045942849453255, "mean_inference_ms": 1.5866853825455267, "mean_action_processing_ms": 0.047349683238746554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1864000, "timers": {"sample_time_ms": 8875.387, "sample_throughput": 450.685, "learn_time_ms": 11890.193, "learn_throughput": 336.412, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 7.898998290300369, "policy_loss": -0.0235086910543032, "vf_loss": 7.917469412088394, "vf_explained_var": 0.344934344291687, "kl": 0.01006525821867399, "entropy": 0.107070985250175, "entropy_coeff": 0.0}}, "num_steps_sampled": 1864000, "num_steps_trained": 1864000}, "done": false, "episodes_total": 186, "training_iteration": 466, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-39-25", "timestamp": 1618148365, "time_this_iter_s": 20.9795823097229, "time_total_s": 9694.842769384384, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cfdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68c0890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9694.842769384384, "timesteps_since_restore": 0, "iterations_since_restore": 466, "perf": {"cpu_util_percent": 59.37666666666666, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 709.0, "episode_reward_min": 709.0, "episode_reward_mean": 709.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [709.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4953392351053946, "mean_raw_obs_processing_ms": 0.12045942849453255, "mean_inference_ms": 1.5866853825455267, "mean_action_processing_ms": 0.047349683238746554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1868000, "timers": {"sample_time_ms": 8701.086, "sample_throughput": 459.713, "learn_time_ms": 11898.062, "learn_throughput": 336.189, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 9.92030218243599, "policy_loss": -0.04926069884095341, "vf_loss": 9.960548102855682, "vf_explained_var": 0.5523557066917419, "kl": 0.01801199812325649, "entropy": 0.16233984171412885, "entropy_coeff": 0.0}}, "num_steps_sampled": 1868000, "num_steps_trained": 1868000}, "done": false, "episodes_total": 186, "training_iteration": 467, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-39-45", "timestamp": 1618148385, "time_this_iter_s": 20.14945340156555, "time_total_s": 9714.99222278595, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c0ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9714.99222278595, "timesteps_since_restore": 0, "iterations_since_restore": 467, "perf": {"cpu_util_percent": 59.86551724137931, "ram_util_percent": 27.793103448275854}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1215.0, "episode_reward_min": 1215.0, "episode_reward_mean": 1215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4956089155370282, "mean_raw_obs_processing_ms": 0.12081596997317773, "mean_inference_ms": 1.5871672445558684, "mean_action_processing_ms": 0.04736771330433659}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1872000, "timers": {"sample_time_ms": 8905.32, "sample_throughput": 449.17, "learn_time_ms": 11889.283, "learn_throughput": 336.437, "update_time_ms": 3.058}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 7.683786764740944, "policy_loss": -0.024058978829998523, "vf_loss": 7.703694984316826, "vf_explained_var": 0.5362497568130493, "kl": 0.008293305538245477, "entropy": 0.11579811875708401, "entropy_coeff": 0.0}}, "num_steps_sampled": 1872000, "num_steps_trained": 1872000}, "done": false, "episodes_total": 187, "training_iteration": 468, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-40-08", "timestamp": 1618148408, "time_this_iter_s": 23.587167263031006, "time_total_s": 9738.57939004898, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cfc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cf690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9738.57939004898, "timesteps_since_restore": 0, "iterations_since_restore": 468, "perf": {"cpu_util_percent": 59.08235294117646, "ram_util_percent": 27.799999999999997}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1215.0, "episode_reward_min": 1215.0, "episode_reward_mean": 1215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4956089155370282, "mean_raw_obs_processing_ms": 0.12081596997317773, "mean_inference_ms": 1.5871672445558684, "mean_action_processing_ms": 0.04736771330433659}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1876000, "timers": {"sample_time_ms": 9097.988, "sample_throughput": 439.658, "learn_time_ms": 11920.577, "learn_throughput": 335.554, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 9.317855700850487, "policy_loss": -0.028402281372109428, "vf_loss": 9.339454889297485, "vf_explained_var": 0.36098262667655945, "kl": 0.01359340496128425, "entropy": 0.12076149391941726, "entropy_coeff": 0.0}}, "num_steps_sampled": 1876000, "num_steps_trained": 1876000}, "done": false, "episodes_total": 187, "training_iteration": 469, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-40-30", "timestamp": 1618148430, "time_this_iter_s": 21.986396074295044, "time_total_s": 9760.565786123276, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67b2fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9760.565786123276, "timesteps_since_restore": 0, "iterations_since_restore": 469, "perf": {"cpu_util_percent": 59.34838709677419, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1398.0, "episode_reward_min": 1398.0, "episode_reward_mean": 1398.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1398.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4964526480470151, "mean_raw_obs_processing_ms": 0.12103194395978824, "mean_inference_ms": 1.5872735478132596, "mean_action_processing_ms": 0.04737120579034244}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1880000, "timers": {"sample_time_ms": 9309.244, "sample_throughput": 429.68, "learn_time_ms": 11852.402, "learn_throughput": 337.484, "update_time_ms": 3.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 9.147330433130264, "policy_loss": -0.023703142651356757, "vf_loss": 9.166159093379974, "vf_explained_var": 0.3979572355747223, "kl": 0.009739978289871942, "entropy": 0.12284383806400001, "entropy_coeff": 0.0}}, "num_steps_sampled": 1880000, "num_steps_trained": 1880000}, "done": false, "episodes_total": 188, "training_iteration": 470, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-40-53", "timestamp": 1618148453, "time_this_iter_s": 22.1291184425354, "time_total_s": 9782.694904565811, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b08d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6799bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9782.694904565811, "timesteps_since_restore": 0, "iterations_since_restore": 470, "perf": {"cpu_util_percent": 58.84375, "ram_util_percent": 27.8}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1398.0, "episode_reward_min": 1398.0, "episode_reward_mean": 1398.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1398.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4964526480470151, "mean_raw_obs_processing_ms": 0.12103194395978824, "mean_inference_ms": 1.5872735478132596, "mean_action_processing_ms": 0.04737120579034244}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1884000, "timers": {"sample_time_ms": 9547.874, "sample_throughput": 418.941, "learn_time_ms": 11842.66, "learn_throughput": 337.762, "update_time_ms": 3.081}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 8.858417198061943, "policy_loss": -0.07113652676343918, "vf_loss": 8.902746722102165, "vf_explained_var": 0.6441285610198975, "kl": 0.053562659653835, "entropy": 0.15486760414205492, "entropy_coeff": 0.0}}, "num_steps_sampled": 1884000, "num_steps_trained": 1884000}, "done": false, "episodes_total": 188, "training_iteration": 471, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-41-15", "timestamp": 1618148475, "time_this_iter_s": 22.57997155189514, "time_total_s": 9805.274876117706, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cd910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69126d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9805.274876117706, "timesteps_since_restore": 0, "iterations_since_restore": 471, "perf": {"cpu_util_percent": 59.3125, "ram_util_percent": 27.8}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1398.0, "episode_reward_min": 1398.0, "episode_reward_mean": 1398.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1398.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4964526480470151, "mean_raw_obs_processing_ms": 0.12103194395978824, "mean_inference_ms": 1.5872735478132596, "mean_action_processing_ms": 0.04737120579034244}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1888000, "timers": {"sample_time_ms": 9586.889, "sample_throughput": 417.237, "learn_time_ms": 11893.81, "learn_throughput": 336.309, "update_time_ms": 3.078}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7507200596821744, "cur_lr": 5e-05, "total_loss": 8.059924766421318, "policy_loss": -0.06429019948700443, "vf_loss": 8.092496916651726, "vf_explained_var": 0.5500532388687134, "kl": 0.04225005232729018, "entropy": 0.17662956193089485, "entropy_coeff": 0.0}}, "num_steps_sampled": 1888000, "num_steps_trained": 1888000}, "done": false, "episodes_total": 188, "training_iteration": 472, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-41-37", "timestamp": 1618148497, "time_this_iter_s": 21.805181741714478, "time_total_s": 9827.08005785942, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67c8e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9827.08005785942, "timesteps_since_restore": 0, "iterations_since_restore": 472, "perf": {"cpu_util_percent": 59.6516129032258, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1198.0, "episode_reward_min": 1198.0, "episode_reward_mean": 1198.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1198.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49707600809707586, "mean_raw_obs_processing_ms": 0.1213202150309233, "mean_inference_ms": 1.587218248658169, "mean_action_processing_ms": 0.04736538056026741}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1892000, "timers": {"sample_time_ms": 9629.729, "sample_throughput": 415.38, "learn_time_ms": 11920.988, "learn_throughput": 335.543, "update_time_ms": 3.104}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 6.8225437104702, "policy_loss": -0.01855398464249447, "vf_loss": 6.835284978151321, "vf_explained_var": 0.40731900930404663, "kl": 0.005161930253962055, "entropy": 0.10780072398483753, "entropy_coeff": 0.0}}, "num_steps_sampled": 1892000, "num_steps_trained": 1892000}, "done": false, "episodes_total": 189, "training_iteration": 473, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-41-58", "timestamp": 1618148518, "time_this_iter_s": 20.655841588974, "time_total_s": 9847.735899448395, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68d55d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cff50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9847.735899448395, "timesteps_since_restore": 0, "iterations_since_restore": 473, "perf": {"cpu_util_percent": 59.38275862068966, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1198.0, "episode_reward_min": 1198.0, "episode_reward_mean": 1198.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1198.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49707600809707586, "mean_raw_obs_processing_ms": 0.1213202150309233, "mean_inference_ms": 1.587218248658169, "mean_action_processing_ms": 0.04736538056026741}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1896000, "timers": {"sample_time_ms": 9759.487, "sample_throughput": 409.858, "learn_time_ms": 11885.455, "learn_throughput": 336.546, "update_time_ms": 3.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 9.053256288170815, "policy_loss": -0.025348117109388113, "vf_loss": 9.070582091808319, "vf_explained_var": 0.5169954895973206, "kl": 0.007124133720935788, "entropy": 0.10787994344718754, "entropy_coeff": 0.0}}, "num_steps_sampled": 1896000, "num_steps_trained": 1896000}, "done": false, "episodes_total": 189, "training_iteration": 474, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-42-20", "timestamp": 1618148540, "time_this_iter_s": 22.507488489151, "time_total_s": 9870.243387937546, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67c8650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68bd350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9870.243387937546, "timesteps_since_restore": 0, "iterations_since_restore": 474, "perf": {"cpu_util_percent": 59.42727272727273, "ram_util_percent": 27.8}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1262.0, "episode_reward_min": 1262.0, "episode_reward_mean": 1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49845354159685396, "mean_raw_obs_processing_ms": 0.12156384293961366, "mean_inference_ms": 1.5875743923978274, "mean_action_processing_ms": 0.04737818721488649}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1900000, "timers": {"sample_time_ms": 10047.911, "sample_throughput": 398.093, "learn_time_ms": 11892.792, "learn_throughput": 336.338, "update_time_ms": 3.098}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 8.143621951341629, "policy_loss": -0.017097993404604495, "vf_loss": 8.152718022465706, "vf_explained_var": 0.5593448877334595, "kl": 0.007105900505848695, "entropy": 0.09705639933235943, "entropy_coeff": 0.0}}, "num_steps_sampled": 1900000, "num_steps_trained": 1900000}, "done": false, "episodes_total": 190, "training_iteration": 475, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-42-43", "timestamp": 1618148563, "time_this_iter_s": 23.122150182724, "time_total_s": 9893.36553812027, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6874b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9893.36553812027, "timesteps_since_restore": 0, "iterations_since_restore": 475, "perf": {"cpu_util_percent": 59.18484848484848, "ram_util_percent": 27.8}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1262.0, "episode_reward_min": 1262.0, "episode_reward_mean": 1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49845354159685396, "mean_raw_obs_processing_ms": 0.12156384293961366, "mean_inference_ms": 1.5875743923978274, "mean_action_processing_ms": 0.04737818721488649}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1904000, "timers": {"sample_time_ms": 10186.708, "sample_throughput": 392.669, "learn_time_ms": 11902.173, "learn_throughput": 336.073, "update_time_ms": 3.044}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 8.28274504840374, "policy_loss": -0.032257734826998785, "vf_loss": 8.305910423398018, "vf_explained_var": 0.54462730884552, "kl": 0.008074363318883115, "entropy": 0.12056816159747541, "entropy_coeff": 0.0}}, "num_steps_sampled": 1904000, "num_steps_trained": 1904000}, "done": false, "episodes_total": 190, "training_iteration": 476, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-43-06", "timestamp": 1618148586, "time_this_iter_s": 22.464858770370483, "time_total_s": 9915.83039689064, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cda10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6799b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9915.83039689064, "timesteps_since_restore": 0, "iterations_since_restore": 476, "perf": {"cpu_util_percent": 59.25, "ram_util_percent": 27.8}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1262.0, "episode_reward_min": 1262.0, "episode_reward_mean": 1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49845354159685396, "mean_raw_obs_processing_ms": 0.12156384293961366, "mean_inference_ms": 1.5875743923978274, "mean_action_processing_ms": 0.04737818721488649}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1908000, "timers": {"sample_time_ms": 10320.533, "sample_throughput": 387.577, "learn_time_ms": 11896.253, "learn_throughput": 336.24, "update_time_ms": 3.036}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 9.284445151686668, "policy_loss": -0.028325215476797894, "vf_loss": 9.304858520627022, "vf_explained_var": 0.5152131915092468, "kl": 0.007025782942946535, "entropy": 0.13875125721096992, "entropy_coeff": 0.0}}, "num_steps_sampled": 1908000, "num_steps_trained": 1908000}, "done": false, "episodes_total": 190, "training_iteration": 477, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-43-27", "timestamp": 1618148607, "time_this_iter_s": 21.42886519432068, "time_total_s": 9937.259262084961, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6912750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9937.259262084961, "timesteps_since_restore": 0, "iterations_since_restore": 477, "perf": {"cpu_util_percent": 59.58333333333333, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1165.0, "episode_reward_min": 1165.0, "episode_reward_mean": 1165.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1165.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4992232534807984, "mean_raw_obs_processing_ms": 0.12190224793976243, "mean_inference_ms": 1.5879653795232402, "mean_action_processing_ms": 0.04739372466103191}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1912000, "timers": {"sample_time_ms": 10131.244, "sample_throughput": 394.818, "learn_time_ms": 11912.093, "learn_throughput": 335.793, "update_time_ms": 2.94}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 10.452876895666122, "policy_loss": -0.0227289036847651, "vf_loss": 10.469516098499298, "vf_explained_var": 0.6021938323974609, "kl": 0.0054080340851214714, "entropy": 0.12579974229447544, "entropy_coeff": 0.0}}, "num_steps_sampled": 1912000, "num_steps_trained": 1912000}, "done": false, "episodes_total": 191, "training_iteration": 478, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-43-49", "timestamp": 1618148629, "time_this_iter_s": 21.850399494171143, "time_total_s": 9959.109661579132, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69a9c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f72ac73f110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9959.109661579132, "timesteps_since_restore": 0, "iterations_since_restore": 478, "perf": {"cpu_util_percent": 59.303225806451614, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1165.0, "episode_reward_min": 1165.0, "episode_reward_mean": 1165.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1165.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4992232534807984, "mean_raw_obs_processing_ms": 0.12190224793976243, "mean_inference_ms": 1.5879653795232402, "mean_action_processing_ms": 0.04739372466103191}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1916000, "timers": {"sample_time_ms": 10049.491, "sample_throughput": 398.03, "learn_time_ms": 11902.1, "learn_throughput": 336.075, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 9.025903359055519, "policy_loss": -0.024923759512603283, "vf_loss": 9.043654799461365, "vf_explained_var": 0.6186734437942505, "kl": 0.006369318754877895, "entropy": 0.1281377524137497, "entropy_coeff": 0.0}}, "num_steps_sampled": 1916000, "num_steps_trained": 1916000}, "done": false, "episodes_total": 191, "training_iteration": 479, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-44-10", "timestamp": 1618148650, "time_this_iter_s": 21.06724262237549, "time_total_s": 9980.176904201508, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6799510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a98d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9980.176904201508, "timesteps_since_restore": 0, "iterations_since_restore": 479, "perf": {"cpu_util_percent": 59.57741935483871, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1173.0, "episode_reward_min": 1173.0, "episode_reward_mean": 1173.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1173.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49845956716798784, "mean_raw_obs_processing_ms": 0.12209591230906876, "mean_inference_ms": 1.5879963223463138, "mean_action_processing_ms": 0.04739092616091778}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1920000, "timers": {"sample_time_ms": 9811.633, "sample_throughput": 407.679, "learn_time_ms": 11932.64, "learn_throughput": 335.215, "update_time_ms": 2.934}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 9.263598531484604, "policy_loss": -0.03157514354097657, "vf_loss": 9.285290017724037, "vf_explained_var": 0.6416437029838562, "kl": 0.008777114751865156, "entropy": 0.14045902504585683, "entropy_coeff": 0.0}}, "num_steps_sampled": 1920000, "num_steps_trained": 1920000}, "done": false, "episodes_total": 192, "training_iteration": 480, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-44-30", "timestamp": 1618148670, "time_this_iter_s": 20.05237865447998, "time_total_s": 10000.229282855988, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68c09d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67c8310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10000.229282855988, "timesteps_since_restore": 0, "iterations_since_restore": 480, "perf": {"cpu_util_percent": 59.96785714285715, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1173.0, "episode_reward_min": 1173.0, "episode_reward_mean": 1173.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1173.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49845956716798784, "mean_raw_obs_processing_ms": 0.12209591230906876, "mean_inference_ms": 1.5879963223463138, "mean_action_processing_ms": 0.04739092616091778}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1924000, "timers": {"sample_time_ms": 9687.487, "sample_throughput": 412.904, "learn_time_ms": 11958.053, "learn_throughput": 334.503, "update_time_ms": 2.917}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 8.110251396894455, "policy_loss": -0.024221934552770108, "vf_loss": 8.128958106040955, "vf_explained_var": 0.4824334979057312, "kl": 0.0048976985781337135, "entropy": 0.10613590804859996, "entropy_coeff": 0.0}}, "num_steps_sampled": 1924000, "num_steps_trained": 1924000}, "done": false, "episodes_total": 192, "training_iteration": 481, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-44-52", "timestamp": 1618148692, "time_this_iter_s": 21.59238624572754, "time_total_s": 10021.821669101715, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6868890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b697bf50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10021.821669101715, "timesteps_since_restore": 0, "iterations_since_restore": 481, "perf": {"cpu_util_percent": 59.545161290322575, "ram_util_percent": 27.79999999999999}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1173.0, "episode_reward_min": 1173.0, "episode_reward_mean": 1173.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1173.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49845956716798784, "mean_raw_obs_processing_ms": 0.12209591230906876, "mean_inference_ms": 1.5879963223463138, "mean_action_processing_ms": 0.04739092616091778}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1928000, "timers": {"sample_time_ms": 9542.404, "sample_throughput": 419.182, "learn_time_ms": 11935.208, "learn_throughput": 335.143, "update_time_ms": 2.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 7.44681079685688, "policy_loss": -0.033017609210219234, "vf_loss": 7.47282138466835, "vf_explained_var": 0.7111740112304688, "kl": 0.012444807041902095, "entropy": 0.1260948139242828, "entropy_coeff": 0.0}}, "num_steps_sampled": 1928000, "num_steps_trained": 1928000}, "done": false, "episodes_total": 192, "training_iteration": 482, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-45-12", "timestamp": 1618148712, "time_this_iter_s": 20.127491235733032, "time_total_s": 10041.949160337448, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67c85d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67c8c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10041.949160337448, "timesteps_since_restore": 0, "iterations_since_restore": 482, "perf": {"cpu_util_percent": 58.91724137931033, "ram_util_percent": 27.796551724137924}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 958.0, "episode_reward_min": 958.0, "episode_reward_mean": 958.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [958.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4974635416783503, "mean_raw_obs_processing_ms": 0.12239421199338862, "mean_inference_ms": 1.5880078983618011, "mean_action_processing_ms": 0.04739288220245702}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1932000, "timers": {"sample_time_ms": 9523.129, "sample_throughput": 420.03, "learn_time_ms": 11914.092, "learn_throughput": 335.737, "update_time_ms": 2.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 7.774390414357185, "policy_loss": -0.03614401337108575, "vf_loss": 7.802378535270691, "vf_explained_var": 0.7580122351646423, "kl": 0.01448543430888094, "entropy": 0.18462415784597397, "entropy_coeff": 0.0}}, "num_steps_sampled": 1932000, "num_steps_trained": 1932000}, "done": false, "episodes_total": 193, "training_iteration": 483, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-45-32", "timestamp": 1618148732, "time_this_iter_s": 20.253212928771973, "time_total_s": 10062.20237326622, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bdc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67c8390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10062.20237326622, "timesteps_since_restore": 0, "iterations_since_restore": 483, "perf": {"cpu_util_percent": 59.68275862068966, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 958.0, "episode_reward_min": 958.0, "episode_reward_mean": 958.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [958.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4974635416783503, "mean_raw_obs_processing_ms": 0.12239421199338862, "mean_inference_ms": 1.5880078983618011, "mean_action_processing_ms": 0.04739288220245702}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1936000, "timers": {"sample_time_ms": 9374.736, "sample_throughput": 426.679, "learn_time_ms": 11922.668, "learn_throughput": 335.495, "update_time_ms": 2.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 6.829929918050766, "policy_loss": -0.024130256613716483, "vf_loss": 6.848591059446335, "vf_explained_var": 0.438805490732193, "kl": 0.009713388011732604, "entropy": 0.09881814382970333, "entropy_coeff": 0.0}}, "num_steps_sampled": 1936000, "num_steps_trained": 1936000}, "done": false, "episodes_total": 193, "training_iteration": 484, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-45-54", "timestamp": 1618148754, "time_this_iter_s": 21.109312772750854, "time_total_s": 10083.311686038971, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6a09610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6952090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10083.311686038971, "timesteps_since_restore": 0, "iterations_since_restore": 484, "perf": {"cpu_util_percent": 59.830000000000005, "ram_util_percent": 27.720000000000013}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1045.0, "episode_reward_min": 1045.0, "episode_reward_mean": 1045.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1045.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49666665569151297, "mean_raw_obs_processing_ms": 0.12259336105402908, "mean_inference_ms": 1.5879760435617742, "mean_action_processing_ms": 0.0473929146171487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1940000, "timers": {"sample_time_ms": 9024.092, "sample_throughput": 443.258, "learn_time_ms": 11942.125, "learn_throughput": 334.949, "update_time_ms": 2.874}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 7.997365847229958, "policy_loss": -0.021103934559505433, "vf_loss": 8.012384712696075, "vf_explained_var": 0.6706643104553223, "kl": 0.010807540340465494, "entropy": 0.1657613543793559, "entropy_coeff": 0.0}}, "num_steps_sampled": 1940000, "num_steps_trained": 1940000}, "done": false, "episodes_total": 194, "training_iteration": 485, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-46-13", "timestamp": 1618148773, "time_this_iter_s": 19.81314253807068, "time_total_s": 10103.124828577042, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6767910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10103.124828577042, "timesteps_since_restore": 0, "iterations_since_restore": 485, "perf": {"cpu_util_percent": 58.47857142857142, "ram_util_percent": 27.792857142857137}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1045.0, "episode_reward_min": 1045.0, "episode_reward_mean": 1045.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1045.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49666665569151297, "mean_raw_obs_processing_ms": 0.12259336105402908, "mean_inference_ms": 1.5879760435617742, "mean_action_processing_ms": 0.0473929146171487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1944000, "timers": {"sample_time_ms": 8804.932, "sample_throughput": 454.291, "learn_time_ms": 11948.505, "learn_throughput": 334.77, "update_time_ms": 2.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 9.195600599050522, "policy_loss": -0.027704388718120754, "vf_loss": 9.21834272146225, "vf_explained_var": 0.4890270233154297, "kl": 0.008813458785880357, "entropy": 0.1401396046858281, "entropy_coeff": 0.0}}, "num_steps_sampled": 1944000, "num_steps_trained": 1944000}, "done": false, "episodes_total": 194, "training_iteration": 486, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-46-34", "timestamp": 1618148794, "time_this_iter_s": 20.333747386932373, "time_total_s": 10123.458575963974, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bda10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6868cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10123.458575963974, "timesteps_since_restore": 0, "iterations_since_restore": 486, "perf": {"cpu_util_percent": 59.73448275862068, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1045.0, "episode_reward_min": 1045.0, "episode_reward_mean": 1045.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1045.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49666665569151297, "mean_raw_obs_processing_ms": 0.12259336105402908, "mean_inference_ms": 1.5879760435617742, "mean_action_processing_ms": 0.0473929146171487}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1948000, "timers": {"sample_time_ms": 8636.272, "sample_throughput": 463.163, "learn_time_ms": 11960.596, "learn_throughput": 334.431, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 5.226583279669285, "policy_loss": -0.03456632973393425, "vf_loss": 5.25508027523756, "vf_explained_var": 0.6779904365539551, "kl": 0.010779659191030078, "entropy": 0.19440232450142503, "entropy_coeff": 0.0}}, "num_steps_sampled": 1948000, "num_steps_trained": 1948000}, "done": false, "episodes_total": 194, "training_iteration": 487, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-46-54", "timestamp": 1618148814, "time_this_iter_s": 19.865392446517944, "time_total_s": 10143.323968410492, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67675d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cfc50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10143.323968410492, "timesteps_since_restore": 0, "iterations_since_restore": 487, "perf": {"cpu_util_percent": 59.76551724137932, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 814.0, "episode_reward_min": 814.0, "episode_reward_mean": 814.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [814.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4954685564967271, "mean_raw_obs_processing_ms": 0.12289564330293405, "mean_inference_ms": 1.5879042033591046, "mean_action_processing_ms": 0.04739055370082756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1952000, "timers": {"sample_time_ms": 8544.877, "sample_throughput": 468.117, "learn_time_ms": 12011.488, "learn_throughput": 333.015, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 10.244513034820557, "policy_loss": -0.030259404215030372, "vf_loss": 10.269137620925903, "vf_explained_var": 0.3929218053817749, "kl": 0.010008020530221984, "entropy": 0.11972515238448977, "entropy_coeff": 0.0}}, "num_steps_sampled": 1952000, "num_steps_trained": 1952000}, "done": false, "episodes_total": 195, "training_iteration": 488, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-47-15", "timestamp": 1618148835, "time_this_iter_s": 21.44743061065674, "time_total_s": 10164.771399021149, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b697b490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10164.771399021149, "timesteps_since_restore": 0, "iterations_since_restore": 488, "perf": {"cpu_util_percent": 59.43333333333332, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 814.0, "episode_reward_min": 814.0, "episode_reward_mean": 814.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [814.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4954685564967271, "mean_raw_obs_processing_ms": 0.12289564330293405, "mean_inference_ms": 1.5879042033591046, "mean_action_processing_ms": 0.04739055370082756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1956000, "timers": {"sample_time_ms": 8518.252, "sample_throughput": 469.58, "learn_time_ms": 11983.933, "learn_throughput": 333.78, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 5.27806781232357, "policy_loss": -0.03334575757617131, "vf_loss": 5.306506529450417, "vf_explained_var": 0.3411352038383484, "kl": 0.008715233736438677, "entropy": 0.10495544271543622, "entropy_coeff": 0.0}}, "num_steps_sampled": 1956000, "num_steps_trained": 1956000}, "done": false, "episodes_total": 195, "training_iteration": 489, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-47-36", "timestamp": 1618148856, "time_this_iter_s": 20.524336576461792, "time_total_s": 10185.29573559761, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69cdb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69b0c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10185.29573559761, "timesteps_since_restore": 0, "iterations_since_restore": 489, "perf": {"cpu_util_percent": 58.97666666666667, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1508.0, "episode_reward_min": 1508.0, "episode_reward_mean": 1508.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1508.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4947577880153158, "mean_raw_obs_processing_ms": 0.12310048617624973, "mean_inference_ms": 1.5879525942028885, "mean_action_processing_ms": 0.04739226531282152}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1960000, "timers": {"sample_time_ms": 8557.458, "sample_throughput": 467.429, "learn_time_ms": 11969.579, "learn_throughput": 334.181, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 6.7198136150836945, "policy_loss": -0.038295692997053266, "vf_loss": 6.752628073096275, "vf_explained_var": 0.36834123730659485, "kl": 0.00973520254046889, "entropy": 0.11127222701907158, "entropy_coeff": 0.0}}, "num_steps_sampled": 1960000, "num_steps_trained": 1960000}, "done": false, "episodes_total": 196, "training_iteration": 490, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-47-56", "timestamp": 1618148876, "time_this_iter_s": 20.30400586128235, "time_total_s": 10205.599741458893, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b02d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b7228510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10205.599741458893, "timesteps_since_restore": 0, "iterations_since_restore": 490, "perf": {"cpu_util_percent": 59.841379310344834, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1508.0, "episode_reward_min": 1508.0, "episode_reward_mean": 1508.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1508.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4947577880153158, "mean_raw_obs_processing_ms": 0.12310048617624973, "mean_inference_ms": 1.5879525942028885, "mean_action_processing_ms": 0.04739226531282152}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1964000, "timers": {"sample_time_ms": 8542.049, "sample_throughput": 468.272, "learn_time_ms": 11963.385, "learn_throughput": 334.354, "update_time_ms": 3.105}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 8.984931141138077, "policy_loss": -0.0437063715653494, "vf_loss": 9.01713202893734, "vf_explained_var": 0.5555297136306763, "kl": 0.02043425675947219, "entropy": 0.1434773593209684, "entropy_coeff": 0.0}}, "num_steps_sampled": 1964000, "num_steps_trained": 1964000}, "done": false, "episodes_total": 196, "training_iteration": 491, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-48-17", "timestamp": 1618148897, "time_this_iter_s": 21.37555718421936, "time_total_s": 10226.975298643112, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6900090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69cd810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10226.975298643112, "timesteps_since_restore": 0, "iterations_since_restore": 491, "perf": {"cpu_util_percent": 59.55333333333333, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1508.0, "episode_reward_min": 1508.0, "episode_reward_mean": 1508.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1508.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4947577880153158, "mean_raw_obs_processing_ms": 0.12310048617624973, "mean_inference_ms": 1.5879525942028885, "mean_action_processing_ms": 0.04739226531282152}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1968000, "timers": {"sample_time_ms": 8512.32, "sample_throughput": 469.907, "learn_time_ms": 11980.051, "learn_throughput": 333.888, "update_time_ms": 3.247}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 8.038194492459297, "policy_loss": -0.03325983649119735, "vf_loss": 8.066283077001572, "vf_explained_var": 0.4605427384376526, "kl": 0.006123089297034312, "entropy": 0.12157960631884634, "entropy_coeff": 0.0}}, "num_steps_sampled": 1968000, "num_steps_trained": 1968000}, "done": false, "episodes_total": 196, "training_iteration": 492, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-48-37", "timestamp": 1618148917, "time_this_iter_s": 20.000577688217163, "time_total_s": 10246.97587633133, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6952d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b96284d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10246.97587633133, "timesteps_since_restore": 0, "iterations_since_restore": 492, "perf": {"cpu_util_percent": 59.44827586206896, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1168.0, "episode_reward_min": 1168.0, "episode_reward_mean": 1168.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1168.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4935007576656871, "mean_raw_obs_processing_ms": 0.12341376412049697, "mean_inference_ms": 1.5881186953359157, "mean_action_processing_ms": 0.04739867252891956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1972000, "timers": {"sample_time_ms": 8534.757, "sample_throughput": 468.672, "learn_time_ms": 11994.089, "learn_throughput": 333.498, "update_time_ms": 3.268}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 9.274429053068161, "policy_loss": -0.0239144979568664, "vf_loss": 9.292128190398216, "vf_explained_var": 0.4857344329357147, "kl": 0.007359118142630905, "entropy": 0.1518987794406712, "entropy_coeff": 0.0}}, "num_steps_sampled": 1972000, "num_steps_trained": 1972000}, "done": false, "episodes_total": 197, "training_iteration": 493, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-48-58", "timestamp": 1618148938, "time_this_iter_s": 20.617588996887207, "time_total_s": 10267.593465328217, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b67c82d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b67c8d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10267.593465328217, "timesteps_since_restore": 0, "iterations_since_restore": 493, "perf": {"cpu_util_percent": 59.658620689655166, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1168.0, "episode_reward_min": 1168.0, "episode_reward_mean": 1168.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1168.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4935007576656871, "mean_raw_obs_processing_ms": 0.12341376412049697, "mean_inference_ms": 1.5881186953359157, "mean_action_processing_ms": 0.04739867252891956}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1976000, "timers": {"sample_time_ms": 8477.713, "sample_throughput": 471.825, "learn_time_ms": 12010.544, "learn_throughput": 333.041, "update_time_ms": 3.279}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 9.20632991194725, "policy_loss": -0.04043180667213164, "vf_loss": 9.238414123654366, "vf_explained_var": 0.4879779815673828, "kl": 0.009884047118248418, "entropy": 0.13213062519207597, "entropy_coeff": 0.0}}, "num_steps_sampled": 1976000, "num_steps_trained": 1976000}, "done": false, "episodes_total": 197, "training_iteration": 494, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-49-19", "timestamp": 1618148959, "time_this_iter_s": 20.70226812362671, "time_total_s": 10288.295733451843, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68bddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6868fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10288.295733451843, "timesteps_since_restore": 0, "iterations_since_restore": 494, "perf": {"cpu_util_percent": 59.633333333333326, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1162.0, "episode_reward_min": 1162.0, "episode_reward_mean": 1162.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1162.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4924661694689442, "mean_raw_obs_processing_ms": 0.1235983922735331, "mean_inference_ms": 1.588020295851173, "mean_action_processing_ms": 0.047395205282213825}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1980000, "timers": {"sample_time_ms": 8465.996, "sample_throughput": 472.478, "learn_time_ms": 11990.176, "learn_throughput": 333.606, "update_time_ms": 3.229}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 12.839364796876907, "policy_loss": -0.032812464982271194, "vf_loss": 12.863760352134705, "vf_explained_var": 0.532971203327179, "kl": 0.009965823381207883, "entropy": 0.15010622958652675, "entropy_coeff": 0.0}}, "num_steps_sampled": 1980000, "num_steps_trained": 1980000}, "done": false, "episodes_total": 198, "training_iteration": 495, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-49-38", "timestamp": 1618148978, "time_this_iter_s": 19.491113424301147, "time_total_s": 10307.786846876144, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b699f390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10307.786846876144, "timesteps_since_restore": 0, "iterations_since_restore": 495, "perf": {"cpu_util_percent": 59.47500000000001, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1162.0, "episode_reward_min": 1162.0, "episode_reward_mean": 1162.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1162.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4924661694689442, "mean_raw_obs_processing_ms": 0.1235983922735331, "mean_inference_ms": 1.588020295851173, "mean_action_processing_ms": 0.047395205282213825}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1984000, "timers": {"sample_time_ms": 8482.897, "sample_throughput": 471.537, "learn_time_ms": 11987.861, "learn_throughput": 333.671, "update_time_ms": 3.221}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 10.230698823928833, "policy_loss": -0.02757290261797607, "vf_loss": 10.251741364598274, "vf_explained_var": 0.4420509338378906, "kl": 0.007732169397058897, "entropy": 0.11535407067276537, "entropy_coeff": 0.0}}, "num_steps_sampled": 1984000, "num_steps_trained": 1984000}, "done": false, "episodes_total": 198, "training_iteration": 496, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-49-59", "timestamp": 1618148999, "time_this_iter_s": 20.4832603931427, "time_total_s": 10328.270107269287, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b68cfa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b68cfe10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10328.270107269287, "timesteps_since_restore": 0, "iterations_since_restore": 496, "perf": {"cpu_util_percent": 58.57586206896553, "ram_util_percent": 27.703448275862076}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1162.0, "episode_reward_min": 1162.0, "episode_reward_mean": 1162.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1162.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4924661694689442, "mean_raw_obs_processing_ms": 0.1235983922735331, "mean_inference_ms": 1.588020295851173, "mean_action_processing_ms": 0.047395205282213825}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1988000, "timers": {"sample_time_ms": 8480.859, "sample_throughput": 471.65, "learn_time_ms": 11998.722, "learn_throughput": 333.369, "update_time_ms": 3.215}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 12.442801147699356, "policy_loss": -0.028342257399344817, "vf_loss": 12.46382948756218, "vf_explained_var": 0.6045039296150208, "kl": 0.008659860992338508, "entropy": 0.1539629187900573, "entropy_coeff": 0.0}}, "num_steps_sampled": 1988000, "num_steps_trained": 1988000}, "done": false, "episodes_total": 198, "training_iteration": 497, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-50-19", "timestamp": 1618149019, "time_this_iter_s": 19.95423412322998, "time_total_s": 10348.224341392517, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b6799210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6799250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10348.224341392517, "timesteps_since_restore": 0, "iterations_since_restore": 497, "perf": {"cpu_util_percent": 60.06785714285714, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1415.0, "episode_reward_min": 1415.0, "episode_reward_mean": 1415.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1415.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4910361921745293, "mean_raw_obs_processing_ms": 0.1238577638168993, "mean_inference_ms": 1.5877496792244585, "mean_action_processing_ms": 0.047382839384563384}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1992000, "timers": {"sample_time_ms": 8361.204, "sample_throughput": 478.4, "learn_time_ms": 11955.949, "learn_throughput": 334.561, "update_time_ms": 3.277}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 8.712297409772873, "policy_loss": -0.030366726976353675, "vf_loss": 8.73455810546875, "vf_explained_var": 0.784355103969574, "kl": 0.009597998418030329, "entropy": 0.14990446413867176, "entropy_coeff": 0.0}}, "num_steps_sampled": 1992000, "num_steps_trained": 1992000}, "done": false, "episodes_total": 199, "training_iteration": 498, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-50-39", "timestamp": 1618149039, "time_this_iter_s": 19.820940732955933, "time_total_s": 10368.045282125473, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b69b0c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b6900c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10368.045282125473, "timesteps_since_restore": 0, "iterations_since_restore": 498, "perf": {"cpu_util_percent": 59.51379310344827, "ram_util_percent": 27.700000000000006}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 1415.0, "episode_reward_min": 1415.0, "episode_reward_mean": 1415.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1415.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4910361921745293, "mean_raw_obs_processing_ms": 0.1238577638168993, "mean_inference_ms": 1.5877496792244585, "mean_action_processing_ms": 0.047382839384563384}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1996000, "timers": {"sample_time_ms": 8277.362, "sample_throughput": 483.246, "learn_time_ms": 12023.527, "learn_throughput": 332.681, "update_time_ms": 3.243}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 2.93581110984087, "policy_loss": -0.02643286544480361, "vf_loss": 2.9556007012724876, "vf_explained_var": 0.6017815470695496, "kl": 0.00786599340790417, "entropy": 0.19885341729968786, "entropy_coeff": 0.0}}, "num_steps_sampled": 1996000, "num_steps_trained": 1996000}, "done": false, "episodes_total": 199, "training_iteration": 499, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-50-59", "timestamp": 1618149059, "time_this_iter_s": 20.36530089378357, "time_total_s": 10388.410583019257, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b685d050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b685d790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10388.410583019257, "timesteps_since_restore": 0, "iterations_since_restore": 499, "perf": {"cpu_util_percent": 59.01379310344827, "ram_util_percent": 27.799999999999994}, "trial_id": "aa3c4_00000"}
{"episode_reward_max": 435.0, "episode_reward_min": 435.0, "episode_reward_mean": 435.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [435.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48978744550735454, "mean_raw_obs_processing_ms": 0.12404205831645712, "mean_inference_ms": 1.587631510733462, "mean_action_processing_ms": 0.0473777208666129}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 2000000, "timers": {"sample_time_ms": 8210.518, "sample_throughput": 487.18, "learn_time_ms": 12031.771, "learn_throughput": 332.453, "update_time_ms": 3.232}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8445600671424462, "cur_lr": 5e-05, "total_loss": 6.591186016798019, "policy_loss": -0.0352902683080174, "vf_loss": 6.619668230414391, "vf_explained_var": 0.5399940013885498, "kl": 0.008061044965870678, "entropy": 0.19229381810873747, "entropy_coeff": 0.0}}, "num_steps_sampled": 2000000, "num_steps_trained": 2000000}, "done": true, "episodes_total": 200, "training_iteration": 500, "experiment_id": "74f23f8c05a34750be5ca7f2cbbfac0c", "date": "2021-04-11_13-51-19", "timestamp": 1618149079, "time_this_iter_s": 19.715547800064087, "time_total_s": 10408.12613081932, "pid": 792, "hostname": "24fef9483094", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 3, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7f71b699f550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7f71b69a9550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 3, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10408.12613081932, "timesteps_since_restore": 0, "iterations_since_restore": 500, "perf": {"cpu_util_percent": 60.00000000000001, "ram_util_percent": 27.703571428571433}, "trial_id": "aa3c4_00000"}
